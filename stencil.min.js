(function(e){"use strict";var a,Ss,u,ha,o,q,Bo,Yn,Ko,Yt,M,Y,_e,k,cn,qn,ga,js,Lt,cc,vn,ne,d,Se,en,Ao,So,Jt,hn,mn,Tn,Fo,jc,Vt,sn,Pe,Oc,tt,zc,Sn,Xe,Lc,Nc,ii,wa,Fc,Mc,U,Oe,Gs,Oa,X,Ec,Wi,ts,$i,Vi,Bi,Hi,xs,Ie,Ni,on,os,zi,ps,Ue,$s,At,Ta,En,E,Ti,Ee,un,Cs,wi,re,Si,Ys,xi,oc,To,ma,ve,wt,Ci,tc,ht,K,rn,L,Be,In,h,ss,j,ki,ws,Xt,ae,Ai,Oi,Qr,Ks,Fi,ji,Un,Yr,Vr,Tr,ot,Ce,fi,mi,gn,Ja,nt,Wn,Or,Te,Os,No,Do,nr,se,sr,Is,je,li,fa,$n,Pc,mr,fr,$,Ji,po,ir,Dt,yr,ea,Rn,Qo,Ds,xt,R,Ae,Le,ds,Dn,hs,rt,w,Cn,Rs,Gr,rs,F,Q,Xo,le,fe,f,S,_s,oa,Je,aa,P,Fe,ro,ra,io,eo,Js,Gt,Zs,Xs,zt,ms,to,Sa,Ei,ka,ya,lc,Ye,cs,Jr,bt,nn,Xr,na,Pn,tn,Zn,Mo,Va,ze,Fs,tr,Ps,oe,me,Gn,Zo,oi,ai,ri,pi,Qt,at,Bc,Ri,Nr,Di,Ns,Ls,yi,us,J,Ne,fs,Ha,Mi,Pa,Ra,La,ys,Qs,xo,Ts,Oo,Da,uc,ks,Hs,Es,wo,_o,jo,fo,mo,bi,uo,vi,Ii,An,co,Bs,ao,oo,Jn,so,no,_n,rl,Bn,ol,t,be,yc,Bt,It,Xi,Us,_a,qt,Qi,si,A,ti,Nn,ba,pn,et,Jo,$t,vo,jn,va,Rt,sa,ac,il,$o,Vo,Kn,Io,Nt,Na,zn,fn,Et,yt,ge,Ws,T,ln,pa,Ho,$e,al,ct,zs,da,Cr,Fn,Mr,ec,xe,ut,dc,ns,Mt,Pt,ce,ja,y,Ln,gt,Ht,Aa,qi,_c,W,it,Tt,vc,lo,fc,gi,p,x,bn,qc,Jc,nl,za,G,Ro,nc,jt,As,Hn,N,pt,_i,V,Wt,Ia,Ze,Ct,lt,ls,Ar,Uc,_r,br,rr,Ui,gr,ci,cr,yn,Co,Ot,Ve,ar,ye,dn,ee,we,Zr,Vn,sc,ic,ca,Gc,mt,ua,gc,wc,Hr,pr,rc,pc,bc,ur,he,Dc,Tc,Ac,xa,Ca,Ea,es,Qn,qs,Ma,Po,Wo,la,Vs,bs,Qc,Yo,Lo,bo,wn,Ba,Ut,Ic,Wa,Kr,Ur,Wr,Br,zr,Fr,Qa,kr,xr,wr,go,an,$c,or,dt,ho,vr,gs,kt,hr,We,Kt,lr,Yi,Zc,Ki,Me,di,Ms,vs,hi,er,Zt,ko,On,Er,Za,Xn,Sr,Pi,Xa,ue,Ga,Dr,Li,Lr,Rr,Pr,dr,Ir,Ya,z,$r,qa,Ka,Ua,$a,Qe,Ke,i,v,ke,De,O,I,zo,m,qe,n,de,l,xn,r,D,B,el,tl,Eo,Wc,Fa,Mn,Re,ui,te,C,Gi,Yc,xc,Cc,kn,kc,He,Sc,is,yo,ft,Kc,ie,H,_t,Rc,ni,Hc,vt,Z,Ft,ei,Zi,mc,hc,ta,pe,Ge,Go,ia,qr,qo,st,Uo,jr,sl,Vc,Xc,St,ll,dl,ul,hl,ml,c={},s=function(){return H.__string_rec(this,"")},_=_||{};function g(e,t){var s,n=Object.create(e);for(s in t)n[s]=t[s];return t.toString!==Object.prototype.toString&&(n.toString=t.toString),n}Ss=function(e,t){this.r=new RegExp(e,t.split("u").join(""))},c.EReg=Ss,Ss.__name__="EReg",Ss.prototype={match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,this.r.m!=null},matched:function(e){if(this.r.m!=null&&e>=0&&e<this.r.m.length)return this.r.m[e];throw t.thrown("EReg::matched")},matchedPos:function(){if(this.r.m==null)throw t.thrown("No string matched");return{pos:this.r.m.index,len:this.r.m[0].length}},matchSub:function(e,t,n){if(n==null&&(n=-1),this.r.global){this.r.lastIndex=t,this.r.m=this.r.exec(n<0?e:u.substr(e,0,t+n));var s=this.r.m!=null;return s&&(this.r.s=e),s}return s=this.match(n<0?u.substr(e,t,null):u.substr(e,t,n)),s&&(this.r.s=e,this.r.m.index+=t),s},split:function(e){var t="#__delim__#";return e.replace(this.r,t).split(t)},__class__:Ss},u=function(){},c.HxOverrides=u,u.__name__="HxOverrides",u.strDate=function(e){switch(e.length){case 8:var o,i,n=e.split(":"),s=new Date;return s.setTime(0),s.setUTCHours(n[0]),s.setUTCMinutes(n[1]),s.setUTCSeconds(n[2]),s;case 10:return n=e.split("-"),new Date(n[0],n[1]-1,n[2],0,0,0);case 19:return n=e.split(" "),o=n[0].split("-"),i=n[1].split(":"),new Date(o[0],o[1]-1,o[2],i[0],i[1],i[2]);default:throw t.thrown("Invalid date format : "+e)}},u.cca=function(e,t){var n=e.charCodeAt(t);return n!=n?0[0]:n},u.substr=function(e,t,n){if(n==null)n=e.length;else if(n<0)if(t==0)n=e.length+n;else return"";return e.substr(t,n)},u.remove=function(e,t){var n=e.indexOf(t);return n!=-1&&(e.splice(n,1),!0)},u.now=function(){return Date.now()},ha=function(){},c.Lambda=ha,ha.__name__="Lambda",ha.array=function(e){for(var s,t=[],n=cl(e);n.hasNext();)s=n.next(),t.push(s);return t},Math.__name__="Math",q=function(){},c.Reflect=q,q.__name__="Reflect",q.field=function(e,t){try{return e[t]}catch{return null}},q.fields=function(e){var t,s,n=[];if(e!=null){s=Object.prototype.hasOwnProperty;for(t in e)t!="__id__"&&t!="hx__closures__"&&s.call(e,t)&&n.push(t)}return n},q.isFunction=function(e){return typeof e=="function"&&!e.__name__&&!e.__ename__},q.compare=function(e,t){return e==t?0:e>t?1:-1},q.isEnumValue=function(e){return e!=null&&e.__enum__!=null},q.deleteField=function(e,t){return!!Object.prototype.hasOwnProperty.call(e,t)&&(delete e[t],!0)},q.copy=function(e){if(e==null)return null;for(var n,s={},t=0,o=q.fields(e);t<o.length;)n=o[t],++t,s[n]=q.field(e,n);return s},o=function(){},c.Std=o,o.__name__="Std",o.string=function(e){return H.__string_rec(e,"")},o.parseInt=function(e){var t=parseInt(e);return isNaN(t)?null:t},o.random=function(e){return e<=0?0:Math.floor(Math.random()*e)},Bo=function(){},c["h3d.IDrawable"]=Bo,Bo.__name__="h3d.IDrawable",Bo.__isInterface__=!0,Bo.prototype={__class__:Bo},Yn=function(){var t=this,e=K.CURRENT;e!=null?(this.engine=e,e.onReady=b(this,this.setup),Us.delay(b(this,this.setup),0)):V.start(function(){e=new K,t.engine=e,e.onReady=b(t,t.setup),e.init()})},c["hxd.App"]=Yn,Yn.__name__="hxd.App",Yn.__interfaces__=[Bo],Yn.staticHandler=function(){},Yn.prototype={onResize:function(){},setScene:function(e,n){n==null&&(n=!0);var s=e instanceof ps?e:null,o=e instanceof Ls?e:null;if(s!=null?(this.sevents.removeScene(this.s2d),this.sevents.addScene(e,0)):o!=null&&(this.sevents.removeScene(this.s3d),this.sevents.addScene(e)),n)if(s!=null)this.s2d.dispose();else if(o!=null)this.s3d.dispose();else throw t.thrown("Can't dispose previous scene");s!=null&&(this.s2d=s),o!=null&&(this.s3d=o)},setCurrent:function(){var e=this;this.engine=K.CURRENT,this.isDisposed=!1,this.engine.onReady=Yn.staticHandler,this.engine.onContextLost=b(this,this.onContextLost),this.engine.onResized=function(){if(e.s2d==null)return;e.s2d.checkResize(),e.onResize()},V.setLoop(b(this,this.mainLoop))},onContextLost:function(){this.s3d!=null&&this.s3d.onContextLost()},setScene2D:function(e,t){t==null&&(t=!0),this.sevents.removeScene(this.s2d),this.sevents.addScene(e,0),t&&this.s2d.dispose(),this.s2d=e,e.mark=b(this,this.mark)},setScene3D:function(e,t){t==null&&(t=!0),this.sevents.removeScene(this.s3d),this.sevents.addScene(e),t&&this.s3d.dispose(),this.s3d=e},render:function(e){this.s3d.render(e),this.s2d.render(e)},mark:function(e){this.s3d.mark(e)},setup:function(){var e=this,t=!1;this.engine.onReady=Yn.staticHandler,this.engine.onContextLost=b(this,this.onContextLost),this.engine.onResized=function(){if(e.s2d==null)return;e.s2d.checkResize(),t&&e.onResize()},this.s3d=new Ls,this.s2d=new ps,this.s2d.mark=b(this,this.mark),this.sevents=new nc,this.sevents.addScene(this.s2d),this.sevents.addScene(this.s3d),this.loadAssets(function(){t=!0,e.init(),N.skip(),e.mainLoop(),V.setLoop(b(e,e.mainLoop)),p.initialize()})},dispose:function(){this.engine.onResized=Yn.staticHandler,this.engine.onContextLost=Yn.staticHandler,this.isDisposed=!0,this.s2d!=null&&this.s2d.dispose(),this.s3d!=null&&this.s3d.dispose(),this.sevents!=null&&this.sevents.dispose()},loadAssets:function(e){e()},init:function(){},mainLoop:function(){if(N.update(),this.sevents.checkEvents(),this.isDisposed)return;if(this.update(N.dt),this.isDisposed)return;var e=N.dt;this.s2d!=null&&this.s2d.setElapsedTime(e),this.s3d!=null&&this.s3d.setElapsedTime(e),this.engine.render(this)},update:function(){},__class__:Yn},Ko=function(){this.lastY=0,this.lastX=0,this.dragging=!1,this.pitch=.615,this.yaw=Math.PI/4,this.distance=8.66,this.time=0,Yn.call(this)},c.Stencil=Ko,Ko.__name__="Stencil",Ko.main=function(){Ro.set_loader(new Kt(new Vs(qt.run("oy13:normalmap.pngty10:hxlogo.pngty14:customFont.fntty14:customFont.pngtg")))),new Ko},Ko.__super__=Yn,Ko.prototype=g(Yn.prototype,{init:function(){this.root=new se(this.s3d);var e,t,n,s,o,a,r,c,l,d,u,m,i=new Zn;i.translate(-.5,-.5,.2),i.unindex(),i.addNormals(),i.addUVs(),l=Ro.get_loader().loadCache("hxlogo.png",We).toTexture(),t=new me(i,Rs.create(l),this.root),e=t.material,e.set_castShadows(!1),e.set_receiveShadows(!1),t=new me(i,Rs.create(l),this.root),t.scaleZ=-1,c=1,d=!0,d?t.flags|=c:t.flags&=~c,u=d,u&&(t.flags&131072)!=0&&(c=262144,t.flags|=c),e=t.material.mshader.color__,e.x=0,e.y=.8,e.z=0,e.w=0,e=t.material,e.set_castShadows(!1),e.set_receiveShadows(!1),a=t.material.passes,a.setPassName("alpha"),a.set_culling(xt.Front),r=new Q,r.setFunc(Ae.LessEqual,1,255,0),a.stencil=r,this.mainPass=a,this.mainStencil=r,i=new Zn(2,2,1e-4),i.addNormals(),i.translate(-1,-1,0),t=new me(i,null,this.root),e=t.material.mshader.color__,e.x=0,e.y=1,e.z=.4,e.w=0,e=t.material,e.set_castShadows(!1),e.set_receiveShadows(!1),a=t.material.passes,r=new Q,a.set_depthWrite(!1),r.setFunc(Ae.Always,1),r.setOp(Le.Keep,Le.Keep,Le.Replace),a.stencil=r,this.mainStencil=r,this.mainPass=a,n=-.5,s=-.5,o=-.5,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),m=new Ha(new h(n,s,o),this.s3d),m.set_enableSpecular(!0),e=H.__cast(this.s3d.lightSystem,Mi).ambientLight,n=.3,s=.3,o=.3,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),e.x=n,e.y=s,e.z=o,this.updateCamera(),e=this.s3d.camera.pos,n=5,s=5,o=5,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),e.x=n,e.y=s,e.z=o,pt.getInstance().addEventTarget(b(this,this.onEvent))},onEvent:function(e){switch(e.kind._hx_index){case 0:e.button==0&&(this.dragging=!0,this.lastX=e.relX,this.lastY=e.relY);break;case 1:e.button==0&&(this.dragging=!1);break;case 2:if(this.dragging){var n=e.relX-this.lastX,t=e.relY-this.lastY;this.yaw+=n*.01,this.pitch+=t*.01,this.pitch>1.4&&(this.pitch=1.4),this.pitch<-1.4&&(this.pitch=-1.4),this.lastX=e.relX,this.lastY=e.relY,this.updateCamera()}break;case 5:this.distance*=1-e.wheelDelta*.1,this.distance<2&&(this.distance=2),this.distance>20&&(this.distance=20),this.updateCamera();break;default:}},updateCamera:function(){var e,o,i,a,n=Math.cos(this.yaw)*Math.cos(this.pitch)*this.distance,s=Math.sin(this.yaw)*Math.cos(this.pitch)*this.distance,t=Math.sin(this.pitch)*this.distance;t>0?(this.mainPass.stencil=this.mainStencil,this.mainPass.set_depthWrite(!1)):(this.mainPass.stencil=null,this.mainPass.set_depthWrite(!0)),e=this.s3d.camera.pos,o=n,i=s,a=t,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),e.x=o,e.y=i,e.z=a,e=this.s3d.camera.target,n=0,s=0,t=0,t==null&&(t=0),s==null&&(s=0),n==null&&(n=0),e.x=n,e.y=s,e.z=t},update:function(e){this.time+=.6*e,this.root.setRotationAxis(0,0,1,this.time)},__class__:Ko}),Yt=function(){this.b=""},c.StringBuf=Yt,Yt.__name__="StringBuf",Yt.prototype={__class__:Yt},M=function(){},c.StringTools=M,M.__name__="StringTools",M.htmlEscape=function(e,t){for(var e,s,o,a,r,n="",i=0,c=e;i<c.length;)switch(e=c,a=i++,s=e.charCodeAt(a),s>=55296&&s<=56319&&(s=s-55232<<10|e.charCodeAt(a+1)&1023),r=s,r>=65536&&++i,o=r,o){case 34:t?n+="&quot;":n+=String.fromCodePoint(o);break;case 38:n+="&amp;";break;case 39:t?n+="&#039;":n+=String.fromCodePoint(o);break;case 60:n+="&lt;";break;case 62:n+="&gt;";break;default:n+=String.fromCodePoint(o)}return n},M.startsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t,0)==0},M.endsWith=function(e,t){var n=t.length,s=e.length;return s>=n&&e.indexOf(t,s-n)==s-n},M.isSpace=function(e,t){var n=u.cca(e,t);return n>8&&n<14||n==32},M.ltrim=function(e){for(var n=e.length,t=0;t<n&&M.isSpace(e,t);)++t;return t>0?u.substr(e,t,n-t):e},M.rtrim=function(e){for(var n=e.length,t=0;t<n&&M.isSpace(e,n-t-1);)++t;return t>0?u.substr(e,0,n-t):e},M.trim=function(e){return M.ltrim(M.rtrim(e))},M.replace=function(e,t,n){return e.split(t).join(n)},M.hex=function(e,t){var n="",s="0123456789ABCDEF";do n=s.charAt(e&15)+n,e>>>=4;while(e>0)if(t!=null)for(;n.length<t;)n="0"+n;return n},Y=function(){},c.Type=Y,Y.__name__="Type",Y.createInstance=function(e,t){var n=Function.prototype.bind.apply(e,[null].concat(t));return new n},Y.createEnum=function(e,n,s){var o=q.field(e,n);if(o==null)throw t.thrown("No such constructor "+n);if(q.isFunction(o)){if(s==null)throw t.thrown("Constructor "+n+" need parameters");return o.apply(e,s)}if(s!=null&&s.length!=0)throw t.thrown("Constructor "+n+" does not need parameters");return o},Y.createEnumIndex=function(e,n,s){var o,a,i=e.__constructs__[n];if(i==null?o=null:(a=i,o=a._hx_name),o==null)throw t.thrown(n+" is not a valid enum constructor index");return Y.createEnum(e,o,s)},Y.enumEq=function(e,t){if(e==t)return!0;try{var n,o,i,a,s=e.__enum__;if(s==null||s!=t.__enum__)return!1;if(e._hx_index!=t._hx_index)return!1;for(a=_[s],o=a.__constructs__[e._hx_index].__params__,n=0;n<o.length;)if(i=o[n],++n,!Y.enumEq(e[i],t[i]))return!1}catch{return!1}return!0},Y.enumParameters=function(e){var t,s,o,i=_[e.__enum__],n=i.__constructs__[e._hx_index].__params__;if(n!=null){for(s=[],t=0;t<n.length;)o=n[t],++t,s.push(e[o]);return s}return[]},_e={},_e.toString=function(e){switch(e){case 0:return"Element";case 1:return"PCData";case 2:return"CData";case 3:return"Comment";case 4:return"DocType";case 5:return"ProcessingInstruction";case 6:return"Document"}},k=function(e){this.nodeType=e,this.children=[],this.attributeMap=new fe},c.Xml=k,k.__name__="Xml",k.parse=function(e){return zs.parse(e)},k.createElement=function(e){var n=new k(k.Element);if(n.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element but found "+(n.nodeType==null?"null":_e.toString(n.nodeType)));return n.nodeName=e,n},k.createPCData=function(e){var n=new k(k.PCData);if(n.nodeType==k.Document||n.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(n.nodeType==null?"null":_e.toString(n.nodeType)));return n.nodeValue=e,n},k.createCData=function(e){var n=new k(k.CData);if(n.nodeType==k.Document||n.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(n.nodeType==null?"null":_e.toString(n.nodeType)));return n.nodeValue=e,n},k.createComment=function(e){var n=new k(k.Comment);if(n.nodeType==k.Document||n.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(n.nodeType==null?"null":_e.toString(n.nodeType)));return n.nodeValue=e,n},k.createDocType=function(e){var n=new k(k.DocType);if(n.nodeType==k.Document||n.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(n.nodeType==null?"null":_e.toString(n.nodeType)));return n.nodeValue=e,n},k.createProcessingInstruction=function(e){var n=new k(k.ProcessingInstruction);if(n.nodeType==k.Document||n.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(n.nodeType==null?"null":_e.toString(n.nodeType)));return n.nodeValue=e,n},k.createDocument=function(){return new k(k.Document)},k.prototype={get:function(e){if(this.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element but found "+(this.nodeType==null?"null":_e.toString(this.nodeType)));return this.attributeMap.h[e]},set:function(e,n){if(this.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element but found "+(this.nodeType==null?"null":_e.toString(this.nodeType)));this.attributeMap.h[e]=n},exists:function(e){if(this.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element but found "+(this.nodeType==null?"null":_e.toString(this.nodeType)));return Object.prototype.hasOwnProperty.call(this.attributeMap.h,e)},attributes:function(){if(this.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element but found "+(this.nodeType==null?"null":_e.toString(this.nodeType)));return new sa(this.attributeMap.h)},elements:function(){if(this.nodeType!=k.Document&&this.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element or Document but found "+(this.nodeType==null?"null":_e.toString(this.nodeType)));for(var n,i,s=[],e=0,o=this.children;e<o.length;)n=o[e],++e,n.nodeType==k.Element&&s.push(n);return i=s,new Ws(i)},elementsNamed:function(e){if(this.nodeType!=k.Document&&this.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element or Document but found "+(this.nodeType==null?"null":_e.toString(this.nodeType)));for(var n,o,r,i=[],s=0,a=this.children;s<a.length;){if(n=a[s],++s,n.nodeType==k.Element){if(n.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element but found "+(n.nodeType==null?"null":_e.toString(n.nodeType)));o=n.nodeName==e}else o=!1;o&&i.push(n)}return r=i,new Ws(r)},firstElement:function(){if(this.nodeType!=k.Document&&this.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element or Document but found "+(this.nodeType==null?"null":_e.toString(this.nodeType)));for(var n,e=0,s=this.children;e<s.length;)if(n=s[e],++e,n.nodeType==k.Element)return n;return null},addChild:function(e){if(this.nodeType!=k.Document&&this.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element or Document but found "+(this.nodeType==null?"null":_e.toString(this.nodeType)));e.parent!=null&&e.parent.removeChild(e),this.children.push(e),e.parent=this},removeChild:function(e){if(this.nodeType!=k.Document&&this.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element or Document but found "+(this.nodeType==null?"null":_e.toString(this.nodeType)));return!!u.remove(this.children,e)&&(e.parent=null,!0)},toString:function(){return da.print(this)},__class__:k},cn=_["format.gif.Block"]={__ename__:!0,__constructs__:null,BFrame:(a=function(e){return{_hx_index:0,frame:e,__enum__:"format.gif.Block",toString:s}},a._hx_name="BFrame",a.__params__=["frame"],a),BExtension:(a=function(e){return{_hx_index:1,extension:e,__enum__:"format.gif.Block",toString:s}},a._hx_name="BExtension",a.__params__=["extension"],a),BEOF:{_hx_name:"BEOF",_hx_index:2,__enum__:"format.gif.Block",toString:s}},cn.__constructs__=[cn.BFrame,cn.BExtension,cn.BEOF],cn.__empty_constructs__=[cn.BEOF],qn=_["format.gif.Extension"]={__ename__:!0,__constructs__:null,EGraphicControl:(a=function(e){return{_hx_index:0,gce:e,__enum__:"format.gif.Extension",toString:s}},a._hx_name="EGraphicControl",a.__params__=["gce"],a),EComment:(a=function(e){return{_hx_index:1,text:e,__enum__:"format.gif.Extension",toString:s}},a._hx_name="EComment",a.__params__=["text"],a),EText:(a=function(e){return{_hx_index:2,pte:e,__enum__:"format.gif.Extension",toString:s}},a._hx_name="EText",a.__params__=["pte"],a),EApplicationExtension:(a=function(e){return{_hx_index:3,ext:e,__enum__:"format.gif.Extension",toString:s}},a._hx_name="EApplicationExtension",a.__params__=["ext"],a),EUnknown:(a=function(e,t){return{_hx_index:4,id:e,data:t,__enum__:"format.gif.Extension",toString:s}},a._hx_name="EUnknown",a.__params__=["id","data"],a)},qn.__constructs__=[qn.EGraphicControl,qn.EComment,qn.EText,qn.EApplicationExtension,qn.EUnknown],qn.__empty_constructs__=[],ga=_["format.gif.ApplicationExtension"]={__ename__:!0,__constructs__:null,AENetscapeLooping:(a=function(e){return{_hx_index:0,loops:e,__enum__:"format.gif.ApplicationExtension",toString:s}},a._hx_name="AENetscapeLooping",a.__params__=["loops"],a),AEUnknown:(a=function(e,t,n){return{_hx_index:1,name:e,version:t,data:n,__enum__:"format.gif.ApplicationExtension",toString:s}},a._hx_name="AEUnknown",a.__params__=["name","version","data"],a)},ga.__constructs__=[ga.AENetscapeLooping,ga.AEUnknown],ga.__empty_constructs__=[],js=_["format.gif.Version"]={__ename__:!0,__constructs__:null,GIF87a:{_hx_name:"GIF87a",_hx_index:0,__enum__:"format.gif.Version",toString:s},GIF89a:{_hx_name:"GIF89a",_hx_index:1,__enum__:"format.gif.Version",toString:s},Unknown:(a=function(e){return{_hx_index:2,version:e,__enum__:"format.gif.Version",toString:s}},a._hx_name="Unknown",a.__params__=["version"],a)},js.__constructs__=[js.GIF87a,js.GIF89a,js.Unknown],js.__empty_constructs__=[js.GIF87a,js.GIF89a],Lt=_["format.gif.DisposalMethod"]={__ename__:!0,__constructs__:null,UNSPECIFIED:{_hx_name:"UNSPECIFIED",_hx_index:0,__enum__:"format.gif.DisposalMethod",toString:s},NO_ACTION:{_hx_name:"NO_ACTION",_hx_index:1,__enum__:"format.gif.DisposalMethod",toString:s},FILL_BACKGROUND:{_hx_name:"FILL_BACKGROUND",_hx_index:2,__enum__:"format.gif.DisposalMethod",toString:s},RENDER_PREVIOUS:{_hx_name:"RENDER_PREVIOUS",_hx_index:3,__enum__:"format.gif.DisposalMethod",toString:s},UNDEFINED:(a=function(e){return{_hx_index:4,index:e,__enum__:"format.gif.DisposalMethod",toString:s}},a._hx_name="UNDEFINED",a.__params__=["index"],a)},Lt.__constructs__=[Lt.UNSPECIFIED,Lt.NO_ACTION,Lt.FILL_BACKGROUND,Lt.RENDER_PREVIOUS,Lt.UNDEFINED],Lt.__empty_constructs__=[Lt.UNSPECIFIED,Lt.NO_ACTION,Lt.FILL_BACKGROUND,Lt.RENDER_PREVIOUS],cc=function(e){this.i=e,e.set_bigEndian(!1)},c["format.gif.Reader"]=cc,cc.__name__="format.gif.Reader",cc.prototype={read:function(){var n,s,o,i,a,r,c,l,d,u,e=71;if(this.i.readByte()!=e)throw t.thrown("Invalid header");if(e=73,this.i.readByte()!=e)throw t.thrown("Invalid header");if(e=70,this.i.readByte()!=e)throw t.thrown("Invalid header");switch(a=this.i.readString(3),s=js.GIF89a,a){case"87a":s=js.GIF87a;break;case"89a":s=js.GIF89a;break;default:s=js.Unknown(a)}for(l=this.i.readUInt16(),d=this.i.readUInt16(),o=this.i.readByte(),u=this.i.readByte(),n=this.i.readByte(),n!=0?n=(n+15)/64:n=1,i={width:l,height:d,hasGlobalColorTable:(o&128)==128,colorResolution:(o&112)>>>4,sorted:(o&8)==8,globalColorTableSize:2<<(o&7),backgroundColorIndex:u,pixelAspectRatio:n},r=null,i.hasGlobalColorTable&&(r=this.readColorTable(i.globalColorTableSize)),c=new jn;!0;)if(e=this.readBlock(),c.add(e),e==cn.BEOF)break;return{version:s,logicalScreenDescriptor:i,globalColorTable:r,blocks:c}},readBlock:function(){var e=this.i.readByte();switch(e){case 33:return this.readExtension();case 44:return this.readImage();case 59:return cn.BEOF}return cn.BEOF},readImage:function(){var r=this.i.readUInt16(),c=this.i.readUInt16(),t=this.i.readUInt16(),n=this.i.readUInt16(),e=this.i.readByte(),s=(e&128)==128,o=(e&64)==64,l=(e&32)==32,i=2<<(e&7),a=null;return s&&(a=this.readColorTable(i)),cn.BFrame({x:r,y:c,width:t,height:n,localColorTable:s,interlaced:o,sorted:l,localColorTableSize:i,pixels:this.readPixels(t,n,o),colorTable:a})},readPixels:function(e,n,s){for(var o,i,r,l,u,p,g,j,C,h=this.i,y=e*n,c=new A(new ArrayBuffer(y)),O=h.readByte(),d=h.readByte()-1,w=h.readByte(),b=8,m=1<<O,k=m+1,a=O+1,f=1<<a,_=f-1,x=[],v=0,E=m;v<E;)u=v++,x[u]=[u];for(r=[],l=m+2,u=0,i=0;u<y;){for(j=i;b<a;){if(d==0)break;w|=h.readByte()<<b,b+=8,--d,d==0&&(d=h.readByte())}if(i=w&_,w>>=a,b-=a,i==m){r=x.slice(),l=m+2,a=O+1,f=1<<a,_=f-1;continue}if(i==k)break;if(i<l)j!=m&&(o=r[j].slice(),o.push(r[i][0]),r[l++]=o);else{if(i!=l)throw t.thrown("Invalid LZW code. Excepted: "+l+", got: "+i);o=r[j].slice(),o.push(o[0]),r[l++]=o}for(o=r[i],v=0;v<o.length;)C=o[v],++v,c.b[u++]=C;l==f&&a<12&&(++a,f=1<<a,_=f-1)}for(;d>0;)h.readByte(),--d,d==0&&(d=h.readByte());for(;u<y;)c.b[u++]=0;return s&&(p=new A(new ArrayBuffer(y)),g=this.deinterlace(c,p,8,0,0,e,n),g=this.deinterlace(c,p,8,4,g,e,n),g=this.deinterlace(c,p,4,2,g,e,n),this.deinterlace(c,p,2,1,g,e,n),c=p),c},deinterlace:function(e,t,n,s,o,i,a){for(;s<a;)t.blit(s*i,e,o,i),o+=i,s+=n;return o},readExtension:function(){var e,n,s,o,i,a,r,c,l,d,u,m,f,p,h=this.i.readByte();switch(h){case 1:if(this.i.readByte()!=12)throw t.thrown("Incorrect size of Plain Text Extension introducer block.");for(f=this.i.readUInt16(),m=this.i.readUInt16(),a=this.i.readUInt16(),u=this.i.readUInt16(),d=this.i.readByte(),r=this.i.readByte(),c=this.i.readByte(),l=this.i.readByte(),e=new zn,s=new A(new ArrayBuffer(255)),n=this.i.readByte();n!=0;)this.i.readBytes(s,0,n),e.writeBytes(s,0,n),n=this.i.readByte();return e.flush(),s=e.getBytes(),e.close(),cn.BExtension(qn.EText({textGridX:f,textGridY:m,textGridWidth:a,textGridHeight:u,charCellWidth:d,charCellHeight:r,textForegroundColorIndex:c,textBackgroundColorIndex:l,text:s.toString()}));case 249:if(this.i.readByte()!=4)throw t.thrown("Incorrect Graphic Control Extension block size!");switch(i=this.i.readByte(),(i&28)>>2){case 0:o=Lt.UNSPECIFIED;break;case 1:o=Lt.NO_ACTION;break;case 2:o=Lt.FILL_BACKGROUND;break;case 3:o=Lt.RENDER_PREVIOUS;break;default:o=Lt.UNDEFINED((i&28)>>2)}return p=cn.BExtension(qn.EGraphicControl({disposalMethod:o,userInput:(i&2)==2,hasTransparentColor:(i&1)==1,delay:this.i.readUInt16(),transparentIndex:this.i.readByte()})),this.i.readByte(),p;case 254:for(e=new zn,s=new A(new ArrayBuffer(255)),n=this.i.readByte();n!=0;)this.i.readBytes(s,0,n),e.writeBytes(s,0,n),n=this.i.readByte();return e.flush(),s=e.getBytes(),e.close(),cn.BExtension(qn.EComment(s.toString()));case 255:return this.readApplicationExtension();default:for(e=new zn,s=new A(new ArrayBuffer(255)),n=this.i.readByte();n!=0;)this.i.readBytes(s,0,n),e.writeBytes(s,0,n),n=this.i.readByte();return e.flush(),s=e.getBytes(),e.close(),cn.BExtension(qn.EUnknown(h,s))}},readApplicationExtension:function(){if(this.i.readByte()!=11)throw t.thrown("Incorrect size of Application Extension introducer block.");for(var e,i=this.i.readString(8),a=this.i.readString(3),n=new zn,s=new A(new ArrayBuffer(255)),o=this.i.readByte();o!=0;)this.i.readBytes(s,0,o),n.writeBytes(s,0,o),o=this.i.readByte();return n.flush(),s=n.getBytes(),n.close(),e=s,i=="NETSCAPE"&&a=="2.0"&&e.b[0]==1?cn.BExtension(qn.EApplicationExtension(ga.AENetscapeLooping(e.b[1]|e.b[2]<<8))):cn.BExtension(qn.EApplicationExtension(ga.AEUnknown(i,a,e)))},readBlocks:function(){for(var e=new zn,t=new A(new ArrayBuffer(255)),n=this.i.readByte();n!=0;)this.i.readBytes(t,0,n),e.writeBytes(t,0,n),n=this.i.readByte();return e.flush(),t=e.getBytes(),e.close(),t},readColorTable:function(e){e*=3;for(var s,o,i,n=new A(new ArrayBuffer(e)),t=0;t<e;)s=this.i.readByte(),n.b[t]=s,o=this.i.readByte(),n.b[t+1]=o,i=this.i.readByte(),n.b[t+2]=i,t+=3;return n},__class__:cc},vn=function(){},c["format.gif.Tools"]=vn,vn.__name__="format.gif.Tools",vn.framesCount=function(e){for(var n,o,i,s=0,t=e.blocks.h;t!=null;)o=t.item,t=t.next,n=o,n._hx_index==0&&(i=n.frame,++s);return s},vn.frame=function(e,t){for(var s,i,a,o=0,n=e.blocks.h;n!=null;)if(i=n.item,n=n.next,s=i,s._hx_index==0){if(a=s.frame,o==t)return a;++o}return null},vn.graphicControl=function(e,t){for(var s,i,r,c,l,a=0,o=null,n=e.blocks.h;n!=null;)switch(r=n.item,n=n.next,s=r,s._hx_index){case 0:if(l=s.frame,a==t)return o;o=null,++a;break;case 1:i=s.extension,i._hx_index==0&&(c=i.gce,o=c);break;default:}return null},vn.extractBGRA=function(e,n){for(var s,o,i,a,r,d,u,h,m,f,p,g,b,c=null,v=0,l=e.blocks.h;l!=null;)switch(g=l.item,l=l.next,d=g,d._hx_index){case 0:if(s=d.frame,v==n){if(o=new A(new ArrayBuffer(s.width*s.height*4)),r=s.localColorTable?s.colorTable:e.globalColorTable,r==null)throw t.thrown("Frame does not have a color table!");for(m=c!=null&&c.hasTransparentColor?c.transparentIndex*3:-1,i=0,u=0,f=s.pixels.length;u<f;)p=u++,a=s.pixels.b[p]*3,o.b[i]=r.b[a+2],o.b[i+1]=r.b[a+1],o.b[i+2]=r.b[a],m==a?o.b[i+3]=0:o.b[i+3]=255,i+=4;return o}++v,c=null;break;case 1:h=d.extension,h._hx_index==0&&(b=h.gce,c=b);break;default:}return null},vn.extractRGBA=function(e,n){for(var s,o,i,a,r,d,u,h,m,f,p,g,b,c=null,v=0,l=e.blocks.h;l!=null;)switch(g=l.item,l=l.next,d=g,d._hx_index){case 0:if(s=d.frame,v==n){if(o=new A(new ArrayBuffer(s.width*s.height*4)),r=s.localColorTable?s.colorTable:e.globalColorTable,r==null)throw t.thrown("Frame does not have a color table!");for(m=c!=null&&c.hasTransparentColor?c.transparentIndex*3:-1,i=0,u=0,f=s.pixels.length;u<f;)p=u++,a=s.pixels.b[p]*3,o.b[i]=r.b[a],o.b[i+1]=r.b[a+1],o.b[i+2]=r.b[a+2],m==a?o.b[i+3]=0:o.b[i+3]=255,i+=4;return o}++v,c=null;break;case 1:h=d.extension,h._hx_index==0&&(b=h.gce,c=b);break;default:}return null},vn.extractFullBGRA=function(e,n){for(var s,i,r,c,l,d,h,m,f,p,v,b,j,y,_,w,O,x,C,a=null,g=0,o=new A(new ArrayBuffer(e.logicalScreenDescriptor.width*e.logicalScreenDescriptor.height*4)),u=e.blocks.h;u!=null;)switch(b=u.item,u=u.next,d=b,d._hx_index){case 0:if(i=d.frame,r=i.localColorTable?i.colorTable:e.globalColorTable,r==null)throw t.thrown("Frame does not have a color table!");switch(y=a!=null&&a.hasTransparentColor?a.transparentIndex*3:-1,h=i.pixels,l=0,s=(i.y*e.logicalScreenDescriptor.width+i.x)*4,f=(e.logicalScreenDescriptor.width-i.width)*4+4,j=g!=n&&a!=null?a.disposalMethod:Lt.NO_ACTION,j._hx_index){case 2:for(m=0,_=h.length;m<_;)C=m++,o.b[s]=0,o.b[s+1]=0,o.b[s+2]=0,o.b[s+3]=0,++l==i.width?(l=0,s+=f):s+=4;break;case 3:break;default:for(p=0,w=h.length;p<w;)O=p++,c=h.b[O]*3,y!=c&&(o.b[s]=r.b[c+2],o.b[s+1]=r.b[c+1],o.b[s+2]=r.b[c],o.b[s+3]=255),++l==i.width?(l=0,s+=f):s+=4}if(g==n)return o;++g,a=null;break;case 1:v=d.extension,v._hx_index==0&&(x=v.gce,a=x);break;default:}return o},vn.extractFullRGBA=function(e,n){for(var s,i,r,c,l,d,h,m,f,p,v,b,j,y,_,w,O,x,C,a=null,g=0,o=new A(new ArrayBuffer(e.logicalScreenDescriptor.width*e.logicalScreenDescriptor.height*4)),u=e.blocks.h;u!=null;)switch(b=u.item,u=u.next,d=b,d._hx_index){case 0:if(i=d.frame,r=i.localColorTable?i.colorTable:e.globalColorTable,r==null)throw t.thrown("Frame does not have a color table!");switch(y=a!=null&&a.hasTransparentColor?a.transparentIndex*3:-1,h=i.pixels,l=0,s=(i.y*e.logicalScreenDescriptor.width+i.x)*4,f=(e.logicalScreenDescriptor.width-i.width)*4+4,j=g!=n&&a!=null?a.disposalMethod:Lt.NO_ACTION,j._hx_index){case 2:for(m=0,_=h.length;m<_;)C=m++,o.b[s]=0,o.b[s+1]=0,o.b[s+2]=0,o.b[s+3]=0,++l==i.width?(l=0,s+=f):s+=4;break;case 3:break;default:for(p=0,w=h.length;p<w;)O=p++,c=h.b[O]*3,y!=c&&(o.b[s]=r.b[c],o.b[s+1]=r.b[c+1],o.b[s+2]=r.b[c+2],o.b[s+3]=255),++l==i.width?(l=0,s+=f):s+=4}if(g==n)return o;++g,a=null;break;case 1:v=d.extension,v._hx_index==0&&(x=v.gce,a=x);break;default:}return o},vn.loopCount=function(e){for(var n,s,o,i,a,t=e.blocks.h;t!=null;)if(i=t.item,t=t.next,n=i,n._hx_index==1&&(s=n.extension,s._hx_index==3&&(o=s.ext,o._hx_index==0)))return a=o.loops,a;return 1},vn.log2=function(e){return Math.log(e)/vn.LN2},ne=_["format.mp3.SamplingRate"]={__ename__:!0,__constructs__:null,SR_8000:{_hx_name:"SR_8000",_hx_index:0,__enum__:"format.mp3.SamplingRate",toString:s},SR_11025:{_hx_name:"SR_11025",_hx_index:1,__enum__:"format.mp3.SamplingRate",toString:s},SR_12000:{_hx_name:"SR_12000",_hx_index:2,__enum__:"format.mp3.SamplingRate",toString:s},SR_22050:{_hx_name:"SR_22050",_hx_index:3,__enum__:"format.mp3.SamplingRate",toString:s},SR_24000:{_hx_name:"SR_24000",_hx_index:4,__enum__:"format.mp3.SamplingRate",toString:s},SR_32000:{_hx_name:"SR_32000",_hx_index:5,__enum__:"format.mp3.SamplingRate",toString:s},SR_44100:{_hx_name:"SR_44100",_hx_index:6,__enum__:"format.mp3.SamplingRate",toString:s},SR_48000:{_hx_name:"SR_48000",_hx_index:7,__enum__:"format.mp3.SamplingRate",toString:s},SR_Bad:{_hx_name:"SR_Bad",_hx_index:8,__enum__:"format.mp3.SamplingRate",toString:s}},ne.__constructs__=[ne.SR_8000,ne.SR_11025,ne.SR_12000,ne.SR_22050,ne.SR_24000,ne.SR_32000,ne.SR_44100,ne.SR_48000,ne.SR_Bad],ne.__empty_constructs__=[ne.SR_8000,ne.SR_11025,ne.SR_12000,ne.SR_22050,ne.SR_24000,ne.SR_32000,ne.SR_44100,ne.SR_48000,ne.SR_Bad],d=_["format.mp3.Bitrate"]={__ename__:!0,__constructs__:null,BR_8:{_hx_name:"BR_8",_hx_index:0,__enum__:"format.mp3.Bitrate",toString:s},BR_16:{_hx_name:"BR_16",_hx_index:1,__enum__:"format.mp3.Bitrate",toString:s},BR_24:{_hx_name:"BR_24",_hx_index:2,__enum__:"format.mp3.Bitrate",toString:s},BR_32:{_hx_name:"BR_32",_hx_index:3,__enum__:"format.mp3.Bitrate",toString:s},BR_40:{_hx_name:"BR_40",_hx_index:4,__enum__:"format.mp3.Bitrate",toString:s},BR_48:{_hx_name:"BR_48",_hx_index:5,__enum__:"format.mp3.Bitrate",toString:s},BR_56:{_hx_name:"BR_56",_hx_index:6,__enum__:"format.mp3.Bitrate",toString:s},BR_64:{_hx_name:"BR_64",_hx_index:7,__enum__:"format.mp3.Bitrate",toString:s},BR_80:{_hx_name:"BR_80",_hx_index:8,__enum__:"format.mp3.Bitrate",toString:s},BR_96:{_hx_name:"BR_96",_hx_index:9,__enum__:"format.mp3.Bitrate",toString:s},BR_112:{_hx_name:"BR_112",_hx_index:10,__enum__:"format.mp3.Bitrate",toString:s},BR_128:{_hx_name:"BR_128",_hx_index:11,__enum__:"format.mp3.Bitrate",toString:s},BR_144:{_hx_name:"BR_144",_hx_index:12,__enum__:"format.mp3.Bitrate",toString:s},BR_160:{_hx_name:"BR_160",_hx_index:13,__enum__:"format.mp3.Bitrate",toString:s},BR_176:{_hx_name:"BR_176",_hx_index:14,__enum__:"format.mp3.Bitrate",toString:s},BR_192:{_hx_name:"BR_192",_hx_index:15,__enum__:"format.mp3.Bitrate",toString:s},BR_224:{_hx_name:"BR_224",_hx_index:16,__enum__:"format.mp3.Bitrate",toString:s},BR_256:{_hx_name:"BR_256",_hx_index:17,__enum__:"format.mp3.Bitrate",toString:s},BR_288:{_hx_name:"BR_288",_hx_index:18,__enum__:"format.mp3.Bitrate",toString:s},BR_320:{_hx_name:"BR_320",_hx_index:19,__enum__:"format.mp3.Bitrate",toString:s},BR_352:{_hx_name:"BR_352",_hx_index:20,__enum__:"format.mp3.Bitrate",toString:s},BR_384:{_hx_name:"BR_384",_hx_index:21,__enum__:"format.mp3.Bitrate",toString:s},BR_416:{_hx_name:"BR_416",_hx_index:22,__enum__:"format.mp3.Bitrate",toString:s},BR_448:{_hx_name:"BR_448",_hx_index:23,__enum__:"format.mp3.Bitrate",toString:s},BR_Free:{_hx_name:"BR_Free",_hx_index:24,__enum__:"format.mp3.Bitrate",toString:s},BR_Bad:{_hx_name:"BR_Bad",_hx_index:25,__enum__:"format.mp3.Bitrate",toString:s}},d.__constructs__=[d.BR_8,d.BR_16,d.BR_24,d.BR_32,d.BR_40,d.BR_48,d.BR_56,d.BR_64,d.BR_80,d.BR_96,d.BR_112,d.BR_128,d.BR_144,d.BR_160,d.BR_176,d.BR_192,d.BR_224,d.BR_256,d.BR_288,d.BR_320,d.BR_352,d.BR_384,d.BR_416,d.BR_448,d.BR_Free,d.BR_Bad],d.__empty_constructs__=[d.BR_8,d.BR_16,d.BR_24,d.BR_32,d.BR_40,d.BR_48,d.BR_56,d.BR_64,d.BR_80,d.BR_96,d.BR_112,d.BR_128,d.BR_144,d.BR_160,d.BR_176,d.BR_192,d.BR_224,d.BR_256,d.BR_288,d.BR_320,d.BR_352,d.BR_384,d.BR_416,d.BR_448,d.BR_Free,d.BR_Bad],Se=function(){},c["format.mp3.MPEG"]=Se,Se.__name__="format.mp3.MPEG",Se.enum2Num=function(e){switch(e._hx_index){case 0:return 3;case 1:return 2;case 2:return 0;case 3:return Se.Reserved}},Se.num2Enum=function(e){switch(e){case 0:return Jt.MPEG_V25;case 2:return Jt.MPEG_V2;case 3:return Jt.MPEG_V1;default:return Jt.MPEG_Reserved}},Se.srNum2Enum=function(e){switch(e){case 8e3:return ne.SR_8000;case 11025:return ne.SR_11025;case 12e3:return ne.SR_12000;case 22050:return ne.SR_22050;case 24e3:return ne.SR_24000;case 32e3:return ne.SR_32000;case 44100:return ne.SR_44100;case 48e3:return ne.SR_48000;default:return ne.SR_Bad}},Se.srEnum2Num=function(e){switch(e._hx_index){case 0:return 8e3;case 1:return 11025;case 2:return 12e3;case 3:return 22050;case 4:return 24e3;case 5:return 32e3;case 6:return 44100;case 7:return 48e3;case 8:return-1}},Se.getBitrateIdx=function(e,n,s){var o=(n==Jt.MPEG_V1?Se.V1_Bitrates:Se.V2_Bitrates)[en.enum2Num(s)];if(o[0]==e)return 0;if(o[1]==e)return 1;if(o[2]==e)return 2;if(o[3]==e)return 3;if(o[4]==e)return 4;if(o[5]==e)return 5;if(o[6]==e)return 6;if(o[7]==e)return 7;if(o[8]==e)return 8;if(o[9]==e)return 9;if(o[10]==e)return 10;if(o[11]==e)return 11;if(o[12]==e)return 12;if(o[13]==e)return 13;if(o[14]==e)return 14;if(o[15]==e)return 15;throw t.thrown("Bitrate index not found")},Se.getSamplingRateIdx=function(e,n){var s=Se.SamplingRates[Se.enum2Num(n)];if(s[0]==e)return 0;if(s[1]==e)return 1;if(s[2]==e)return 2;if(s[3]==e)return 3;throw t.thrown("Sampling rate index not found")},Se.bitrateEnum2Num=function(e){switch(e._hx_index){case 0:return 8;case 1:return 16;case 2:return 24;case 3:return 32;case 4:return 40;case 5:return 48;case 6:return 56;case 7:return 64;case 8:return 80;case 9:return 96;case 10:return 112;case 11:return 128;case 12:return 144;case 13:return 160;case 14:return 176;case 15:return 192;case 16:return 224;case 17:return 256;case 18:return 288;case 19:return 320;case 20:return 352;case 21:return 384;case 22:return 416;case 23:return 448;case 24:return 0;case 25:return-1}},Se.bitrateNum2Enum=function(e){switch(e){case 0:return d.BR_Free;case 8:return d.BR_8;case 16:return d.BR_16;case 24:return d.BR_24;case 32:return d.BR_32;case 40:return d.BR_40;case 48:return d.BR_48;case 56:return d.BR_56;case 64:return d.BR_64;case 80:return d.BR_80;case 96:return d.BR_96;case 112:return d.BR_112;case 128:return d.BR_128;case 144:return d.BR_144;case 160:return d.BR_160;case 176:return d.BR_176;case 192:return d.BR_192;case 224:return d.BR_224;case 256:return d.BR_256;case 288:return d.BR_288;case 320:return d.BR_320;case 352:return d.BR_352;case 384:return d.BR_384;case 416:return d.BR_416;case 448:return d.BR_448;default:return d.BR_Bad}},en=function(){},c["format.mp3.CLayer"]=en,en.__name__="format.mp3.CLayer",en.enum2Num=function(e){switch(e._hx_index){case 0:return en.LReserved;case 1:return en.LLayer3;case 2:return en.LLayer2;case 3:return en.LLayer1}},en.num2Enum=function(e){switch(e){case 1:return hn.Layer3;case 2:return hn.Layer2;case 3:return hn.Layer1;default:return hn.LayerReserved}},Ao=function(){},c["format.mp3.CChannelMode"]=Ao,Ao.__name__="format.mp3.CChannelMode",Ao.enum2Num=function(e){switch(e._hx_index){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3}},Ao.num2Enum=function(e){switch(e){case 0:return mn.Stereo;case 1:return mn.JointStereo;case 2:return mn.DualChannel;case 3:return mn.Mono;default:throw t.thrown("assert")}},So=function(){},c["format.mp3.CEmphasis"]=So,So.__name__="format.mp3.CEmphasis",So.enum2Num=function(e){switch(e._hx_index){case 0:return 0;case 1:return 1;case 2:return 3;case 3:return 2}},So.num2Enum=function(e){switch(e){case 0:return Tn.NoEmphasis;case 1:return Tn.Ms50_15;case 2:return Tn.InvalidEmphasis;case 3:return Tn.CCIT_J17;default:throw t.thrown("assert")}},Jt=_["format.mp3.MPEGVersion"]={__ename__:!0,__constructs__:null,MPEG_V1:{_hx_name:"MPEG_V1",_hx_index:0,__enum__:"format.mp3.MPEGVersion",toString:s},MPEG_V2:{_hx_name:"MPEG_V2",_hx_index:1,__enum__:"format.mp3.MPEGVersion",toString:s},MPEG_V25:{_hx_name:"MPEG_V25",_hx_index:2,__enum__:"format.mp3.MPEGVersion",toString:s},MPEG_Reserved:{_hx_name:"MPEG_Reserved",_hx_index:3,__enum__:"format.mp3.MPEGVersion",toString:s}},Jt.__constructs__=[Jt.MPEG_V1,Jt.MPEG_V2,Jt.MPEG_V25,Jt.MPEG_Reserved],Jt.__empty_constructs__=[Jt.MPEG_V1,Jt.MPEG_V2,Jt.MPEG_V25,Jt.MPEG_Reserved],hn=_["format.mp3.Layer"]={__ename__:!0,__constructs__:null,LayerReserved:{_hx_name:"LayerReserved",_hx_index:0,__enum__:"format.mp3.Layer",toString:s},Layer3:{_hx_name:"Layer3",_hx_index:1,__enum__:"format.mp3.Layer",toString:s},Layer2:{_hx_name:"Layer2",_hx_index:2,__enum__:"format.mp3.Layer",toString:s},Layer1:{_hx_name:"Layer1",_hx_index:3,__enum__:"format.mp3.Layer",toString:s}},hn.__constructs__=[hn.LayerReserved,hn.Layer3,hn.Layer2,hn.Layer1],hn.__empty_constructs__=[hn.LayerReserved,hn.Layer3,hn.Layer2,hn.Layer1],mn=_["format.mp3.ChannelMode"]={__ename__:!0,__constructs__:null,Stereo:{_hx_name:"Stereo",_hx_index:0,__enum__:"format.mp3.ChannelMode",toString:s},JointStereo:{_hx_name:"JointStereo",_hx_index:1,__enum__:"format.mp3.ChannelMode",toString:s},DualChannel:{_hx_name:"DualChannel",_hx_index:2,__enum__:"format.mp3.ChannelMode",toString:s},Mono:{_hx_name:"Mono",_hx_index:3,__enum__:"format.mp3.ChannelMode",toString:s}},mn.__constructs__=[mn.Stereo,mn.JointStereo,mn.DualChannel,mn.Mono],mn.__empty_constructs__=[mn.Stereo,mn.JointStereo,mn.DualChannel,mn.Mono],Tn=_["format.mp3.Emphasis"]={__ename__:!0,__constructs__:null,NoEmphasis:{_hx_name:"NoEmphasis",_hx_index:0,__enum__:"format.mp3.Emphasis",toString:s},Ms50_15:{_hx_name:"Ms50_15",_hx_index:1,__enum__:"format.mp3.Emphasis",toString:s},CCIT_J17:{_hx_name:"CCIT_J17",_hx_index:2,__enum__:"format.mp3.Emphasis",toString:s},InvalidEmphasis:{_hx_name:"InvalidEmphasis",_hx_index:3,__enum__:"format.mp3.Emphasis",toString:s}},Tn.__constructs__=[Tn.NoEmphasis,Tn.Ms50_15,Tn.CCIT_J17,Tn.InvalidEmphasis],Tn.__empty_constructs__=[Tn.NoEmphasis,Tn.Ms50_15,Tn.CCIT_J17,Tn.InvalidEmphasis],Fo=_["format.mp3.FrameType"]={__ename__:!0,__constructs__:null,FT_MP3:{_hx_name:"FT_MP3",_hx_index:0,__enum__:"format.mp3.FrameType",toString:s},FT_NONE:{_hx_name:"FT_NONE",_hx_index:1,__enum__:"format.mp3.FrameType",toString:s}},Fo.__constructs__=[Fo.FT_MP3,Fo.FT_NONE],Fo.__empty_constructs__=[Fo.FT_MP3,Fo.FT_NONE],jc=function(e){this.i=e,e.set_bigEndian(!0),this.bits=new Nc(e),this.samples=0,this.sampleSize=0,this.any_read=!1},c["format.mp3.Reader"]=jc,jc.__name__="format.mp3.Reader",jc.prototype={skipID3v2:function(){this.id3v2_version=this.i.readUInt16(),this.id3v2_flags=this.i.readByte();var e=this.i.readByte()&127,e=e<<7|this.i.readByte()&127,e=e<<7|this.i.readByte()&127,e=e<<7|this.i.readByte()&127;this.id3v2_data=this.i.read(e)},seekFrame:function(){var e,n=!1;try{for(;!0;)if(e=this.i.readByte(),this.any_read||(this.any_read=!0,e==73&&(e=this.i.readByte(),e==68&&(e=this.i.readByte(),e==51&&this.skipID3v2()))),e==255&&(this.bits.nbits=0,e=this.bits.readBits(3),e==7))return Fo.FT_MP3}catch(e){if(t.caught(e).unwrap()instanceof fn)return Fo.FT_NONE;throw e}},readFrames:function(){for(var e,t,n=[];!0;){if(e=this.seekFrame(),e==Fo.FT_NONE)break;switch(e._hx_index){case 0:t=this.readFrame(),t!=null&&n.push(t);break;case 1:break}}return n},readFrameHeader:function(){var t,n,o,i,a,r,c,l,u,h,m,f,p,e=this.bits.readBits(2),s=this.bits.readBits(2),g=!this.bits.readBit();return e==Se.Reserved||s==en.LReserved?null:(c=this.bits.readBits(4),t=Vt.getBitrate(e,s,c),a=this.bits.readBits(2),n=Vt.getSamplingRate(e,a),r=this.bits.readBit(),i=this.bits.readBit(),t==d.BR_Bad||t==d.BR_Free||n==ne.SR_Bad?null:(l=this.bits.readBits(2),u=this.bits.readBit(),h=this.bits.readBit(),m=this.bits.readBit(),f=this.bits.readBit(),p=this.bits.readBits(2),o=0,g&&(o=this.i.readUInt16()),{version:Se.num2Enum(e),layer:en.num2Enum(s),hasCrc:g,crc16:o,bitrate:t,samplingRate:n,isPadded:r,privateBit:i,channelMode:Ao.num2Enum(l),isIntensityStereo:u,isMSStereo:h,isCopyrighted:m,isOriginal:f,emphasis:So.num2Enum(p)}))},readFrame:function(){var n,e=this.readFrameHeader();if(e==null||Vt.isInvalidFrameHeader(e))return null;try{return n=this.i.read(Vt.getSampleDataSizeHdr(e)),this.samples+=Vt.getSampleCountHdr(e),this.sampleSize+=n.length,{header:e,data:n}}catch(e){if(t.caught(e).unwrap()instanceof fn)return null;throw e}},read:function(){var e=this.readFrames();return{frames:e,sampleCount:this.samples,sampleSize:this.sampleSize,id3v2:this.id3v2_data==null?null:{versionBytes:this.id3v2_version,flagByte:this.id3v2_flags,data:this.id3v2_data}}},__class__:jc},Vt=function(){},c["format.mp3.Tools"]=Vt,Vt.__name__="format.mp3.Tools",Vt.getBitrate=function(e,t,n){return e==Se.Reserved||t==en.LReserved?d.BR_Bad:(e==3?Se.V1_Bitrates:Se.V2_Bitrates)[t][n]},Vt.getSamplingRate=function(e,t){return Se.SamplingRates[e][t]},Vt.isInvalidFrameHeader=function(e){return e.version==Jt.MPEG_Reserved||e.layer==hn.LayerReserved||e.bitrate==d.BR_Bad||e.bitrate==d.BR_Free||e.samplingRate==ne.SR_Bad},Vt.getSampleDataSize=function(e,t,n,s,o){return((e==3?144:72)*t*1e3/n|0)+(s?1:0)-(o?2:0)-4},Vt.getSampleDataSizeHdr=function(e){return Vt.getSampleDataSize(Se.enum2Num(e.version),Se.bitrateEnum2Num(e.bitrate),Se.srEnum2Num(e.samplingRate),e.isPadded,e.hasCrc)},Vt.getSampleCount=function(e){return e==3?1152:576},Vt.getSampleCountHdr=function(e){return Vt.getSampleCount(Se.enum2Num(e.version))},Vt.getFrameInfo=function(e){return o.string(e.header.version)+", "+o.string(e.header.layer)+", "+o.string(e.header.channelMode)+", "+o.string(e.header.samplingRate)+" Hz, "+o.string(e.header.bitrate)+" kbps Emphasis: "+o.string(e.header.emphasis)+", "+(e.header.hasCrc?"(CRC) ":"")+(e.header.isPadded?"(Padded) ":"")+(e.header.isIntensityStereo?"(Intensity Stereo) ":"")+(e.header.isMSStereo?"(MS Stereo) ":"")+(e.header.isCopyrighted?"(Copyrighted) ":"")+(e.header.isOriginal?"(Original) ":"")},sn=_["format.png.Color"]={__ename__:!0,__constructs__:null,ColGrey:(a=function(e){return{_hx_index:0,alpha:e,__enum__:"format.png.Color",toString:s}},a._hx_name="ColGrey",a.__params__=["alpha"],a),ColTrue:(a=function(e){return{_hx_index:1,alpha:e,__enum__:"format.png.Color",toString:s}},a._hx_name="ColTrue",a.__params__=["alpha"],a),ColIndexed:{_hx_name:"ColIndexed",_hx_index:2,__enum__:"format.png.Color",toString:s}},sn.__constructs__=[sn.ColGrey,sn.ColTrue,sn.ColIndexed],sn.__empty_constructs__=[sn.ColIndexed],Pe=_["format.png.Chunk"]={__ename__:!0,__constructs__:null,CEnd:{_hx_name:"CEnd",_hx_index:0,__enum__:"format.png.Chunk",toString:s},CHeader:(a=function(e){return{_hx_index:1,h:e,__enum__:"format.png.Chunk",toString:s}},a._hx_name="CHeader",a.__params__=["h"],a),CData:(a=function(e){return{_hx_index:2,b:e,__enum__:"format.png.Chunk",toString:s}},a._hx_name="CData",a.__params__=["b"],a),CPalette:(a=function(e){return{_hx_index:3,b:e,__enum__:"format.png.Chunk",toString:s}},a._hx_name="CPalette",a.__params__=["b"],a),CUnknown:(a=function(e,t){return{_hx_index:4,id:e,data:t,__enum__:"format.png.Chunk",toString:s}},a._hx_name="CUnknown",a.__params__=["id","data"],a)},Pe.__constructs__=[Pe.CEnd,Pe.CHeader,Pe.CData,Pe.CPalette,Pe.CUnknown],Pe.__empty_constructs__=[Pe.CEnd],Oc=function(e){this.i=e,e.set_bigEndian(!0),this.checkCRC=!0},c["format.png.Reader"]=Oc,Oc.__name__="format.png.Reader",Oc.prototype={read:function(){var n,s,e=137;if(this.i.readByte()!=e)throw t.thrown("Invalid header");if(e=80,this.i.readByte()!=e)throw t.thrown("Invalid header");if(e=78,this.i.readByte()!=e)throw t.thrown("Invalid header");if(e=71,this.i.readByte()!=e)throw t.thrown("Invalid header");if(e=13,this.i.readByte()!=e)throw t.thrown("Invalid header");if(e=10,this.i.readByte()!=e)throw t.thrown("Invalid header");if(e=26,this.i.readByte()!=e)throw t.thrown("Invalid header");if(e=10,this.i.readByte()!=e)throw t.thrown("Invalid header");for(n=new jn;!0;)if(s=this.readChunk(),n.add(s),s==Pe.CEnd)break;return n},readHeader:function(e){e.set_bigEndian(!0);var n,s,a,r,c=e.readInt32(),l=e.readInt32(),o=e.readByte(),i=e.readByte();switch(i){case 0:n=sn.ColGrey(!1);break;case 2:n=sn.ColTrue(!1);break;case 3:n=sn.ColIndexed;break;case 4:n=sn.ColGrey(!0);break;case 6:n=sn.ColTrue(!0);break;default:throw t.thrown("Unknown color model "+i+":"+o)}if(a=e.readByte(),r=e.readByte(),a!=0||r!=0)throw t.thrown("Invalid header");if(s=e.readByte(),s!=0&&s!=1)throw t.thrown("Invalid header");return{width:c,height:l,colbits:o,color:n,interlaced:s==1}},readChunk:function(){var e,n,i,a,r,c,l=this.i.readInt32(),s=this.i.readString(4),o=this.i.read(l),d=this.i.readInt32();if(this.checkCRC){for(n=-1,e=(n^u.cca(s,0))&255,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,n=n>>>8^e,e=(n^u.cca(s,1))&255,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,n=n>>>8^e,e=(n^u.cca(s,2))&255,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,n=n>>>8^e,e=(n^u.cca(s,3))&255,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,n=n>>>8^e,a=o.b.bufferValue,i=0,r=o.length;i<r;)c=i++,e=(n^a.bytes[c])&255,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,e=e>>>1^-(e&1)&-306674912,n=n>>>8^e;if((n^-1)!=d)throw t.thrown("CRC check failure")}switch(s){case"IDAT":return Pe.CData(o);case"IEND":return Pe.CEnd;case"IHDR":return Pe.CHeader(this.readHeader(new Nt(o)));case"PLTE":return Pe.CPalette(o);default:return Pe.CUnknown(s,o)}},__class__:Oc},tt=function(){},c["format.png.Tools"]=tt,tt.__name__="format.png.Tools",tt.getHeader=function(e){for(var s,o,i,n=e.h;n!=null;)if(o=n.item,n=n.next,s=o,s._hx_index==1)return i=s.h,i;throw t.thrown("Header not found")},tt.getPalette=function(e){for(var n,s,o,t=e.h;t!=null;)if(s=t.item,t=t.next,n=s,n._hx_index==3)return o=n.b,o;return null},tt.filter=function(e,t,n,s,o,i,a){a==null&&(a=4);var r,c,d=n==0?0:e.b[i-s],u=t==0||n==0?0:e.b[i-s-a],h=o+d-u,l=h-o;return l<0&&(l=-l),r=h-d,r<0&&(r=-r),c=h-u,c<0&&(c=-c),l<=r&&l<=c?o:r<=c?d:u},tt.reverseBytes=function(e){for(var s,o,i,a,c,t=0,n=0,r=e.length>>2;n<r;)c=n++,s=e.b[t],o=e.b[t+1],i=e.b[t+2],a=e.b[t+3],e.b[t++]=a,e.b[t++]=i,e.b[t++]=o,e.b[t++]=s},tt.extractGrey=function(e){for(var s,o,a,r,d,u,h,m,f,p,g,v,j,y,_,w,O,x,C,E,k,S,M,F,T,z,D,N,L,R,P,H,I,B,V,$,W,U,K,q,l=tt.getHeader(e),i=new A(new ArrayBuffer(l.width*l.height)),n=null,c=null,b=e.h;b!=null;)R=b.item,b=b.next,d=R,d._hx_index==2&&(r=d.b,c!=null?c.add(r):n==null?n=r:(c=new Kn,c.add(n),c.add(r),n=null));if(c!=null&&(n=c.getBytes()),n==null)throw t.thrown("Data not found");if(n=wa.run(n),s=0,o=0,u=l.color,u._hx_index==0){if(E=u.alpha,l.colbits!=8)throw t.thrown("Unsupported color mode");if(a=l.width,j=(E?2:1)*a+1,n.length<l.height*j)throw t.thrown("Not enough data");for(f=E?2:1,u=0,B=l.height;u<B;)switch(v=u++,k=n.b[s++],k){case 0:for(M=0,z=a;M<z;)U=M++,D=n.b[s],s+=f,i.b[o++]=D;break;case 1:for(O=0,C=0,P=a;C<P;)W=C++,O+=n.b[s],s+=f,i.b[o++]=O;break;case 2:for(j=v==0?0:a,S=0,I=a;S<I;)K=S++,N=n.b[s]+i.b[o-j],s+=f,i.b[o++]=N;break;case 3:for(w=0,H=v==0?0:a,T=0,L=a;T<L;)q=T++,w=n.b[s]+(w+i.b[o-H]>>1)&255,s+=f,i.b[o++]=w;break;case 4:for(F=a,g=0,x=0,$=a;x<$;)V=x++,_=1,_==null&&(_=4),r=v==0?0:i.b[o-F],d=V==0||v==0?0:i.b[o-F-_],y=g+r-d,p=y-g,p<0&&(p=-p),m=y-r,m<0&&(m=-m),h=y-d,h<0&&(h=-h),g=(p<=m&&p<=h?g:m<=h?r:d)+n.b[s]&255,s+=f,i.b[o++]=g;break;default:throw t.thrown("Invalid filter "+k)}}else throw t.thrown("Unsupported color mode");return i},tt.extract32=function(e,n,s){for(var ee,o,a,g,x,ye,he,c,m,v,O,ue,h,E,F,I,B,$,W,Q,He,Ee,ae,J,lt,ne,b,V,le,Y,dt,ie,Re,Qe,Ie,Me,gt,je,jt,Ke,Fe,yt,se,z,it,S,$e,Be,mt,Pe,Ve,ht,p,y,C,Oe,We,Ue,_,w,ut,M,N,R,P,H,K,q,Z,ft,De,vt,Ae,k,T,D,L,pt,re,ce,de,l,d,u,U,G,at,X,rt,be,ve,ge,nt,Ge,Xe,pe,we,_e,et,ot,st,fe,me,xe,Ye,ct,Ze,Ce,ke,Se,te,Le,Ne,qe,ze,bt,Je,Te,f=tt.getHeader(e),i=n??new A(new ArrayBuffer(f.width*f.height*4)),r=null,oe=null,j=e.h;j!=null;)ee=j.item,j=j.next,g=ee,g._hx_index==2&&(x=g.b,oe!=null?oe.add(x):r==null?r=x:(oe=new Kn,oe.add(r),oe.add(x),r=null));if(oe!=null&&(r=oe.getBytes()),r==null)throw t.thrown("Data not found");switch(r=wa.run(r),a=0,o=0,ye=0,s&&(ye=-f.width*8,o=(f.height-1)*(f.width*4)),he=s?-1:1,O=f.color,O._hx_index){case 0:if(m=O.alpha,f.colbits!=8)throw t.thrown("Unsupported color mode");if(c=f.width,v=(m?2:1)*c+1,r.length<f.height*v)throw t.thrown("Not enough data");if(ue=-1,!m)for(j=e.h;j!=null;)if(ee=j.item,j=j.next,F=ee,F._hx_index==4&&F.id=="tRNS"){$=F.data,$.length>=2&&(ue=$.b[1]);break}for(B=0,E=f.height;B<E;){switch(h=B++,W=r.b[a++],W){case 0:if(m)for(I=0,Q=c;I<Q;)He=I++,Ee=r.b[a++],i.b[o++]=Ee,i.b[o++]=Ee,i.b[o++]=Ee,i.b[o++]=r.b[a++];else for(ae=0,J=c;ae<J;)lt=ae++,ne=r.b[a++],i.b[o++]=ne,i.b[o++]=ne,i.b[o++]=ne,i.b[o++]=ne==ue?0:255;break;case 1:if(V=0,b=0,m)for(le=0,Y=c;le<Y;)dt=le++,V+=r.b[a++],i.b[o++]=V,i.b[o++]=V,i.b[o++]=V,b+=r.b[a++],i.b[o++]=b;else for(ie=0,Re=c;ie<Re;)Qe=ie++,V+=r.b[a++],i.b[o++]=V,i.b[o++]=V,i.b[o++]=V,i.b[o++]=V==ue?0:255;break;case 2:if(v=h==0?0:c*4*he,m)for(Ie=0,Me=c;Ie<Me;)gt=Ie++,je=r.b[a++]+i.b[o-v],i.b[o++]=je,i.b[o++]=je,i.b[o++]=je,jt=r.b[a++]+i.b[o-v],i.b[o++]=jt;else for(Ke=0,Fe=c;Ke<Fe;)yt=Ke++,se=r.b[a++]+i.b[o-v],i.b[o++]=se,i.b[o++]=se,i.b[o++]=se,i.b[o++]=se==ue?0:255;break;case 3:if(z=0,it=0,S=h==0?0:c*4*he,m)for($e=0,Be=c;$e<Be;)mt=$e++,z=r.b[a++]+(z+i.b[o-S]>>1)&255,i.b[o++]=z,i.b[o++]=z,i.b[o++]=z,it=r.b[a++]+(it+i.b[o-S]>>1)&255,i.b[o++]=it;else for(Pe=0,Ve=c;Pe<Ve;)ht=Pe++,z=r.b[a++]+(z+i.b[o-S]>>1)&255,i.b[o++]=z,i.b[o++]=z,i.b[o++]=z,i.b[o++]=z==ue?0:255;break;case 4:if(p=c*4*he,C=0,Oe=0,m)for(We=0,Ue=c;We<Ue;)Z=We++,x=h==0?0:i.b[o-p],g=Z==0||h==0?0:i.b[o-p-4],N=C+x-g,w=N-C,w<0&&(w=-w),_=N-x,_<0&&(_=-_),y=N-g,y<0&&(y=-y),ut=a++,C=(w<=_&&w<=y?C:_<=y?x:g)+r.b[ut]&255,i.b[o++]=C,i.b[o++]=C,i.b[o++]=C,q=h==0?0:i.b[o-p],R=Z==0||h==0?0:i.b[o-p-4],K=Oe+q-R,P=K-Oe,P<0&&(P=-P),H=K-q,H<0&&(H=-H),M=K-R,M<0&&(M=-M),ft=a++,Oe=(P<=H&&P<=M?Oe:H<=M?q:R)+r.b[ft]&255,i.b[o++]=Oe;else for(De=0,vt=c;De<vt;)Ae=De++,G=h==0?0:i.b[o-p],k=Ae==0||h==0?0:i.b[o-p-4],U=C+G-k,D=U-C,D<0&&(D=-D),T=U-G,T<0&&(T=-T),L=U-k,L<0&&(L=-L),pt=a++,C=(D<=T&&D<=L?C:T<=L?G:k)+r.b[pt]&255,i.b[o++]=C,i.b[o++]=C,i.b[o++]=C,i.b[o++]=C==ue?0:255;break;default:throw t.thrown("Invalid filter "+W)}o+=ye}break;case 1:if(m=O.alpha,f.colbits!=8)throw t.thrown("Unsupported color mode");if(c=f.width,v=(m?4:3)*c+1,r.length<f.height*v)throw t.thrown("Not enough data");if(re=-1,ce=-1,de=-1,!m)for(j=e.h;j!=null;)if(ee=j.item,j=j.next,F=ee,F._hx_index==4&&F.id=="tRNS"){$=F.data,$.length>=6&&(re=$.b[1],ce=$.b[3],de=$.b[5]);break}for(u=0,l=0,d=0,b=0,O=0,B=f.height;O<B;){switch(h=O++,W=r.b[a++],W){case 0:if(m)for(E=0,I=c;E<I;)He=E++,i.b[o++]=r.b[a+2],i.b[o++]=r.b[a+1],i.b[o++]=r.b[a],i.b[o++]=r.b[a+3],a+=4;else for(Q=0,ae=c;Q<ae;)lt=Q++,d=r.b[a+2],i.b[o++]=d,l=r.b[a+1],i.b[o++]=l,u=r.b[a],i.b[o++]=u,i.b[o++]=u==re&&l==ce&&d==de?0:255,a+=3;break;case 1:if(b=0,d=b,l=d,u=l,m)for(J=0,le=c;J<le;)dt=J++,d+=r.b[a+2],i.b[o++]=d,l+=r.b[a+1],i.b[o++]=l,u+=r.b[a],i.b[o++]=u,b+=r.b[a+3],i.b[o++]=b,a+=4;else for(Y=0,ie=c;Y<ie;)Qe=Y++,d+=r.b[a+2],i.b[o++]=d,l+=r.b[a+1],i.b[o++]=l,u+=r.b[a],i.b[o++]=u,i.b[o++]=u==re&&l==ce&&d==de?0:255,a+=3;break;case 2:if(v=h==0?0:c*4*he,m)for(Re=0,Ie=c;Re<Ie;)gt=Re++,i.b[o]=r.b[a+2]+i.b[o-v],++o,i.b[o]=r.b[a+1]+i.b[o-v],++o,i.b[o]=r.b[a]+i.b[o-v],++o,i.b[o]=r.b[a+3]+i.b[o-v],++o,a+=4;else for(Me=0,Ke=c;Me<Ke;)yt=Me++,d=r.b[a+2]+i.b[o-v],i.b[o]=d,++o,l=r.b[a+1]+i.b[o-v],i.b[o]=l,++o,u=r.b[a]+i.b[o-v],i.b[o]=u,++o,i.b[o++]=u==re&&l==ce&&d==de?0:255,a+=3;break;case 3:if(b=0,d=b,l=d,u=l,S=h==0?0:c*4*he,m)for(Fe=0,$e=c;Fe<$e;)mt=Fe++,d=r.b[a+2]+(d+i.b[o-S]>>1)&255,i.b[o++]=d,l=r.b[a+1]+(l+i.b[o-S]>>1)&255,i.b[o++]=l,u=r.b[a]+(u+i.b[o-S]>>1)&255,i.b[o++]=u,b=r.b[a+3]+(b+i.b[o-S]>>1)&255,i.b[o++]=b,a+=4;else for(Be=0,Pe=c;Be<Pe;)ht=Be++,d=r.b[a+2]+(d+i.b[o-S]>>1)&255,i.b[o++]=d,l=r.b[a+1]+(l+i.b[o-S]>>1)&255,i.b[o++]=l,u=r.b[a]+(u+i.b[o-S]>>1)&255,i.b[o++]=u,i.b[o++]=u==re&&l==ce&&d==de?0:255,a+=3;break;case 4:if(p=c*4*he,b=0,d=b,l=d,u=l,m)for(Ve=0,We=c;Ve<We;)Z=Ve++,x=h==0?0:i.b[o-p],g=Z==0||h==0?0:i.b[o-p-4],N=d+x-g,w=N-d,w<0&&(w=-w),_=N-x,_<0&&(_=-_),y=N-g,y<0&&(y=-y),d=(w<=_&&w<=y?d:_<=y?x:g)+r.b[a+2]&255,i.b[o++]=d,q=h==0?0:i.b[o-p],R=Z==0||h==0?0:i.b[o-p-4],K=l+q-R,P=K-l,P<0&&(P=-P),H=K-q,H<0&&(H=-H),M=K-R,M<0&&(M=-M),l=(P<=H&&P<=M?l:H<=M?q:R)+r.b[a+1]&255,i.b[o++]=l,G=h==0?0:i.b[o-p],k=Z==0||h==0?0:i.b[o-p-4],U=u+G-k,D=U-u,D<0&&(D=-D),T=U-G,T<0&&(T=-T),L=U-k,L<0&&(L=-L),u=(D<=T&&D<=L?u:T<=L?G:k)+r.b[a]&255,i.b[o++]=u,at=h==0?0:i.b[o-p],X=Z==0||h==0?0:i.b[o-p-4],rt=b+at-X,be=rt-b,be<0&&(be=-be),ve=rt-at,ve<0&&(ve=-ve),ge=rt-X,ge<0&&(ge=-ge),b=(be<=ve&&be<=ge?b:ve<=ge?at:X)+r.b[a+3]&255,i.b[o++]=b,a+=4;else for(Ue=0,De=c;Ue<De;)Ae=Ue++,nt=h==0?0:i.b[o-p],Ge=Ae==0||h==0?0:i.b[o-p-4],Xe=d+nt-Ge,pe=Xe-d,pe<0&&(pe=-pe),we=Xe-nt,we<0&&(we=-we),_e=Xe-Ge,_e<0&&(_e=-_e),d=(pe<=we&&pe<=_e?d:we<=_e?nt:Ge)+r.b[a+2]&255,i.b[o++]=d,et=h==0?0:i.b[o-p],ot=Ae==0||h==0?0:i.b[o-p-4],st=l+et-ot,fe=st-l,fe<0&&(fe=-fe),me=st-et,me<0&&(me=-me),xe=st-ot,xe<0&&(xe=-xe),l=(fe<=me&&fe<=xe?l:me<=xe?et:ot)+r.b[a+1]&255,i.b[o++]=l,Ye=h==0?0:i.b[o-p],ct=Ae==0||h==0?0:i.b[o-p-4],Ze=u+Ye-ct,Ce=Ze-u,Ce<0&&(Ce=-Ce),ke=Ze-Ye,ke<0&&(ke=-ke),Se=Ze-ct,Se<0&&(Se=-Se),u=(Ce<=ke&&Ce<=Se?u:ke<=Se?Ye:ct)+r.b[a]&255,i.b[o++]=u,i.b[o++]=u==re&&l==ce&&d==de?0:255,a+=3;break;default:throw t.thrown("Invalid filter "+W)}o+=ye}break;case 2:if(te=tt.getPalette(e),te==null)throw t.thrown("PNG Palette is missing");for(m=null,j=e.h;j!=null;)if(ee=j.item,j=j.next,F=ee,F._hx_index==4&&F.id=="tRNS"){$=F.data,m=$;break}if(m!=null&&m.length<1<<f.colbits&&(Le=new A(new ArrayBuffer(1<<f.colbits)),Le.blit(0,m,0,m.length),Le.fill(m.length,Le.length-m.length,255),m=Le),c=f.width,v=Math.ceil(c*f.colbits/8)+1,r.length<f.height*v)throw t.thrown("Not enough data");for(Ne=v-1,O=0,B=f.height;O<B;){if(h=O++,W=r.b[a++],W==0){a+=Ne;continue}switch(W){case 1:for(g=0,E=0,I=c;E<I;)He=E++,Ee=r.b[a],g+=Ee,r.b[a++]=g&255;break;case 2:for(v=h==0?0:Ne+1,Q=0,ae=c;Q<ae;)lt=Q++,ne=r.b[a],r.b[a]=ne+r.b[a-v],++a;break;case 3:for(R=0,S=h==0?0:Ne+1,J=0,le=c;J<le;)dt=J++,je=r.b[a],R=je+(R+r.b[a-S]>>1)&255,r.b[a++]=R;break;case 4:for(p=Ne+1,k=0,Y=0,ie=c;Y<ie;)Qe=Y++,se=r.b[a],qe=1,qe==null&&(qe=4),x=h==0?0:r.b[a-p],X=Qe==0||h==0?0:r.b[a-p-qe],N=k+x-X,w=N-k,w<0&&(w=-w),_=N-x,_<0&&(_=-_),y=N-X,y<0&&(y=-y),k=(w<=_&&w<=y?k:_<=y?x:X)+se&255,r.b[a++]=k;break;default:throw t.thrown("Invalid filter "+W)}}if(a=0,f.colbits==8)for(O=0,B=f.height;O<B;){for(h=O++,++a,E=0,I=f.width;E<I;)He=E++,g=r.b[a++],i.b[o++]=te.b[g*3+2],i.b[o++]=te.b[g*3+1],i.b[o++]=te.b[g*3],i.b[o++]=m!=null?m.b[g]:255;o+=ye}else if(f.colbits<8)for(ze=f.colbits,bt=(1<<ze)-1,O=0,B=f.height;O<B;){for(h=O++,++a,Je=0,Te=0,E=0,I=f.width;E<I;)He=E++,Te<ze&&(Je=Je<<8|r.b[a++],Te+=8),g=Je>>>Te-ze&bt,Te-=ze,i.b[o++]=te.b[g*3+2],i.b[o++]=te.b[g*3+1],i.b[o++]=te.b[g*3],i.b[o++]=m!=null?m.b[g]:255;o+=ye}else throw t.thrown(f.colbits+" indexed bits per pixel not supported");break}return i},tt.extract=function(e,n,s){s==null&&(s=!1);var i,c,m,j,O,C,E,oe,o,r,l,u,h,f,g,x,ie,p,_,w,k,P,re,B,ue,de,D,le,he,N,R,K,fe,I,se,V,te,Y,ge,v,b,U,X,Q,J,pe,$,ne,F,H,W,Z,me,q,ae,L,ce,y,S,M,T,ee,G,d=tt.getHeader(e),z=!1,a=d.color;switch(a._hx_index){case 0:j=a.alpha,z=j,C=j?2:1;break;case 1:j=a.alpha,z=j,C=j?4:3;break;case 2:throw t.thrown("assert")}for(s&&z&&(s=!1),c=d.colbits>>3,E=s?C+1:C,n==null&&(n=new A(new ArrayBuffer(E*c*d.width*d.height))),i=null,m=null,O=e.h;O!=null;)oe=O.item,O=O.next,f=oe,f._hx_index==2&&(r=f.b,m!=null?m.add(r):i==null?i=r:(m=new Kn,m.add(i),m.add(r),i=null));if(m!=null&&(i=m.getBytes()),i==null)throw t.thrown("Data not found");if(i=wa.run(i),g=0,o=0,h=d.width,u=C*c,x=E*c*h,ie=E*c,i.length<d.height*(u*h+1))throw t.thrown("Not enough data");for(a=[],p=0,_=u;p<_;)P=p++,a.push(0);for(l=a,a=0,p=d.height;a<p;){if(k=a++,w=i.b[g++],w!=0&&w!=2)for(_=0,re=u;_<re;)P=_++,l[P]=0;switch(w){case 0:for(B=0,ue=h;B<ue;){for(de=B++,D=0,le=u;D<le;)he=D++,n.b[o++]=i.b[g++];s&&(n.b[o++]=255,c==2&&(n.b[o++]=255))}break;case 1:for(R=0,K=h;R<K;){for(fe=R++,I=0,se=u;I<se;)V=I++,l[V]+=i.b[g++],n.b[o++]=l[V];s&&(n.b[o++]=255,c==2&&(n.b[o++]=255))}break;case 2:for(te=k==0?0:x,W=0,Z=h;W<Z;){for(me=W++,N=0,Y=u;N<Y;)ge=N++,X=i.b[g++]+n.b[o-te],n.b[o++]=X;s&&(n.b[o++]=255,c==2&&(n.b[o++]=255))}break;case 3:for(Q=k==0?0:x,U=0,J=h;U<J;){for(pe=U++,$=0,ne=u;$<ne;)F=$++,l[F]=i.b[g++]+(l[F]+n.b[o-Q]>>1)&255,n.b[o++]=l[F];s&&(n.b[o++]=255,c==2&&(n.b[o++]=255))}break;case 4:for(H=0,q=h;H<q;){for(ae=H++,L=0,ce=u;L<ce;)M=L++,S=l[M],r=k==0?0:n.b[o-x],f=ae==0||k==0?0:n.b[o-x-ie],T=S+r-f,y=T-S,y<0&&(y=-y),b=T-r,b<0&&(b=-b),v=T-f,v<0&&(v=-v),ee=g++,l[M]=(y<=b&&y<=v?S:b<=v?r:f)+i.b[ee]&255,n.b[o++]=l[M];s&&(n.b[o++]=255,c==2&&(n.b[o++]=255))}break;default:throw t.thrown("Invalid filter "+w)}}if(d.colbits==16)for(o=0,a=0,p=d.height*h*E;a<p;)de=a++,G=n.b[o],r=n.b[o+1],n.b[o++]=r,n.b[o++]=G;return n},tt.buildGrey=function(e,t,n,s){s==null&&(s=9);for(var o,a,l,h,m,i=new A(new ArrayBuffer(e*t+t)),r=0,d=0,c=0,u=t;c<u;)for(h=c++,i.b[r++]=0,a=0,l=e;a<l;)m=a++,i.b[r++]=n.b[d++];return o=new jn,o.add(Pe.CHeader({width:e,height:t,colbits:8,color:sn.ColGrey(!1),interlaced:!1})),o.add(Pe.CData(ii.run(i,s))),o.add(Pe.CEnd),o},tt.buildIndexed=function(e,t,n,s,o){o==null&&(o=9);for(var i,r,d,m,f,a=new A(new ArrayBuffer(e*t+t)),c=0,u=0,l=0,h=t;l<h;)for(m=l++,a.b[c++]=0,r=0,d=e;r<d;)f=r++,a.b[c++]=n.b[u++];return i=new jn,i.add(Pe.CHeader({width:e,height:t,colbits:8,color:sn.ColIndexed,interlaced:!1})),i.add(Pe.CPalette(s)),i.add(Pe.CData(ii.run(a,o))),i.add(Pe.CEnd),i},tt.buildRGB=function(e,t,n,s){s==null&&(s=9);for(var i,c,d,h,m,o=new A(new ArrayBuffer(e*t*3+t)),a=0,r=0,l=0,u=t;l<u;)for(h=l++,o.b[a++]=0,c=0,d=e;c<d;)m=c++,o.b[a++]=n.b[r+2],o.b[a++]=n.b[r+1],o.b[a++]=n.b[r],r+=3;return i=new jn,i.add(Pe.CHeader({width:e,height:t,colbits:8,color:sn.ColTrue(!1),interlaced:!1})),i.add(Pe.CData(ii.run(o,s))),i.add(Pe.CEnd),i},tt.build32ARGB=function(e,t,n,s){s==null&&(s=9);for(var r,c,d,h,m,o=new A(new ArrayBuffer(e*t*4+t)),i=0,a=0,l=0,u=t;l<u;)for(h=l++,o.b[i++]=0,c=0,d=e;c<d;)m=c++,o.b[i++]=n.b[a+1],o.b[i++]=n.b[a+2],o.b[i++]=n.b[a+3],o.b[i++]=n.b[a],a+=4;return r=new jn,r.add(Pe.CHeader({width:e,height:t,colbits:8,color:sn.ColTrue(!0),interlaced:!1})),r.add(Pe.CData(ii.run(o,s))),r.add(Pe.CEnd),r},tt.build32BGRA=function(e,t,n,s){s==null&&(s=9);for(var r,c,d,h,m,o=new A(new ArrayBuffer(e*t*4+t)),i=0,a=0,l=0,u=t;l<u;)for(h=l++,o.b[i++]=0,c=0,d=e;c<d;)m=c++,o.b[i++]=n.b[a+2],o.b[i++]=n.b[a+1],o.b[i++]=n.b[a],o.b[i++]=n.b[a+3],a+=4;return r=new jn,r.add(Pe.CHeader({width:e,height:t,colbits:8,color:sn.ColTrue(!0),interlaced:!1})),r.add(Pe.CData(ii.run(o,s))),r.add(Pe.CEnd),r},zc=function(e){this.o=e,e.set_bigEndian(!0)},c["format.png.Writer"]=zc,zc.__name__="format.png.Writer",zc.prototype={write:function(e){var n,s,o,i,a,r,c,l,d,u,h,m,t=137;for(this.o.writeByte(t),t=80,this.o.writeByte(t),t=78,this.o.writeByte(t),t=71,this.o.writeByte(t),t=13,this.o.writeByte(t),t=10,this.o.writeByte(t),t=26,this.o.writeByte(t),t=10,this.o.writeByte(t),o=e.h;o!=null;)switch(r=o.item,o=o.next,n=r,n._hx_index){case 0:this.writeChunk("IEND",new A(new ArrayBuffer(0)));break;case 1:switch(s=n.h,t=new zn,t.set_bigEndian(!0),t.writeInt32(s.width),t.writeInt32(s.height),t.writeByte(s.colbits),a=s.color,a._hx_index){case 0:c=a.alpha,i=c?4:0;break;case 1:l=a.alpha,i=l?6:2;break;case 2:i=3;break}t.writeByte(i),t.writeByte(0),t.writeByte(0),t.writeByte(s.interlaced?1:0),this.writeChunk("IHDR",t.getBytes());break;case 2:d=n.b,this.writeChunk("IDAT",d);break;case 3:u=n.b,this.writeChunk("PLTE",u);break;case 4:h=n.id,m=n.data,this.writeChunk(h,m);break}},writeChunk:function(e,t){this.o.writeInt32(t.length),this.o.writeString(e),this.o.write(t);for(var i,s=-1,n=(s^u.cca(e,0))&255,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,s=s>>>8^n,n=(s^u.cca(e,1))&255,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,s=s>>>8^n,n=(s^u.cca(e,2))&255,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,s=s>>>8^n,n=(s^u.cca(e,3))&255,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,s=s>>>8^n,a=t.b.bufferValue,o=0,r=t.length;o<r;)i=o++,n=(s^a.bytes[i])&255,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,n=n>>>1^-(n&1)&-306674912,s=s>>>8^n;this.o.writeInt32(s^-1)},__class__:zc},Sn=_["format.tga.ImageOrigin"]={__ename__:!0,__constructs__:null,BottomLeft:{_hx_name:"BottomLeft",_hx_index:0,__enum__:"format.tga.ImageOrigin",toString:s},BottomRight:{_hx_name:"BottomRight",_hx_index:1,__enum__:"format.tga.ImageOrigin",toString:s},TopLeft:{_hx_name:"TopLeft",_hx_index:2,__enum__:"format.tga.ImageOrigin",toString:s},TopRight:{_hx_name:"TopRight",_hx_index:3,__enum__:"format.tga.ImageOrigin",toString:s}},Sn.__constructs__=[Sn.BottomLeft,Sn.BottomRight,Sn.TopLeft,Sn.TopRight],Sn.__empty_constructs__=[Sn.BottomLeft,Sn.BottomRight,Sn.TopLeft,Sn.TopRight],Xe=_["format.tga.ImageType"]={__ename__:!0,__constructs__:null,NoImage:{_hx_name:"NoImage",_hx_index:0,__enum__:"format.tga.ImageType",toString:s},UncompressedColorMapped:{_hx_name:"UncompressedColorMapped",_hx_index:1,__enum__:"format.tga.ImageType",toString:s},UncompressedTrueColor:{_hx_name:"UncompressedTrueColor",_hx_index:2,__enum__:"format.tga.ImageType",toString:s},UncompressedBlackAndWhite:{_hx_name:"UncompressedBlackAndWhite",_hx_index:3,__enum__:"format.tga.ImageType",toString:s},RunLengthColorMapped:{_hx_name:"RunLengthColorMapped",_hx_index:4,__enum__:"format.tga.ImageType",toString:s},RunLengthTrueColor:{_hx_name:"RunLengthTrueColor",_hx_index:5,__enum__:"format.tga.ImageType",toString:s},RunLengthBlackAndWhite:{_hx_name:"RunLengthBlackAndWhite",_hx_index:6,__enum__:"format.tga.ImageType",toString:s},Unknown:(a=function(e){return{_hx_index:7,type:e,__enum__:"format.tga.ImageType",toString:s}},a._hx_name="Unknown",a.__params__=["type"],a)},Xe.__constructs__=[Xe.NoImage,Xe.UncompressedColorMapped,Xe.UncompressedTrueColor,Xe.UncompressedBlackAndWhite,Xe.RunLengthColorMapped,Xe.RunLengthTrueColor,Xe.RunLengthBlackAndWhite,Xe.Unknown],Xe.__empty_constructs__=[Xe.NoImage,Xe.UncompressedColorMapped,Xe.UncompressedTrueColor,Xe.UncompressedBlackAndWhite,Xe.RunLengthColorMapped,Xe.RunLengthTrueColor,Xe.RunLengthBlackAndWhite],Lc=function(e){this.i=e,e.set_bigEndian(!1)},c["format.tga.Reader"]=Lc,Lc.__name__="format.tga.Reader",Lc.prototype={read:function(){var t=this.i.readByte(),e=this.readHeader(),s=t==0?"":this.i.readString(t),n=this.readColorMapData(e);return{header:e,imageId:s,colorMapData:n,imageData:this.readImageData(e,n),developerData:null}},readHeader:function(){var e,t,n,s,o,i,a,r,c,l,d,h=this.i.readByte(),u=this.i.readByte();switch(u){case 0:e=Xe.NoImage;break;case 1:e=Xe.UncompressedColorMapped;break;case 2:e=Xe.UncompressedTrueColor;break;case 3:e=Xe.UncompressedBlackAndWhite;break;case 9:e=Xe.RunLengthColorMapped;break;case 10:e=Xe.RunLengthTrueColor;break;case 11:e=Xe.RunLengthBlackAndWhite;break;default:e=Xe.Unknown(u)}switch(d=this.i.readInt16(),o=this.i.readInt16(),i=this.i.readByte(),s=this.i.readInt16(),a=this.i.readInt16(),r=this.i.readInt16(),c=this.i.readInt16(),l=this.i.readByte(),n=this.i.readByte(),n&48){case 16:t=Sn.BottomRight;break;case 32:t=Sn.TopLeft;break;case 48:t=Sn.TopRight;break;default:t=Sn.BottomLeft}return{colorMapType:h,imageType:e,colorMapFirstIndex:d,colorMapLength:o,colorMapEntrySize:i,xOrigin:s,yOrigin:a,width:r,height:c,bitsPerPixel:l,alphaChannelBits:n&15,imageOrigin:t}},readColorMapData:function(e){return e.colorMapType==0?null:this.readPixels(e.colorMapEntrySize,e.colorMapLength,e.alphaChannelBits,!1)},readImageData:function(e,n){switch(e.imageType._hx_index){case 0:return null;case 1:return this.readIndexes(e.bitsPerPixel,e.width*e.height,n,e.colorMapFirstIndex,!1);case 2:return this.readPixels(e.bitsPerPixel,e.width*e.height,e.alphaChannelBits,!1);case 3:return this.readMono(e.bitsPerPixel,e.width*e.height,e.alphaChannelBits,!1);case 4:return this.readIndexes(e.bitsPerPixel,e.width*e.height,n,e.colorMapFirstIndex,!0);case 5:return this.readPixels(e.bitsPerPixel,e.width*e.height,e.alphaChannelBits,!0);case 6:return this.readMono(e.bitsPerPixel,e.width*e.height,e.alphaChannelBits,!0);default:throw t.thrown("Unsupported image data type!")}},readPixels:function(e,n,s,o){var i,r,c,l,h,f,p,d=new Array(n),u=s!=0,m=e/3|0;switch(m>8&&(m=8),e){case 8:c=(a=this.i,b(a,a.readByte)),r=b(this,this.parsePixel1);break;case 16:c=(a=this.i,b(a,a.readUInt16)),r=b(this,this.parsePixel2);break;case 24:c=(a=this.i,b(a,a.readUInt24)),r=b(this,this.parsePixel3);break;case 32:c=(a=this.i,b(a,a.readInt32)),r=b(this,this.parsePixel4);break;default:throw t.thrown("Unsupported bits per pixels amount!")}if(o)for(l=0;l<n;)if(i=this.i.readByte(),(i&128)!=0)for(i&=127,f=r(c(),u);i>=0;)d[l++]=f,--i;else for(i&=127;i>=0;)d[l++]=r(c(),u),--i;else for(h=0,p=n;h<p;)l=h++,d[l]=r(c(),u);return d},readMono:function(e,n,s,o){var i,r,c,l,h,m,f,d=new Array(n),u=s!=0;switch(e){case 8:l=(a=this.i,b(a,a.readByte)),c=b(this,this.parsePixel1);break;case 16:l=(a=this.i,b(a,a.readUInt16)),c=b(this,this.parsePixelGreyAlpha);break;default:throw t.thrown("Unsupported bits per pixels amount!")}if(o)for(r=0;r<n;)if(i=this.i.readByte(),(i&128)!=0)for(i&=127,m=c(l(),u);i>=0;)d[r++]=m,--i;else for(i&=127;i>=0;)d[r++]=c(l(),u),--i;else for(h=0,f=n;h<f;)r=h++,d[r]=c(l(),u);return d},readIndexes:function(e,n,s,o,i){var r,c,l,u,h,m,d=new Array(n);switch(e){case 8:c=(a=this.i,b(a,a.readByte));break;case 16:c=(a=this.i,b(a,a.readUInt16));break;case 24:c=(a=this.i,b(a,a.readUInt24));break;case 32:c=(a=this.i,b(a,a.readInt32));break;default:throw t.thrown("Unsupported bits per pixels amount!")}if(i)for(l=0;l<n;)if(r=this.i.readByte(),(r&128)!=0)for(r&=127,h=s[o+c()];r>=0;)d[l++]=h,--r;else for(r&=127;r>=0;)d[l++]=s[o+c()],--r;else for(u=0,m=n;u<m;)l=u++,d[l]=s[o+c()];return d},parsePixel1:function(e){return e<<16|e<<8|e},parsePixelGreyAlpha:function(e,t){return(t?(e&65280)<<16:0)|this.parsePixel1(e&255,!1)},parsePixel2:function(e,t){return(t?(e&32768)==1?-16777216:0:0)|(((e&31744)>>10)/31*255|0)<<16|(((e&992)>>5)/31*255|0)<<8|((e&31)/31*255|0)},parsePixel3:function(e){return e},parsePixel4:function(e){return e},__class__:Lc},Nc=function(e){this.i=e,this.nbits=0,this.bits=0},c["format.tools.BitsInput"]=Nc,Nc.__name__="format.tools.BitsInput",Nc.prototype={readBits:function(e){if(this.nbits>=e){var o,n=this.nbits-e,s=this.bits>>>n&(1<<e)-1;return this.nbits=n,s}if(s=this.i.readByte(),this.nbits>=24){if(e>31)throw t.thrown("Bits error");return n=8+this.nbits-e,o=this.bits&(1<<this.nbits)-1,o=o<<8-n|s<<n,this.bits=s,this.nbits=n,o}return this.bits=this.bits<<8|s,this.nbits+=8,this.readBits(e)},readBit:function(){return this.nbits==0&&(this.bits=this.i.readByte(),this.nbits=8),this.nbits--,(this.bits>>>this.nbits&1)==1},reset:function(){this.nbits=0},__class__:Nc},ii=function(){},c["format.tools.Deflate"]=ii,ii.__name__="format.tools.Deflate",ii.run=function(e,t){return t==null&&(t=9),Cr.run(e,t)},wa=function(){},c["format.tools.Inflate"]=wa,wa.__name__="format.tools.Inflate",wa.run=function(e){return dc.run(e)},Fc=_["format.wav.WAVEFormat"]={__ename__:!0,__constructs__:null,WF_PCM:{_hx_name:"WF_PCM",_hx_index:0,__enum__:"format.wav.WAVEFormat",toString:s}},Fc.__constructs__=[Fc.WF_PCM],Fc.__empty_constructs__=[Fc.WF_PCM],Mc=function(e){this.i=e,e.set_bigEndian(!1)},c["format.wav.Reader"]=Mc,Mc.__name__="format.wav.Reader",Mc.prototype={readInt:function(){return this.i.readInt32()},read:function(){if(this.i.readString(4)!="RIFF")throw t.thrown("RIFF header expected");var e,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w=this.i.readInt32();if(this.i.readString(4)!="WAVE")throw t.thrown("WAVE signature not found");e=this.i.readString(4);_hx_loop1:for(;e!="fmt ";)switch(e){case"JUNK":u=this.i.readInt32(),this.i.read(u),e=this.i.readString(4);break;case"bext":c=this.i.readInt32(),this.i.read(c),e=this.i.readString(4);break;default:break _hx_loop1}if(e!="fmt ")throw t.thrown("unsupported wave chunk "+e);switch(i=this.i.readInt32(),this.i.readUInt16()){case 1:case 3:p=Fc.WF_PCM;break;default:throw t.thrown("only PCM (uncompressed) WAV files are supported")}for(h=this.i.readUInt16(),v=this.i.readInt32(),l=this.i.readInt32(),d=this.i.readUInt16(),r=this.i.readUInt16(),i>16&&this.i.read(i-16),n=this.i.readString(4);n!="data";)this.i.read(this.i.readInt32()),n=this.i.readString(4);if(n!="data")throw t.thrown("expected data subchunk");m=this.i.readInt32();try{f=this.i.read(m)}catch(e){throw t.caught(e).unwrap()instanceof fn?t.thrown("Invalid chunk data length"):e}a=[];try{for(;!0;)if(n=this.i.readString(4),n=="cue ")for(this.i.readInt32(),g=this.i.readInt32(),o=0,b=g;o<b;)_=o++,y=this.i.readInt32(),this.i.readInt32(),this.i.readString(4),this.i.readInt32(),this.i.readInt32(),j=this.i.readInt32(),a.push({id:y,sampleOffset:j});else{if(s=this.i.readInt32(),s<0)break;this.i.read(s)}}catch(e){if(!(t.caught(e).unwrap()instanceof fn))throw e}return{header:{format:p,channels:h,samplingRate:v,byteRate:l,blockAlign:d,bitsPerSample:r},data:f,cuePoints:a}},__class__:Mc},U=function(e,t){t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t},c["h2d.col.PointImpl"]=U,U.__name__="h2d.col.PointImpl",U.prototype={distanceSq:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},distance:function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},toString:function(){return"{"+x.fmt(this.x)+","+x.fmt(this.y)+"}"},sub:function(e){var t=this.x-e.x,n=this.y-e.y;return n==null&&(n=0),t==null&&(t=0),new U(t,n)},add:function(e){var t=this.x+e.x,n=this.y+e.y;return n==null&&(n=0),t==null&&(t=0),new U(t,n)},scaled:function(e){var t=this.x*e,n=this.y*e;return n==null&&(n=0),t==null&&(t=0),new U(t,n)},equals:function(e){return this.x==e.x&&this.y==e.y},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var e=this.x*this.x+this.y*this.y;e<1e-20?e=0:e=1/Math.sqrt(e),this.x*=e,this.y*=e},normalized:function(){var t,n,e=this.x*this.x+this.y*this.y;return e<1e-20?e=0:e=1/Math.sqrt(e),t=this.x*e,n=this.y*e,n==null&&(n=0),t==null&&(t=0),new U(t,n)},set:function(e,t){t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t},load:function(e){this.x=e.x,this.y=e.y},scale:function(e){this.x*=e,this.y*=e},clone:function(){var e=this.x,t=this.y;return t==null&&(t=0),e==null&&(e=0),new U(e,t)},cross:function(e){return this.x*e.y-this.y*e.x},lerp:function(e,t,n){var s=e.x;this.x=s+n*(t.x-s),s=e.y,this.y=s+n*(t.y-s)},transform:function(e){var t=e.a*this.x+e.c*this.y+e.x,n=e.b*this.x+e.d*this.y+e.y;this.x=t,this.y=n},transformed:function(e){var s=e.a*this.x+e.c*this.y+e.x,o=e.b*this.x+e.d*this.y+e.y,t=s,n=o;return n==null&&(n=0),t==null&&(t=0),new U(t,n)},transform2x2:function(e){var t=e.a*this.x+e.c*this.y,n=e.b*this.x+e.d*this.y;this.x=t,this.y=n},transformed2x2:function(e){var s=e.a*this.x+e.c*this.y,o=e.b*this.x+e.d*this.y,t=s,n=o;return n==null&&(n=0),t==null&&(t=0),new U(t,n)},toIPoint:function(e){return e==null&&(e=1),new E(Math.round(this.x*e),Math.round(this.y*e))},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),s=this.x*t-this.y*n,o=this.x*n+this.y*t;this.x=s,this.y=o},__class__:U},Oe=function(e){this.blendMode=X.Alpha,this.alpha=1,this.visible=!0,this.rotation=0,this.scaleY=1,this.scaleX=1,this.y=0,this.x=0,this.matA=1,this.matB=0,this.matC=0,this.matD=1,this.absX=0,this.absY=0,this.posChanged=e!=null,this.children=[],e!=null&&e.addChild(this)},c["h2d.Object"]=Oe,Oe.__name__="h2d.Object",Oe.prototype={getBounds:function(e,t){return t==null?t=new At:(t.xMin=1e20,t.yMin=1e20,t.xMax=-1e20,t.yMax=-1e20),e!=null&&e.syncPos(),e!=this&&this.syncPos(),this.getBoundsRec(e,t,!1),(t.xMax<=t.xMin||t.yMax<=t.yMin)&&(this.addBounds(e,t,-1,-1,2,2),t.xMax=t.xMin=(t.xMax+t.xMin)*.5,t.yMax=t.yMin=(t.yMax+t.yMin)*.5),t},getSize:function(e){e==null?e=new At:(e.xMin=1e20,e.yMin=1e20,e.xMax=-1e20,e.yMax=-1e20),this.syncPos(),this.getBoundsRec(this.parent,e,!0),(e.xMax<=e.xMin||e.yMax<=e.yMin)&&(this.addBounds(this.parent,e,-1,-1,2,2),e.xMax=e.xMin=(e.xMax+e.xMin)*.5,e.yMax=e.yMin=(e.yMax+e.yMin)*.5);var t=-this.x,n=-this.y;return e.xMin+=t,e.xMax+=t,e.yMin+=n,e.yMax+=n,e},getAbsPos:function(){this.syncPos();var e=new Cs;return e.a=this.matA,e.b=this.matB,e.c=this.matC,e.d=this.matD,e.x=this.absX,e.y=this.absY,e},contains:function(e){for(;e!=null;)if(e=e.parent,e==this)return!0;return!1},find:function(e){var n,s,o,t=e(this);if(t!=null)return t;for(n=0,s=this.children;n<s.length;)if(o=s[n],++n,t=o.find(e),t!=null)return t;return null},findAll:function(e,t){t==null&&(t=[]);var n,s,i,o=e(this);for(o!=null&&t.push(o),n=0,s=this.children;n<s.length;)i=s[n],++n,i.findAll(e,t);return t},set_filter:function(e){return this.filter!=null&&this.allocated&&this.filter.unbind(this),this.filter=e,e!=null&&this.allocated&&e.bind(this),e},getBoundsRec:function(e,t,n){if(this.posChanged){this.calcAbsPos();for(var s,a,r,c,l,d,o=0,i=this.children;o<i.length;)s=i[o],++o,s.posChanged=!0;this.posChanged=!1}if(d=this.children.length,d==0){t.xMin=1e20,t.yMin=1e20,t.xMax=-1e20,t.yMax=-1e20;return}if(d==1){s=this.children[0],s.visible?s.getBoundsRec(e,t,n):(t.xMin=1e20,t.yMin=1e20,t.xMax=-1e20,t.yMax=-1e20);return}for(a=1/0,r=1/0,c=-(1/0),l=-(1/0),o=0,i=this.children;o<i.length;){if(s=i[o],++o,!s.visible)continue;s.getBoundsRec(e,t,n),t.xMin<a&&(a=t.xMin),t.yMin<r&&(r=t.yMin),t.xMax>c&&(c=t.xMax),t.yMax>l&&(l=t.yMax)}t.xMin=a,t.yMin=r,t.xMax=c,t.yMax=l},addBounds:function(e,t,n,s,o,i){if(o<=0||i<=0)return;if(e==null){var c,l,d,u,h,m,f,p,g,v,a=n*this.matA+s*this.matC+this.absX,r=n*this.matB+s*this.matD+this.absY;a<t.xMin&&(t.xMin=a),a>t.xMax&&(t.xMax=a),r<t.yMin&&(t.yMin=r),r>t.yMax&&(t.yMax=r),a=(n+o)*this.matA+s*this.matC+this.absX,r=(n+o)*this.matB+s*this.matD+this.absY,a<t.xMin&&(t.xMin=a),a>t.xMax&&(t.xMax=a),r<t.yMin&&(t.yMin=r),r>t.yMax&&(t.yMax=r),a=n*this.matA+(s+i)*this.matC+this.absX,r=n*this.matB+(s+i)*this.matD+this.absY,a<t.xMin&&(t.xMin=a),a>t.xMax&&(t.xMax=a),r<t.yMin&&(t.yMin=r),r>t.yMax&&(t.yMax=r),a=(n+o)*this.matA+(s+i)*this.matC+this.absX,r=(n+o)*this.matB+(s+i)*this.matD+this.absY,a<t.xMin&&(t.xMin=a),a>t.xMax&&(t.xMax=a),r<t.yMin&&(t.yMin=r),r>t.yMax&&(t.yMax=r);return}if(e==this){t.xMin>n&&(t.xMin=n),t.yMin>s&&(t.yMin=s),t.xMax<n+o&&(t.xMax=n+o),t.yMax<s+i&&(t.yMax=s+i);return}if(v=e.matA*e.matD-e.matB*e.matC,v==0)return;d=1/v,u=e.matD*d,h=-e.matB*d,m=-e.matC*d,f=e.matA*d,p=this.absX-e.absX,g=this.absY-e.absY,a=n*this.matA+s*this.matC+p,r=n*this.matB+s*this.matD+g,c=a*u+r*m,l=a*h+r*f,c<t.xMin&&(t.xMin=c),c>t.xMax&&(t.xMax=c),l<t.yMin&&(t.yMin=l),l>t.yMax&&(t.yMax=l),a=(n+o)*this.matA+s*this.matC+p,r=(n+o)*this.matB+s*this.matD+g,c=a*u+r*m,l=a*h+r*f,c<t.xMin&&(t.xMin=c),c>t.xMax&&(t.xMax=c),l<t.yMin&&(t.yMin=l),l>t.yMax&&(t.yMax=l),a=n*this.matA+(s+i)*this.matC+p,r=n*this.matB+(s+i)*this.matD+g,c=a*u+r*m,l=a*h+r*f,c<t.xMin&&(t.xMin=c),c>t.xMax&&(t.xMax=c),l<t.yMin&&(t.yMin=l),l>t.yMax&&(t.yMax=l),a=(n+o)*this.matA+(s+i)*this.matC+p,r=(n+o)*this.matB+(s+i)*this.matD+g,c=a*u+r*m,l=a*h+r*f,c<t.xMin&&(t.xMin=c),c>t.xMax&&(t.xMax=c),l<t.yMin&&(t.yMin=l),l>t.yMax&&(t.yMax=l)},getObjectsCount:function(){for(var s,t=0,e=0,n=this.children;e<n.length;)s=n[e],++e,t+=s.getObjectsCount()+1;return t},localToGlobal:function(e){this.syncPos(),e==null&&(e=new U(0,0));var t=e.x*this.matA+e.y*this.matC+this.absX,n=e.x*this.matB+e.y*this.matD+this.absY;return e.x=t,e.y=n,e},globalToLocal:function(e){this.syncPos(),e.x-=this.absX,e.y-=this.absY;var t=1/(this.matA*this.matD-this.matB*this.matC),n=(e.x*this.matD-e.y*this.matC)*t,s=(-e.x*this.matB+e.y*this.matA)*t;return e.x=n,e.y=s,e},getScene:function(){for(var e=this;e.parent!=null;)e=e.parent;return e instanceof ps?e:null},set_visible:function(e){return this.visible==e?e:(this.visible=e,this.parentContainer!=null&&this.parentContainer.contentChanged(this),e)},addChild:function(e){this.addChildAt(e,this.children.length)},addChildAt:function(e,n){n<0&&(n=0),n>this.children.length&&(n=this.children.length);for(var o,s=this;s!=null;){if(s==e)throw t.thrown("Recursive addChild");s=s.parent}e.parent!=null&&(o=e.allocated,e.allocated=!1,e.parent.removeChild(e),e.allocated=o),this.children.splice(n,0,e),!this.allocated&&e.allocated&&e.onRemove(),e.parent=this,e.parentContainer=this.parentContainer,e.posChanged=!0,this.allocated&&(e.allocated?e.onHierarchyMoved(!0):e.onAdd()),this.parentContainer!=null&&this.parentContainer.contentChanged(this)},onContentChanged:function(){this.parentContainer!=null&&this.parentContainer.contentChanged(this)},onHierarchyMoved:function(e){for(var s,t=0,n=this.children;t<n.length;)s=n[t],++t,s.onHierarchyMoved(e)},onAdd:function(){this.allocated=!0,this.filter!=null&&this.filter.bind(this);for(var n,e=0,t=this.children;e<t.length;)n=t[e],++e,n.onAdd()},onRemove:function(){this.allocated=!1,this.filter!=null&&this.filter.unbind(this);for(var e,t=this.children.length-1;t>=0;)e=this.children[t--],e!=null&&e.onRemove()},getMatrix:function(e){e.a=this.matA,e.b=this.matB,e.c=this.matC,e.d=this.matD,e.x=this.absX,e.y=this.absY},removeChild:function(e){u.remove(this.children,e)&&(e.allocated&&e.onRemove(),e.parent=null,e.parentContainer!=null&&e.setParentContainer(null),e.posChanged=!0,this.parentContainer!=null&&this.parentContainer.contentChanged(this))},setParentContainer:function(e){this.parentContainer=e;for(var s,t=0,n=this.children;t<n.length;)s=n[t],++t,s.setParentContainer(e)},removeChildren:function(){for(;this.children.length>0;)this.removeChild(this.getChildAt(0))},remove:function(){this.parent!=null&&this.parent.removeChild(this)},drawTo:function(e){var t=this.getScene(),n=t==null;t==null&&(t=new ps),t.drawImplTo(this,[e]),n&&(t.dispose(),this.onRemove())},drawToTextures:function(e,t){var n=this.getScene(),s=n==null;n==null&&(n=new ps),n.drawImplTo(this,e,t),s&&(n.dispose(),this.onRemove())},draw:function(){},sync:function(e){var t,n,s,o=this.posChanged;for(o&&(this.calcAbsPos(),this.posChanged=!1),this.lastFrame=e.frame,t=0,s=this.children.length;t<s;){if(n=this.children[t],n==null)break;n.lastFrame!=e.frame&&(o&&(n.posChanged=!0),n.sync(e)),this.children[t]!=n?(t=0,s=this.children.length):++t}},syncPos:function(){if(this.parent!=null&&this.parent.syncPos(),this.posChanged){this.calcAbsPos();for(var n,e=0,t=this.children;e<t.length;)n=t[e],++e,n.posChanged=!0;this.posChanged=!1}},calcAbsPos:function(){if(this.parent==null)this.rotation==0?(e=1,t=0,this.matA=this.scaleX,this.matB=0,this.matC=0,this.matD=this.scaleY):(e=Math.cos(this.rotation),t=Math.sin(this.rotation),this.matA=this.scaleX*e,this.matB=this.scaleX*t,this.matC=this.scaleY*-t,this.matD=this.scaleY*e),this.absX=this.x,this.absY=this.y;else{if(this.rotation==0)this.matA=this.scaleX*this.parent.matA,this.matB=this.scaleX*this.parent.matB,this.matC=this.scaleY*this.parent.matC,this.matD=this.scaleY*this.parent.matD;else{var e=Math.cos(this.rotation),t=Math.sin(this.rotation),n=this.scaleX*e,s=this.scaleX*t,o=this.scaleY*-t,i=this.scaleY*e;this.matA=n*this.parent.matA+s*this.parent.matC,this.matB=n*this.parent.matB+s*this.parent.matD,this.matC=o*this.parent.matA+i*this.parent.matC,this.matD=o*this.parent.matB+i*this.parent.matD}this.absX=this.x*this.parent.matA+this.y*this.parent.matC+this.parent.absX,this.absY=this.x*this.parent.matB+this.y*this.parent.matD+this.parent.absY}},emitTile:function(e,t){Oe.nullDrawable==null&&(Oe.nullDrawable=new Gs(null)),Oe.nullDrawable.smooth=!!(this.filter!=null&&this.filter.smooth)||null,Oe.nullDrawable.absX=this.absX,Oe.nullDrawable.absY=this.absY,Oe.nullDrawable.matA=this.matA,Oe.nullDrawable.matB=this.matB,Oe.nullDrawable.matC=this.matC,Oe.nullDrawable.matD=this.matD,e.drawTile(Oe.nullDrawable,t)},clipBounds:function(e,t,n,s){s==null&&(s=1),n==null&&(n=1);var i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,o=e.tmpBounds;e.inFilter!=null?(j=e.baseShader.filterMatrixA__,b=e.baseShader.filterMatrixB__,_=this.matA*j.x+this.matB*j.y,w=this.matA*b.x+this.matB*b.y,y=this.matC*j.x+this.matD*j.y,O=this.matC*b.x+this.matD*b.y,S=this.absX*j.x+this.absY*j.y+j.z,A=this.absX*b.x+this.absY*b.y+b.z,u=(_*e.viewA+w*e.viewC)/n,h=(_*e.viewB+w*e.viewD)/s,m=(y*e.viewA+O*e.viewC)/n,f=(y*e.viewB+O*e.viewD)/s,g=S*e.viewA+A*e.viewC+e.viewX,p=S*e.viewB+A*e.viewD+e.viewY):(u=(this.matA*e.viewA+this.matB*e.viewC)/n,h=(this.matA*e.viewB+this.matB*e.viewD)/s,m=(this.matC*e.viewA+this.matD*e.viewC)/n,f=(this.matC*e.viewB+this.matD*e.viewD)/s,g=this.absX*e.viewA+this.absY*e.viewC+e.viewX,p=this.absX*e.viewB+this.absY*e.viewD+e.viewY),o.xMin=1e20,o.yMin=1e20,o.xMax=-1e20,o.yMax=-1e20,r=t.xMin,c=t.yMin,a=r*u+c*m+g,i=r*h+c*f+p,a<o.xMin&&(o.xMin=a),a>o.xMax&&(o.xMax=a),i<o.yMin&&(o.yMin=i),i>o.yMax&&(o.yMax=i),r=t.xMax,c=t.yMin,a=r*u+c*m+g,i=r*h+c*f+p,a<o.xMin&&(o.xMin=a),a>o.xMax&&(o.xMax=a),i<o.yMin&&(o.yMin=i),i>o.yMax&&(o.yMax=i),r=t.xMin,c=t.yMax,a=r*u+c*m+g,i=r*h+c*f+p,a<o.xMin&&(o.xMin=a),a>o.xMax&&(o.xMax=a),i<o.yMin&&(o.yMin=i),i>o.yMax&&(o.yMax=i),r=t.xMax,c=t.yMax,a=r*u+c*m+g,i=r*h+c*f+p,a<o.xMin&&(o.xMin=a),a>o.xMax&&(o.xMax=a),i<o.yMin&&(o.yMin=i),i>o.yMax&&(o.yMax=i),o.xMin<-1&&(o.xMin=-1),o.yMin<-1&&(o.yMin=-1),o.xMax>1&&(o.xMax=1),o.yMax>1&&(o.yMax=1),v=1/(u*f-h*m),x=o.xMin,C=o.yMin,E=o.xMax,k=o.yMax,o.xMin=1e20,o.yMin=1e20,o.xMax=-1e20,o.yMax=-1e20,r=x,c=C,r-=g,c-=p,a=(r*f-c*m)*v,i=(-r*h+c*u)*v,a<o.xMin&&(o.xMin=a),a>o.xMax&&(o.xMax=a),i<o.yMin&&(o.yMin=i),i>o.yMax&&(o.yMax=i),r=E,c=C,r-=g,c-=p,a=(r*f-c*m)*v,i=(-r*h+c*u)*v,a<o.xMin&&(o.xMin=a),a>o.xMax&&(o.xMax=a),i<o.yMin&&(o.yMin=i),i>o.yMax&&(o.yMax=i),r=x,c=k,r-=g,c-=p,a=(r*f-c*m)*v,i=(-r*h+c*u)*v,a<o.xMin&&(o.xMin=a),a>o.xMax&&(o.xMax=a),i<o.yMin&&(o.yMin=i),i>o.yMax&&(o.yMax=i),r=E,c=k,r-=g,c-=p,a=(r*f-c*m)*v,i=(-r*h+c*u)*v,a<o.xMin&&(o.xMin=a),a>o.xMax&&(o.xMax=a),i<o.yMin&&(o.yMin=i),i>o.yMax&&(o.yMax=i),d=t.xMin,l=o.xMin,t.xMin=d<l?l:d,d=t.yMin,l=o.yMin,t.yMin=d<l?l:d,d=t.xMax,l=o.xMax,t.xMax=d>l?l:d,d=t.yMax,l=o.yMax,t.yMax=d>l?l:d},drawFilters:function(e){if(!e.pushFilter(this))return;var t,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,n=e.tmpBounds,s=new At;if(this.filter.sync(e,this),this.filter.useScreenResolution?(O=e.scene,c=O.viewportScaleX*this.filter.resolutionScale,l=O.viewportScaleY*this.filter.resolutionScale):(c=this.filter.resolutionScale,l=this.filter.resolutionScale),this.filter.autoBounds?(f=this.filter.boundsExtend,f>=0&&(this.getBounds(this,n),n.xMin=n.xMin*c-f,n.yMin=n.yMin*l-f,n.xMax=n.xMax*c+f,n.yMax=n.yMax*l+f,n.xMin<s.xMin&&(s.xMin=n.xMin),n.xMax>s.xMax&&(s.xMax=n.xMax),n.yMin<s.yMin&&(s.yMin=n.yMin),n.yMax>s.yMax&&(s.yMax=n.yMax))):(b=Oe.tmpPoint,t=b,i=c,o=l,o==null&&(o=0),i==null&&(i=0),t.x=i,t.y=o,this.filter.getBounds(this,n,b),n.xMin<s.xMin&&(s.xMin=n.xMin),n.xMax>s.xMax&&(s.xMax=n.xMax),n.yMin<s.yMin&&(s.yMin=n.yMin),n.yMax>s.yMax&&(s.yMax=n.yMax),c=b.x,l=b.y),e.setFilterScale(c,l),this.clipBounds(e,s,c,l),g=Math.floor(s.xMin+1e-10),p=Math.floor(s.yMin+1e-10),j=Math.ceil(s.xMax-g-1e-10),y=Math.ceil(s.yMax-p-1e-10),j<=0||y<=0||s.xMax<s.xMin){e.popFilter();return}if(w=e.textures.allocTarget("filterTemp",j,y,!1),e.pushTarget(w,g,p,j,y),e.engine.clear(0),A=e.globalAlpha,m=e.baseShader,t=m.filterMatrixA__,i=t.x,o=t.y,r=t.z,r==null&&(r=0),o==null&&(o=0),i==null&&(i=0),d=i,h=o,u=r,u==null&&(u=0),h==null&&(h=0),d==null&&(d=0),F=d,N=h,T=u,t=m.filterMatrixB__,i=t.x,o=t.y,r=t.z,r==null&&(r=0),o==null&&(o=0),i==null&&(i=0),d=i,h=o,u=r,u==null&&(u=0),h==null&&(h=0),d==null&&(d=0),k=d,M=h,S=u,v=1/(this.matA*this.matD-this.matB*this.matC),_=this.matD*v*c,E=-this.matB*v*l,C=-this.matC*v*c,x=this.matA*v*l,z=-(this.absX*_+this.absY*C),D=-(this.absX*E+this.absY*x),t=m.filterMatrixA__,i=_,o=C,r=z,r==null&&(r=0),o==null&&(o=0),i==null&&(i=0),t.x=i,t.y=o,t.z=r,t=m.filterMatrixB__,i=E,o=x,r=D,r==null&&(r=0),o==null&&(o=0),i==null&&(i=0),t.x=i,t.y=o,t.z=r,e.globalAlpha=1,this.drawContent(e),a=Ue.fromTexture(w),a.dx=g/c,a.dy=p/l,L=a,a=this.filter.draw(e,a),a!=null&&(a!=L&&(a.dx=(a.dx+g)/c,a.dy=(a.dy+p)/l),a.width/=c,a.height/=l),t=m.filterMatrixA__,t.x=F,t.y=N,t.z=T,t=m.filterMatrixB__,t.x=k,t.y=M,t.z=S,e.popTarget(),e.popFilter(),e.globalAlpha=A,a==null)return;this.drawFiltered(e,a)},drawFiltered:function(e,t){var n=e.globalAlpha;e.currentBlend=null,e.inFilterBlend=this.blendMode,e.globalAlpha*=this.alpha,this.emitTile(e,t),e.globalAlpha=n,e.inFilterBlend=null,e.currentBlend=null},drawRec:function(e){if(!this.visible)return;if(this.posChanged){this.calcAbsPos();for(var s,o,t=0,n=this.children;t<n.length;)s=n[t],++t,s.posChanged=!0;this.posChanged=!1}this.filter!=null&&this.filter.get_enable()?this.drawFilters(e):(o=e.globalAlpha,e.globalAlpha*=this.alpha,this.drawContent(e),e.globalAlpha=o)},drawContent:function(e){if(e.front2back){for(var t,n,o,s=this.children.length;s-- >0;)this.children[s].drawRec(e);this.draw(e)}else for(this.draw(e),t=0,n=this.children;t<n.length;)o=n[t],++t,o.drawRec(e)},set_x:function(e){return this.posChanged=!0,this.x=e},set_y:function(e){return this.posChanged=!0,this.y=e},set_scaleX:function(e){return this.posChanged=!0,this.scaleX=e},set_scaleY:function(e){return this.posChanged=!0,this.scaleY=e},set_rotation:function(e){return this.posChanged=!0,this.rotation=e},move:function(e,t){var n=this.x+(e*Math.cos(this.rotation)-t*Math.sin(this.rotation));this.posChanged=!0,this.x=n,n=this.y+(e*Math.sin(this.rotation)+t*Math.cos(this.rotation)),this.posChanged=!0,this.y=n},setPosition:function(e,t){this.posChanged=!0,this.x=e,this.posChanged=!0,this.y=t},rotate:function(e){this.posChanged=!0,this.rotation+=e},scale:function(e){this.posChanged=!0,this.scaleX*=e,this.posChanged=!0,this.scaleY*=e},setScale:function(e){this.posChanged=!0,this.scaleX=e,this.posChanged=!0,this.scaleY=e},getChildAt:function(e){return this.children[e]},getChildIndex:function(e){for(var t,n=0,s=this.children.length;n<s;)if(t=n++,this.children[t]==e)return t;return-1},getObjectByName:function(e){if(this.name==e)return this;for(var n,o,t=0,s=this.children;t<s.length;)if(o=s[t],++t,n=o.getObjectByName(e),n!=null)return n;return null},get_numChildren:function(){return this.children.length},iterator:function(){return new Wa(this.children)},toString:function(){var t=H.getClass(this),e=t.__name__;return this.name==null?e:this.name+"("+e+")"},contentChanged:function(){},constraintSize:function(){},__class__:Oe},Gs=function(e){Oe.call(this,e);var t=1,n=1,s=1,o=1;o==null&&(o=1),s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),this.color=new j(t,n,s,o)},c["h2d.Drawable"]=Gs,Gs.__name__="h2d.Drawable",Gs.__super__=Oe,Gs.prototype=g(Oe.prototype,{set_tileWrap:function(e){return this.tileWrap=e},get_colorAdd:function(){var e=this.getShader(ks);return e==null?null:e.color__},set_colorAdd:function(e){var t=this.getShader(ks);return t==null?e!=null&&(t=this.addShader(new ks),t.color__=e):e==null?this.removeShader(t):t.color__=e,e},drawFiltered:function(e,t){var n=this.shaders;this.shaders=null,Oe.prototype.drawFiltered.call(this,e,t),this.shaders=n},set_colorKey:function(e){var t,n,s=this.getShader(Hs);return s==null?e!=null&&(s=this.addShader(new Hs(-16777216|e))):e==null?this.removeShader(s):(t=s.colorKey__,n=-16777216|e,t.x=(n>>16&255)/255,t.y=(n>>8&255)/255,t.z=(n&255)/255,t.w=(n>>>24)/255),this.colorKey=e},adjustColor:function(e){if(e==null)this.set_colorMatrix(null);else{var t=this.get_colorMatrix();t==null&&(t=new L,this.set_colorMatrix(t)),t.identity(),t.adjustColor(e)}},get_colorMatrix:function(){var e=this.getShader(Es);return e==null?null:e.matrix__},set_colorMatrix:function(e){var t=this.getShader(Es);return t==null?e!=null&&(t=this.addShader(new Es),t.matrix__=e):e==null?this.removeShader(t):t.matrix__=e,e},getShader:function(e){if(this.shaders!=null)for(var n,s,o,t=this.shaders,i=null;t!=i;)if(o=t.s,t=t.next,n=o,s=H.__downcastCheck(n,e)?n:null,s!=null)return s;return null},getShaders:function(){return new Go(this.shaders,null)},addShader:function(e){if(e==null)throw t.thrown("Can't add null shader");return this.shaders=Ge.addSort(e,this.shaders),e},removeShader:function(e){for(var n=null,t=this.shaders;t!=null;){if(t.s==e)return n==null?this.shaders=t.next:n.next=t.next,!0;n=t,t=t.next}return!1},emitTile:function(e,t){if(t==null&&(t=new Ue(null,0,0,5,5)),!e.drawTile(this,t))return},__class__:Gs}),Oa=function(e,t){Gs.call(this,t),this.set_tile(e)},c["h2d.Bitmap"]=Oa,Oa.__name__="h2d.Bitmap",Oa.__super__=Gs,Oa.prototype=g(Gs.prototype,{getBoundsRec:function(e,t,n){Gs.prototype.getBoundsRec.call(this,e,t,n),this.tile!=null&&(this.width==null&&this.height==null?this.addBounds(e,t,this.tile.dx,this.tile.dy,this.tile.width,this.tile.height):this.addBounds(e,t,this.tile.dx,this.tile.dy,this.width!=null?this.width:this.tile.width*this.height/this.tile.height,this.height!=null?this.height:this.tile.height*this.width/this.tile.width))},set_width:function(e){return this.width==e?e:(this.width=e,this.parentContainer!=null&&this.parentContainer.contentChanged(this),e)},set_height:function(e){return this.height==e?e:(this.height=e,this.parentContainer!=null&&this.parentContainer.contentChanged(this),e)},set_tile:function(e){return this.tile==e?e:(this.tile=e,this.parentContainer!=null&&this.parentContainer.contentChanged(this),e)},draw:function(e){if(this.width==null&&this.height==null){this.emitTile(e,this.tile);return}this.tile==null&&this.set_tile(Ue.fromColor(16711935));var t=this.tile.width,n=this.tile.height;this.tile.width=this.width!=null?this.width:t*this.height/n,this.tile.height=this.height!=null?this.height:n*this.width/t,this.emitTile(e,this.tile),this.tile.width=t,this.tile.height=n},__class__:Oa}),X=_["h2d.BlendMode"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"h2d.BlendMode",toString:s},Alpha:{_hx_name:"Alpha",_hx_index:1,__enum__:"h2d.BlendMode",toString:s},Add:{_hx_name:"Add",_hx_index:2,__enum__:"h2d.BlendMode",toString:s},AlphaAdd:{_hx_name:"AlphaAdd",_hx_index:3,__enum__:"h2d.BlendMode",toString:s},SoftAdd:{_hx_name:"SoftAdd",_hx_index:4,__enum__:"h2d.BlendMode",toString:s},Multiply:{_hx_name:"Multiply",_hx_index:5,__enum__:"h2d.BlendMode",toString:s},AlphaMultiply:{_hx_name:"AlphaMultiply",_hx_index:6,__enum__:"h2d.BlendMode",toString:s},Erase:{_hx_name:"Erase",_hx_index:7,__enum__:"h2d.BlendMode",toString:s},Screen:{_hx_name:"Screen",_hx_index:8,__enum__:"h2d.BlendMode",toString:s},Sub:{_hx_name:"Sub",_hx_index:9,__enum__:"h2d.BlendMode",toString:s},Max:{_hx_name:"Max",_hx_index:10,__enum__:"h2d.BlendMode",toString:s},Min:{_hx_name:"Min",_hx_index:11,__enum__:"h2d.BlendMode",toString:s}},X.__constructs__=[X.None,X.Alpha,X.Add,X.AlphaAdd,X.SoftAdd,X.Multiply,X.AlphaMultiply,X.Erase,X.Screen,X.Sub,X.Max,X.Min],X.__empty_constructs__=[X.None,X.Alpha,X.Add,X.AlphaAdd,X.SoftAdd,X.Multiply,X.AlphaMultiply,X.Erase,X.Screen,X.Sub,X.Max,X.Min],Ec=function(e){this.followRotation=!1,this.posChanged=!0,this.x=0,this.posChanged=!0,this.y=0,this.posChanged=!0,this.scaleX=1,this.posChanged=!0,this.scaleY=1,this.posChanged=!0,this.rotation=0,this.posChanged=!0,this.anchorX=0,this.posChanged=!0,this.anchorY=0,this.viewX=0,this.viewY=0,this.viewW=1,this.viewH=1,this.visible=!0,e!=null&&e.addCamera(this)},c["h2d.Camera"]=Ec,Ec.__name__="h2d.Camera",Ec.prototype={remove:function(){this.scene!=null&&this.scene.removeCamera(this)},layerVisible:function(){return!0},enter:function(e){if(e.pushCamera(this),this.clipViewport){var t=e.inFilter;e.inFilter=null,e.pushRenderZone(this.viewX*this.scene.width,this.viewY*this.scene.height,this.viewW*this.scene.width,this.viewH*this.scene.height),e.inFilter=t}},exit:function(e){if(this.clipViewport){var t=e.inFilter;e.inFilter=null,e.popRenderZone(),e.inFilter=t}e.popCamera()},sync:function(e,t){if(t==null&&(t=!1),this.scene==null)return;if(this.follow!=null&&(this.posChanged=!0,this.x=this.follow.absX,this.posChanged=!0,this.y=this.follow.absY,this.followRotation&&(this.posChanged=!0,this.rotation=-this.follow.rotation)),this.posChanged||t){if(this.rotation==0)this.matA=this.scaleX,this.matB=0,this.matC=0,this.matD=this.scaleY;else{var n=Math.cos(this.rotation),s=Math.sin(this.rotation);this.matA=this.scaleX*n,this.matB=this.scaleX*s,this.matC=this.scaleY*-s,this.matD=this.scaleY*n}this.absX=Math.round(-(this.x*this.matA+this.y*this.matC)+this.scene.width*this.anchorX*this.viewW+this.scene.width*this.viewX),this.absY=Math.round(-(this.x*this.matB+this.y*this.matD)+this.scene.height*this.anchorY*this.viewH+this.scene.height*this.viewY),this.invDet=1/(this.matA*this.matD-this.matB*this.matC),this.posChanged=!1}},setScale:function(e,t){this.posChanged=!0,this.scaleX=e,this.posChanged=!0,this.scaleY=t},scale:function(e,t){this.posChanged=!0,this.scaleX*=e,this.posChanged=!0,this.scaleY*=t},setPosition:function(e,t){this.posChanged=!0,this.x=e,this.posChanged=!0,this.y=t},move:function(e,t){this.posChanged=!0,this.x+=e,this.posChanged=!0,this.y+=t},rotate:function(e){this.posChanged=!0,this.rotation+=e},setAnchor:function(e,t){this.posChanged=!0,this.anchorX=e,this.posChanged=!0,this.anchorY=t},setViewport:function(e,n,s,o){if(o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),e==null&&(e=0),this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");if(this.posChanged=!0,this.viewX=Math.floor(e)/this.scene.width,this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");this.posChanged=!0,this.viewY=Math.floor(n)/this.scene.height;var i=s==0?this.scene.width:s;if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");if(this.posChanged=!0,this.viewW=Math.ceil(i)/this.scene.width,i=o==0?this.scene.height:o,this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");this.posChanged=!0,this.viewH=Math.ceil(i)/this.scene.height},setRawViewport:function(e,t,n,s){s==null&&(s=1),n==null&&(n=1),t==null&&(t=0),e==null&&(e=0),this.viewX=e,this.viewY=t,this.viewW=n,this.viewH=s,this.posChanged=!0},screenXToCamera:function(e,t){return(((e-this.scene.offsetX)/this.scene.viewportScaleX-this.absX)*this.matD-((t-this.scene.offsetY)/this.scene.viewportScaleY-this.absY)*this.matC)*this.invDet},screenYToCamera:function(e,t){return(-((e-this.scene.offsetX)/this.scene.viewportScaleX-this.absX)*this.matB+((t-this.scene.offsetY)/this.scene.viewportScaleY-this.absY)*this.matA)*this.invDet},cameraXToScreen:function(e,t){return(e*this.matA+t*this.matC+this.absX)*this.scene.viewportScaleX+this.scene.offsetX},cameraYToScreen:function(e,t){return(e*this.matB+t*this.matD+this.absY)*this.scene.viewportScaleY+this.scene.offsetY},sceneXToCamera:function(e,t){return((e-this.absX)*this.matD-(t-this.absY)*this.matC)*this.invDet},sceneYToCamera:function(e,t){return(-(e-this.absX)*this.matB+(t-this.absY)*this.matA)*this.invDet},cameraXToScene:function(e,t){return e*this.matA+t*this.matC+this.absX},cameraYToScene:function(e,t){return e*this.matB+t*this.matD+this.absY},eventToCamera:function(e){var t=(e.relX-this.scene.offsetX)/this.scene.viewportScaleX-this.absX,n=(e.relY-this.scene.offsetY)/this.scene.viewportScaleY-this.absY;e.relX=(t*this.matD-n*this.matC)*this.invDet,e.relY=(-t*this.matB+n*this.matA)*this.invDet},screenToCamera:function(e){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");var n=(e.x-this.scene.offsetX)/this.scene.viewportScaleX-this.absX,s=(e.y-this.scene.offsetY)/this.scene.viewportScaleY-this.absY;e.x=(n*this.matD-s*this.matC)*this.invDet,e.y=(-n*this.matB+s*this.matA)*this.invDet},cameraToScreen:function(e){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");var n=e.x,s=e.y;e.x=(n*this.matA+s*this.matC+this.absX)*this.scene.viewportScaleX+this.scene.offsetX,e.y=(n*this.matB+s*this.matD+this.absY)*this.scene.viewportScaleY+this.scene.offsetY},sceneToCamera:function(e){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");var n=e.x-this.absX,s=e.y-this.absY;e.x=(n*this.matD-s*this.matC)*this.invDet,e.y=(-n*this.matB+s*this.matA)*this.invDet},cameraToScene:function(e){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");var n=e.x,s=e.y;e.x=n*this.matA+s*this.matC+this.absX,e.y=n*this.matB+s*this.matD+this.absY},checkScene:function(){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene")},set_x:function(e){return this.posChanged=!0,this.x=e},set_y:function(e){return this.posChanged=!0,this.y=e},set_scaleX:function(e){return this.posChanged=!0,this.scaleX=e},set_scaleY:function(e){return this.posChanged=!0,this.scaleY=e},set_rotation:function(e){return this.posChanged=!0,this.rotation=e},get_viewportX:function(){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");return this.viewX*this.scene.width},set_viewportX:function(e){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");return this.posChanged=!0,this.viewX=Math.floor(e)/this.scene.width,e},get_viewportY:function(){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");return this.viewY*this.scene.height},set_viewportY:function(e){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");return this.posChanged=!0,this.viewY=Math.floor(e)/this.scene.height,e},get_viewportWidth:function(){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");return this.viewW*this.scene.width},set_viewportWidth:function(e){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");return this.posChanged=!0,this.viewW=Math.ceil(e)/this.scene.width,e},get_viewportHeight:function(){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");return this.viewH*this.scene.height},set_viewportHeight:function(e){if(this.scene==null)throw t.thrown("This method requires Camera to be added to the Scene");return this.posChanged=!0,this.viewH=Math.ceil(e)/this.scene.height,e},set_anchorX:function(e){return this.posChanged=!0,this.anchorX=e},set_anchorY:function(e){return this.posChanged=!0,this.anchorY=e},__class__:Ec},Wi=function(e,t){this.prevChar=e,this.offset=t},c["h2d.Kerning"]=Wi,Wi.__name__="h2d.Kerning",Wi.prototype={__class__:Wi},ts=function(e,t){this.t=e,this.width=t},c["h2d.FontChar"]=ts,ts.__name__="h2d.FontChar",ts.prototype={addKerning:function(e,t){var n=new Wi(e,t);n.next=this.kerning,this.kerning=n},getKerningOffset:function(e){for(var t=this.kerning;t!=null;){if(t.prevChar==e)return t.offset;t=t.next}return 0},clone:function(){var t,s,n=new ts(this.t.clone(),this.width),e=this.kerning;if(e!=null)for(t=new Wi(e.prevChar,e.offset),n.kerning=t,e=e.next;e!=null;)s=new Wi(e.prevChar,e.offset),t=t.next=s,e=e.next;return n},__class__:ts},$i=_["h2d.FontType"]={__ename__:!0,__constructs__:null,BitmapFont:{_hx_name:"BitmapFont",_hx_index:0,__enum__:"h2d.FontType",toString:s},SignedDistanceField:(a=function(e,t,n){return{_hx_index:1,channel:e,alphaCutoff:t,smoothing:n,__enum__:"h2d.FontType",toString:s}},a._hx_name="SignedDistanceField",a.__params__=["channel","alphaCutoff","smoothing"],a)},$i.__constructs__=[$i.BitmapFont,$i.SignedDistanceField],$i.__empty_constructs__=[$i.BitmapFont],Vi=function(e,t,n){this.offsetY=0,this.offsetX=0,this.name=e,this.size=t,this.initSize=t,this.glyphs=new le,this.defaultChar=this.nullChar=new ts(new Ue(null,0,0,0,0),0),this.charset=gt.getDefault(),e!=null&&(this.tilePath=ge.withExtension(e,"png")),n==null?this.type=$i.BitmapFont:this.type=n},c["h2d.Font"]=Vi,Vi.__name__="h2d.Font",Vi.prototype={getChar:function(e){var t=this.glyphs.h[e];return t==null&&(t=this.charset.resolveChar(e,this.glyphs),t==null&&(t=e==13||e==10?this.nullChar:this.defaultChar)),t},setOffset:function(e,t){var o,i,n=e-this.offsetX,s=t-this.offsetY;if(n==0&&s==0)return;for(o=this.glyphs.iterator();o.hasNext();)i=o.next(),i.t.dx+=n,i.t.dy+=s;this.offsetX+=n,this.offsetY+=s},clone:function(){var t,n,s,o,e=new Vi(this.name,this.size);for(e.baseLine=this.baseLine,e.lineHeight=this.lineHeight,e.tile=this.tile.clone(),e.charset=this.charset,e.defaultChar=this.defaultChar.clone(),e.type=this.type,e.offsetX=this.offsetX,e.offsetY=this.offsetY,t=this.glyphs.keys();t.hasNext();)n=t.next(),s=this.glyphs.h[n],o=s.clone(),s==this.defaultChar&&(e.defaultChar=o),e.glyphs.h[n]=o;return e},resizeTo:function(e){for(var n,s,t=e/this.size,o=this.glyphs.iterator();o.hasNext();)for(n=o.next(),n.width*=t,n.t.scaleToSize(n.t.width*t,n.t.height*t),n.t.dx*=t,n.t.dy*=t,s=n.kerning;s!=null;)s.offset*=t,s=s.next;this.lineHeight=Math.ceil(this.lineHeight*t),this.baseLine=Math.ceil(this.baseLine*t),this.size=e},hasChar:function(e){return this.glyphs.h[e]!=null},dispose:function(){this.tile.dispose()},calcBaseLine:function(){var e,t=0,n=this.glyphs.h[32];return n!=null&&(t=n.t.height*.5),e=this.glyphs.h[65],e==null&&(e=this.glyphs.h[97]),e==null&&(e=this.glyphs.h[48]),e==null?this.lineHeight-2-t:e.t.dy+e.t.height-t},__class__:Vi},Bi=function(){},c["hxd.Interactive"]=Bi,Bi.__name__="hxd.Interactive",Bi.__isInterface__=!0,Bi.prototype={__class__:Bi},Hi=function(e,t,n,s){this.shapeY=0,this.shapeX=0,this.lastClickFrame=-1,this.mouseDownButton=-1,this.allowMultiClick=!1,this.enableRightButton=!1,this.propagateEvents=!1,this.cancelEvents=!1,this.cursor=Ht.Button,Oe.call(this,n),this.width=e,this.height=t,this.shape=s},c["h2d.Interactive"]=Hi,Hi.__name__="h2d.Interactive",Hi.__interfaces__=[Bi],Hi.__super__=Oe,Hi.prototype=g(Oe.prototype,{onAdd:function(){this.scene=this.getScene(),this.scene!=null&&this.scene.addEventTarget(this),Oe.prototype.onAdd.call(this)},draw:function(e){this.maskedBounds=e.getCurrentRenderZone(this.maskedBounds),this.backgroundColor!=null&&this.emitTile(e,Ue.fromColor(this.backgroundColor,this.width|0,this.height|0,(this.backgroundColor>>>24)/255))},getBoundsRec:function(e,t,n){Oe.prototype.getBoundsRec.call(this,e,t,n),(this.backgroundColor!=null||n)&&this.addBounds(e,t,0,0,this.width|0,this.height|0)},onHierarchyMoved:function(e){Oe.prototype.onHierarchyMoved.call(this,e),this.scene!=null&&(this.scene.removeEventTarget(this),this.scene=this.getScene(),this.scene!=null&&this.scene.addEventTarget(this))},onRemove:function(){this.scene!=null&&(this.scene.removeEventTarget(this,!0),this.scene=null),Oe.prototype.onRemove.call(this)},checkBounds:function(e){switch(e.kind._hx_index){case 4:case 6:case 7:case 10:return!1;default:return!0}},preventClick:function(){this.mouseDownButton=-1},getInteractiveScene:function(){return this.scene},handleEvent:function(e){if(this.maskedBounds!=null&&this.checkBounds(e)){var t,o,i,a,r,c,n=e.relX,s=e.relY;if(s==null&&(s=0),n==null&&(n=0),t=new U(n,s),this.localToGlobal(t),t.x<this.maskedBounds.xMin||t.y<this.maskedBounds.yMin||t.x>this.maskedBounds.xMax||t.y>this.maskedBounds.yMax){e.cancel=!0;return}}if(this.shape==null&&this.isEllipse&&this.checkBounds(e)&&(o=this.width*.5,i=this.height*.5,a=(e.relX-o)/o,r=(e.relY-i)/i,a*a+r*r>1)){e.cancel=!0;return}switch(this.propagateEvents&&(e.propagate=!0),this.cancelEvents&&(e.cancel=!0),e.kind._hx_index){case 0:(this.enableRightButton||e.button==0)&&(this.mouseDownButton=e.button,this.onPush(e),e.cancel&&(this.mouseDownButton=-1));break;case 1:(this.enableRightButton||e.button==0)&&(this.onRelease(e),c=N.frameCount,this.mouseDownButton==e.button&&(this.lastClickFrame!=c||this.allowMultiClick)&&(this.onClick(e),this.lastClickFrame=c)),this.mouseDownButton=-1;break;case 2:this.onMove(e);break;case 3:this.onOver(e);break;case 4:this.onOut(e);break;case 5:e.propagate=!0,this.onWheel(e);break;case 6:this.onFocus(e);break;case 7:this.onFocusLost(e);break;case 8:this.onKeyDown(e);break;case 9:this.onKeyUp(e);break;case 10:(this.enableRightButton||e.button==0)&&(this.onRelease(e),this.mouseDownButton==e.button&&this.onReleaseOutside(e)),this.mouseDownButton=-1;break;case 11:this.onTextInput(e);break;case 12:this.onCheck(e);break}},calcAbsPos:function(){Oe.prototype.calcAbsPos.call(this),this.invDet=1/(this.matA*this.matD-this.matB*this.matC)},set_cursor:function(e){return this.cursor=e,this.scene!=null&&this.scene.events!=null&&this.scene.events.updateCursor(this),e},eventToLocal:function(e){var t=this,n=e.relX-t.absX,s=e.relY-t.absY;e.relX=(n*t.matD-s*t.matC)*t.invDet,e.relY=(-n*t.matB+s*t.matA)*t.invDet},startCapture:function(e,t,n){var s=this;this.scene.startCapture(function(t){var n=t.relX,o=t.relY;s.eventToLocal(t),e(t),t.relX=n,t.relY=o},t,n)},stopCapture:function(){this.scene.stopCapture()},startDrag:function(e,t){this.startCapture(e,t)},stopDrag:function(){this.stopCapture()},focus:function(){if(this.scene==null||this.scene.events==null)return;this.scene.events.focus(this)},blur:function(){this.hasFocus()&&this.scene.events.blur()},isOver:function(){return this.scene!=null&&this.scene.events!=null&&this.scene.events.overList.indexOf(this)!=-1},hasFocus:function(){return this.scene!=null&&this.scene.events!=null&&this.scene.events.currentFocus==this},onOver:function(){},onOut:function(){},onPush:function(){},onRelease:function(){},onReleaseOutside:function(){},onClick:function(){},onMove:function(){},onWheel:function(){},onFocus:function(){},onFocusLost:function(){},onKeyUp:function(){},onKeyDown:function(){},onCheck:function(){},onTextInput:function(){},__class__:Hi}),xs=function(e){Oe.call(this,e),this.layersIndexes=[],this.layerCount=0},c["h2d.Layers"]=xs,xs.__name__="h2d.Layers",xs.__super__=Oe,xs.prototype=g(Oe.prototype,{addChild:function(e){this.add(e,-1)},add:function(e,t,n){if(n==null&&(n=-1),t==null&&(t=-1),e.parent==this){var s,o,i,a,r,c,l=e.allocated;e.allocated=!1,this.removeChild(e),e.allocated=l}for(t==-1&&(t=this.layerCount==0?0:this.layerCount-1);t>=this.layerCount;)this.layersIndexes[this.layerCount++]=this.children.length;for(n!=-1?t==0?(s=this.layersIndexes[t],o=n>s?s:n,Oe.prototype.addChildAt.call(this,e,0<o?o:0)):n<0?Oe.prototype.addChildAt.call(this,e,this.layersIndexes[t-1]):(i=this.layersIndexes[t-1]+n,s=this.layersIndexes[t],Oe.prototype.addChildAt.call(this,e,i>s?s:i)):Oe.prototype.addChildAt.call(this,e,this.layersIndexes[t]),a=t,r=this.layerCount;a<r;)c=a++,this.layersIndexes[c]++},addChildAt:function(e,t){this.add(e,-1,t)},removeChild:function(e){for(var t,n,s=0,o=this.children.length;s<o;)if(n=s++,this.children[n]==e){for(this.children.splice(n,1),e.allocated&&e.onRemove(),e.parent=null,e.posChanged=!0,e.parentContainer!=null&&e.setParentContainer(null),t=this.layerCount-1;t>=0&&this.layersIndexes[t]>n;)this.layersIndexes[t]--,--t;this.parentContainer!=null&&this.parentContainer.contentChanged(this);break}},under:function(e){for(var t,n,s,o,i,a,r=0,c=this.children.length;r<c;)if(n=r++,this.children[n]==e){for(s=0,o=0,i=this.layersIndexes;o<i.length;){if(a=i[o],++o,a>n)break;s=a}for(t=n;t>s;)this.children[t]=this.children[t-1],--t;this.children[s]=e,e.allocated&&e.onHierarchyMoved(!1);return}},over:function(e){for(var t,n,s,o,i,a,c,r=0,l=this.children.length;r<l;)if(t=r++,this.children[t]==e){for(n=0,o=this.layersIndexes;n<o.length;)if(s=o[n],++n,s>t){for(i=t,c=s-1;i<c;)a=i++,this.children[a]=this.children[a+1];this.children[s-1]=e,e.allocated&&e.onHierarchyMoved(!1);return}return}},getLayer:function(e){if(e>=this.layerCount)t=[];else{var t,n=e==0?0:this.layersIndexes[e-1],s=this.layersIndexes[e];t=this.children.slice(n,s)}return new Wa(t)},getChildAtLayer:function(e,t){return t==-1&&(t=this.layerCount==0?0:this.layerCount-1),t>=this.layerCount||e<0||e>=this.layersIndexes[t]?null:t==0?this.children[e]:this.children[this.layersIndexes[t-1]+e]},getChildLayer:function(e){if(e.parent!=this)return-1;for(var t,s=this.children.indexOf(e),n=0,o=this.layerCount;n<o;)if(t=n++,this.layersIndexes[t]>s)return t;return-1},getChildIndexInLayer:function(e){if(e.parent!=this)return-1;var n,s,o,t=this.children.indexOf(e);if(t<this.layersIndexes[0])return t;for(n=1,o=this.layerCount;n<o;)if(s=n++,this.layersIndexes[s]>t)return t-this.layersIndexes[s-1];return-1},drawLayer:function(e,t){if(t>=this.layerCount)return;var n,s,o,i,a,r=e.globalAlpha;if(e.globalAlpha*=this.alpha,a=t==0?0:this.layersIndexes[t-1],s=this.layersIndexes[t],e.front2back)for(n=a,o=s;n<o;)i=n++,this.children[s-1-i].drawRec(e);else for(n=a,o=s;n<o;)i=n++,this.children[i].drawRec(e);e.globalAlpha=r},ysort:function(e){if(e>=this.layerCount)return;var t,n,s,i,a,o=e==0?0:this.layersIndexes[e-1],r=this.layersIndexes[e];if(o==r)return;for(n=o,i=this.children[n++].y;n<r;){if(t=this.children[n],t.y<i){for(s=n-1;s>=o;){if(a=this.children[s],t.y>=a.y)break;this.children[s+1]=a,--s}this.children[s+1]=t,t.allocated&&t.onHierarchyMoved(!1)}else i=t.y;++n}},__class__:xs}),Ie=function(){this.shaderBuffers=new uc,this.engine=K.CURRENT,this.frame=0,this.time=0,this.elapsedTime=1/V.getDefaultFrameRate(),this.textures=new Rn,this.globals=new ie},c["h3d.impl.RenderContext"]=Ie,Ie.__name__="h3d.impl.RenderContext",Ie.get=function(){return Ie.inst},Ie.getType=function(e){var t=Ie.inst;return H.__downcastCheck(t,e)?t:null},Ie.prototype={setCurrent:function(){Ie.inst=this},clearCurrent:function(){if(Ie.inst==this)Ie.inst=null;else throw t.thrown("Context has changed")},dispose:function(){this.textures.dispose()},fillRec:function(e,n,s,i){switch(n._hx_index){case 1:return s[i]=e,1;case 3:return s[i]=e,1;case 5:var a,r,c,l,h,m,f,p,g,v,b,j,y,u=n.size,d=n.t;return u==4?(r=e,s[i++]=r.x,s[i++]=r.y,s[i++]=r.z,s[i++]=r.w,4):(l=u,r=e,s[i++]=r.x,s[i++]=r.y,l==3&&(s[i++]=r.z),l);break;case 6:return a=e,s[i++]=a._11,s[i++]=a._21,s[i++]=a._31,s[i++]=0,s[i++]=a._12,s[i++]=a._22,s[i++]=a._32,s[i++]=0,s[i++]=a._13,s[i++]=a._23,s[i++]=a._33,s[i++]=0,12;case 7:return a=e,s[i++]=a._11,s[i++]=a._21,s[i++]=a._31,s[i++]=a._41,s[i++]=a._12,s[i++]=a._22,s[i++]=a._32,s[i++]=a._42,s[i++]=a._13,s[i++]=a._23,s[i++]=a._33,s[i++]=a._43,s[i++]=a._14,s[i++]=a._24,s[i++]=a._34,s[i++]=a._44,16;case 8:return a=e,s[i++]=a._11,s[i++]=a._21,s[i++]=a._31,s[i++]=a._41,s[i++]=a._12,s[i++]=a._22,s[i++]=a._32,s[i++]=a._42,s[i++]=a._13,s[i++]=a._23,s[i++]=a._33,s[i++]=a._43,12;case 13:for(j=n.vl,v=0,u=0;u<j.length;)b=j[u],++u,v+=this.fillRec(q.field(e,b.name),b.type,s,i+v);return v;case 15:switch(u=n.t,d=n.size,u._hx_index){case 3:if(d._hx_index==0){for(c=d.v,r=e,m=0,y=r.length<c?r.length:c,h=0,p=y;h<p;)f=h++,s[i++]=r[f];return c}throw t.thrown("assert "+o.string(n));break;case 5:if(u.size==4)if(u.t._hx_index==1){if(d._hx_index==0){for(c=d.v,r=e,h=0,p=c;h<p;){if(f=h++,l=r[f],l==null)break;s[i++]=l.x,s[i++]=l.y,s[i++]=l.z,s[i++]=l.w}return c*4}throw t.thrown("assert "+o.string(n))}else if(d._hx_index==0){for(g=u,c=d.v,r=e,m=0,h=0,p=c;h<p;){if(f=h++,l=r[f],l==null)break;m=this.fillRec(l,g,s,i),i+=m}return c*m}else throw t.thrown("assert "+o.string(n));else if(d._hx_index==0){for(g=u,c=d.v,r=e,m=0,h=0,p=c;h<p;){if(f=h++,l=r[f],l==null)break;m=this.fillRec(l,g,s,i),i+=m}return c*m}else throw t.thrown("assert "+o.string(n));break;case 8:if(d._hx_index==0){for(c=d.v,r=e,h=0,p=c;h<p;){if(f=h++,a=r[f],a==null)break;s[i++]=a._11,s[i++]=a._21,s[i++]=a._31,s[i++]=a._41,s[i++]=a._12,s[i++]=a._22,s[i++]=a._32,s[i++]=a._42,s[i++]=a._13,s[i++]=a._23,s[i++]=a._33,s[i++]=a._43}return c*12}throw t.thrown("assert "+o.string(n));break;default:if(d._hx_index==0){for(g=u,c=d.v,r=e,m=0,u=0,d=c;u<d;){if(f=u++,l=r[f],l==null)break;m=this.fillRec(l,g,s,i),i+=m}return c*m}throw t.thrown("assert "+o.string(n))}break;default:throw t.thrown("assert "+o.string(n))}},shaderInfo:function(e,t){for(var n,s,o,i,a=t.split(".").pop();e!=null;){for(o=e.s.instance,n=0,s=o.shader.vars;n<s.length;)if(i=s[n],++n,i.name==a)return e.s.toString();e=e.next}return"(not found)"},getPtr:function(e){return e},getParamValue:function(e,n,s){if(s==null&&(s=!1),e.perObjectGlobal!=null){var a,r,c,l,d,i=this.globals.map.h[e.perObjectGlobal.gid];if(i==null)throw t.thrown("Missing global value "+e.perObjectGlobal.path+" for shader "+this.shaderInfo(n,e.perObjectGlobal.path));return r=e.type,r._hx_index==17?(d=r.size,c=!0):c=!1,c?i.texture:i}for(a=n,l=e.instance;--l>0;)a=a.next;if(i=a.s.getParamValue(e.index),i==null&&!s)throw t.thrown("Missing param value "+o.string(a.s)+"."+e.name);return i},fillGlobals:function(e,n){for(var o,i=this,s=n.vertex.globals,a=e.vertex.globals;s!=null;){if(o=i.globals.map.h[s.gid],o==null)throw t.thrown("Missing global value "+s.path);i.fillRec(o,s.type,a,s.pos),s=s.next}if(n.fragment!=null)for(s=n.fragment.globals,a=e.fragment.globals;s!=null;){if(o=i.globals.map.h[s.gid],o==null)throw t.thrown("Missing global value "+s.path);i.fillRec(o,s.type,a,s.pos),s=s.next}},fillParams:function(e,n,s,i){i==null&&(i=!1);for(var c,l,d,u,m,f,p,v,b,j,y,w,O,C,E,k,A,S,M,F,T,z,N,L,R,g=this,h=-1,r=null,_=e.vertex,x=n.vertex,a=x.params,D=_.params;a!=null;){if(a.perObjectGlobal==null){{switch(a.type._hx_index){case 1:case 3:if(c=a.instance,h==c)v=r;else{for(d=s,h=c,i&&++c;--c>0;)d=d.next;r=d.s,v=r}D[a.pos]=v.getParamFloatValue(a.index),a=a.next;continue;default:}if(b=a.instance,h==b)u=r;else{for(O=s,h=b,i&&++b;--b>0;)O=O.next;r=O.s,u=r}if(l=u.getParamValue(a.index),l==null)throw t.thrown("Missing param value "+o.string(r)+"."+a.name)}}else if(a.perObjectGlobal!=null){if(m=g.globals.map.h[a.perObjectGlobal.gid],m==null)throw t.thrown("Missing global value "+a.perObjectGlobal.path+" for shader "+g.shaderInfo(s,a.perObjectGlobal.path));f=a.type,f._hx_index==17?(F=f.size,C=!0):C=!1,l=C?m.texture:m}else{if(j=a.instance,h==j)A=r;else{for(w=s,h=j,i&&++j;--j>0;)w=w.next;r=w.s,A=r}if(z=A.getParamValue(a.index),z==null)throw t.thrown("Missing param value "+o.string(s.s)+"."+a.name);l=z}g.fillRec(l,a.type,D,a.pos),a=a.next}for(M=0,a=x.textures;a!=null;){if(p=!Ie.STRICT,p==null&&(p=!1),a.perObjectGlobal!=null){if(l=g.globals.map.h[a.perObjectGlobal.gid],l==null)throw t.thrown("Missing global value "+a.perObjectGlobal.path+" for shader "+g.shaderInfo(s,a.perObjectGlobal.path));f=a.type,f._hx_index==17?(F=f.size,S=!0):S=!1,y=S?l.texture:l}else{if(c=a.instance,h==c)u=r;else{for(d=s,h=c,i&&++c;--c>0;)d=d.next;r=d.s,u=r}if(m=u.getParamValue(a.index),m==null&&!p)throw t.thrown("Missing param value "+o.string(s.s)+"."+a.name);y=m}if(a.pos<0)for(N=y,T=0,L=-a.pos;T<L;)v=T++,_.tex[M++]=N[v];else _.tex[M++]=y;a=a.next}for(a=x.buffers,R=0;a!=null;){if(p=!Ie.STRICT,p==null&&(p=!1),a.perObjectGlobal!=null){if(l=g.globals.map.h[a.perObjectGlobal.gid],l==null)throw t.thrown("Missing global value "+a.perObjectGlobal.path+" for shader "+g.shaderInfo(s,a.perObjectGlobal.path));f=a.type,f._hx_index==17?(F=f.size,E=!0):E=!1,k=E?l.texture:l}else{if(c=a.instance,h==c)u=r;else{for(d=s,h=c,i&&++c;--c>0;)d=d.next;r=d.s,u=r}if(m=u.getParamValue(a.index),m==null&&!p)throw t.thrown("Missing param value "+o.string(s.s)+"."+a.name);k=m}_.buffers[R++]=k,a=a.next}if(n.fragment!=null){for(_=e.fragment,x=n.fragment,a=x.params,D=_.params;a!=null;){if(a.perObjectGlobal==null){{switch(a.type._hx_index){case 1:case 3:if(c=a.instance,h==c)v=r;else{for(d=s,h=c,i&&++c;--c>0;)d=d.next;r=d.s,v=r}D[a.pos]=v.getParamFloatValue(a.index),a=a.next;continue;default:}if(b=a.instance,h==b)u=r;else{for(O=s,h=b,i&&++b;--b>0;)O=O.next;r=O.s,u=r}if(l=u.getParamValue(a.index),l==null)throw t.thrown("Missing param value "+o.string(r)+"."+a.name)}}else if(a.perObjectGlobal!=null){if(m=g.globals.map.h[a.perObjectGlobal.gid],m==null)throw t.thrown("Missing global value "+a.perObjectGlobal.path+" for shader "+g.shaderInfo(s,a.perObjectGlobal.path));f=a.type,f._hx_index==17?(F=f.size,C=!0):C=!1,l=C?m.texture:m}else{if(j=a.instance,h==j)A=r;else{for(w=s,h=j,i&&++j;--j>0;)w=w.next;r=w.s,A=r}if(z=A.getParamValue(a.index),z==null)throw t.thrown("Missing param value "+o.string(s.s)+"."+a.name);l=z}g.fillRec(l,a.type,D,a.pos),a=a.next}for(M=0,a=x.textures;a!=null;){if(p=!Ie.STRICT,p==null&&(p=!1),a.perObjectGlobal!=null){if(l=g.globals.map.h[a.perObjectGlobal.gid],l==null)throw t.thrown("Missing global value "+a.perObjectGlobal.path+" for shader "+g.shaderInfo(s,a.perObjectGlobal.path));f=a.type,f._hx_index==17?(F=f.size,S=!0):S=!1,y=S?l.texture:l}else{if(c=a.instance,h==c)u=r;else{for(d=s,h=c,i&&++c;--c>0;)d=d.next;r=d.s,u=r}if(m=u.getParamValue(a.index),m==null&&!p)throw t.thrown("Missing param value "+o.string(s.s)+"."+a.name);y=m}if(a.pos<0)for(N=y,T=0,L=-a.pos;T<L;)v=T++,_.tex[M++]=N[v];else _.tex[M++]=y;a=a.next}for(a=x.buffers,R=0;a!=null;){if(p=!Ie.STRICT,p==null&&(p=!1),a.perObjectGlobal!=null){if(l=g.globals.map.h[a.perObjectGlobal.gid],l==null)throw t.thrown("Missing global value "+a.perObjectGlobal.path+" for shader "+g.shaderInfo(s,a.perObjectGlobal.path));f=a.type,f._hx_index==17?(F=f.size,E=!0):E=!1,k=E?l.texture:l}else{if(c=a.instance,h==c)u=r;else{for(d=s,h=c,i&&++c;--c>0;)d=d.next;r=d.s,u=r}if(m=u.getParamValue(a.index),m==null&&!p)throw t.thrown("Missing param value "+o.string(s.s)+"."+a.name);k=m}_.buffers[R++]=k,a=a.next}}},__class__:Ie},Ni=function(e){this.renderZoneIndex=0,this.renderZoneStack=[],this.currentCamera=null,this.tmpBounds=new At,this.defaultSmooth=!1,this.globalAlpha=1,Ie.call(this),this.scene=e,this.bufPos=0,this.output=new Ei,this.pass=new F("",null),this.pass.depth(!0,Ae.Always),this.pass.set_culling(xt.None),this.baseShader=new Qs,this.baseShader.setPriority(100),this.baseShader.zValue__=0,this.baseShaderList=new Ge(this.baseShader),this.targetsStack=[],this.targetsStackIndex=0,this.cameraStack=[],this.cameraStackIndex=0,this.filterStack=[],this.filterStackIndex=0},c["h2d.RenderContext"]=Ni,Ni.__name__="h2d.RenderContext",Ni.__super__=Ie,Ni.prototype=g(Ie.prototype,{dispose:function(){Ie.prototype.dispose.call(this),this.fixedBuffer!=null&&this.fixedBuffer.dispose()},hasBuffering:function(){return!1},begin:function(){this.texture=null,this.currentObj=null,this.bufPos=0,this.stride=0,this.viewA=this.scene.viewportA,this.viewB=0,this.viewC=0,this.viewD=this.scene.viewportD,this.viewX=this.scene.viewportX,this.viewY=this.scene.viewportY,this.setCurrent(),this.targetFlipY=this.engine.driver.hasFeature(je.BottomLeftCoords)?-1:1,this.baseFlipY=this.engine.getCurrentTarget()!=null?this.targetFlipY:1,this.inFilter=null,this.globals.set("time",this.time),this.globals.set("global.time",this.time),this.globals.set("depthMap",{texture:this.engine.driver.getDefaultDepthBuffer(),channel:Re.R});var t,n,s,e=this.baseShader;e.constModified=!0,e.pixelAlign__=!1,e=this.baseShader.halfPixelInverse__,t=.5/this.engine.width,n=.5/this.engine.height,n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=0,e=this.baseShader.viewportA__,t=this.scene.viewportA,n=0,s=this.scene.viewportX,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=s,e=this.baseShader.viewportB__,t=0,n=this.scene.viewportD*-this.baseFlipY,s=this.scene.viewportY*-this.baseFlipY,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=s,e=this.baseShader.filterMatrixA__,t=1,n=0,s=0,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=s,e=this.baseShader.filterMatrixB__,t=0,n=1,s=0,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=s,this.baseShaderList.next=null,this.initShaders(this.baseShaderList),this.engine.selectMaterial(this.pass),this.textures.begin()},allocTarget:function(e,t){t==null&&(t=!1);var n=this.textures.allocTarget(e,this.scene.width,this.scene.height,!1);return n.set_filter(t?Dn.Linear:Dn.Nearest),n},clear:function(e){this.engine.clear(e)},initShaders:function(e){this.needInitShaders=!1,this.currentShaders=e,this.compiledShader=this.output.compileShaders(this.globals,e);var t=this.shaderBuffers,n=this.compiledShader;t.vertex.grow(n.vertex),n.fragment!=null&&t.fragment.grow(n.fragment),this.fillGlobals(t,this.compiledShader),this.engine.selectShader(this.compiledShader),this.engine.uploadShaderBuffers(t,0)},end:function(){if(this.texture=null,this.currentObj=null,this.baseShaderList.next=null,this.clearCurrent(),this.targetsStackIndex!=0)throw t.thrown("Missing popTarget()");if(this.cameraStackIndex!=0)throw t.thrown("Missing popCamera()")},pushCamera:function(e){var n,s,o,i,a,r,c,l,d,t=this.cameraStack[this.cameraStackIndex++];t==null&&(t={va:0,vb:0,vc:0,vd:0,vx:0,vy:0,camera:null},this.cameraStack.push(t)),a=this.viewA,r=this.viewB,c=this.viewC,l=this.viewD,t.va=a,t.vb=r,t.vc=c,t.vd=l,t.vx=this.viewX,t.vy=this.viewY,t.camera=this.currentCamera,this.currentCamera=e,this.viewA=e.matA*a+e.matB*c,this.viewB=e.matA*r+e.matB*l,this.viewC=e.matC*a+e.matD*c,this.viewD=e.matC*r+e.matD*l,this.viewX=e.absX*a+e.absY*c+this.viewX,this.viewY=e.absX*r+e.absY*l+this.viewY,d=this.curTarget!=null?-this.targetFlipY:-this.baseFlipY,n=this.baseShader.viewportA__,s=this.viewA,o=this.viewC,i=this.viewX,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,n=this.baseShader.viewportB__,s=this.viewB*d,o=this.viewD*d,i=this.viewY*d,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i},popCamera:function(){if(this.cameraStackIndex==0)throw t.thrown("Too many popCamera()");var n,s,o,i,a,e=this.cameraStack[--this.cameraStackIndex];this.viewA=e.va,this.viewB=e.vb,this.viewC=e.vc,this.viewD=e.vd,this.viewX=e.vx,this.viewY=e.vy,this.currentCamera=e.camera,e.camera=null,a=this.curTarget!=null?-this.targetFlipY:-this.baseFlipY,n=this.baseShader.viewportA__,s=this.viewA,o=this.viewC,i=this.viewX,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,n=this.baseShader.viewportB__,s=this.viewB*a,o=this.viewD*a,i=this.viewY*a,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i},pushFilter:function(e){return!(this.filterStack.length==0&&this.onEnterFilter!=null&&!this.onEnterFilter(e))&&(this.inFilter=this.filterStack[this.filterStackIndex++],this.inFilter==null&&(this.inFilter={spr:null,scaleX:1,scaleY:1},this.filterStack.push(this.inFilter)),this.inFilter.spr=e,this.inFilter.scaleX=1,this.inFilter.scaleY=1,!0)},setFilterScale:function(e,t){this.inFilter!=null&&(this.inFilter.scaleX=e,this.inFilter.scaleY=t)},getFilterScale:function(e){if(e==null&&(e=new U(0,0)),this.inFilter!=null){var s=e,t=this.inFilter.scaleX,n=this.inFilter.scaleY;n==null&&(n=0),t==null&&(t=0),s.x=t,s.y=n}else s=e,t=1,n=1,n==null&&(n=0),t==null&&(t=0),s.x=t,s.y=n;return e},popFilter:function(){this.inFilter.spr=null,this.filterStackIndex--,this.filterStackIndex>0?this.inFilter=this.filterStack[this.filterStackIndex-1]:(this.inFilter=null,this.onLeaveFilter!=null&&this.onLeaveFilter(this.filterStack[this.filterStackIndex].spr))},pushTarget:function(e,t,n,s,o){o==null&&(o=-1),s==null&&(s=-1),n==null&&(n=0),t==null&&(t=0),this.engine.pushTarget(e),this.initShaders(this.baseShaderList);var a,r,c,l,i=this.targetsStack[this.targetsStackIndex++];i==null&&(i={t:null,va:0,vb:0,vc:0,vd:0,vx:0,vy:0,hasRZ:!1,rzX:0,rzY:0,rzW:0,rzH:0},this.targetsStack.push(i)),i.t=this.curTarget,i.va=this.viewA,i.vb=this.viewB,i.vc=this.viewC,i.vd=this.viewD,i.vx=this.viewX,i.vy=this.viewY,i.hasRZ=this.hasRenderZone,i.rzX=this.renderX,i.rzY=this.renderY,i.rzW=this.renderW,i.rzH=this.renderH,s<0&&(s=e==null?this.scene.width:e.width),o<0&&(o=e==null?this.scene.height:e.height),this.viewA=2/s,this.viewB=0,this.viewC=0,this.viewD=2/o,this.viewX=-1-t*this.viewA,this.viewY=-1-n*this.viewD,a=this.baseShader.halfPixelInverse__,r=.5/(e==null?this.engine.width:e.width),c=.5/(e==null?this.engine.height:e.height),c==null&&(c=0),r==null&&(r=0),a.x=r,a.y=c,a.z=0,a=this.baseShader.viewportA__,r=this.viewA,c=this.viewC,l=this.viewX,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),a.x=r,a.y=c,a.z=l,a=this.baseShader.viewportB__,r=this.viewB*-this.targetFlipY,c=this.viewD*-this.targetFlipY,l=this.viewY*-this.targetFlipY,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),a.x=r,a.y=c,a.z=l,this.curTarget=e,this.currentBlend=null,this.hasRenderZone&&(this.hasRenderZone=!1,this.engine.setRenderZone())},pushTargets:function(e){this.pushTarget(e[0]),e.length>1&&(this.engine.popTarget(),this.engine.pushTargets(e))},popTarget:function(){if(this.targetsStackIndex<=0)throw t.thrown("Too many popTarget()");this.engine.popTarget();var n,s,o,i,r,e=this.targetsStack[--this.targetsStackIndex],a=this.curTarget=e.t;this.viewA=e.va,this.viewB=e.vb,this.viewC=e.vc,this.viewD=e.vd,this.viewX=e.vx,this.viewY=e.vy,r=a==null?-this.baseFlipY:-this.targetFlipY,this.initShaders(this.baseShaderList),n=this.baseShader.halfPixelInverse__,s=.5/(a==null?this.engine.width:a.width),o=.5/(a==null?this.engine.height:a.height),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=0,n=this.baseShader.viewportA__,s=this.viewA,o=this.viewC,i=this.viewX,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,n=this.baseShader.viewportB__,s=this.viewB*r,o=this.viewD*r,i=this.viewY*r,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,e.hasRZ&&this.setRZ(e.rzX,e.rzY,e.rzW,e.rzH)},pushRenderZone:function(e,t,n,s){var o=this.renderZoneStack[this.renderZoneIndex++];o==null?(o={hasRZ:this.hasRenderZone,x:this.renderX,y:this.renderY,w:this.renderW,h:this.renderH},this.renderZoneStack[this.renderZoneIndex-1]=o):this.hasRenderZone?(o.hasRZ=!0,o.x=this.renderX,o.y=this.renderY,o.w=this.renderW,o.h=this.renderH):o.hasRZ=!1,this.setRZ(e,t,n,s)},popRenderZone:function(){if(this.renderZoneIndex==0)throw t.thrown("Too many popRenderZone()");var e=this.renderZoneStack[--this.renderZoneIndex];e.hasRZ?this.setRZ(e.x,e.y,e.w,e.h):(this.hasRenderZone=!1,this.engine.setRenderZone())},getCurrentRenderZone:function(e){if(!this.hasRenderZone)return null;e==null&&(e=new At);var t=this.renderX,n=this.renderY;return e.xMin=t,e.yMin=n,e.xMax=t+this.renderW,e.yMax=n+this.renderH,e},clipRenderZone:function(e,t,n,s){if(!this.hasRenderZone){this.pushRenderZone(e,t,n,s);return}var o=Math.min(e+n,this.renderX+this.renderW),i=Math.min(t+s,this.renderY+this.renderH);e=Math.max(e,this.renderX),t=Math.max(t,this.renderY),o<e&&(o=e),i<t&&(i=t),this.pushRenderZone(e,t,o-e,i-t)},setRZ:function(e,t,n,s){this.hasRenderZone=!0,this.renderX=e,this.renderY=t,this.renderW=n,this.renderH=s;var o,i,a,r,c,l,h,m,d=this.scene.viewportA*this.engine.width/2,u=this.scene.viewportD*this.engine.height/2;this.inFilter!=null&&(o=this.baseShader.filterMatrixA__,i=this.baseShader.filterMatrixB__,a=e+n,r=t+s,c=e*o.x+t*o.y+o.z,l=e*i.x+t*i.y+i.z,h=a*o.x+r*o.y+o.z,m=a*i.x+r*i.y+i.z,e=c,t=l,n=h-c,s=m-l),this.engine.setRenderZone(e*d+(this.scene.viewportX+1)*(this.engine.width/2)+1e-10|0,t*u+(this.scene.viewportY+1)*(this.engine.height/2)+1e-10|0,n*d+1e-10|0,s*u+1e-10|0)},clearRZ:function(){this.hasRenderZone=!1,this.engine.setRenderZone()},setRenderZone:function(e,t,n,s){this.pushRenderZone(e,t,n,s)},clearRenderZone:function(){this.popRenderZone()},drawLayer:function(e){this.scene.drawLayer(this,e)},drawScene:function(){this.scene.drawRec(this)},flush:function(){},_flush:function(){if(this.bufPos==0)return;this.beforeDraw();var t,n=this.bufPos/this.stride|0,e=new wt(n,y.get_XY_UV_RGBA(),[ve.Dynamic]);e.uploadFloats(this.buffer,0,n),t=this.engine,t.renderBuffer(e,t.mem.getQuadIndexes(e.vertices),2,0,-1),e.dispose(),this.bufPos=0,this.texture=null},beforeDraw:function(){this.texture==null&&(this.texture=S.fromColor(16711935)),this.baseShader.texture__=this.texture,this.texture.set_filter((this.currentObj.smooth==null?this.defaultSmooth:this.currentObj.smooth)?Dn.Linear:Dn.Nearest),this.texture.set_wrap(this.currentObj.tileWrap&&(this.currentObj.filter==null||this.inFilter!=null)?hs.Repeat:hs.Clamp);var t,e=this.currentObj.blendMode;this.inFilter!=null&&this.inFilter.spr==this.currentObj&&e==X.Erase&&(e=X.Add),this.inFilterBlend!=null&&(e=this.inFilterBlend),e!=this.currentBlend&&(this.currentBlend=e,this.pass.setBlendMode(e),(e==X.Alpha||e==X.Add)&&(this.pass.set_blendAlphaSrc(R.One),this.inFilterBlend!=null&&this.pass.set_blendSrc(R.One))),t=this.shaderBuffers,this.fillParams(t,this.compiledShader,this.currentShaders),this.engine.selectMaterial(this.pass),this.engine.uploadInstanceShaderBuffers(t)},setupColor:function(e){if(this.inFilter!=null&&this.inFilter.spr==e){var t=this.baseShader.color__,n=e.color.x,s=e.color.y,o=e.color.z,i=e.color.w;i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t.x=n,t.y=s,t.z=o,t.w=i}else this.inFilterBlend!=null?(t=this.baseShader.color__,n=this.globalAlpha,s=this.globalAlpha,o=this.globalAlpha,i=this.globalAlpha,i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t.x=n,t.y=s,t.z=o,t.w=i):(t=this.baseShader.color__,n=e.color.x,s=e.color.y,o=e.color.z,i=e.color.w*this.globalAlpha,i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t.x=n,t.y=s,t.z=o,t.w=i)},beginDrawBatchState:function(e){if(!this.beginDraw(e,null,!0))return!1;if(this.inFilter!=null&&this.inFilter.spr==e){var t=this.baseShader.color__,n=e.color.x,s=e.color.y,o=e.color.z,i=e.color.w;i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t.x=n,t.y=s,t.z=o,t.w=i}else this.inFilterBlend!=null?(t=this.baseShader.color__,n=this.globalAlpha,s=this.globalAlpha,o=this.globalAlpha,i=this.globalAlpha,i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t.x=n,t.y=s,t.z=o,t.w=i):(t=this.baseShader.color__,n=e.color.x,s=e.color.y,o=e.color.z,i=e.color.w*this.globalAlpha,i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t.x=n,t.y=s,t.z=o,t.w=i);return t=this.baseShader.absoluteMatrixA__,n=e.matA,s=e.matC,o=e.absX,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t.x=n,t.y=s,t.z=o,t=this.baseShader.absoluteMatrixB__,n=e.matB,s=e.matD,o=e.absY,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t.x=n,t.y=s,t.z=o,!0},swapTexture:function(e){this.texture=e,this.beforeDraw()},beginDrawObject:function(e,t){if(!this.beginDraw(e,t,!0))return!1;if(this.inFilter!=null&&this.inFilter.spr==e){var n=this.baseShader.color__,s=e.color.x,o=e.color.y,i=e.color.z,a=e.color.w;a==null&&(a=1),i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,n.w=a}else this.inFilterBlend!=null?(n=this.baseShader.color__,s=this.globalAlpha,o=this.globalAlpha,i=this.globalAlpha,a=this.globalAlpha,a==null&&(a=1),i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,n.w=a):(n=this.baseShader.color__,s=e.color.x,o=e.color.y,i=e.color.z,a=e.color.w*this.globalAlpha,a==null&&(a=1),i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,n.w=a);return n=this.baseShader.absoluteMatrixA__,s=e.matA,o=e.matC,i=e.absX,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,n=this.baseShader.absoluteMatrixB__,s=e.matB,o=e.matD,i=e.absY,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,this.beforeDraw(),!0},beginDrawBatch:function(e,t){return this.beginDraw(e,t,!1)},drawTile:function(e,t){if(this.inFilter!=null){var n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,_,x,C,E,k,A,S,M,T,N,H,I,O=this.baseShader.filterMatrixA__,w=this.baseShader.filterMatrixB__,P=e.matA*O.x+e.matB*O.y,R=e.matA*w.x+e.matB*w.y,L=e.matC*O.x+e.matD*O.y,F=e.matC*w.x+e.matD*w.y,D=e.absX*O.x+e.absY*O.y+O.z,z=e.absX*w.x+e.absY*w.y+w.z;p=P*this.viewA+R*this.viewC,_=P*this.viewB+R*this.viewD,j=L*this.viewA+F*this.viewC,f=L*this.viewB+F*this.viewD,E=D*this.viewA+z*this.viewC+this.viewX,k=D*this.viewB+z*this.viewD+this.viewY}else p=e.matA*this.viewA+e.matB*this.viewC,_=e.matA*this.viewB+e.matB*this.viewD,j=e.matC*this.viewA+e.matD*this.viewC,f=e.matC*this.viewB+e.matD*this.viewD,E=e.absX*this.viewA+e.absY*this.viewC+this.viewX,k=e.absX*this.viewB+e.absY*this.viewD+this.viewY;if(_==0&&j==0){if(T=t.dx+t.width*.5,N=t.dy+t.height*.5,M=p<0?-p:p,x=f<0?-f:f,C=(t.width>t.height?t.width:t.height)*1.5*(M<x?x:M),S=E+T*p,A=k+N*f,S+C<-1||S-C>1||A+C<-1||A-C>1)return!1}else if(b=1e20,m=1e20,v=-1e20,g=-1e20,I=t.width*.5,H=t.height*.5,u=t.dx*p+t.dy*j,d=t.dx*_+t.dy*f,u<b&&(b=u),u>v&&(v=u),d<m&&(m=d),d>g&&(g=d),r=t.width,u=(r+t.dx)*p+t.dy*j,d=(r+t.dx)*_+t.dy*f,u<b&&(b=u),u>v&&(v=u),d<m&&(m=d),d>g&&(g=d),c=t.height,u=t.dx*p+(c+t.dy)*j,d=t.dx*_+(c+t.dy)*f,u<b&&(b=u),u>v&&(v=u),d<m&&(m=d),d>g&&(g=d),r=t.width,c=t.height,u=(r+t.dx)*p+(c+t.dy)*j,d=(r+t.dx)*_+(c+t.dy)*f,u<b&&(b=u),u>v&&(v=u),d<m&&(m=d),d>g&&(g=d),E+v<-1||k+g<-1||E+b>1||k+m>1)return!1;return!!this.beginDraw(e,t.innerTex,!0,!0)&&(this.inFilter!=null&&this.inFilter.spr==e?(a=this.baseShader.color__,r=e.color.x,c=e.color.y,l=e.color.z,h=e.color.w,h==null&&(h=1),l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),a.x=r,a.y=c,a.z=l,a.w=h):this.inFilterBlend!=null?(a=this.baseShader.color__,r=this.globalAlpha,c=this.globalAlpha,l=this.globalAlpha,h=this.globalAlpha,h==null&&(h=1),l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),a.x=r,a.y=c,a.z=l,a.w=h):(a=this.baseShader.color__,r=e.color.x,c=e.color.y,l=e.color.z,h=e.color.w*this.globalAlpha,h==null&&(h=1),l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),a.x=r,a.y=c,a.z=l,a.w=h),a=this.baseShader.absoluteMatrixA__,r=t.width*e.matA,c=t.height*e.matC,l=e.absX+t.dx*e.matA+t.dy*e.matC,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),a.x=r,a.y=c,a.z=l,a=this.baseShader.absoluteMatrixB__,r=t.width*e.matB,c=t.height*e.matD,l=e.absY+t.dx*e.matB+t.dy*e.matD,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),a.x=r,a.y=c,a.z=l,a=this.baseShader.uvPos__,r=t.u,c=t.v,l=t.u2-t.u,h=t.v2-t.v,h==null&&(h=1),l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),a.x=r,a.y=c,a.z=l,a.w=h,this.beforeDraw(),(this.fixedBuffer==null||this.fixedBuffer.vbuf==null)&&(this.fixedBuffer=new wt(4,y.get_XY_UV_RGBA()),n=Tt._new(0),i=0,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=0,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=0,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=0,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=0,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=0,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=0,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=0,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,i=1,n.pos==n.array.length&&(s=n.array.length<<1,s<128&&(s=128),o=new Float32Array(s),o.set(n.array),n.array=o),n.array[n.pos++]=i,this.fixedBuffer.uploadFloats(n,0,4)),a=this.engine,x=this.fixedBuffer,a.renderBuffer(x,a.mem.getQuadIndexes(x.vertices),2,0,-1),!0)},beginDraw:function(e,n,s,o){if(o==null&&(o=!1),this.onBeginDraw!=null&&!this.onBeginDraw(e))return!1;for(var i,c,d,h,m=8,l=this.needInitShaders,u=!1,a=e.shaders,r=this.currentShaders.next;a!=null&&r!=null;)c=a.s,d=r.s,a=a.next,r=r.next,h=d.instance,c!=d&&(u=!0),c.updateConstants(this.globals),c.instance!=h&&(l=!0);if((a!=null||r!=null||this.baseShader.isRelative__!=s||this.baseShader.hasUVPos__!=o||this.baseShader.killAlpha__!=this.killAlpha)&&(l=!0),l)i=this.baseShader,i.constModified=!0,i.hasUVPos__=o,i=this.baseShader,i.constModified=!0,i.isRelative__=s,i=this.baseShader,i.constModified=!0,i.killAlpha__=this.killAlpha,this.baseShader.updateConstants(this.globals),this.baseShaderList.next=e.shaders,this.initShaders(this.baseShaderList);else if(u){if(this.currentShaders!=this.baseShaderList)throw t.thrown("!");this.currentShaders.next=e.shaders}return this.texture=n,this.stride=m,this.currentObj=e,!0},setCurrent:function(){Ie.prototype.setCurrent.call(this),this.needInitShaders=!0},__class__:Ni}),on=_["h2d.ScaleModeAlign"]={__ename__:!0,__constructs__:null,Left:{_hx_name:"Left",_hx_index:0,__enum__:"h2d.ScaleModeAlign",toString:s},Right:{_hx_name:"Right",_hx_index:1,__enum__:"h2d.ScaleModeAlign",toString:s},Center:{_hx_name:"Center",_hx_index:2,__enum__:"h2d.ScaleModeAlign",toString:s},Top:{_hx_name:"Top",_hx_index:3,__enum__:"h2d.ScaleModeAlign",toString:s},Bottom:{_hx_name:"Bottom",_hx_index:4,__enum__:"h2d.ScaleModeAlign",toString:s}},on.__constructs__=[on.Left,on.Right,on.Center,on.Top,on.Bottom],on.__empty_constructs__=[on.Left,on.Right,on.Center,on.Top,on.Bottom],os=_["h2d.ScaleMode"]={__ename__:!0,__constructs__:null,Resize:{_hx_name:"Resize",_hx_index:0,__enum__:"h2d.ScaleMode",toString:s},Stretch:(a=function(e,t){return{_hx_index:1,width:e,height:t,__enum__:"h2d.ScaleMode",toString:s}},a._hx_name="Stretch",a.__params__=["width","height"],a),LetterBox:(a=function(e,t,n,o,i){return{_hx_index:2,width:e,height:t,integerScale:n,horizontalAlign:o,verticalAlign:i,__enum__:"h2d.ScaleMode",toString:s}},a._hx_name="LetterBox",a.__params__=["width","height","integerScale","horizontalAlign","verticalAlign"],a),Fixed:(a=function(e,t,n,o,i){return{_hx_index:3,width:e,height:t,zoom:n,horizontalAlign:o,verticalAlign:i,__enum__:"h2d.ScaleMode",toString:s}},a._hx_name="Fixed",a.__params__=["width","height","zoom","horizontalAlign","verticalAlign"],a),Zoom:(a=function(e){return{_hx_index:4,level:e,__enum__:"h2d.ScaleMode",toString:s}},a._hx_name="Zoom",a.__params__=["level"],a),AutoZoom:(a=function(e,t,n){return{_hx_index:5,minWidth:e,minHeight:t,integerScaling:n,__enum__:"h2d.ScaleMode",toString:s}},a._hx_name="AutoZoom",a.__params__=["minWidth","minHeight","integerScaling"],a)},os.__constructs__=[os.Resize,os.Stretch,os.LetterBox,os.Fixed,os.Zoom,os.AutoZoom],os.__empty_constructs__=[os.Resize],zi=function(){},c["hxd.InteractiveScene"]=zi,zi.__name__="hxd.InteractiveScene",zi.__isInterface__=!0,zi.prototype={__class__:zi},ps=function(){this.scaleMode=os.Resize,xs.call(this,null);var e=K.CURRENT;this.ctx=new Ni(this),this._cameras=[],new Ec(this),this.set_interactiveCamera(this._cameras[0]),this.width=e.width,this.height=e.height,this.viewportA=2/e.width,this.viewportD=2/e.height,this.viewportX=-1,this.viewportY=-1,this.viewportScaleX=1,this.viewportScaleY=1,this.offsetX=0,this.offsetY=0,this.interactive=[],this.eventListeners=[],this.shapePoint=new U(0,0),this.window=pt.getInstance(),this.posChanged=!0},c["h2d.Scene"]=ps,ps.__name__="h2d.Scene",ps.__interfaces__=[zi,Bo],ps.__super__=xs,ps.prototype=g(xs.prototype,{get_defaultSmooth:function(){return this.ctx.defaultSmooth},set_defaultSmooth:function(e){return this.ctx.defaultSmooth=e},setEvents:function(e){this.events=e},get_zoom:function(){var t,e=this.scaleMode;return e._hx_index==4?(t=e.level,t|0):0},set_zoom:function(e){return this.set_scaleMode(os.Zoom(e)),e},set_scaleMode:function(e){return this.scaleMode=e,this.checkResize(),e},get_renderer:function(){return this.ctx},set_renderer:function(e){return this.ctx=e,e},get_camera:function(){return this._cameras[0]},get_cameras:function(){return this._cameras},set_interactiveCamera:function(e){if(e==null)throw t.thrown("Interactive cammera cannot be null!");return e.scene!=this&&this.addCamera(e),this.interactiveCamera=e},addCamera:function(e,t){e.scene!=null&&e.scene.removeCamera(e),e.scene=this,e.posChanged=!0,t!=null?this._cameras.splice(t,0,e):this._cameras.push(e)},removeCamera:function(e){if(e==this.interactiveCamera)throw t.thrown("Current interactive Camera cannot be removed from camera list!");e.scene=null,u.remove(this._cameras,e)},setFixedSize:function(e,t){this.set_scaleMode(os.Stretch(e,t))},checkResize:function(){var t,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,e=this,n=K.CURRENT;if(n==null)return;switch(s=this.scaleMode,s._hx_index){case 0:r=n.width,a=n.height,(r!=e.width||a!=e.height)&&(e.width=r,e.height=a,e.posChanged=!0),e.viewportScaleX=1,e.viewportScaleY=1,e.viewportA=2/e.width,e.viewportD=2/e.height,e.viewportX=-1,e.viewportY=-1;break;case 1:i=s.width,o=s.height,(i!=e.width||o!=e.height)&&(e.width=i,e.height=o,e.posChanged=!0),e.viewportScaleX=n.width/i,e.viewportScaleY=n.height/o,e.viewportA=2/e.width,e.viewportD=2/e.height,e.viewportX=-1,e.viewportY=-1;break;case 2:switch(i=s.width,o=s.height,p=s.integerScale,m=s.horizontalAlign,f=s.verticalAlign,(i!=e.width||o!=e.height)&&(e.width=i,e.height=o,e.posChanged=!0),d=n.width/i,u=n.height/o,t=d>u?u:d,p&&(t=t|0,t==0&&(t=1)),c=m,l=f,e.viewportA=t*2/n.width,e.viewportD=t*2/n.height,e.viewportScaleX=t,e.viewportScaleY=t,c==null&&(c=on.Center),c._hx_index){case 0:e.viewportX=-1,e.offsetX=0;break;case 1:e.viewportX=1-e.width*e.viewportA,e.offsetX=n.width-e.width*t;break;default:e.viewportX=Math.floor((n.width-e.width*t)/(t*2))*e.viewportA-1,e.offsetX=Math.floor((n.width-e.width*t)/2)}switch(l==null&&(l=on.Center),l._hx_index){case 3:e.viewportY=-1,e.offsetY=0;break;case 4:e.viewportY=1-e.height*e.viewportD,e.offsetY=n.height-e.height*t;break;default:e.viewportY=Math.floor((n.height-e.height*t)/(t*2))*e.viewportD-1,e.offsetY=Math.floor((n.height-e.height*t)/2)}break;case 3:switch(i=s.width,o=s.height,t=s.zoom,m=s.horizontalAlign,f=s.verticalAlign,(i!=e.width||o!=e.height)&&(e.width=i,e.height=o,e.posChanged=!0),c=m,l=f,e.viewportA=t*2/n.width,e.viewportD=t*2/n.height,e.viewportScaleX=t,e.viewportScaleY=t,c==null&&(c=on.Center),c._hx_index){case 0:e.viewportX=-1,e.offsetX=0;break;case 1:e.viewportX=1-e.width*e.viewportA,e.offsetX=n.width-e.width*t;break;default:e.viewportX=Math.floor((n.width-e.width*t)/(t*2))*e.viewportA-1,e.offsetX=Math.floor((n.width-e.width*t)/2)}switch(l==null&&(l=on.Center),l._hx_index){case 3:e.viewportY=-1,e.offsetY=0;break;case 4:e.viewportY=1-e.height*e.viewportD,e.offsetY=n.height-e.height*t;break;default:e.viewportY=Math.floor((n.height-e.height*t)/(t*2))*e.viewportD-1,e.offsetY=Math.floor((n.height-e.height*t)/2)}break;case 4:h=s.level,r=Math.ceil(n.width/h),a=Math.ceil(n.height/h),(r!=e.width||a!=e.height)&&(e.width=r,e.height=a,e.posChanged=!0),e.viewportScaleX=h,e.viewportScaleY=h,e.viewportA=2/e.width,e.viewportD=2/e.height,e.viewportX=-1,e.viewportY=-1;break;case 5:g=s.minWidth,v=s.minHeight,b=s.integerScaling,d=n.width/g,u=n.height/v,t=d>u?u:d,b&&(t=t|0,t==0&&(t=1)),r=Math.ceil(n.width/t),a=Math.ceil(n.height/t),(r!=e.width||a!=e.height)&&(e.width=r,e.height=a,e.posChanged=!0),e.viewportScaleX=t,e.viewportScaleY=t,e.viewportA=2/e.width,e.viewportD=2/e.height,e.viewportX=-1,e.viewportY=-1;break}},screenXToViewport:function(e){var t=this.interactiveCamera,e=this.window.get_mouseX(),n=this.window.get_mouseY();return(((e-t.scene.offsetX)/t.scene.viewportScaleX-t.absX)*t.matD-((n-t.scene.offsetY)/t.scene.viewportScaleY-t.absY)*t.matC)*t.invDet},screenYToViewport:function(e){var t=this.interactiveCamera,n=this.window.get_mouseX(),e=this.window.get_mouseY();return(-((n-t.scene.offsetX)/t.scene.viewportScaleX-t.absX)*t.matB+((e-t.scene.offsetY)/t.scene.viewportScaleY-t.absY)*t.matA)*t.invDet},get_mouseX:function(){this.syncPos();var o,t=this.window.get_mouseX(),e=this.interactiveCamera,t=this.window.get_mouseX(),n=this.window.get_mouseY(),s=(((t-e.scene.offsetX)/e.scene.viewportScaleX-e.absX)*e.matD-((n-e.scene.offsetY)/e.scene.viewportScaleY-e.absY)*e.matC)*e.invDet-this.absX;return this.matC==0?s/this.matA:(n=this.window.get_mouseY(),e=this.interactiveCamera,t=this.window.get_mouseX(),n=this.window.get_mouseY(),o=(-((t-e.scene.offsetX)/e.scene.viewportScaleX-e.absX)*e.matB+((n-e.scene.offsetY)/e.scene.viewportScaleY-e.absY)*e.matA)*e.invDet-this.absY,(s*this.matD-o*this.matC)/(this.matA*this.matD-this.matB*this.matC))},get_mouseY:function(){this.syncPos();var o,t=this.window.get_mouseY(),e=this.interactiveCamera,n=this.window.get_mouseX(),t=this.window.get_mouseY(),s=(-((n-e.scene.offsetX)/e.scene.viewportScaleX-e.absX)*e.matB+((t-e.scene.offsetY)/e.scene.viewportScaleY-e.absY)*e.matA)*e.invDet-this.absY;return this.matB==0?s/this.matD:(n=this.window.get_mouseX(),e=this.interactiveCamera,n=this.window.get_mouseX(),t=this.window.get_mouseY(),o=(((n-e.scene.offsetX)/e.scene.viewportScaleX-e.absX)*e.matD-((t-e.scene.offsetY)/e.scene.viewportScaleY-e.absY)*e.matC)*e.invDet-this.absX,(s*this.matA-o*this.matB)/(this.matA*this.matD-this.matB*this.matC))},dispatchListeners:function(e){this.screenToViewport(e);for(var s,t=0,n=this.eventListeners;t<n.length;)if(s=n[t],++t,s(e),!e.propagate)break},isInteractiveVisible:function(e){for(var t=e;t!=this;){if(t==null||!t.visible)return!1;t=t.parent}return!0},getInteractive:function(e,t){for(var n,s,o,i,a,r,c,l,d,u,f=this.shapePoint,h=0,m=this.interactive;h<m.length;){if(n=m[h],++h,n.posChanged&&n.syncPos(),c=e-n.absX,l=t-n.absY,o=(c*n.matD-l*n.matC)*n.invDet,i=(l*n.matA-c*n.matB)*n.invDet,n.shape!=null){if(d=f,a=o+n.shapeX,r=i+n.shapeY,r==null&&(r=0),a==null&&(a=0),d.x=a,d.y=r,!n.shape.contains(f))continue}else if(i<0||o<0||o>=n.width||i>=n.height)continue;for(u=!0,s=n;s!=null;){if(!s.visible){u=!1;break}s=s.parent}if(!u)continue;return n}return null},screenToViewport:function(e){this.interactiveCamera.eventToCamera(e)},dispatchEvent:function(e,t){var s,o,i,a,n=t;this.screenToViewport(e),s=e.relX-n.absX,o=e.relY-n.absY,i=(s*n.matD-o*n.matC)*n.invDet,a=(o*n.matA-s*n.matB)*n.invDet,e.relX=i,e.relY=a,n.handleEvent(e)},handleEvent:function(e,t){this.screenToViewport(e);var n,s,o,i,a,r,c,d,u,h,m,f,g,v,b,l=e.relX,p=e.relY;if(l<0||p<0||l>=this.width||p>=this.height)return null;for(b=t==null?0:this.interactive.indexOf(t)+1,m=this.shapePoint,u=b,v=this.interactive.length;u<v;){if(g=u++,n=this.interactive[g],n==null)break;if(n.invDet==0)continue;if(c=l-n.absX,d=p-n.absY,i=(c*n.matD-d*n.matC)*n.invDet,o=(d*n.matA-c*n.matB)*n.invDet,n.shape!=null){if(h=m,r=i+n.shapeX,a=o+n.shapeY,a==null&&(a=0),r==null&&(r=0),h.x=r,h.y=a,!n.shape.contains(m))continue}else if(o<0||i<0||i>=n.width||o>=n.height)continue;for(f=!0,s=n;s!=null;){if(!s.visible){f=!1;break}s=s.parent}if(!f)continue;if(e.relX=i,e.relY=o,n.handleEvent(e),e.cancel){e.cancel=!1,e.propagate=!1;continue}return n}return null},addEventListener:function(e){this.eventListeners.push(e)},removeEventListener:function(e){for(var n,t=0,s=this.eventListeners;t<s.length;)if(n=s[t],++t,n==e)return u.remove(this.eventListeners,n),!0;return!1},startCapture:function(e,t,n){var s=this;this.events.startCapture(function(t){s.screenToViewport(t),e(t)},t,n)},stopCapture:function(){this.events.stopCapture()},startDrag:function(e,t,n){this.startCapture(e,t,n!=null?n.touchId:null)},stopDrag:function(){this.stopCapture()},getFocus:function(){if(this.events==null)return null;var t,e=this.events.getFocus();return e==null?null:(t=e instanceof Hi?e:null,t==null?null:this.interactive[this.interactive.indexOf(t)])},addEventTarget:function(e){for(var t,n,o,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,s=e,i=0;s!=null;)s=s.parent,++i;for(b=i,d=0,v=this.interactive.length;d<v;){for(l=d++,s=e,o=this.interactive[l],c=b,a=o,i=0;a!=null;)a=a.parent,++i;for(r=i,n=s,t=o;c>r;)s=n,n=n.parent,--c;for(;r>c;)o=t,t=t.parent,--r;for(;n!=t;)s=n,n=n.parent,o=t,t=t.parent;for(u=-1,h=0,j=n.children.length;h<j;)if(m=h++,n.children[m]==s){u=m;break}for(y=u,f=-1,p=0,_=t.children.length;p<_;)if(g=p++,t.children[g]==o){f=g;break}if(y>f){this.interactive.splice(l,0,e);return}}this.interactive.push(e)},removeEventTarget:function(e,t){t==null&&(t=!1),u.remove(this.interactive,e),t&&this.events!=null&&this.events.onRemove(e)},dispose:function(){this.allocated&&this.onRemove(),this.ctx.dispose()},setElapsedTime:function(e){this.ctx.elapsedTime=e},drawImplTo:function(e,n,s){for(var i,a,r,c,o=0;o<n.length;)if(r=n[o],++o,(r.flags&1<<w.Target._hx_index)==0)throw t.thrown("Can only draw to texture created with Target flag");this.ctx.engine=K.CURRENT,c=this.ctx.engine.backgroundColor,i=this.ctx.engine.inRender,this.ctx.engine.backgroundColor=null,this.ctx.globalAlpha=this.alpha,a=Ie.get(),i?this.ctx.targetFlipY==0&&this.ctx.begin():(this.ctx.engine.begin(),this.ctx.begin()),this.ctx.pushTargets(n),s!=null&&this.ctx.output.setOutput(s),e.drawRec(this.ctx),s!=null&&this.ctx.output.setOutput(),this.ctx.popTarget(),this.ctx.engine.backgroundColor=c,i||(this.ctx.end(),this.ctx.engine.end()),a!=null&&a.setCurrent()},syncOnly:function(e){var t=K.CURRENT;this.setElapsedTime(e),this.ctx.engine=t,this.ctx.frame++,this.ctx.time+=this.ctx.elapsedTime,this.ctx.globalAlpha=this.alpha,this.sync(this.ctx)},render:function(e){this.ctx.engine=e,this.ctx.frame++,this.ctx.time+=this.ctx.elapsedTime,this.ctx.globalAlpha=this.alpha,this.mark("s2d"),this.sync(this.ctx),this.children.length!=0&&(this.ctx.begin(),this.ctx.drawScene(),this.ctx.end()),this.mark("vsync")},mark:function(){},sync:function(e){var t,n,s,o=this.posChanged;for(this.allocated||this.onAdd(),xs.prototype.sync.call(this,e),t=0,n=this._cameras;t<n.length;)s=n[t],++t,s.sync(e,o)},clipBounds:function(e,t,n,s){if(s==null&&(s=1),n==null&&(n=1),e.inFilter!=null){var a,r,c,l,d,u,h,i=e.baseShader.filterMatrixA__,o=e.baseShader.filterMatrixB__,m=this.matA*i.x+this.matB*i.y,f=this.matA*o.x+this.matB*o.y,p=this.matC*i.x+this.matD*i.y,g=this.matC*o.x+this.matD*o.y,v=this.absX*i.x+this.absY*i.y+i.z,b=this.absX*o.x+this.absY*o.y+o.z;l=(m*e.viewA+f*e.viewC)/n,u=(m*e.viewB+f*e.viewD)/s,d=(p*e.viewA+g*e.viewC)/n,c=(p*e.viewB+g*e.viewD)/s,a=v*e.viewA+b*e.viewC+e.viewX,r=v*e.viewB+b*e.viewD+e.viewY}else l=(this.matA*e.viewA+this.matB*e.viewC)/n,u=(this.matA*e.viewB+this.matB*e.viewD)/s,d=(this.matC*e.viewA+this.matD*e.viewC)/n,c=(this.matC*e.viewB+this.matD*e.viewD)/s,a=this.absX*e.viewA+this.absY*e.viewC+e.viewX,r=this.absX*e.viewB+this.absY*e.viewD+e.viewY;h=1/(l*c-u*d),t.xMin=((-1-a)*c+(r+1)*d)*h,t.yMin=((a+1)*u+(-1-r)*l)*h,t.xMax=((1-a)*c+(r-1)*d)*h,t.yMax=((a-1)*u+(1-r)*l)*h},drawContent:function(e){if(e.front2back){for(var t,n,s,i,o=0,a=this._cameras;o<a.length;){if(t=a[o],++o,!t.visible)continue;for(s=this.children.length,n=this.layerCount,t.enter(e);n-- >0;)if(i=n==0?0:this.layersIndexes[n-1],t.layerVisible(n))for(;s>=i;)this.children[s--].drawRec(e);else s=i-1;t.exit(e)}this.draw(e)}else for(this.draw(e),o=0,a=this._cameras;o<a.length;){if(t=a[o],++o,!t.visible)continue;for(s=0,n=0,t.enter(e);n<this.layerCount;)if(i=this.layersIndexes[n++],t.layerVisible(n-1))for(;s<i;)this.children[s++].drawRec(e);else s=i;t.exit(e)}},onAdd:function(){this.checkResize(),xs.prototype.onAdd.call(this),this.window.addResizeEvent(b(this,this.checkResize))},onRemove:function(){xs.prototype.onRemove.call(this),this.window.removeResizeEvent(b(this,this.checkResize))},captureBitmap:function(e){var n,s,o,i,a,r,c,t=K.CURRENT;return e==null&&(n=new S(this.width,this.height,[w.Target]),e=new Ue(n,0,0,this.width,this.height)),n=e.innerTex,t.begin(),t.pushTarget(n),t.setRenderZone(e.x|0,e.y|0,Math.ceil(e.width),Math.ceil(e.height)),s=this.width,o=this.height,i=this.viewportA,a=this.viewportD,r=this.viewportX,c=this.viewportY,this.width=n.width,this.height=n.height,this.viewportA=2/this.width,this.viewportD=2/this.height,this.viewportX=-1,this.viewportY=-1,this.posChanged=!0,this.render(t),t.popTarget(),this.width=s,this.height=o,this.viewportA=i,this.viewportD=a,this.viewportX=r,this.viewportY=c,this.posChanged=!0,t.setRenderZone(),t.end(),new Oa(e)},__class__:ps}),Ue=function(e,t,n,s,o,i,a){a==null&&(a=0),i==null&&(i=0),this.innerTex=e,this.x=t,this.y=n,this.width=s,this.height=o,this.dx=i,this.dy=a,e!=null&&this.setTexture(e)},c["h2d.Tile"]=Ue,Ue.__name__="h2d.Tile",Ue.fromColor=function(e,t,n,s){s==null&&(s=1),n==null&&(n=1),t==null&&(t=1);var o=new Ue(S.fromColor(e,s),0,0,1,1);return o.width=t,o.height=n,o},Ue.fromBitmap=function(e){var t=S.fromBitmap(e);return new Ue(t,0,0,e.ctx.canvas.width,e.ctx.canvas.height)},Ue.autoCut=function(e,t,n){e.lock(),n==null&&(n=t);for(var s,o,i,r,c,d,u,h,m,f,g=e.getPixel(e.ctx.canvas.width-1,e.ctx.canvas.height-1),p=[],l=1,a=1;l<e.ctx.canvas.width;)l<<=1;for(;a<e.ctx.canvas.height;)a<<=1;for(r=new S(l,a),c=0,m=e.ctx.canvas.height/n|0;c<m;)for(o=c++,d=[],p[o]=d,i=0,f=e.ctx.canvas.width/t|0;i<f;){if(u=i++,s=Ue.isEmpty(e,u*t,o*n,t,n,g),s==null)break;d.push(new Ue(r,u*t+s.dx,o*n+s.dy,s.w,s.h,s.dx,s.dy))}return e.unlock(),h=new Ue(r,0,0,e.ctx.canvas.width,e.ctx.canvas.height),h.upload(e),{main:h,tiles:p}},Ue.fromTexture=function(e){return new Ue(e,0,0,e.width,e.height)},Ue.fromPixels=function(e){var t=e.makeSquare(!0),n=S.fromPixels(t,S.nativeFormat);return t!=e&&t.dispose(),new Ue(n,0,0,e.width,e.height)},Ue.isEmpty=function(e,t,n,s,o,i){for(var a,r,c,m,g,f=!0,l=s,d=o,u=0,h=0,p=0,v=s;p<v;)for(a=p++,m=0,g=o;m<g;){if(r=m++,c=e.getPixel(a+t,r+n),(c&-16777216)==0){c!=0&&e.setPixel(a+t,r+n,0);continue}c!=i&&(f=!1,a<l&&(l=a),r<d&&(d=r),a>u&&(u=a),r>h&&(h=r)),c==i&&c!=0&&e.setPixel(a+t,r+n,0)}return f?null:{dx:l,dy:d,w:u-l+1,h:h-d+1}},Ue.prototype={get_ix:function(){return Math.floor(this.x)},get_iy:function(){return Math.floor(this.y)},get_iwidth:function(){return Math.ceil(this.width+this.x)-Math.floor(this.x)},get_iheight:function(){return Math.ceil(this.height+this.y)-Math.floor(this.y)},getTexture:function(){return this.innerTex},isDisposed:function(){if(this.innerTex!=null){var e=this.innerTex;return e.t==null&&(!!e.isDepth()||e.realloc==null)}else return!0},setTexture:function(e){this.innerTex=e,e!=null&&(this.u=this.x/e.width,this.v=this.y/e.height,this.u2=(this.x+this.width)/e.width,this.v2=(this.y+this.height)/e.height)},switchTexture:function(e){this.setTexture(e.innerTex)},sub:function(e,t,n,s,o,i){return i==null&&(i=0),o==null&&(o=0),new Ue(this.innerTex,this.x+e,this.y+t,n,s,o,i)},center:function(){return this.sub(0,0,this.width,this.height,-(this.width*.5),-(this.height*.5))},setCenterRatio:function(e,t){t==null&&(t=.5),e==null&&(e=.5),this.dx=-(e*this.width),this.dy=-(t*this.height)},flipX:function(){var e=this.u;this.u=this.u2,this.u2=e,this.dx=-this.dx-this.width},flipY:function(){var e=this.v;this.v=this.v2,this.v2=e,this.dy=-this.dy-this.height},setPosition:function(e,t){this.x=e,this.y=t;var n=this.innerTex;n!=null&&(this.u=e/n.width,this.v=t/n.height,this.u2=(e+this.width)/n.width,this.v2=(t+this.height)/n.height)},setSize:function(e,t){this.width=e,this.height=t;var n=this.innerTex;n!=null&&(this.u2=(this.x+e)/n.width,this.v2=(this.y+t)/n.height)},scaleToSize:function(e,t){this.width=e,this.height=t},scrollDiscrete:function(e,t){var n=this.innerTex;this.u+=e/n.width,this.v-=t/n.height,this.u2+=e/n.width,this.v2-=t/n.height,this.x=this.u*n.width,this.y=this.v*n.height},dispose:function(){this.innerTex!=null&&this.innerTex.dispose(),this.innerTex=null},clone:function(){var e=new Ue(null,this.x,this.y,this.width,this.height,this.dx,this.dy);return e.innerTex=this.innerTex,e.u=this.u,e.u2=this.u2,e.v=this.v,e.v2=this.v2,e},get_xFlip:function(){return this.u2<this.u},get_yFlip:function(){return this.v2<this.v},set_xFlip:function(e){return e!=this.get_xFlip()&&this.flipX(),e},set_yFlip:function(e){return e!=this.get_yFlip()&&this.flipY(),e},split:function(e,t,n){n==null&&(n=!1),t==null&&(t=!1),e==null&&(e=0);var s,o,i,a,r=[];if(t)for(e==0&&(e=this.height/this.width|0),s=n?this.height/e:this.height/e|0,o=0,i=e;o<i;)a=o++,r.push(this.sub(0,a*s,this.width,s));else for(e==0&&(e=this.width/this.height|0),s=n?this.width/e:this.width/e|0,o=0,i=e;o<i;)a=o++,r.push(this.sub(a*s,0,s,this.height));return r},gridFlatten:function(e,t,n){n==null&&(n=0),t==null&&(t=0);for(var s,a,r,c,o=[],i=0,l=this.height/e|0;i<l;)for(a=i++,s=0,r=this.width/e|0;s<r;)c=s++,o.push(this.sub(c*e,a*e,e,e,t,n));return o},grid:function(e,t,n){n==null&&(n=0),t==null&&(t=0);for(var s,o,r,c,l,i=[],a=0,d=this.width/e|0;a<d;){for(r=a++,s=[],o=0,c=this.height/e|0;o<c;)l=o++,s.push(this.sub(r*e,l*e,e,e,t,n));i.push(s)}return i},toString:function(){return"Tile("+this.x+","+this.y+","+this.width+"x"+this.height+(this.dx!=0||this.dy!=0?","+this.dx+":"+this.dy:"")+")"},upload:function(e){var t=this.innerTex.width,n=this.innerTex.height;this.innerTex.uploadBitmap(e)},__class__:Ue},$s=function(){},c["h2d.col.Collider"]=$s,$s.__name__="h2d.col.Collider",$s.prototype={__class__:$s},At=function(){this.xMin=1e20,this.yMin=1e20,this.xMax=-1e20,this.yMax=-1e20},c["h2d.col.Bounds"]=At,At.__name__="h2d.col.Bounds",At.fromValues=function(e,t,n,s){var o=new At;return o.xMin=e,o.yMin=t,o.xMax=e+n,o.yMax=t+s,o},At.fromPoints=function(e,t){var n=new At;return n.xMin=e.x,n.yMin=e.y,n.xMax=t.x,n.yMax=t.y,n},At.__super__=$s,At.prototype=g($s.prototype,{toIBounds:function(e){e==null&&(e=1);var n=Math.floor(this.xMin*e),s=Math.floor(this.yMin*e),o=Math.ceil(this.xMax*e)-n,i=Math.ceil(this.yMax*e)-s,t=new En;return t.xMin=n,t.yMin=s,t.xMax=n+o,t.yMax=s+i,t},intersects:function(e){return!(this.xMin>e.xMax||this.yMin>e.yMax||this.xMax<e.xMin||this.yMax<e.yMin)},collideBounds:function(e){return!(this.xMin>e.xMax||this.yMin>e.yMax||this.xMax<e.xMin||this.yMax<e.yMin)},collideCircle:function(e){if(e.x<this.xMin-e.ray)return!1;if(e.x>this.xMax+e.ray)return!1;if(e.y<this.yMin-e.ray)return!1;if(e.y>this.yMax+e.ray)return!1;if(e.x<this.xMin&&e.y<this.yMin){var t,n=e.x-this.xMin,s=e.y-this.yMin;t=n*n+s*s>e.ray*e.ray}else t=!1;return!t&&(e.x>this.xMax&&e.y<this.yMin?(n=e.x-this.xMax,s=e.y-this.yMin,t=n*n+s*s>e.ray*e.ray):t=!1,!t&&(e.x<this.xMin&&e.y>this.yMax?(n=e.x-this.xMin,s=e.y-this.yMax,t=n*n+s*s>e.ray*e.ray):t=!1,!t&&(e.x>this.xMax&&e.y>this.yMax?(n=e.x-this.xMax,s=e.y-this.yMax,t=n*n+s*s>e.ray*e.ray):t=!1,!t)))},contains:function(e){return e.x>=this.xMin&&e.x<this.xMax&&e.y>=this.yMin&&e.y<this.yMax},rayIntersection:function(e){var t=(this.xMin-e.px)/e.lx,n=(this.yMin-e.py)/e.ly,s=(this.xMax-e.px)/e.lx,o=(this.yMax-e.py)/e.ly,i=t>s?s:t,a=n>o?o:n,r=t<s?s:t,c=n<o?o:n,d=r>c?c:r,l=i<a?a:i;return d<l?-1:l},distanceSq:function(e){var t=e.x<this.xMin?this.xMin-e.x:e.x>this.xMax?e.x-this.xMax:0,n=e.y<this.yMin?this.yMin-e.y:e.y>this.yMax?e.y-this.yMax:0;return t*t+n*n},distance:function(e){var t=e.x<this.xMin?this.xMin-e.x:e.x>this.xMax?e.x-this.xMax:0,n=e.y<this.yMin?this.yMin-e.y:e.y>this.yMax?e.y-this.yMax:0;return Math.sqrt(t*t+n*n)},addBounds:function(e){e.xMin<this.xMin&&(this.xMin=e.xMin),e.xMax>this.xMax&&(this.xMax=e.xMax),e.yMin<this.yMin&&(this.yMin=e.yMin),e.yMax>this.yMax&&(this.yMax=e.yMax)},addPoint:function(e){e.x<this.xMin&&(this.xMin=e.x),e.x>this.xMax&&(this.xMax=e.x),e.y<this.yMin&&(this.yMin=e.y),e.y>this.yMax&&(this.yMax=e.y)},addPos:function(e,t){e<this.xMin&&(this.xMin=e),e>this.xMax&&(this.xMax=e),t<this.yMin&&(this.yMin=t),t>this.yMax&&(this.yMax=t)},set:function(e,t,n,s){this.xMin=e,this.yMin=t,this.xMax=e+n,this.yMax=t+s},setMin:function(e){this.xMin=e.x,this.yMin=e.y},setMax:function(e){this.xMax=e.x,this.yMax=e.y},doIntersect:function(e){var t=this.xMin,n=e.xMin;this.xMin=t<n?n:t,t=this.yMin,n=e.yMin,this.yMin=t<n?n:t,t=this.xMax,n=e.xMax,this.xMax=t>n?n:t,t=this.yMax,n=e.yMax,this.yMax=t>n?n:t},doUnion:function(e){var t=this.xMin,n=e.xMin;this.xMin=t>n?n:t,t=this.yMin,n=e.yMin,this.yMin=t>n?n:t,t=this.xMax,n=e.xMax,this.xMax=t<n?n:t,t=this.yMax,n=e.yMax,this.yMax=t<n?n:t},intersection:function(e){var t=new At,n=this.xMin,s=e.xMin;return t.xMin=n<s?s:n,n=this.yMin,s=e.yMin,t.yMin=n<s?s:n,n=this.xMax,s=e.xMax,t.xMax=n>s?s:n,n=this.yMax,s=e.yMax,t.yMax=n>s?s:n,t.xMax<t.xMin&&(t.xMax=t.xMin),t.yMax<t.yMin&&(t.yMax=t.yMin),t},union:function(e){var s=new At,t=this.xMin,n=e.xMin;return s.xMin=t>n?n:t,t=this.yMin,n=e.yMin,s.yMin=t>n?n:t,t=this.xMax,n=e.xMax,s.xMax=t<n?n:t,t=this.yMax,n=e.yMax,s.yMax=t<n?n:t,s},load:function(e){this.xMin=e.xMin,this.yMin=e.yMin,this.xMax=e.xMax,this.yMax=e.yMax},scalePivot:function(e){this.xMin*=e,this.yMin*=e,this.xMax*=e,this.yMax*=e},scaleCenter:function(e){var t=(this.xMax-this.xMin)*.5*e,n=(this.yMax-this.yMin)*.5*e,s=(this.xMax+this.xMin)*.5,o=(this.yMax+this.yMin)*.5;this.xMin=s-t,this.yMin=o-n,this.xMax=s+t,this.yMax=o+n},rotate:function(e){var t,n,s=Math.cos(e),o=Math.sin(e),i=this.xMin,a=this.yMin,r=this.xMax,c=this.yMax;this.xMin=1e20,this.yMin=1e20,this.xMax=-1e20,this.yMax=-1e20,t=i*s-a*o,n=i*o+a*s,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),n<this.yMin&&(this.yMin=n),n>this.yMax&&(this.yMax=n),t=r*s-a*o,n=r*o+a*s,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),n<this.yMin&&(this.yMin=n),n>this.yMax&&(this.yMax=n),t=i*s-c*o,n=i*o+c*s,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),n<this.yMin&&(this.yMin=n),n>this.yMax&&(this.yMax=n),t=r*s-c*o,n=r*o+c*s,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),n<this.yMin&&(this.yMin=n),n>this.yMax&&(this.yMax=n)},offset:function(e,t){this.xMin+=e,this.xMax+=e,this.yMin+=t,this.yMax+=t},getMin:function(){var e=this.xMin,t=this.yMin;return t==null&&(t=0),e==null&&(e=0),new U(e,t)},getCenter:function(){var e=(this.xMin+this.xMax)*.5,t=(this.yMin+this.yMax)*.5;return t==null&&(t=0),e==null&&(e=0),new U(e,t)},getSize:function(){var e=this.xMax-this.xMin,t=this.yMax-this.yMin;return t==null&&(t=0),e==null&&(e=0),new U(e,t)},getMax:function(){var e=this.xMax,t=this.yMax;return t==null&&(t=0),e==null&&(e=0),new U(e,t)},isEmpty:function(){return this.xMax<=this.xMin||this.yMax<=this.yMin},empty:function(){this.xMin=1e20,this.yMin=1e20,this.xMax=-1e20,this.yMax=-1e20},all:function(){this.xMin=-1e20,this.yMin=-1e20,this.xMax=1e20,this.yMax=1e20},clone:function(){var e=new At;return e.xMin=this.xMin,e.yMin=this.yMin,e.xMax=this.xMax,e.yMax=this.yMax,e},get_x:function(){return this.xMin},get_y:function(){return this.yMin},set_x:function(e){return this.xMax+=e-this.xMin,this.xMin=e},set_y:function(e){return this.yMax+=e-this.yMin,this.yMin=e},get_width:function(){return this.xMax-this.xMin},get_height:function(){return this.yMax-this.yMin},set_width:function(e){return this.xMax=this.xMin+e,e},set_height:function(e){return this.yMax=this.yMin+e,e},toString:function(){var n,e=this.xMin,t=this.yMin;return t==null&&(t=0),e==null&&(e=0),n="{"+o.string(new U(e,t))+",",e=this.xMax-this.xMin,t=this.yMax-this.yMin,t==null&&(t=0),e==null&&(e=0),n+o.string(new U(e,t))+"}"},toCircle:function(){var e=this.xMax-this.xMin,t=this.yMax-this.yMin;return new Ta((this.xMin+this.xMax)*.5,(this.yMin+this.yMax)*.5,Math.sqrt(e*e+t*t)*.5)},__class__:At}),Ta=function(e,t,n){this.x=e,this.y=t,this.ray=n},c["h2d.col.Circle"]=Ta,Ta.__name__="h2d.col.Circle",Ta.__super__=$s,Ta.prototype=g($s.prototype,{distanceSq:function(e){var t=e.x-this.x,n=e.y-this.y,s=t*t+n*n-this.ray*this.ray;return s<0?0:s},side:function(e){var t=e.x-this.x,n=e.y-this.y;return this.ray*this.ray-(t*t+n*n)},collideCircle:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n<(this.ray+e.ray)*(this.ray+e.ray)},collideBounds:function(e){if(this.x<e.xMin-this.ray)return!1;if(this.x>e.xMax+this.ray)return!1;if(this.y<e.yMin-this.ray)return!1;if(this.y>e.yMax+this.ray)return!1;if(this.x<e.xMin&&this.y<e.yMin){var t,n=this.x-e.xMin,s=this.y-e.yMin;t=n*n+s*s>this.ray*this.ray}else t=!1;return!t&&(this.x>e.xMax&&this.y<e.yMin?(n=this.x-e.xMax,s=this.y-e.yMin,t=n*n+s*s>this.ray*this.ray):t=!1,!t&&(this.x<e.xMin&&this.y>e.yMax?(n=this.x-e.xMin,s=this.y-e.yMax,t=n*n+s*s>this.ray*this.ray):t=!1,!t&&(this.x>e.xMax&&this.y>e.yMax?(n=this.x-e.xMax,s=this.y-e.yMax,t=n*n+s*s>this.ray*this.ray):t=!1,!t)))},lineIntersect:function(e,t){var n,s,o,r,l,d,u,h,m,f,p,i=t.x-e.x,a=t.y-e.y,c=i*i+a*a;return c<1e-8?null:(o=2*(i*(e.x-this.x)+a*(e.y-this.y)),l=e.x-this.x,d=e.y-this.y,f=l*l+d*d-this.ray*this.ray,r=o*o-4*c*f,r<0?null:r==0?(u=-o/(2*c),n=e.x+u*i,s=e.y+u*a,s==null&&(s=0),n==null&&(n=0),[new U(n,s)]):(h=(-o-Math.sqrt(r))/(2*c),m=(-o+Math.sqrt(r))/(2*c),n=e.x+h*i,s=e.y+h*a,s==null&&(s=0),n==null&&(n=0),p=new U(n,s),n=e.x+m*i,s=e.y+m*a,s==null&&(s=0),n==null&&(n=0),[p,new U(n,s)]))},toString:function(){return"{"+x.fmt(this.x)+","+x.fmt(this.y)+","+x.fmt(this.ray)+"}"},contains:function(e){var t=e.x-this.x,n=e.y-this.y,s=t*t+n*n-this.ray*this.ray;return(s<0?0:s)==0},__class__:Ta}),En=function(){this.xMin=2147483647,this.yMin=2147483647,this.xMax=-2147483648,this.yMax=-2147483648},c["h2d.col.IBounds"]=En,En.__name__="h2d.col.IBounds",En.fromValues=function(e,t,n,s){var o=new En;return o.xMin=e,o.yMin=t,o.xMax=e+n,o.yMax=t+s,o},En.fromPoints=function(e,t){var n=new En;return n.xMin=e.x,n.yMin=e.y,n.xMax=t.x,n.yMax=t.y,n},En.prototype={toBounds:function(e){e==null&&(e=1);var n=this.xMin*e,s=this.yMin*e,o=(this.xMax-this.xMin)*e,i=(this.yMax-this.yMin)*e,t=new At;return t.xMin=n,t.yMin=s,t.xMax=n+o,t.yMax=s+i,t},intersects:function(e){return!(this.xMin>e.xMax||this.yMin>e.yMax||this.xMax<e.xMin||this.yMax<e.yMin)},contains:function(e){return e.x>=this.xMin&&e.x<this.xMax&&e.y>=this.yMin&&e.y<this.yMax},addBounds:function(e){e.xMin<this.xMin&&(this.xMin=e.xMin),e.xMax>this.xMax&&(this.xMax=e.xMax),e.yMin<this.yMin&&(this.yMin=e.yMin),e.yMax>this.yMax&&(this.yMax=e.yMax)},addPoint:function(e){e.x<this.xMin&&(this.xMin=e.x),e.x>this.xMax&&(this.xMax=e.x),e.y<this.yMin&&(this.yMin=e.y),e.y>this.yMax&&(this.yMax=e.y)},addPos:function(e,t){e<this.xMin&&(this.xMin=e),e>this.xMax&&(this.xMax=e),t<this.yMin&&(this.yMin=t),t>this.yMax&&(this.yMax=t)},set:function(e,t,n,s){this.xMin=e,this.yMin=t,this.xMax=e+n,this.yMax=t+s},setMin:function(e){this.xMin=e.x,this.yMin=e.y},setMax:function(e){this.xMax=e.x,this.yMax=e.y},doIntersect:function(e){var t=this.xMin,n=e.xMin;this.xMin=t<n?n:t,t=this.yMin,n=e.yMin,this.yMin=t<n?n:t,t=this.xMax,n=e.xMax,this.xMax=t>n?n:t,t=this.yMax,n=e.yMax,this.yMax=t>n?n:t},doUnion:function(e){var t=this.xMin,n=e.xMin;this.xMin=t>n?n:t,t=this.yMin,n=e.yMin,this.yMin=t>n?n:t,t=this.xMax,n=e.xMax,this.xMax=t<n?n:t,t=this.yMax,n=e.yMax,this.yMax=t<n?n:t},intersection:function(e){var t=new En,n=this.xMin,s=e.xMin;return t.xMin=n<s?s:n,n=this.yMin,s=e.yMin,t.yMin=n<s?s:n,n=this.xMax,s=e.xMax,t.xMax=n>s?s:n,n=this.yMax,s=e.yMax,t.yMax=n>s?s:n,t.xMax<t.xMin&&(t.xMax=t.xMin),t.yMax<t.yMin&&(t.yMax=t.yMin),t},union:function(e){var s=new En,t=this.xMin,n=e.xMin;return s.xMin=t>n?n:t,t=this.yMin,n=e.yMin,s.yMin=t>n?n:t,t=this.xMax,n=e.xMax,s.xMax=t<n?n:t,t=this.yMax,n=e.yMax,s.yMax=t<n?n:t,s},load:function(e){this.xMin=e.xMin,this.yMin=e.yMin,this.xMax=e.xMax,this.yMax=e.yMax},offset:function(e,t){this.xMin+=e,this.xMax+=e,this.yMin+=t,this.yMax+=t},getMin:function(){return new E(this.xMin,this.yMin)},getCenter:function(){return new E(this.xMin+this.xMax>>1,this.yMin+this.yMax>>1)},getSize:function(){return new E(this.xMax-this.xMin,this.yMax-this.yMin)},getMax:function(){return new E(this.xMax,this.yMax)},isEmpty:function(){return!(this.xMax>this.xMin)||this.yMax<=this.yMin},empty:function(){this.xMin=2147483647,this.yMin=2147483647,this.xMax=-2147483648,this.yMax=-2147483648},all:function(){this.xMin=-2147483648,this.yMin=-2147483648,this.xMax=2147483647,this.yMax=2147483647},clone:function(){var e=new En;return e.xMin=this.xMin,e.yMin=this.yMin,e.xMax=this.xMax,e.yMax=this.yMax,e},get_x:function(){return this.xMin},get_y:function(){return this.yMin},set_x:function(e){return this.xMax+=e-this.xMin,this.xMin=e},set_y:function(e){return this.yMax+=e-this.yMin,this.yMin=e},get_width:function(){return this.xMax-this.xMin},get_height:function(){return this.yMax-this.yMin},set_width:function(e){return this.xMax=this.xMin+e,e},set_height:function(e){return this.yMax=this.yMin+e,e},toString:function(){return"{"+o.string(new E(this.xMin,this.yMin))+","+o.string(new E(this.xMax-this.xMin,this.yMax-this.yMin))+"}"},__class__:En},E=function(e,t){t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t},c["h2d.col.IPoint"]=E,E.__name__="h2d.col.IPoint",E.prototype={load:function(e){this.x=e.x,this.y=e.y},scale:function(e){this.x*=e,this.y*=e},scaled:function(e){return new E(this.x*e,this.y*e)},distanceSq:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},distance:function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},toString:function(){return"{"+this.x+","+this.y+"}"},sub:function(e){return new E(this.x-e.x,this.y-e.y)},add:function(e){return new E(this.x+e.x,this.y+e.y)},equals:function(e){return this.x==e.x&&this.y==e.y},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set:function(e,t){t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t},clone:function(){return new E(this.x,this.y)},cross:function(e){return this.x*e.y-this.y*e.x},toPoint:function(e){e==null&&(e=1);var t=this.x*e,n=this.y*e;return n==null&&(n=0),t==null&&(t=0),new U(t,n)},__class__:E},Ti=_["h2d.col.OffsetKind"]={__ename__:!0,__constructs__:null,Square:{_hx_name:"Square",_hx_index:0,__enum__:"h2d.col.OffsetKind",toString:s},Miter:{_hx_name:"Miter",_hx_index:1,__enum__:"h2d.col.OffsetKind",toString:s},Round:(a=function(e){return{_hx_index:2,arc:e,__enum__:"h2d.col.OffsetKind",toString:s}},a._hx_name="Round",a.__params__=["arc"],a)},Ti.__constructs__=[Ti.Square,Ti.Miter,Ti.Round],Ti.__empty_constructs__=[Ti.Square,Ti.Miter],Ee={},Ee.get_length=function(e){return e.length},Ee.get_points=function(e){return e},Ee._new=function(e){return e??[]},Ee.iterator=function(e){return new Kr(e)},Ee.toPolygon=function(e,t){t==null&&(t=1);for(var n,s,o,a,r=[],i=0,c=e;i<c.length;)a=c[i],++i,n=t,n==null&&(n=1),s=a.x*n,o=a.y*n,o==null&&(o=0),s==null&&(s=0),r.push(new U(s,o));return r},Ee.getBounds=function(e,t){t==null&&(t=new En);for(var n,s=0,o=e;s<o.length;)n=o[s],++s,n.x<t.xMin&&(t.xMin=n.x),n.x>t.xMax&&(t.xMax=n.x),n.y<t.yMin&&(t.yMin=n.y),n.y>t.yMax&&(t.yMax=n.y);return t},Ee.union=function(e,t,n){n==null&&(n=!0);var s=new Ve;return n||(s.resultKind=Ot.NoHoles),s.addPolygon(e,we.Clip),s.addPolygon(t,we.Clip),s.execute(Ze.Union,ee.NonZero,ee.NonZero)},Ee.intersection=function(e,t,n){return n==null&&(n=!0),Ee.clipperOp(e,t,Ze.Intersection,n)},Ee.subtraction=function(e,t,n){return n==null&&(n=!0),Ee.clipperOp(e,t,Ze.Difference,n)},Ee.offset=function(e,t,n,s){s==null&&(s=!0);var i,o=new ar;switch(n._hx_index){case 0:o.addPolygon(e,dn.Square,ye.ClosedPol);break;case 1:o.addPolygon(e,dn.Miter,ye.ClosedPol);break;case 2:i=n.arc,o.ArcTolerance=i,o.addPolygon(e,dn.Round,ye.ClosedPol);break}return s||(o.resultKind=Ot.NoHoles),o.execute(t)},Ee.clipperOp=function(e,t,n,s){var o=new Ve;return s||(o.resultKind=Ot.NoHoles),o.addPolygon(e,we.Subject),o.addPolygon(t,we.Clip),o.execute(n,ee.NonZero,ee.NonZero)},Ee.convexHull=function(e){var n,s,o,i,a,r,c,l,d,u,m,f,h=e.length;if(h<3)throw t.thrown("convexHull() needs at least 3 points");for(a=0,l=e[a].x,n=1,c=e.length;n<c;)o=n++,d=e[o].x,d<l&&(a=o,l=d);u=[],s=a,i=0;do{for(u.push(e[s]),i=(s+1)%h,n=0,c=h;n<c;)o=n++,r=e[o],m=e[s],f=e[i],(m.x-r.x)*(f.y-r.y)-(m.y-r.y)*(f.x-r.x)<0&&(i=o);s=i}while(s!=a)return u},Ee.isClockwise=function(e){for(var t,o=0,n=e[e.length-1],s=0,i=e;s<i.length;)t=i[s],++s,o+=(t.x-n.x)*(t.y+n.y),n=t;return o<0},Ee.area=function(e){for(var n,t=0,s=e[e.length-1],o=0,i=e;o<i.length;)n=i[o],++o,t+=s.x*n.y-n.x*s.y,s=n;return(t<0?-t:t)*.5},Ee.side=function(e,t,n,s){return(n.x-t.x)*(s.y-t.y)-(n.y-t.y)*(s.x-t.x)},Ee.isConvex=function(e){for(var i,t=e[e.length-2],n=e[e.length-1],s=e[0],a=(n.x-t.x)*(s.y-t.y)-(n.y-t.y)*(s.x-t.x)>0,o=1,r=e.length;o<r;)if(i=o++,t=n,n=s,s=e[i],(n.x-t.x)*(s.y-t.y)-(n.y-t.y)*(s.x-t.x)>0!=a)return!1;return!0},Ee.reverse=function(e){e.reverse()},Ee.contains=function(e,t,n){if(n==null&&(n=!1),n){for(var s,r,o=e[e.length-1],i=0,a=e;i<a.length;){if(s=a[i],++i,(s.x-o.x)*(t.y-o.y)-(s.y-o.y)*(t.x-o.x)<0)return!1;o=s}return!0}for(r=0,o=e[e.length-1],i=0,a=e;i<a.length;)s=a[i],++i,s.y<=t.y?o.y>t.y&&(o.x-s.x)*(t.y-s.y)-(o.y-s.y)*(t.x-s.x)>0&&++r:o.y<=t.y&&(o.x-s.x)*(t.y-s.y)-(o.y-s.y)*(t.x-s.x)<0&&--r,o=s;return r!=0},Ee.optimize=function(e,t){var n=[];return Ee.optimizeRec(e,0,e.length,n,t),n},Ee.optimizeRec=function(e,t,n,s,o){for(var a,r,c,l,d,u,m,f,p,g,b,j,y,_,v=0,i=e[t],h=e[n-1],w=t+1,O=n-1;w<O;)p=w++,c=e[p],_=c.x-i.x,j=c.y-i.y,r=h.x-i.x,l=h.y-i.y,y=_*r+j*l,b=r*r+l*l,a=-1,b!=0&&(a=y/b),a<0?(d=i.x,u=i.y):a>1?(d=h.x,u=h.y):(d=i.x+a*r,u=i.y+a*l),g=c.x-d,f=c.y-u,m=g*g+f*f,m>v&&(t=p,v=m);v>=o?(Ee.optimizeRec(e,0,t,s,o),s.pop(),Ee.optimizeRec(e,t,n,s,o)):(s.push(e[t]),s.push(e[n-1]))},un={},un.get_length=function(e){return e.length},un.get_polygons=function(e){return e},un._new=function(e){return e??[]},un.iterator=function(e){return new Ur(e)},un.toPolygons=function(e,t){t==null&&(t=1);for(var i,s=[],n=0,o=e;n<o.length;)i=o[n],++n,s.push(Ee.toPolygon(i,t));return s},un.getBounds=function(e,t){t==null&&(t=new En);for(var o,n=0,s=e;n<s.length;)o=s[n],++n,Ee.getBounds(o,t);return t},un.union=function(e,t,n){n==null&&(n=!0);var s=new Ve;return n||(s.resultKind=Ot.NoHoles),s.addPolygons(e,we.Clip),t!=null&&s.addPolygons(t,we.Clip),s.execute(Ze.Union,ee.NonZero,ee.NonZero)},un.intersection=function(e,t,n){return n==null&&(n=!0),un.clipperOp(e,t,Ze.Intersection,n)},un.subtraction=function(e,t,n){return n==null&&(n=!0),un.clipperOp(e,t,Ze.Difference,n)},un.offset=function(e,t,n,s){if(s==null&&(s=!0),e.length==0){var o,a,i=null;return i??[]}switch(o=new ar,n._hx_index){case 0:o.addPolygons(e,dn.Square,ye.ClosedPol);break;case 1:o.addPolygons(e,dn.Miter,ye.ClosedPol);break;case 2:a=n.arc,o.ArcTolerance=a,o.addPolygons(e,dn.Round,ye.ClosedPol);break}return s||(o.resultKind=Ot.NoHoles),o.execute(t)},un.clipperOp=function(e,t,n,s){var o=new Ve;return s||(o.resultKind=Ot.NoHoles),o.addPolygons(e,we.Subject),o.addPolygons(t,we.Clip),o.execute(n,ee.NonZero,ee.NonZero)},un.contains=function(e,t,n){n==null&&(n=!1);for(var i,s=0,o=e;s<o.length;)if(i=o[s],++s,Ee.contains(i,t,n))return!0;return!1},un.optimize=function(e,t){for(var i,s=[],n=0,o=e;n<o.length;)i=o[n],++n,s.push(Ee.optimize(i,t));return s},Cs=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.x=0,this.y=0},c["h2d.col.Matrix"]=Cs,Cs.__name__="h2d.col.Matrix",Cs.prototype={identity:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.x=0,this.y=0},initTranslate:function(e,t){this.a=1,this.b=0,this.c=0,this.d=1,this.x=e,this.y=t},initScale:function(e,t){this.a=e,this.b=0,this.c=0,this.d=t,this.x=0,this.y=0},initRotate:function(e){var t=Math.cos(e),n=Math.sin(e);this.a=t,this.b=n,this.c=-n,this.d=t,this.x=0,this.y=0},initSkew:function(e,t){var n=Math.tan(e),s=Math.tan(t);this.a=1,this.b=s,this.c=n,this.d=1,this.x=0,this.y=0},invert:function(){this.inverse(this)},getDeterminant:function(){return this.a*this.d-this.b*this.c},inverse:function(e){var n=e.a,s=e.b,o=e.c,i=e.d,a=e.x,r=e.y,t=1/(e.a*e.d-e.b*e.c);this.a=i*t,this.b=-s*t,this.c=-o*t,this.d=n*t,this.x=(-a*i+o*r)*t,this.y=(a*s-n*r)*t},transform:function(e){var t=e.x*this.a+e.y*this.c+this.x,n=e.x*this.b+e.y*this.d+this.y;return n==null&&(n=0),t==null&&(t=0),new U(t,n)},translate:function(e,t){this.x+=e,this.y+=t},translateX:function(e){this.x+=e},translateY:function(e){this.y+=e},prependTranslate:function(e,t){this.x+=this.a*e+this.c*t,this.y+=this.b*e+this.d*t},prependTranslateX:function(e){this.x+=this.a*e},prependTranslateY:function(e){this.y+=this.d*e},multiply:function(e,t){var a=e.a,r=e.b,c=e.c,l=e.d,d=e.x,u=e.y,n=t.a,s=t.b,o=t.c,i=t.d,h=t.x,m=t.y;this.a=a*n+r*o,this.b=a*s+r*i,this.c=c*n+l*o,this.d=c*s+l*i,this.x=d*n+u*o+h,this.y=d*s+u*i+m},getScale:function(e){return e==null&&(e=new U(0,0)),e.x=Math.sqrt(this.a*this.a+this.b*this.b),e.y=Math.sqrt(this.c*this.c+this.d*this.d),this.a*this.d-this.b*this.c<0&&(e.x*=-1,e.y*=-1),e},scale:function(e,t){this.a*=e,this.c*=e,this.x*=e,this.b*=t,this.d*=t,this.y*=t},scaleX:function(e){this.a*=e,this.c*=e,this.x*=e},scaleY:function(e){this.b*=e,this.d*=e,this.y*=e},rotate:function(e){var t=Cs.tmp,n=Math.cos(e),s=Math.sin(e);t.a=n,t.b=s,t.c=-s,t.d=n,t.x=0,t.y=0,this.multiply(this,Cs.tmp)},skew:function(e,t){var o=this.a,i=this.b,a=this.c,r=this.d,c=this.x,l=this.y,n=Math.tan(t),s=Math.tan(e);this.a=o+i*s,this.b=o*n+i,this.c=a+r*s,this.d=a*n+r,this.x=c+l*s,this.y=c*n+l},skewX:function(e){var t=Math.tan(e);this.a+=this.b*t,this.c+=this.d*t,this.x+=this.y*t},skewY:function(e){var t=Math.tan(e);this.b=this.a*t+this.b,this.d=this.c*t+this.d,this.y=this.x*t+this.y},clone:function(){var e=new Cs;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.x=this.x,e.y=this.y,e},getPosition:function(e){e==null&&(e=new U(0,0));var s=e,t=this.x,n=this.y;return n==null&&(n=0),t==null&&(t=0),s.x=t,s.y=n,e},toString:function(){return`MAT=[
  [ `+x.fmt(this.a)+", "+x.fmt(this.b)+` ]
  [ `+x.fmt(this.c)+", "+x.fmt(this.d)+` ]
  [ `+x.fmt(this.x)+", "+x.fmt(this.y)+` ]
]`},__class__:Cs},wi={},wi._new=function(e,t){return t==null&&(t=0),e==null&&(e=0),new U(e,t)},wi.sub=function(e,t){var n=e.x-t.x,s=e.y-t.y;return s==null&&(s=0),n==null&&(n=0),new U(n,s)},wi.add=function(e,t){var n=e.x+t.x,s=e.y+t.y;return s==null&&(s=0),n==null&&(n=0),new U(n,s)},wi.transform=function(e,t){var n=t.a*e.x+t.c*e.y+t.x,s=t.b*e.x+t.d*e.y+t.y;e.x=n,e.y=s},wi.transformed=function(e,t){var o=t.a*e.x+t.c*e.y+t.x,i=t.b*e.x+t.d*e.y+t.y,n=o,s=i;return s==null&&(s=0),n==null&&(n=0),new U(n,s)},wi.scale=function(e,t){e.x*=t,e.y*=t},wi.scaled=function(e,t){var n=e.x*t,s=e.y*t;return s==null&&(s=0),n==null&&(n=0),new U(n,s)},wi.scaledInv=function(e,t){var n=t.x*e,s=t.y*e;return s==null&&(s=0),n==null&&(n=0),new U(n,s)},re={},re.get_length=function(e){return e.length},re.get_points=function(e){return e},re._new=function(e){return e??[]},re.iterator=function(e){return new Wr(e)},re.fastTriangulate=function(e){return(new sc).triangulate_anon_y_Float_x_Float(e)},re.toSegments=function(e){for(var n,a,s=[],o=e[e.length-1],t=0,i=e;t<i.length;)n=i[t],++t,a=new oc(o,n),s.push(a),o=n;return s},re.toIPolygon=function(e,t){t==null&&(t=1);for(var n,o,r,i=[],s=0,a=e;s<a.length;)r=a[s],++s,o=r,n=t,n==null&&(n=1),i.push(new E(Math.round(o.x*n),Math.round(o.y*n)));return i},re.getBounds=function(e,t){t==null&&(t=new At);for(var n,s=0,o=e;s<o.length;)n=o[s],++s,n.x<t.xMin&&(t.xMin=n.x),n.x>t.xMax&&(t.xMax=n.x),n.y<t.yMin&&(t.yMin=n.y),n.y>t.yMax&&(t.yMax=n.y);return t},re.getCollider=function(e,t){return t==null&&(t=!1),new Si([e],t)},re.xSort=function(e,t,n){return t.x==n.x?t.y<n.y?-1:1:t.x<n.x?-1:1},re.convexHull=function(e){var t,n,s,o,i,a,r,c,l,d=e.length;if(e.length<3)return e;for(e.sort(function(e,t){return e.x==t.x?e.y<t.y?-1:1:e.x<t.x?-1:1}),n=[],t=0,r=0,l=e;r<l.length;){for(o=l[r],++r;!0;){if(t>=2?(s=n[t-2],a=n[t-1],i=(a.x-s.x)*(o.y-s.y)-(a.y-s.y)*(o.x-s.x)<=0):i=!1,!i)break;--t}n[t++]=o}for(c=e.length-2,d=t+1;c>=0;){for(o=e[c];!0;){if(t>=d?(s=n[t-2],a=n[t-1],i=(a.x-s.x)*(o.y-s.y)-(a.y-s.y)*(o.x-s.x)<=0):i=!1,!i)break;--t}n[t++]=o,--c}for(;n.length>=t;)n.pop();return n},re.isClockwise=function(e){for(var t,o=0,n=e[e.length-1],s=0,i=e;s<i.length;)t=i[s],++s,o+=(t.x-n.x)*(t.y+n.y),n=t;return o<0},re.area=function(e){for(var n,t=0,s=e[e.length-1],o=0,i=e;o<i.length;)n=i[o],++o,t+=n.x*s.y-s.x*n.y,s=n;return(t<0?-t:t)*.5},re.centroid=function(e){for(var t,o,i,a,s=0,r=0,c=0,n=e[e.length-1],l=0,d=e;l<d.length;)t=d[l],++l,o=n.x*t.y-t.x*n.y,r+=(n.x+t.x)*o,c+=(n.y+t.y)*o,s+=o,n=t;return s*=.5,r*=1/(6*s),c*=1/(6*s),i=r,a=c,a==null&&(a=0),i==null&&(i=0),new U(i,a)},re.side=function(e,t,n,s){return(n.x-t.x)*(s.y-t.y)-(n.y-t.y)*(s.x-t.x)},re.isConvex=function(e){if(e.length<4)return!0;for(var i,t=e[e.length-2],n=e[e.length-1],s=e[0],a=(n.x-t.x)*(s.y-t.y)-(n.y-t.y)*(s.x-t.x)>0,o=1,r=e.length;o<r;)if(i=o++,t=n,n=s,s=e[i],(n.x-t.x)*(s.y-t.y)-(n.y-t.y)*(s.x-t.x)>0!=a)return!1;return!0},re.reverse=function(e){e.reverse()},re.transform=function(e,t){for(var n,o,i,a,s=0,r=e.length;s<r;)o=s++,n=e[o],i=t.a*n.x+t.c*n.y+t.x,a=t.b*n.x+t.d*n.y+t.y,n.x=i,n.y=a},re.transformed=function(e,t){for(var e,s,o,i,r,c,n=e.slice(),a=0,l=n.length;a<l;)i=a++,e=n[i],r=t.a*e.x+t.c*e.y+t.x,c=t.b*e.x+t.d*e.y+t.y,s=r,o=c,o==null&&(o=0),s==null&&(s=0),n[i]=new U(s,o);return n??[]},re.contains=function(e,t,n){if(n==null&&(n=!1),n){for(var s,r,o=e[e.length-1],i=0,a=e;i<a.length;){if(s=a[i],++i,(s.x-o.x)*(t.y-o.y)-(s.y-o.y)*(t.x-o.x)<0)return!1;o=s}return!0}for(r=0,o=e[e.length-1],i=0,a=e;i<a.length;)s=a[i],++i,s.y<=t.y?o.y>t.y&&(o.x-s.x)*(t.y-s.y)-(o.y-s.y)*(t.x-s.x)>0&&++r:o.y<=t.y&&(o.x-s.x)*(t.y-s.y)-(o.y-s.y)*(t.x-s.x)<0&&--r,o=s;return r!=0},re.findClosestPoint=function(e,t,n){for(var o,i,a,r,c,l=null,d=n*n,s=0,u=e;s<u.length;)o=u[s],++s,i=o,a=i.x-t.x,r=i.y-t.y,c=a*a+r*r,c<d&&(l=o,d=c);return l},re.projectPoint=function(e,t,n){var i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,z,D,N,T=e[e.length-1],s=0,o=0;for(o==null&&(o=0),s==null&&(s=0),F=s,b=o,n==null&&(n=new U(0,0)),k=1e10,u=0,E=e;u<E.length;)v=E[u],++u,O=T,y=v,c=O.x,r=O.y,a=y.x-c,l=y.y-r,M=a*a+l*l,N=1/M,d=n,D=t.x-c,z=t.y-r,h=D*a+z*l,d==null&&(d=new U(0,0)),h<0?(i=d,s=c,o=r,o==null&&(o=0),s==null&&(s=0),i.x=s,i.y=o):h>M?(C=d,m=c+a,f=r+l,f==null&&(f=0),m==null&&(m=0),C.x=m,C.y=f):(A=h*N,S=d,p=c+A*a,g=r+A*l,g==null&&(g=0),p==null&&(p=0),S.x=p,S.y=g),x=n,w=x.x-t.x,_=x.y-t.y,j=w*w+_*_,j<k&&(F=n.x,b=n.y,k=j),T=v;return i=n,i.x=F,i.y=b,n},re.distance=function(e,t,n){return Math.sqrt(re.distanceSq(e,t,n))},re.distanceSq=function(e,t,n){for(var s,o,i,a,r,c,l,u,m,f,p,g,v,b,j,y,_,w,x=e[e.length-1],d=1e10,h=0,O=e;h<O.length;)p=O[h],++h,g=x,m=p,i=g.x,a=g.y,o=m.x-i,s=m.y-a,f=o*o+s*s,w=1/f,(n==null||o*(t.y-a)-s*(t.x-i)<0==n)&&(l=t.x-i,u=t.y-a,c=l*o+u*s,c<0?r=l*l+u*u:c>f?(v=t.x-(i+o),b=t.y-(a+s),r=v*v+b*b):(j=c*w,y=i+j*o-t.x,_=a+j*s-t.y,r=y*y+_*_),r<d&&(d=r)),x=p;return d==1e10?0:d},re.rayIntersection=function(e,t,n,s){s==null&&(s=!1);for(var i,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,O,x,E,k,a=-1,o=e[e.length-1],w=0,C=e;w<C.length;){if(i=C[w],++w,(t.lx*(o.y-t.py)-t.ly*(o.x-t.px))*(t.lx*(i.y-t.py)-t.ly*(i.x-t.px))>0){o=i;continue}if(j=(t.lx*(o.y-t.py)-t.ly*(o.x-t.px))/(t.ly*(i.x-o.x)-t.lx*(i.y-o.y)),x=o.x+j*(i.x-o.x),O=o.y+j*(i.y-o.y),h=x-t.px,m=O-t.py,m==null&&(m=0),h==null&&(h=0),f=h,p=m,p==null&&(p=0),f==null&&(f=0),g=f,v=p,!s?b=!0:(u=t.lx,d=t.ly,d==null&&(d=0),u==null&&(u=0),l=u,c=d,c==null&&(c=0),l==null&&(l=0),E=l,k=c,b=E*g+k*v>0),b&&(y=g,_=v,r=y*y+_*_,r<a||a<0)){if(!n)return Math.sqrt(r);a=r}o=i}return a<0?a:Math.sqrt(a)},re.orientation=function(e,t,n,s){var o=(n.x-t.x)*(s.y-t.y)-(n.y-t.y)*(s.x-t.x);return o==0?0:o>0?1:-1},re.onSegment=function(e,t,n,s){var o=t.x,i=n.x;return!(s.x>(o<i?i:o))&&(o=t.x,i=n.x,!(s.x<(o>i?i:o))&&(o=t.y,i=n.y,!(s.y>(o<i?i:o))&&(o=t.y,i=n.y,!(s.y<(o>i?i:o)))))},re.intersect=function(e,t,n,s,o){var i,a,c,l,d,u,r=(n.x-t.x)*(s.y-t.y)-(n.y-t.y)*(s.x-t.x),h=r==0?0:r>0?1:-1,r=(n.x-t.x)*(o.y-t.y)-(n.y-t.y)*(o.x-t.x),m=r==0?0:r>0?1:-1,r=(o.x-s.x)*(t.y-s.y)-(o.y-s.y)*(t.x-s.x),f=r==0?0:r>0?1:-1,r=(o.x-s.x)*(n.y-s.y)-(o.y-s.y)*(n.x-s.x),p=r==0?0:r>0?1:-1;return h!=m&&f!=p||(h==0?(i=t.x,a=n.x,s.x>(i<a?a:i)?u=!1:(i=t.x,a=n.x,s.x<(i>a?a:i)?u=!1:(i=t.y,a=n.y,s.y>(i<a?a:i)?u=!1:(i=t.y,a=n.y,u=!(s.y<(i>a?a:i)))))):u=!1,u?d=!0:m==0?(i=t.x,a=n.x,o.x>(i<a?a:i)?d=!1:(i=t.x,a=n.x,o.x<(i>a?a:i)?d=!1:(i=t.y,a=n.y,o.y>(i<a?a:i)?d=!1:(i=t.y,a=n.y,d=!(o.y<(i>a?a:i)))))):d=!1,d?l=!0:f==0?(i=s.x,a=o.x,t.x>(i<a?a:i)?l=!1:(i=s.x,a=o.x,t.x<(i>a?a:i)?l=!1:(i=s.y,a=o.y,t.y>(i<a?a:i)?l=!1:(i=s.y,a=o.y,l=!(t.y<(i>a?a:i)))))):l=!1,l?c=!0:p==0?(i=s.x,a=o.x,n.x>(i<a?a:i)?c=!1:(i=s.x,a=o.x,n.x<(i>a?a:i)?c=!1:(i=s.y,a=o.y,n.y>(i<a?a:i)?c=!1:(i=s.y,a=o.y,c=!(n.y<(i>a?a:i)))))):c=!1,!!c)},re.getIntersectionPoint=function(e,t,n,s,o){if(!re.intersect(e,t,n,s,o))return null;var i,a,f,p,r=n.y-t.y,c=t.x-n.x,h=r*t.x+c*t.y,l=o.y-s.y,d=s.x-o.x,m=l*s.x+d*s.y,u=r*d-l*c;return u==0?null:(f=(d*h-c*m)/u,p=(r*m-l*h)/u,i=f,a=p,a==null&&(a=0),i==null&&(i=0),new U(i,a))},re.selfIntersecting=function(e){if(e.length<4)return!1;for(var t,n,s,o,i,r,c,l,a=0,d=e.length-2;a<d;)for(t=a++,n=e[t],r=e[t+1],s=t+2,c=e.length;s<c;)if(o=s++,l=e[o],i=e[(o+1)%e.length],i!=n&&re.intersect(e,n,r,l,i))return!0;return!1},re.optimize=function(e,t){var n=[];return re.optimizeRec(e,0,e.length-1,n,t),n},re.optimizeRec=function(e,t,n,s,o){for(var a,r,c,l,d,u,f,p,g,v,j,y,_,O,m=0,i=e[t],h=e[n],b=0,w=t+1,x=n;w<x;)g=w++,r=e[g],O=r.x-i.x,y=r.y-i.y,l=h.x-i.x,c=h.y-i.y,_=O*l+y*c,j=l*l+c*c,a=-1,j!=0&&(a=_/j),a<0?(d=i.x,u=i.y):a>1?(d=h.x,u=h.y):(d=i.x+a*l,u=i.y+a*c),v=r.x-d,p=r.y-u,f=v*v+p*p,f>m&&(b=g,m=f);m>=o*o?(re.optimizeRec(e,t,b,s,o),s.pop(),re.optimizeRec(e,b,n,s,o)):(s.push(e[t]),s.push(e[n]))},re.makeCircle=function(e,t,n,s){if(s==null&&(s=0),s==0){var o,i,a,c,l,d,u,h,r=n*3.14*2/4;s=Math.ceil(r<0?-r:r)}for(s<3&&(s=3),d=6.2831853071795862/s,o=[],c=0,u=s;c<u;)h=c++,l=h*d,i=Math.cos(l)*n+e,a=Math.sin(l)*n+t,a==null&&(a=0),i==null&&(i=0),o.push(new U(i,a));return o??[]},Si=function(e,t){t==null&&(t=!1),this.polygons=e,this.isConvex=t},c["h2d.col.PolygonCollider"]=Si,Si.__name__="h2d.col.PolygonCollider",Si.__super__=$s,Si.prototype=g($s.prototype,{contains:function(e){return this.polygons!=null&&Ys.contains(this.polygons,e,this.isConvex)},collideCircle:function(){throw t.thrown("Not implemented")},collideBounds:function(){throw t.thrown("Not implemented")},__class__:Si}),Ys={},Ys.get_length=function(e){return e.length},Ys.get_polygons=function(e){return e},Ys._new=function(e){return e??[]},Ys.iterator=function(e){return new Br(e)},Ys.toIPolygons=function(e,t){t==null&&(t=1);for(var i,s=[],n=0,o=e;n<o.length;)i=o[n],++n,s.push(re.toIPolygon(i,t));return s},Ys.getBounds=function(e,t){t==null&&(t=new At);for(var o,n=0,s=e;n<s.length;)o=s[n],++n,re.getBounds(o,t);return t},Ys.getCollider=function(e,t){return t==null&&(t=!1),new Si(e,t)},Ys.contains=function(e,t,n){n==null&&(n=!1);for(var i,s=0,o=e;s<o.length;)if(i=o[s],++s,re.contains(i,t,n))return!0;return!1},Ys.optimize=function(e,t){for(var i,s=[],n=0,o=e;n<o.length;)i=o[n],++n,s.push(re.optimize(i,t));return s},xi=function(){},c["h2d.col.Ray"]=xi,xi.__name__="h2d.col.Ray",xi.fromPoints=function(e,t){var n=new xi;return n.px=e.x,n.py=e.y,n.lx=t.x-e.x,n.ly=t.y-e.y,n.normalize(),n},xi.fromValues=function(e,t,n,s){var o=new xi;return o.px=e,o.py=t,o.lx=n,o.ly=s,o.normalize(),o},xi.prototype={side:function(e){return this.lx*(e.y-this.py)-this.ly*(e.x-this.px)},getPoint:function(e){var t=this.px+e*this.lx,n=this.py+e*this.ly;return n==null&&(n=0),t==null&&(t=0),new U(t,n)},getPos:function(){var e=this.px,t=this.py;return t==null&&(t=0),e==null&&(e=0),new U(e,t)},getDir:function(){var e=this.lx,t=this.ly;return t==null&&(t=0),e==null&&(e=0),new U(e,t)},normalize:function(){var e=this.lx*this.lx+this.ly*this.ly;if(e==1)return;e<1e-20?e=0:e=1/Math.sqrt(e),this.lx*=e,this.ly*=e},__class__:xi},oc=function(e,t){this.x=e.x,this.y=e.y,this.dx=t.x-this.x,this.dy=t.y-this.y,this.lenSq=this.dx*this.dx+this.dy*this.dy,this.invLenSq=1/this.lenSq},c["h2d.col.Segment"]=oc,oc.__name__="h2d.col.Segment",oc.prototype={setPoints:function(e,t){this.x=e.x,this.y=e.y,this.dx=t.x-this.x,this.dy=t.y-this.y,this.lenSq=this.dx*this.dx+this.dy*this.dy,this.invLenSq=1/this.lenSq},side:function(e){return this.dx*(e.y-this.y)-this.dy*(e.x-this.x)},distanceSq:function(e){var o,i,a,r,c,t=e.x-this.x,n=e.y-this.y,s=t*this.dx+n*this.dy;return s<0?t*t+n*n:s>this.lenSq?(o=e.x-(this.x+this.dx),i=e.y-(this.y+this.dy),o*o+i*i):(a=s*this.invLenSq,r=this.x+a*this.dx-e.x,c=this.y+a*this.dy-e.y,r*r+c*c)},distance:function(e){var t,i,a,r,c,l,n=e.x-this.x,s=e.y-this.y,o=n*this.dx+s*this.dy;return o<0?t=n*n+s*s:o>this.lenSq?(i=e.x-(this.x+this.dx),a=e.y-(this.y+this.dy),t=i*i+a*a):(r=o*this.invLenSq,c=this.x+r*this.dx-e.x,l=this.y+r*this.dy-e.y,t=c*c+l*l),Math.sqrt(t)},project:function(e,t){var n,s,o,a,r=e.x-this.x,c=e.y-this.y,i=r*this.dx+c*this.dy;return t==null&&(t=new U(0,0)),i<0?(o=t,n=this.x,s=this.y,s==null&&(s=0),n==null&&(n=0),o.x=n,o.y=s):i>this.lenSq?(o=t,n=this.x+this.dx,s=this.y+this.dy,s==null&&(s=0),n==null&&(n=0),o.x=n,o.y=s):(a=i*this.invLenSq,o=t,n=this.x+a*this.dx,s=this.y+a*this.dy,s==null&&(s=0),n==null&&(n=0),o.x=n,o.y=s),t},lineIntersection:function(e,t){var n,s,a,r,c,l,d,o=this.x,i=this.y;return i==null&&(i=0),o==null&&(o=0),n=o,s=i,s==null&&(s=0),n==null&&(n=0),r=n,c=s,o=this.x+this.dx,i=this.y+this.dy,i==null&&(i=0),o==null&&(o=0),n=o,s=i,s==null&&(s=0),n==null&&(n=0),l=n,d=s,(e.lx*(c-e.py)-e.ly*(r-e.px))*(e.lx*(d-e.py)-e.ly*(l-e.px))>0?null:(a=(e.lx*(this.y-e.py)-e.ly*(this.x-e.px))/(e.ly*this.dx-e.lx*this.dy),a<0||a>1?null:(t==null&&(t=new U(0,0)),t.x=this.x+a*this.dx,t.y=this.y+a*this.dy,t))},__class__:oc},To={},To.get_segments=function(e){return e},To.get_length=function(e){return e.length},To.iterator=function(e){return new zr(e)},To.containsPoint=function(e,n,s){if(s){for(var o,i=0,a=e;i<a.length;)if(o=a[i],++i,o.dx*(n.y-o.y)-o.dy*(n.x-o.x)<0)return!1}else throw t.thrown("TODO");return!0},To.toPolygon=function(e){for(var t,n,o,i=[],s=0,a=e;s<a.length;)o=a[s],++s,t=o.x,n=o.y,n==null&&(n=0),t==null&&(t=0),i.push(new U(t,n));return i},To.project=function(e,t){for(var s,o,i,a,r,c,l,d,u,h,m,f,p,g,b=1e20,n=null,v=0,j=e;v<j.length;)s=j[v],++v,d=t.x-s.x,u=t.y-s.y,r=d*s.dx+u*s.dy,r<0?h=d*d+u*u:r>s.lenSq?(g=t.x-(s.x+s.dx),m=t.y-(s.y+s.dy),h=g*g+m*m):(l=r*s.invLenSq,f=s.x+l*s.dx-t.x,p=s.y+l*s.dy-t.y,h=f*f+p*p),h<b&&(b=h,n=s);return c=null,d=t.x-n.x,u=t.y-n.y,r=d*n.dx+u*n.dy,c==null&&(c=new U(0,0)),r<0?(a=c,i=n.x,o=n.y,o==null&&(o=0),i==null&&(i=0),a.x=i,a.y=o):r>n.lenSq?(a=c,i=n.x+n.dx,o=n.y+n.dy,o==null&&(o=0),i==null&&(i=0),a.x=i,a.y=o):(l=r*n.invLenSq,a=c,i=n.x+l*n.dx,o=n.y+l*n.dy,o==null&&(o=0),i==null&&(i=0),a.x=i,a.y=o),c},To.distanceSq=function(e,t){for(var n,s,o,i,a,l,d,u,h,m,r=1e20,c=0,f=e;c<f.length;)n=f[c],++c,i=t.x-n.x,a=t.y-n.y,o=i*n.dx+a*n.dy,o<0?s=i*i+a*a:o>n.lenSq?(l=t.x-(n.x+n.dx),d=t.y-(n.y+n.dy),s=l*l+d*d):(u=o*n.invLenSq,h=n.x+u*n.dx-t.x,m=n.y+u*n.dy-t.y,s=h*h+m*m),s<r&&(r=s);return r},To.distance=function(e,t){return Math.sqrt(To.distanceSq(e,t))},ma=function(){this.useScreenResolution=ma.defaultUseScreenResolution,this.resolutionScale=1,this.enable=!0,this.smooth=!1,this.boundsExtend=0,this.autoBounds=!0},c["h2d.filter.Filter"]=ma,ma.__name__="h2d.filter.Filter",ma.prototype={get_enable:function(){return this.enable},set_enable:function(e){return this.enable=e},set_resolutionScale:function(e){return this.resolutionScale=e},set_useScreenResolution:function(e){return this.useScreenResolution=e},sync:function(){},bind:function(){},unbind:function(){},getBounds:function(e,t,n){e.getBounds(e,t),t.xMin=t.xMin*n.x-this.boundsExtend,t.xMax=t.xMax*n.x+this.boundsExtend,t.yMin=t.yMin*n.y-this.boundsExtend,t.yMax=t.yMax*n.y+this.boundsExtend},draw:function(e,t){return t},__class__:ma},ve=_["h3d.BufferFlag"]={__ename__:!0,__constructs__:null,Dynamic:{_hx_name:"Dynamic",_hx_index:0,__enum__:"h3d.BufferFlag",toString:s},NoAlloc:{_hx_name:"NoAlloc",_hx_index:1,__enum__:"h3d.BufferFlag",toString:s},UniformBuffer:{_hx_name:"UniformBuffer",_hx_index:2,__enum__:"h3d.BufferFlag",toString:s},ReadWriteBuffer:{_hx_name:"ReadWriteBuffer",_hx_index:3,__enum__:"h3d.BufferFlag",toString:s},IndexBuffer:{_hx_name:"IndexBuffer",_hx_index:4,__enum__:"h3d.BufferFlag",toString:s}},ve.__constructs__=[ve.Dynamic,ve.NoAlloc,ve.UniformBuffer,ve.ReadWriteBuffer,ve.IndexBuffer],ve.__empty_constructs__=[ve.Dynamic,ve.NoAlloc,ve.UniformBuffer,ve.ReadWriteBuffer,ve.IndexBuffer],wt=function(e,t,n){if(this.id=wt.GUID++,this.vertices=e,this.format=t,this.flags=0,this.allocPos=wn.make(),n!=null)for(var o,s=0;s<n.length;)o=n[s],++s,this.flags|=1<<o._hx_index;this.engine=K.CURRENT,(this.flags&1<<ve.NoAlloc._hx_index)==0&&this.engine.mem.allocBuffer(this)},c["h3d.Buffer"]=wt,wt.__name__="h3d.Buffer",wt.ofFloats=function(e,t,n){var s=Math.ceil(e.pos/t.stride),o=new wt(s,t,n);return o.uploadFloats(e,0,s),o},wt.ofSubFloats=function(e,t,n,s){var o=new wt(t,n,s);return o.uploadFloats(e,0,t),o},wt.prototype={getMemSize:function(){return this.vertices*this.format.strideBytes},isDisposed:function(){return this.vbuf==null},dispose:function(){this.vbuf!=null&&(this.engine.mem.freeBuffer(this),this.vbuf=null)},uploadFloats:function(e,n,s,o){if(o==null&&(o=0),o<0||s<0||o+s>this.vertices)throw t.thrown("Invalid vertices count");if(s==0)return;if(this.format.hasLowPrecision){for(var i,r,l,u,m,f,p,g,v,b,j,_,w,O,x,E,S,M,F,T,z,c=new A(new ArrayBuffer(s*this.format.strideBytes)),a=0,d=n,h=0,C=this.format.inputs,k=0,D=s;k<D;)for(z=k++,h=0;h<C.length;){switch(r=C[h++],f=r.type,l=f==H.__cast(9,St)?1:f,i=0,r.precision){case 0:for(v=0,b=l;v<b;)S=v++,c.setFloat(a+i,e.array[d++]),i+=4;break;case 1:for(u=0,w=l;u<w;)F=u++,x=y.float32to16(e.array[d++]),c.setUInt16(a+i,x),i+=2;break;case 2:for(g=0,E=l;g<E;)M=g++,_=y.float32toU8(e.array[d++]),c.b[a+i]=_,++i;break;case 3:for(p=0,O=l;p<O;)T=p++,j=y.float32toS8(e.array[d++]),c.b[a+i]=j,++i;break}m=r.type,a+=(m==H.__cast(9,St)?1:m)*Mt.SIZES[r.precision],(a&3)!=0&&(a+=4-(a&3))}this.uploadBytes(c,0,s);return}this.engine.driver.uploadBufferData(this,o,s,e,n)},uploadBytes:function(e,n,s){if(s<0||s>this.vertices)throw t.thrown("Invalid vertices count");if(s==0)return;this.engine.driver.uploadBufferBytes(this,0,s,e,n)},readBytes:function(e,n,s,o){if(o==null&&(o=0),o<0||s<0||o+s>this.vertices)throw t.thrown("Invalid vertices count");this.engine.driver.readBufferBytes(this,o,s,e,n)},__class__:wt},Ci=function(e,t,n,s,o,i){i==null&&(i=!1),o==null&&(o=4e3),s==null&&(s=.02),n==null&&(n=1.333333),t==null&&(t=1),e==null&&(e=25),this.reverseDepth=!1,this.jitterOffsetY=0,this.jitterOffsetX=0,this.viewY=0,this.viewX=0,this.fovY=e,this.zoom=t,this.screenRatio=n,this.zNear=s,this.zFar=o,this.rightHanded=i;var a=2,r=3,c=4;c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),this.pos=new h(a,r,c),a=0,r=0,c=1,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),this.up=new h(a,r,c),a=0,r=0,c=0,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),this.target=new h(a,r,c),this.m=new L,this.mcam=new L,this.mproj=new L,this.frustum=new Ja,this.update()},c["h3d.Camera"]=Ci,Ci.__name__="h3d.Camera",Ci.prototype={setFovX:function(e,t){var n=Math.PI/180;this.fovY=2*Math.atan(Math.tan(e*.5*n)/t)/n},getFovX:function(){var e=Math.PI/180,t=Math.atan(Math.tan(this.fovY*.5*e)*this.screenRatio),n=t*2/e;return n},clone:function(){var o=new Ci(this.fovY,this.zoom,this.screenRatio,this.zNear,this.zFar,this.rightHanded),e=this.pos,t=e.x,n=e.y,s=e.z;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o.pos=new h(t,n,s),e=this.up,t=e.x,n=e.y,s=e.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o.up=new h(t,n,s),e=this.target,t=e.x,n=e.y,s=e.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o.target=new h(t,n,s),o.update(),o},getInverseViewProj:function(){return this.minv==null&&(this.minv=new L),this.needInv&&(this.minv.initInverse(this.m),this.needInv=!1),this.minv},getInverseProj:function(){return this.mprojInv==null&&(this.mprojInv=new L,this.mprojInv._44=0),this.mprojInv._44==0&&this.mprojInv.initInverse(this.mproj),this.mprojInv},getInverseView:function(){return this.mcamInv==null&&(this.mcamInv=new L,this.mcamInv._44=0),this.mcamInv._44==0&&this.mcamInv.initInverse(this.mcam),this.mcamInv},calcDirections:function(){var e,t,n,a,r,c,l,d,u,h,m,f,p,g,j,y,_,b=this.target,v=this.pos,s=b.x-v.x,o=b.y-v.y,i=b.z-v.z;i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),t=s,n=o,e=i,e==null&&(e=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,r=e,a=l*l+c*c+r*r,a<1e-20?a=0:a=1/Math.sqrt(a),s=l*a,o=c*a,i=r*a,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),t=s,n=o,e=i,e==null&&(e=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,r=e,d=this.up,s=d.y*r-d.z*c,o=d.z*l-d.x*r,i=d.x*c-d.y*l,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),t=s,n=o,e=i,e==null&&(e=0),n==null&&(n=0),t==null&&(t=0),h=t,m=n,f=e,a=h*h+m*m+f*f,a<1e-20?a=0:a=1/Math.sqrt(a),s=h*a,o=m*a,i=f*a,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),t=s,n=o,e=i,e==null&&(e=0),n==null&&(n=0),t==null&&(t=0),p=t,u=n,g=e,s=c*g-r*u,o=r*p-l*g,i=l*u-c*p,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),t=s,n=o,e=i,e==null&&(e=0),n==null&&(n=0),t==null&&(t=0),j=t,y=n,_=e,this.directions._11=l,this.directions._12=c,this.directions._13=r,this.directions._21=p,this.directions._22=u,this.directions._23=g,this.directions._31=j,this.directions._32=y,this.directions._33=_,this.directions._44=1},getForward:function(){var e=new h(0,0,0);return this.directions==null&&(this.directions=new L,this.directions._44=0),this.directions._44==0&&this.calcDirections(),e.x=this.directions._11,e.y=this.directions._12,e.z=this.directions._13,e},getRight:function(){var e=new h(0,0,0);return this.directions==null&&(this.directions=new L,this.directions._44=0),this.directions._44==0&&this.calcDirections(),e.x=this.directions._21,e.y=this.directions._22,e.z=this.directions._23,e},getUp:function(){var e=new h(0,0,0);return this.directions==null&&(this.directions=new L,this.directions._44=0),this.directions._44==0&&this.calcDirections(),e.x=this.directions._31,e.y=this.directions._32,e.z=this.directions._33,e},setCubeMap:function(e,t){var n,s,o,i,a=0,r=0,c=0;switch(e){case 0:a=1,n=this.up,s=0,o=1,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i;break;case 1:a=-1,n=this.up,s=0,o=1,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i;break;case 2:r=1,n=this.up,s=0,o=0,i=-1,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i;break;case 3:r=-1,n=this.up,s=0,o=0,i=1,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i;break;case 4:c=1,n=this.up,s=0,o=1,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i;break;case 5:c=-1,n=this.up,s=0,o=1,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i;break}t!=null&&(n=this.pos,n.x=t.x,n.y=t.y,n.z=t.z),n=this.target,s=this.pos.x+a,o=this.pos.y+r,i=this.pos.z+c,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i},unproject:function(e,t,n){var s,o,i,l,d,u,m,a=e,r=t,c=n;return c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),l=new h(a,r,c),o=l,s=this.getInverseViewProj(),d=o.x*s._11+o.y*s._21+o.z*s._31+s._41,u=o.x*s._12+o.y*s._22+o.z*s._32+s._42,m=o.x*s._13+o.y*s._23+o.z*s._33+s._43,i=1/(o.x*s._14+o.y*s._24+o.z*s._34+s._44),o.x=d*i,o.y=u*i,o.z=m*i,l},rayFromScreen:function(e,t,n,s){s==null&&(s=-1),n==null&&(n=-1);var o,i,a,r,c,l=K.CURRENT;return n<0&&(n=l.width),s<0&&(s=l.height),r=(e/n-.5)*2,c=(.5-t/s)*2,i=this.unproject(r,c,0),a=this.unproject(r,c,1),o=new nt,o.px=i.x,o.py=i.y,o.pz=i.z,o.lx=a.x-i.x,o.ly=a.y-i.y,o.lz=a.z-i.z,o.normalize(),o},update:function(){if(this.follow!=null){var o,r,i=this.follow.pos.localToGlobal(),a=this.follow.target.localToGlobal(),e=this.pos,t=i.x,n=i.y,s=i.z;if(s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=s,e=this.target,t=a.x,n=a.y,s=a.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=s,this.follow.pos.name!=null)for(o=this.follow.pos;o!=null;){if(o.currentAnimation!=null&&(r=o.currentAnimation.getPropValue(this.follow.pos.name,"FOVY"),r!=null)){this.fovY=r;break}o=o.parent}}this.makeCameraMatrix(this.mcam),this.makeFrustumMatrix(this.mproj),this.m.multiply(this.mcam,this.mproj),this.needInv=!0,this.mcamInv!=null&&(this.mcamInv._44=0),this.mprojInv!=null&&(this.mprojInv._44=0),this.directions!=null&&(this.directions._44=0),this.frustum.loadMatrix(this.m)},getFrustumCorners:function(e,t){return t==null&&(t=0),e==null&&(e=1),[this.unproject(-1,1,t),this.unproject(1,1,t),this.unproject(1,-1,t),this.unproject(-1,-1,t),this.unproject(-1,1,e),this.unproject(1,1,e),this.unproject(1,-1,e),this.unproject(-1,-1,e)]},lostUp:function(){var e,t,n,s,o,i,a,r,c=this.pos,l=c.x,d=c.y,u=c.z;return u==null&&(u=0),d==null&&(d=0),l==null&&(l=0),o=l,i=d,a=u,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,e=t*t+n*n+s*s,e<1e-20?e=0:e=1/Math.sqrt(e),t*=e,n*=e,s*=e,r=this.up,Math.abs(t*r.x+n*r.y+s*r.z)>.999},getViewDirection:function(e,t,n){n==null&&(n=0);var s,o,i,a,d,u,m,r=e,c=t,l=n;return l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),a=new h(r,c,l),s=a,o=this.mcam,d=s.x*o._11+s.y*o._21+s.z*o._31,u=s.x*o._12+s.y*o._22+s.z*o._32,m=s.x*o._13+s.y*o._23+s.z*o._33,s.x=d,s.y=u,s.z=m,s=a,i=s.x*s.x+s.y*s.y+s.z*s.z,i<1e-20?i=0:i=1/Math.sqrt(i),s.x*=i,s.y*=i,s.z*=i,a},movePosAxis:function(e,t,n){n==null&&(n=0);var s,o,i,a,r,c,l,m,f,p,u=e,h=t,d=n;d==null&&(d=0),h==null&&(h=0),u==null&&(u=0),r=u,c=h,l=d,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),o=r,i=c,a=l,s=this.mcam,m=o*s._11+i*s._21+a*s._31,f=o*s._12+i*s._22+a*s._32,p=o*s._13+i*s._23+a*s._33,o=m,i=f,a=p,this.pos.x+=o,this.pos.y+=i,this.pos.z+=a},moveTargetAxis:function(e,t,n){n==null&&(n=0);var s,o,i,a,r,c,l,m,f,p,u=e,h=t,d=n;d==null&&(d=0),h==null&&(h=0),u==null&&(u=0),r=u,c=h,l=d,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),o=r,i=c,a=l,s=this.mcam,m=o*s._11+i*s._21+a*s._31,f=o*s._12+i*s._22+a*s._32,p=o*s._13+i*s._23+a*s._33,o=m,i=f,a=p,this.target.x+=o,this.target.y+=i,this.target.z+=a},forward:function(e){e==null&&(e=1);var t=1-.025*e,n=this.pos,s=this.target.x+(this.pos.x-this.target.x)*t,o=this.target.y+(this.pos.y-this.target.y)*t,i=this.target.z+(this.pos.z-this.target.z)*t;i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i},backward:function(e){e==null&&(e=1);var t=1+.025*e,n=this.pos,s=this.target.x+(this.pos.x-this.target.x)*t,o=this.target.y+(this.pos.y-this.target.y)*t,i=this.target.z+(this.pos.z-this.target.z)*t;i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i},makeCameraMatrix:function(e){var t,s,o,i,a,r,c,h,m,f,p,v,b,j,g=this.target,n=this.pos,u=g.x-n.x,d=g.y-n.y,l=g.z-n.z;l==null&&(l=0),d==null&&(d=0),u==null&&(u=0),a=u,r=d,c=l,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),s=a,i=r,o=c,this.rightHanded&&(s*=-1,i*=-1,o*=-1),t=s*s+i*i+o*o,t<1e-20?t=0:t=1/Math.sqrt(t),s*=t,i*=t,o*=t,p=this.up,u=p.y*o-p.z*i,d=p.z*s-p.x*o,l=p.x*i-p.y*s,l==null&&(l=0),d==null&&(d=0),u==null&&(u=0),a=u,r=d,c=l,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),h=a,m=r,f=c,t=h*h+m*m+f*f,t<1e-20?t=0:t=1/Math.sqrt(t),h*=t,m*=t,f*=t,Math.sqrt(h*h+m*m+f*f)==0&&(h=i,m=o,f=s),u=i*f-o*m,d=o*h-s*f,l=s*m-i*h,l==null&&(l=0),d==null&&(d=0),u==null&&(u=0),a=u,r=d,c=l,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),v=a,b=r,j=c,e._11=h,e._12=v,e._13=s,e._14=0,e._21=m,e._22=b,e._23=i,e._24=0,e._31=f,e._32=j,e._33=o,e._34=0,n=this.pos,e._41=-(h*n.x+m*n.y+f*n.z),n=this.pos,e._42=-(v*n.x+b*n.y+j*n.z),n=this.pos,e._43=-(s*n.x+i*n.y+o*n.z),e._44=1},setTransform:function(e){var i,a,r,c,l,d,u,h,t=this.pos,n=e._41,s=e._42,o=e._43;o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t.x=n,t.y=s,t.z=o,t=this.target,i=this.pos,a=e.getDirection(),n=i.x+a.x,s=i.y+a.y,o=i.z+a.z,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),r=n,c=s,l=o,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),d=r,u=c,h=l,t.x=d,t.y=u,t.z=h},makeFrustumMatrix:function(e){e.zero();var n,s,o,i,a,r,t=this.orthoBounds;t!=null?(n=1/(t.xMax-t.xMin),s=1/(t.yMax-t.yMin),o=1/(t.zMax-t.zMin),e._11=2*n,e._22=2*s,e._33=o,e._41=-(t.xMin+t.xMax)*n,e._42=-(t.yMin+t.yMax)*s,e._43=-t.zMin*o,e._44=1):(a=Math.PI/180,r=Math.atan(Math.tan(this.fovY*.5*a)*this.screenRatio),i=this.zoom/Math.tan(r),e._11=i,e._22=i*this.screenRatio,e._33=this.reverseDepth?-this.zNear/(this.zFar-this.zNear):this.zFar/(this.zFar-this.zNear),e._34=1,e._43=this.reverseDepth?this.zNear*this.zFar/(this.zFar-this.zNear):-(this.zNear*this.zFar)/(this.zFar-this.zNear),e._31=this.jitterOffsetX,e._32=this.jitterOffsetY),e._11+=this.viewX*e._14,e._21+=this.viewX*e._24,e._31+=this.viewX*e._34,e._41+=this.viewX*e._44,e._12+=this.viewY*e._14,e._22+=this.viewY*e._24,e._32+=this.viewY*e._34,e._42+=this.viewY*e._44,this.rightHanded&&(e._33*=-1,e._34*=-1)},projectInline:function(e,t,n,s,o,i){i==null&&(i=!0);var r,l,f,p,g,c=new h(0,0,0),a=c,d=e,u=t,m=n;return m==null&&(m=0),u==null&&(u=0),d==null&&(d=0),a.x=d,a.y=u,a.z=m,a=c,r=this.m,f=a.x*r._11+a.y*r._21+a.z*r._31+r._41,p=a.x*r._12+a.y*r._22+a.z*r._32+r._42,g=a.x*r._13+a.y*r._23+a.z*r._33+r._43,l=1/(a.x*r._14+a.y*r._24+a.z*r._34+r._44),a.x=f*l,a.y=p*l,a.z=g*l,c.x=(c.x+1)*.5*s,c.y=(-c.y+1)*.5*o,i&&(c.x=Math.round(c.x),c.y=Math.round(c.y)),c},project:function(e,t,n,s,o,i,a){i==null&&(i=!0),a==null&&(a=new h(0,0,0));var c,l,f,p,g,r=a,d=e,u=t,m=n;return m==null&&(m=0),u==null&&(u=0),d==null&&(d=0),r.x=d,r.y=u,r.z=m,r=a,c=this.m,f=r.x*c._11+r.y*c._21+r.z*c._31+c._41,p=r.x*c._12+r.y*c._22+r.z*c._32+c._42,g=r.x*c._13+r.y*c._23+r.z*c._33+c._43,l=1/(r.x*c._14+r.y*c._24+r.z*c._34+c._44),r.x=f*l,r.y=p*l,r.z=g*l,a.x=(a.x+1)*.5*s,a.y=(-a.y+1)*.5*o,i&&(a.x=Math.round(a.x),a.y=Math.round(a.y)),a},distanceToDepth:function(e){var t=this.zNear,n=this.zFar;return n==null&&(n=1),t==null&&(t=0),((this.zFar+this.zNear-2*this.zNear*this.zFar/(e<t?t:e>n?n:e))/(this.zFar-this.zNear)+1)/2},depthToDistance:function(e){var t=0,n=1;return n==null&&(n=1),t==null&&(t=0),((e<t?t:e>n?n:e)*this.zFar-this.zNear*this.zFar)/(this.zFar-this.zNear)},load:function(e){var t=this.pos,n=e.pos;t.x=n.x,t.y=n.y,t.z=n.z,t=this.target,n=e.target,t.x=n.x,t.y=n.y,t.z=n.z,t=this.up,n=e.up,t.x=n.x,t.y=n.y,t.z=n.z,e.orthoBounds!=null?(this.orthoBounds=new Ce,this.orthoBounds.load(e.orthoBounds)):this.orthoBounds=null,this.fovY=e.fovY,this.screenRatio=e.screenRatio,this.zoom=e.zoom,this.zNear=e.zNear,this.zFar=e.zFar,e.follow!=null?this.follow={pos:e.follow.pos,target:e.follow.target}:this.follow=null,this.viewX=e.viewX,this.viewY=e.viewY,this.update()},__class__:Ci},tc=function(e,t,n,s,o){this.t=e,this.next=t,this.layer=n,this.mipLevel=s,this.depthBinding=o},c["h3d._Engine.TargetTmp"]=tc,tc.__name__="h3d._Engine.TargetTmp",tc.prototype={__class__:tc},ht=_["h3d.DepthBinding"]={__ename__:!0,__constructs__:null,ReadWrite:{_hx_name:"ReadWrite",_hx_index:0,__enum__:"h3d.DepthBinding",toString:s},ReadOnly:{_hx_name:"ReadOnly",_hx_index:1,__enum__:"h3d.DepthBinding",toString:s},DepthOnly:{_hx_name:"DepthOnly",_hx_index:2,__enum__:"h3d.DepthBinding",toString:s},NotBound:{_hx_name:"NotBound",_hx_index:3,__enum__:"h3d.DepthBinding",toString:s}},ht.__constructs__=[ht.ReadWrite,ht.ReadOnly,ht.DepthOnly,ht.NotBound],ht.__empty_constructs__=[ht.ReadWrite,ht.ReadOnly,ht.DepthOnly,ht.NotBound],K=function(){this.resCache=new Rt,this.ready=!1,this.inRender=!1,this.textureColorCache=new le,this.tmpVector=new j(0,0,0,1),this.backgroundColor=-16777216,this.hardware=!K.SOFTWARE_DRIVER,this.antiAlias=K.ANTIALIASING,this.autoResize=!0,this.set_fullScreen(!V.getValue(As.IsWindowed)),this.window=pt.getInstance(),this.realFps=V.getDefaultFrameRate(),this.lastTime=u.now()/1e3,this.window.addResizeEvent(b(this,this.onWindowResize)),K.CURRENT=this,this.window.setCurrent(),this.driver=_i.get_supported()?new $(this.antiAlias):new ir},c["h3d.Engine"]=K,K.__name__="h3d.Engine",K.getCurrent=function(){return K.CURRENT},K.prototype={setDriver:function(e){this.driver=e,this.mem!=null&&(this.mem.driver=e)},setCurrent:function(){K.CURRENT=this,this.window.setCurrent()},init:function(){this.driver.init(b(this,this.onCreate),!this.hardware)},driverName:function(e){return e==null&&(e=!1),this.driver.getDriverName(e)},selectShader:function(e){this.needFlushTarget&&this.doFlushTarget(),this.driver.selectShader(e)&&this.shaderSwitches++},selectMaterial:function(e){this.driver.selectMaterial(e)},uploadInstanceShaderBuffers:function(e){this.driver.flushShaderBuffers(),this.driver.uploadShaderBuffers(e,1),this.driver.uploadShaderBuffers(e,2),this.driver.uploadShaderBuffers(e,3)},uploadShaderBuffers:function(e,t){this.driver.uploadShaderBuffers(e,t)},selectBuffer:function(e){return e.vbuf!=null&&(this.needFlushTarget&&this.doFlushTarget(),this.driver.selectBuffer(e),!0)},renderTriBuffer:function(e,t,n){n==null&&(n=-1),t==null&&(t=0),this.renderBuffer(e,this.mem.getTriIndexes(e.vertices),3,t,n)},renderQuadBuffer:function(e,t,n){n==null&&(n=-1),t==null&&(t=0),this.renderBuffer(e,this.mem.getQuadIndexes(e.vertices),2,t,n)},renderBuffer:function(e,n,s,o,i){if(i==null&&(i=-1),o==null&&(o=0),n.vbuf==null)return;var a=e.vertices/s|0;if(i<0&&(i=a-o),o<0||i<0||o+i>a)throw t.thrown("Invalid vertices count");i>0&&this.selectBuffer(e)&&(this.driver.draw(n,o*3,i),this.drawTriangles+=i,this.drawCalls++)},renderIndexed:function(e,t,n,s){if(s==null&&(s=-1),n==null&&(n=0),t.vbuf==null)return;var o=t.vertices/3|0;s<0&&(s=o-n),s>0&&this.selectBuffer(e)&&(this.driver.draw(t,n*3,s),this.drawTriangles+=s,this.drawCalls++)},renderMultiBuffers:function(e,t,n,s,o){o==null&&(o=-1),s==null&&(s=0);var i=n.vertices/3|0;if(i<=0)return;if(this.needFlushTarget&&this.doFlushTarget(),this.driver.selectMultiBuffers(e,t),n.vbuf==null)return;o<0&&(o=i-s),o>0&&(this.driver.draw(n,s*3,o),this.drawTriangles+=o,this.drawCalls++)},renderInstanced:function(e,t){if(e.vbuf==null)return;t.commandCount>0&&(this.driver.drawInstanced(e,t),this.drawTriangles+=t.triCount,this.drawCalls++)},set_debug:function(e){return this.debug=e,this.driver.setDebug(this.debug),e},onCreate:function(e){K.CURRENT=this,this.window.setCurrent(),this.autoResize&&(this.width=this.window.get_width(),this.height=this.window.get_height()),e?(Ut.get().onContextLost(),this.mem.onContextLost()):(this.mem=new po(this.driver),this.mem.init(),this.nullTexture=new S(0,0,[w.NoAlloc])),this.hardware=this.driver.hasFeature(je.HardwareAccelerated),this.set_debug(this.debug),this.set_fullScreen(this.fullScreen),this.resize(this.width,this.height),e?this.onContextLost():this.onReady(),this.ready=!0},onContextLost:function(){},onReady:function(){},onWindowResize:function(){if(this.autoResize&&!this.driver.isDisposed()){var e=this.window.get_width(),t=this.window.get_height();(e!=this.width||t!=this.height)&&this.resize(e,t),this.onResized()}},set_fullScreen:function(e){return this.fullScreen=e,this.mem!=null&&V.getValue(As.IsWindowed)&&this.window.set_displayMode(e?Wt.Borderless:Wt.Windowed),e},onResized:function(){},resize:function(e,t){e<32&&(e=32),t<32&&(t=32),this.width=e,this.height=t,this.driver.isDisposed()||this.driver.resize(e,t)},begin:function(){return!this.driver.isDisposed()&&(this.inRender=!0,this.drawTriangles=0,this.shaderSwitches=0,this.drawCalls=0,this.dispatches=0,this.targetStack=null,this.needFlushTarget=this.currentTargetTex!=null,this.driver.begin(N.frameCount),this.backgroundColor!=null&&this.clear(this.backgroundColor,1,0),!0)},hasFeature:function(e){return this.driver.hasFeature(e)},end:function(){this.inRender=!1,this.driver.end()},getCurrentTarget:function(){return this.targetStack==null?null:this.targetStack.t==this.nullTexture?this.targetStack.textures[0]:this.targetStack.t},pushTarget:function(e,t,n,s){s==null&&(s=ht.ReadWrite),n==null&&(n=0),t==null&&(t=0);var o=this.targetTmp;o==null?o=new tc(e,this.targetStack,t,n,s):(this.targetTmp=o.next,o.t=e,o.next=this.targetStack,o.mipLevel=n,o.layer=t,o.depthBinding=s),this.targetStack=o,this.updateNeedFlush()},updateNeedFlush:function(){var e=this.targetStack;e==null?this.needFlushTarget=this.currentTargetTex!=null:this.needFlushTarget=this.currentTargetTex!=e.t||this.currentTargetLayer!=e.layer||this.currentTargetMip!=e.mipLevel||e.textures!=null||this.currentDepthBinding!=e.depthBinding},pushTargets:function(e,t){t==null&&(t=ht.ReadWrite),this.pushTarget(this.nullTexture,null,null,t),this.targetStack.textures=e,this.needFlushTarget=!0},pushDepth:function(e){this.pushTarget(e,null,null,ht.DepthOnly)},popTarget:function(){var e=this.targetStack;if(e==null)throw t.thrown("popTarget() with no matching pushTarget()");this.targetStack=e.next,this.updateNeedFlush(),e.t=null,e.textures=null,e.next=this.targetTmp,this.targetTmp=e},flushTarget:function(){this.needFlushTarget&&this.doFlushTarget()},doFlushTarget:function(){var e=this.targetStack;e==null?(this.driver.setRenderTarget(null),this.currentTargetTex=null):(e.depthBinding==ht.DepthOnly?this.driver.setDepth(e.t):e.textures!=null?this.driver.setRenderTargets(e.textures,e.depthBinding):this.driver.setRenderTarget(e.t,e.layer,e.mipLevel,e.depthBinding),this.currentTargetTex=e.t,this.currentTargetLayer=e.layer,this.currentTargetMip=e.mipLevel,this.currentDepthBinding=e.depthBinding),this.needFlushTarget=!1},clearF:function(e,t,n){this.needFlushTarget&&this.doFlushTarget(),this.driver.clear(e,t,n)},clear:function(e,t,n){if(e!=null){var s=this.tmpVector;s.x=(e>>16&255)/255,s.y=(e>>8&255)/255,s.z=(e&255)/255,s.w=(e>>>24)/255}this.needFlushTarget&&this.doFlushTarget(),this.driver.clear(e==null?null:this.tmpVector,t,n)},setRenderZone:function(e,t,n,s){s==null&&(s=-1),n==null&&(n=-1),t==null&&(t=0),e==null&&(e=0),this.needFlushTarget&&this.doFlushTarget(),this.driver.setRenderZone(e,t,n,s)},render:function(e){if(!this.begin())return!1;e.render(this),this.end();var t,n,s=u.now()/1e3-this.lastTime;return this.lastTime+=s,s>0&&(t=1/s,t>this.realFps*2?t=this.realFps*2:t<this.realFps*.5&&(t=this.realFps*.5),n=s/.5,n>.3&&(n=.3),this.realFps=this.realFps*(1-n)+t*n),!0},setDepthClamp:function(e){this.driver.setDepthClamp(e)},setDepthBias:function(e,t){this.driver.setDepthBias(e,t)},dispose:function(){this.driver.dispose(),this.window.removeResizeEvent(b(this,this.onWindowResize)),this.mem!=null&&this.mem.dispose()},get_fps:function(){return Math.ceil(this.realFps*100)/100},__class__:K},rn={},rn._new=function(e,t){return t==null&&(t=!1),new wt(e,t?y.get_INDEX32():y.get_INDEX16(),[ve.IndexBuffer])},rn.uploadIndexes=function(e,n,s,o,i){if(i==null&&(i=0),i<0||o<0||i+o>e.vertices)throw t.thrown("Invalid indices count");if(e.format.inputs[0].precision!=1)throw t.thrown("Can't upload indexes on a 32-bit buffer");if(o==0)return;K.CURRENT.driver.uploadIndexData(e,i,o,n,s)},rn.get_count=function(e){return e.vertices},rn.alloc=function(e,t,n){n==null&&(n=-1),t==null&&(t=0),n<0&&(n=e.length);var s=rn._new(n);return rn.uploadIndexes(s,e,0,n),s},L=function(){},c["h3d.MatrixImpl"]=L,L.__name__="h3d.MatrixImpl",L.prototype={get_tx:function(){return this._41},get_ty:function(){return this._42},get_tz:function(){return this._43},set_tx:function(e){return this._41=e},set_ty:function(e){return this._42=e},set_tz:function(e){return this._43=e},equal:function(e){return this._11==e._11&&this._12==e._12&&this._13==e._13&&this._14==e._14&&this._21==e._21&&this._22==e._22&&this._23==e._23&&this._24==e._24&&this._31==e._31&&this._32==e._32&&this._33==e._33&&this._34==e._34&&this._41==e._41&&this._42==e._42&&this._43==e._43&&this._44==e._44},zero:function(){this._11=0,this._12=0,this._13=0,this._14=0,this._21=0,this._22=0,this._23=0,this._24=0,this._31=0,this._32=0,this._33=0,this._34=0,this._41=0,this._42=0,this._43=0,this._44=0},identity:function(){this._11=1,this._12=0,this._13=0,this._14=0,this._21=0,this._22=1,this._23=0,this._24=0,this._31=0,this._32=0,this._33=1,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},isIdentity:function(){return!(this._41!=0||this._42!=0||this._43!=0)&&!(this._11!=1||this._22!=1||this._33!=1)&&!(this._12!=0||this._13!=0||this._14!=0)&&!(this._21!=0||this._23!=0||this._24!=0)&&!(this._31!=0||this._32!=0||this._34!=0)&&this._44==1},isIdentityEpsilon:function(e){var n,s,t=this._41;return(t<0?-t:t)>e?s=!0:(t=this._42,s=(t<0?-t:t)>e),s?n=!0:(t=this._43,n=(t<0?-t:t)>e),!n&&(t=this._11-1,(t<0?-t:t)>e?s=!0:(t=this._22-1,s=(t<0?-t:t)>e),s?n=!0:(t=this._33-1,n=(t<0?-t:t)>e),!n&&(t=this._12,(t<0?-t:t)>e?s=!0:(t=this._13,s=(t<0?-t:t)>e),s?n=!0:(t=this._14,n=(t<0?-t:t)>e),!n&&(t=this._21,(t<0?-t:t)>e?s=!0:(t=this._23,s=(t<0?-t:t)>e),s?n=!0:(t=this._24,n=(t<0?-t:t)>e),!n&&(t=this._31,(t<0?-t:t)>e?s=!0:(t=this._32,s=(t<0?-t:t)>e),s?n=!0:(t=this._34,n=(t<0?-t:t)>e),!n&&(t=this._44-1,(t<0?-t:t)<=e)))))},initRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);this._11=1,this._12=0,this._13=0,this._14=0,this._21=0,this._22=t,this._23=n,this._24=0,this._31=0,this._32=-n,this._33=t,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},initRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);this._11=t,this._12=0,this._13=-n,this._14=0,this._21=0,this._22=1,this._23=0,this._24=0,this._31=n,this._32=0,this._33=t,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},initRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);this._11=t,this._12=n,this._13=0,this._14=0,this._21=-n,this._22=t,this._23=0,this._24=0,this._31=0,this._32=0,this._33=1,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},initTranslation:function(e,t,n){n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this._11=1,this._12=0,this._13=0,this._14=0,this._21=0,this._22=1,this._23=0,this._24=0,this._31=0,this._32=0,this._33=1,this._34=0,this._41=e,this._42=t,this._43=n,this._44=1},initScale:function(e,t,n){n==null&&(n=1),t==null&&(t=1),e==null&&(e=1),this._11=e,this._12=0,this._13=0,this._14=0,this._21=0,this._22=t,this._23=0,this._24=0,this._31=0,this._32=0,this._33=n,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},initRotationAxis:function(e,t){var a,c,r=Math.cos(t),i=Math.sin(t),l=1-r,s=-e.x,n=-e.y,o=-e.z,u=s*s,h=n*n,m=o*o,d=1/Math.sqrt(u+h+m);s*=d,n*=d,o*=d,c=s*l,a=o*l,this._11=r+s*c,this._12=n*c-o*i,this._13=s*a+n*i,this._14=0,this._21=n*c+o*i,this._22=r+n*n*l,this._23=n*a-s*i,this._24=0,this._31=s*a-n*i,this._32=n*a+s*i,this._33=r+o*a,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},initRotation:function(e,t,n){var i=Math.cos(e),a=Math.sin(e),r=Math.cos(t),c=Math.sin(t),s=Math.cos(n),o=Math.sin(n),l=i*c,d=a*c;this._11=r*s,this._12=r*o,this._13=-c,this._14=0,this._21=d*s-i*o,this._22=d*o+i*s,this._23=a*r,this._24=0,this._31=l*s+a*o,this._32=l*o-a*s,this._33=i*r,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},translate:function(e,t,n){n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this._11+=e*this._14,this._12+=t*this._14,this._13+=n*this._14,this._21+=e*this._24,this._22+=t*this._24,this._23+=n*this._24,this._31+=e*this._34,this._32+=t*this._34,this._33+=n*this._34,this._41+=e*this._44,this._42+=t*this._44,this._43+=n*this._44},scale:function(e,t,n){n==null&&(n=1),t==null&&(t=1),e==null&&(e=1),this._11*=e,this._21*=e,this._31*=e,this._41*=e,this._12*=t,this._22*=t,this._32*=t,this._42*=t,this._13*=n,this._23*=n,this._33*=n,this._43*=n},rotate:function(e,t,n){var s=L.tmp;s.initRotation(e,t,n),this.multiply(this,s)},rotateAxis:function(e,t){var r,l,h=L.tmp,n=h,c=Math.cos(t),a=Math.sin(t),d=1-c,o=-e.x,s=-e.y,i=-e.z,m=o*o,f=s*s,p=i*i,u=1/Math.sqrt(m+f+p);o*=u,s*=u,i*=u,l=o*d,r=i*d,n._11=c+o*l,n._12=s*l-i*a,n._13=o*r+s*a,n._14=0,n._21=s*l+i*a,n._22=c+s*s*d,n._23=s*r-o*a,n._24=0,n._31=o*r-s*a,n._32=s*r+o*a,n._33=c+i*r,n._34=0,n._41=0,n._42=0,n._43=0,n._44=1,this.multiply(this,h)},getPosition:function(){var o=new h(0,0,0),e=o,t=this._41,n=this._42,s=this._43;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=s,o},setPosition:function(e){this._41=e.x,this._42=e.y,this._43=e.z},prependTranslation:function(e,t,n){n==null&&(n=0),t==null&&(t=0),e==null&&(e=0);var s=this._11*e+this._21*t+this._31*n+this._41,o=this._12*e+this._22*t+this._32*n+this._42,i=this._13*e+this._23*t+this._33*n+this._43,a=this._14*e+this._24*t+this._34*n+this._44;this._41=s,this._42=o,this._43=i,this._44=a},getScale:function(){var e=new h(0,0,0);return e.x=Math.sqrt(this._11*this._11+this._12*this._12+this._13*this._13),e.y=Math.sqrt(this._21*this._21+this._22*this._22+this._23*this._23),e.z=Math.sqrt(this._31*this._31+this._32*this._32+this._33*this._33),this._11*(this._22*this._33-this._23*this._32)+this._12*(this._23*this._31-this._21*this._33)+this._13*(this._21*this._32-this._22*this._31)<0&&(e.x*=-1,e.y*=-1,e.z*=-1),e},prependRotation:function(e,t,n){var s=L.tmp;s.initRotation(e,t,n),this.multiply(s,this)},prependRotationAxis:function(e,t){var r,l,h=L.tmp,n=h,c=Math.cos(t),a=Math.sin(t),d=1-c,o=-e.x,s=-e.y,i=-e.z,m=o*o,f=s*s,p=i*i,u=1/Math.sqrt(m+f+p);o*=u,s*=u,i*=u,l=o*d,r=i*d,n._11=c+o*l,n._12=s*l-i*a,n._13=o*r+s*a,n._14=0,n._21=s*l+i*a,n._22=c+s*s*d,n._23=s*r-o*a,n._24=0,n._31=o*r-s*a,n._32=s*r+o*a,n._33=c+i*r,n._34=0,n._41=0,n._42=0,n._43=0,n._44=1,this.multiply(h,this)},prependScale:function(e,t,n){n==null&&(n=1),t==null&&(t=1),e==null&&(e=1);var s=L.tmp;s.initScale(e,t,n),this.multiply(s,this)},multiply3x4:function(e,t){var y=e._11,b=e._12,w=e._13,_=e._21,j=e._22,h=e._23,m=e._31,g=e._32,p=e._33,f=e._41,v=e._42,u=e._43,r=t._11,d=t._12,l=t._13,c=t._21,s=t._22,a=t._23,n=t._31,i=t._32,o=t._33,O=t._41,x=t._42,C=t._43;this._11=y*r+b*c+w*n,this._12=y*d+b*s+w*i,this._13=y*l+b*a+w*o,this._14=0,this._21=_*r+j*c+h*n,this._22=_*d+j*s+h*i,this._23=_*l+j*a+h*o,this._24=0,this._31=m*r+g*c+p*n,this._32=m*d+g*s+p*i,this._33=m*l+g*a+p*o,this._34=0,this._41=f*r+v*c+u*n+O,this._42=f*d+v*s+u*i+x,this._43=f*l+v*a+u*o+C,this._44=1},multiply3x4inline:function(e,t){var y=e._11,b=e._12,w=e._13,_=e._21,j=e._22,h=e._23,m=e._31,g=e._32,p=e._33,f=e._41,v=e._42,u=e._43,r=t._11,d=t._12,l=t._13,c=t._21,s=t._22,a=t._23,n=t._31,i=t._32,o=t._33,O=t._41,x=t._42,C=t._43;this._11=y*r+b*c+w*n,this._12=y*d+b*s+w*i,this._13=y*l+b*a+w*o,this._14=0,this._21=_*r+j*c+h*n,this._22=_*d+j*s+h*i,this._23=_*l+j*a+h*o,this._24=0,this._31=m*r+g*c+p*n,this._32=m*d+g*s+p*i,this._33=m*l+g*a+p*o,this._34=0,this._41=f*r+v*c+u*n+O,this._42=f*d+v*s+u*i+x,this._43=f*l+v*a+u*o+C,this._44=1},multiply:function(e,t){var n=e._11,s=e._12,o=e._13,i=e._14,a=e._21,r=e._22,c=e._23,l=e._24,d=e._31,u=e._32,h=e._33,m=e._34,f=e._41,p=e._42,g=e._43,v=e._44,b=t._11,j=t._12,y=t._13,_=t._14,w=t._21,O=t._22,x=t._23,C=t._24,E=t._31,k=t._32,A=t._33,S=t._34,M=t._41,F=t._42,T=t._43,z=t._44;this._11=n*b+s*w+o*E+i*M,this._12=n*j+s*O+o*k+i*F,this._13=n*y+s*x+o*A+i*T,this._14=n*_+s*C+o*S+i*z,this._21=a*b+r*w+c*E+l*M,this._22=a*j+r*O+c*k+l*F,this._23=a*y+r*x+c*A+l*T,this._24=a*_+r*C+c*S+l*z,this._31=d*b+u*w+h*E+m*M,this._32=d*j+u*O+h*k+m*F,this._33=d*y+u*x+h*A+m*T,this._34=d*_+u*C+h*S+m*z,this._41=f*b+p*w+g*E+v*M,this._42=f*j+p*O+g*k+v*F,this._43=f*y+p*x+g*A+v*T,this._44=f*_+p*C+g*S+v*z},multiplyValue:function(e){this._11*=e,this._12*=e,this._13*=e,this._14*=e,this._21*=e,this._22*=e,this._23*=e,this._24*=e,this._31*=e,this._32*=e,this._33*=e,this._34*=e,this._41*=e,this._42*=e,this._43*=e,this._44*=e},invert:function(){this.initInverse(this)},getInverse:function(e){return e==null&&(e=new L),e.initInverse(this),e},getDeterminant:function(){return this._11*(this._22*this._33-this._23*this._32)+this._12*(this._23*this._31-this._21*this._33)+this._13*(this._21*this._32-this._22*this._31)},inverse3x4:function(e){var t,f,n=e._11,s=e._12,o=e._13,d=e._21,r=e._22,a=e._23,i=e._31,c=e._32,l=e._33,u=e._41,h=e._42,m=e._43;if(this._11=r*l-a*c,this._12=o*c-s*l,this._13=s*a-o*r,this._14=0,this._21=a*i-d*l,this._22=n*l-o*i,this._23=o*d-n*a,this._24=0,this._31=d*c-r*i,this._32=s*i-n*c,this._33=n*r-s*d,this._34=0,this._41=-d*c*m+d*l*h+i*r*m-i*a*h-u*r*l+u*a*c,this._42=n*c*m-n*l*h-i*s*m+i*o*h+u*s*l-u*o*c,this._43=-n*r*m+n*a*h+d*s*m-d*o*h-u*s*a+u*o*r,this._44=n*r*l-n*a*c-d*s*l+d*o*c+i*s*a-i*o*r,this._44=1,f=n*this._11+s*this._21+o*this._31,(f<0?-f:f)<1e-10){this.zero();return}t=1/f,this._11*=t,this._12*=t,this._13*=t,this._21*=t,this._22*=t,this._23*=t,this._31*=t,this._32*=t,this._33*=t,this._41*=t,this._42*=t,this._43*=t},initInverse:function(e){var t,n=e._11,s=e._12,o=e._13,i=e._14,v=e._21,l=e._22,r=e._23,c=e._24,a=e._31,d=e._32,u=e._33,h=e._34,m=e._41,f=e._42,p=e._43,g=e._44;if(this._11=l*u*g-l*h*p-d*r*g+d*c*p+f*r*h-f*c*u,this._12=-s*u*g+s*h*p+d*o*g-d*i*p-f*o*h+f*i*u,this._13=s*r*g-s*c*p-l*o*g+l*i*p+f*o*c-f*i*r,this._14=-s*r*h+s*c*u+l*o*h-l*i*u-d*o*c+d*i*r,this._21=-v*u*g+v*h*p+a*r*g-a*c*p-m*r*h+m*c*u,this._22=n*u*g-n*h*p-a*o*g+a*i*p+m*o*h-m*i*u,this._23=-n*r*g+n*c*p+v*o*g-v*i*p-m*o*c+m*i*r,this._24=n*r*h-n*c*u-v*o*h+v*i*u+a*o*c-a*i*r,this._31=v*d*g-v*h*f-a*l*g+a*c*f+m*l*h-m*c*d,this._32=-n*d*g+n*h*f+a*s*g-a*i*f-m*s*h+m*i*d,this._33=n*l*g-n*c*f-v*s*g+v*i*f+m*s*c-m*i*l,this._34=-n*l*h+n*c*d+v*s*h-v*i*d-a*s*c+a*i*l,this._41=-v*d*p+v*u*f+a*l*p-a*r*f-m*l*u+m*r*d,this._42=n*d*p-n*u*f-a*s*p+a*o*f+m*s*u-m*o*d,this._43=-n*l*p+n*r*f+v*s*p-v*o*f-m*s*r+m*o*l,this._44=n*l*u-n*r*d-v*s*u+v*o*d+a*s*r-a*o*l,t=n*this._11+s*this._21+o*this._31+i*this._41,(t<0?-t:t)<1e-10){this.zero();return}t=1/t,this._11*=t,this._12*=t,this._13*=t,this._14*=t,this._21*=t,this._22*=t,this._23*=t,this._24*=t,this._31*=t,this._32*=t,this._33*=t,this._34*=t,this._41*=t,this._42*=t,this._43*=t,this._44*=t},initInverse3x3:function(e){var t,n=e._11,s=e._12,o=e._13,i=e._21,a=e._22,r=e._23,c=e._31,l=e._32,d=e._33;if(this._11=a*d-l*r,this._12=-s*d+l*o,this._13=s*r-a*o,this._21=-i*d+c*r,this._22=n*d-c*o,this._23=-n*r+i*o,this._31=i*l-c*a,this._32=-n*l+c*s,this._33=n*a-i*s,t=n*this._11+s*this._21+o*this._31,(t<0?-t:t)<1e-10){this.zero();return}t=1/t,this._11*=t,this._12*=t,this._13*=t,this._14=0,this._21*=t,this._22*=t,this._23*=t,this._24=0,this._31*=t,this._32*=t,this._33*=t,this._34=0,this._41=0,this._42=0,this._43=0,this._44=1},front:function(){var e,t,i,n=this._11,s=this._12,o=this._13;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),i=new h(n,s,o),e=i,t=e.x*e.x+e.y*e.y+e.z*e.z,t<1e-20?t=0:t=1/Math.sqrt(t),e.x*=t,e.y*=t,e.z*=t,i},right:function(){var e,t,i,n=this._21,s=this._22,o=this._23;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),i=new h(n,s,o),e=i,t=e.x*e.x+e.y*e.y+e.z*e.z,t<1e-20?t=0:t=1/Math.sqrt(t),e.x*=t,e.y*=t,e.z*=t,i},up:function(){var e,t,i,n=this._31,s=this._32,o=this._33;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),i=new h(n,s,o),e=i,t=e.x*e.x+e.y*e.y+e.z*e.z,t<1e-20?t=0:t=1/Math.sqrt(t),e.x*=t,e.y*=t,e.z*=t,i},transpose:function(){var e=this._12;this._12=this._21,this._21=e,e=this._13,this._13=this._31,this._31=e,e=this._14,this._14=this._41,this._41=e,e=this._23,this._23=this._32,this._32=e,e=this._24,this._24=this._42,this._42=e,e=this._34,this._34=this._43,this._43=e},clone:function(){var e=new L;return e._11=this._11,e._12=this._12,e._13=this._13,e._14=this._14,e._21=this._21,e._22=this._22,e._23=this._23,e._24=this._24,e._31=this._31,e._32=this._32,e._33=this._33,e._34=this._34,e._41=this._41,e._42=this._42,e._43=this._43,e._44=this._44,e},load:function(e){this._11=e._11,this._12=e._12,this._13=e._13,this._14=e._14,this._21=e._21,this._22=e._22,this._23=e._23,this._24=e._24,this._31=e._31,this._32=e._32,this._33=e._33,this._34=e._34,this._41=e._41,this._42=e._42,this._43=e._43,this._44=e._44},loadValues:function(e){this._11=e[0],this._12=e[1],this._13=e[2],this._14=e[3],this._21=e[4],this._22=e[5],this._23=e[6],this._24=e[7],this._31=e[8],this._32=e[9],this._33=e[10],this._34=e[11],this._41=e[12],this._42=e[13],this._43=e[14],this._44=e[15]},getFloats:function(){return[this._11,this._12,this._13,this._14,this._21,this._22,this._23,this._24,this._31,this._32,this._33,this._34,this._41,this._42,this._43,this._44]},getDirection:function(){var t,n,s,e=new In;return e.initRotateMatrix(this),e.normalize(),t=1-2*(e.y*e.y+e.z*e.z),n=2*(e.x*e.y+e.z*e.w),s=2*(e.x*e.z-e.y*e.w),s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},getEulerAngles:function(){var o,i,a,r,c,l,d,u,e=this.clone(),t=0,n=0,s=0;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),r=t,c=n,l=s,r=Math.sqrt(this._11*this._11+this._12*this._12+this._13*this._13),c=Math.sqrt(this._21*this._21+this._22*this._22+this._23*this._23),l=Math.sqrt(this._31*this._31+this._32*this._32+this._33*this._33),this._11*(this._22*this._33-this._23*this._32)+this._12*(this._23*this._31-this._21*this._33)+this._13*(this._21*this._32-this._22*this._31)<0&&(r*=-1,c*=-1,l*=-1),e.prependScale(1/r,1/c,1/l),a=Math.sqrt(e._11*e._11+e._12*e._12),a>.01?(t=Math.atan2(e._23,e._33),n=Math.atan2(-e._13,a),s=Math.atan2(e._12,e._11),s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),d=new h(t,n,s),t=Math.atan2(-e._23,-e._33),n=Math.atan2(-e._13,-a),s=Math.atan2(-e._12,-e._11),s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),u=new h(t,n,s),o=d,i=u,o.x*o.x+o.y*o.y+o.z*o.z<i.x*i.x+i.y*i.y+i.z*i.z?d:u):(t=Math.atan2(-e._32,e._22),n=Math.atan2(-e._13,a),s=0,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s))},toString:function(){return`MAT=[
  [ `+x.fmt(this._11)+", "+x.fmt(this._12)+", "+x.fmt(this._13)+", "+x.fmt(this._14)+` ]
  [ `+x.fmt(this._21)+", "+x.fmt(this._22)+", "+x.fmt(this._23)+", "+x.fmt(this._24)+` ]
  [ `+x.fmt(this._31)+", "+x.fmt(this._32)+", "+x.fmt(this._33)+", "+x.fmt(this._34)+` ]
  [ `+x.fmt(this._41)+", "+x.fmt(this._42)+", "+x.fmt(this._43)+", "+x.fmt(this._44)+` ]
]`},colorHue:function(e){if(e==0)return;var o=Math.cos(-e),s=Math.sin(-e),n=(1-o)/3,t=L.tmp;t._11=o+n,t._12=n-.57735026918962576450914878050196*s,t._13=n+.57735026918962576450914878050196*s,t._21=n+.57735026918962576450914878050196*s,t._22=o+n,t._23=n-.57735026918962576450914878050196*s,t._31=n-.57735026918962576450914878050196*s,t._32=n+.57735026918962576450914878050196*s,t._33=o+n,t._34=0,t._41=0,t._42=0,t._43=0,this.multiply3x4(this,t)},colorSaturate:function(e){++e;var n=1-e,s=n*.212671,o=n*.71516,i=n*.072169,t=L.tmp;t._11=s+e,t._12=s,t._13=s,t._21=o,t._22=o+e,t._23=o,t._31=i,t._32=i,t._33=i+e,t._41=0,t._42=0,t._43=0,this.multiply3x4(this,t)},colorContrast:function(e){var t=L.tmp,n=e+1;t._11=n,t._12=0,t._13=0,t._21=0,t._22=n,t._23=0,t._31=0,t._32=0,t._33=n,t._41=-e*.5,t._42=-e*.5,t._43=-e*.5,this.multiply3x4(this,t)},colorLightness:function(e){this._41+=e,this._42+=e,this._43+=e},colorGain:function(e,t){var n=L.tmp;n._11=1-t,n._12=0,n._13=0,n._21=0,n._22=1-t,n._23=0,n._31=0,n._32=0,n._33=1-t,n._41=(e>>16&255)/255*t,n._42=(e>>8&255)/255*t,n._43=(e&255)/255*t,this.multiply3x4(this,n)},colorBits:function(e,t){var s,o,f,p,g,v,b,j,y,_,w,O,x,C,i=0,a=0,r=0,c=0,l=0,d=0,u=0,h=0,m=0,n=e;(n&1)==1&&(i=1),n>>=1,(n&1)==1&&(a=1),n>>=1,(n&1)==1&&(r=1),n>>=1,(n&1)==1&&(c=1),n>>=1,(n&1)==1&&(l=1),n>>=1,(n&1)==1&&(d=1),n>>=1,(n&1)==1&&(u=1),n>>=1,(n&1)==1&&(h=1),n>>=1,(n&1)==1&&(m=1),n>>=1,g=i+c+u,p=a+l+h,f=r+d+m,g>1&&(i/=g,c/=g,u/=g),p>1&&(a/=p,l/=p,h/=p),f>1&&(r/=f,d/=f,m/=f),v=this._11*i+this._12*c+this._13*u,b=this._11*a+this._12*l+this._13*h,j=this._11*r+this._12*d+this._13*m,y=this._21*i+this._22*c+this._23*u,_=this._21*a+this._22*l+this._23*h,w=this._21*r+this._22*d+this._23*m,O=this._31*i+this._32*c+this._33*u,x=this._31*a+this._32*l+this._33*h,C=this._31*r+this._32*d+this._33*m,s=t,o=1-s,this._11=this._11*o+v*s,this._12=this._12*o+b*s,this._13=this._13*o+j*s,this._21=this._21*o+y*s,this._22=this._22*o+_*s,this._23=this._23*o+w*s,this._31=this._31*o+O*s,this._32=this._32*o+x*s,this._33=this._33*o+C*s},colorAdd:function(e){this._41+=(e>>16&255)/255,this._42+=(e>>8&255)/255,this._43+=(e&255)/255},colorSet:function(e,t){t==null&&(t=1),this.zero(),this._44=t,this._41+=(e>>16&255)/255,this._42+=(e>>8&255)/255,this._43+=(e&255)/255},adjustColor:function(e){e.hue!=null&&this.colorHue(e.hue),e.saturation!=null&&this.colorSaturate(e.saturation),e.contrast!=null&&this.colorContrast(e.contrast),e.lightness!=null&&this.colorLightness(e.lightness),e.gain!=null&&this.colorGain(e.gain.color,e.gain.alpha)},toMatrix2D:function(e){return e==null&&(e=new Cs),e.a=this._11,e.b=this._12,e.c=this._21,e.d=this._22,e.x=this._41,e.y=this._42,e},decomposeMatrix:function(e){this.load(e);var t,n,s,o,i,a,r,c,l,u,d=0,m=0,h=0;h==null&&(h=0),m==null&&(m=0),d==null&&(d=0),r=d,c=m,l=h,r=Math.sqrt(this._11*this._11+this._12*this._12+this._13*this._13),c=Math.sqrt(this._21*this._21+this._22*this._22+this._23*this._23),l=Math.sqrt(this._31*this._31+this._32*this._32+this._33*this._33),this._11*(this._22*this._33-this._23*this._32)+this._12*(this._23*this._31-this._21*this._33)+this._13*(this._21*this._32-this._22*this._31)<0&&(r*=-1,c*=-1,l*=-1),this.prependScale(1/r,1/c,1/l),o=0,i=0,a=0,s=1,u=this._11+this._22+this._33,u>0?(n=Math.sqrt(u+1)*2,t=1/n,o=(this._23-this._32)*t,i=(this._31-this._13)*t,a=(this._12-this._21)*t,s=.25*n):this._11>this._22&&this._11>this._33?(n=Math.sqrt(1+this._11-this._22-this._33)*2,t=1/n,o=.25*n,i=(this._21+this._12)*t,a=(this._31+this._13)*t,s=(this._23-this._32)*t):this._22>this._33?(n=Math.sqrt(1+this._22-this._11-this._33)*2,t=1/n,o=(this._21+this._12)*t,i=.25*n,a=(this._32+this._23)*t,s=(this._31-this._13)*t):(n=Math.sqrt(1+this._33-this._11-this._22)*2,t=1/n,o=(this._31+this._13)*t,i=(this._32+this._23)*t,a=.25*n,s=(this._12-this._21)*t),this._11=r,this._12=o,this._13=i,this._14=0,this._21=a,this._22=c,this._23=s,this._24=0,this._31=0,this._32=0,this._33=l,this._34=0,this._41=e._41,this._42=e._42,this._43=e._43,this._44=1},recomposeMatrix:function(e){var t,n,s,o,i,r,c,l,d,h,m,f,p,v,g=e._11,M=e._12,S=e._13,k=e._14,F=e._21,u=e._22,T=e._23,E=e._24,D=e._31,A=e._32,_=e._33,w=e._34,O=e._41,x=e._42,C=e._43,z=e._44,a=e._12,b=e._13,j=e._21,y=e._23;y==null&&(y=1),j==null&&(j=0),b==null&&(b=0),a==null&&(a=0),n=a,o=b,s=j,i=y,t=this,t==null&&(t=new L),v=n*n,p=n*o,r=n*s,f=n*i,m=o*o,h=o*s,d=o*i,l=s*s,c=s*i,t._11=1-2*(m+l),t._12=2*(p+c),t._13=2*(r-d),t._14=0,t._21=2*(p-c),t._22=1-2*(v+l),t._23=2*(h+f),t._24=0,t._31=2*(r+d),t._32=2*(h-f),t._33=1-2*(v+m),t._34=0,t._41=0,t._42=0,t._43=0,t._44=1,this._11*=g,this._12*=g,this._13*=g,this._21*=u,this._22*=u,this._23*=u,this._31*=_,this._32*=_,this._33*=_,this._41=O,this._42=x,this._43=C,this._14=k,this._24=E,this._34=w},__class__:L},Be={},Be._new=function(){return new L},Be.multiplied=function(e,t){var n=new L;return n.multiply(e,t),n},Be.I=function(){var e=new L;return e.identity(),e},Be.L=function(e){var t=new L;return t.loadValues(e),t},Be.T=function(e,t,n){n==null&&(n=0),t==null&&(t=0),e==null&&(e=0);var s=new L;return s.initTranslation(e,t,n),s},Be.R=function(e,t,n){var s=new L;return s.initRotation(e,t,n),s},Be.S=function(e,t,n){n==null&&(n=1),t==null&&(t=1),e==null&&(e=1);var s=new L;return s.initScale(e,t,n),s},Be.lookAtXInline=function(e,t,n){var o,i,a,r,c,l,u,h,m,f,p,g,v,b,j,s=e,d=s.x*s.x+s.y*s.y+s.z*s.z;return d<1e-20?d=0:d=1/Math.sqrt(d),o=s.x*d,i=s.y*d,a=s.z*d,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,c=i,l=a,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),g=r,f=c,p=l,s=t,o=s.y*p-s.z*f,i=s.z*g-s.x*p,a=s.x*f-s.y*g,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,c=i,l=a,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),h=r,u=c,m=l,d=h*h+u*u+m*m,d<1e-20?d=0:d=1/Math.sqrt(d),o=h*d,i=u*d,a=m*d,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,c=i,l=a,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),h=r,u=c,m=l,h*h+u*u+m*m<1e-20&&(h=f,u=p,m=g),o=f*m-p*u,i=p*h-g*m,a=g*u-f*h,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,c=i,l=a,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),v=r,b=c,j=l,n._11=g,n._12=f,n._13=p,n._14=0,n._21=h,n._22=u,n._23=m,n._24=0,n._31=v,n._32=b,n._33=j,n._34=0,n._41=0,n._42=0,n._43=0,n._44=1,n},Be.lookAtX=function(e,t,n){if(t==null){var a,r,c,l,d,u,m,f,p,g,v,b,j,y,s=0,o=0,i=1;i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),t=new h(s,o,i)}return n==null&&(n=new L),a=e,r=a.x*a.x+a.y*a.y+a.z*a.z,r<1e-20?r=0:r=1/Math.sqrt(r),s=a.x*r,o=a.y*r,i=a.z*r,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),c=s,l=o,d=i,d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),v=c,p=l,g=d,a=t,s=a.y*g-a.z*p,o=a.z*v-a.x*g,i=a.x*p-a.y*v,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),c=s,l=o,d=i,d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),m=c,u=l,f=d,r=m*m+u*u+f*f,r<1e-20?r=0:r=1/Math.sqrt(r),s=m*r,o=u*r,i=f*r,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),c=s,l=o,d=i,d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),m=c,u=l,f=d,m*m+u*u+f*f<1e-20&&(m=p,u=g,f=v),s=p*f-g*u,o=g*m-v*f,i=v*u-p*m,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),c=s,l=o,d=i,d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),b=c,j=l,y=d,n._11=v,n._12=p,n._13=g,n._14=0,n._21=m,n._22=u,n._23=f,n._24=0,n._31=b,n._32=j,n._33=y,n._34=0,n._41=0,n._42=0,n._43=0,n._44=1,n},In=function(e,t,n,s){s==null&&(s=1),n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t,this.z=n,this.w=s},c["h3d.Quat"]=In,In.__name__="h3d.Quat",In.prototype={set:function(e,t,n,s){this.x=e,this.y=t,this.z=n,this.w=s},identity:function(){this.x=this.y=this.z=0,this.w=1},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},load:function(e){this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w},clone:function(){return new In(this.x,this.y,this.z,this.w)},initMoveTo:function(e,t){var n=e.x+t.x,s=e.y+t.y,o=e.z+t.z;this.x=e.y*o-e.z*s,this.y=e.z*n-e.x*o,this.z=e.x*s-e.y*n,this.w=e.x*n+e.y*s+e.z*o,this.normalize()},initNormal:function(e,t){t==null&&(t=0);var n,s,o,i,a,r,d,u,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,l=e,c=l.x*l.x+l.y*l.y+l.z*l.z;c<1e-20?c=0:c=1/Math.sqrt(c),n=l.x*c,s=l.y*c,o=l.z*c,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),i=n,a=s,r=o,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),d=i,u=a,m=r,d*d+u*u<1e-20?(n=1,s=0,o=0,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),this.initDirection(new h(n,s,o))):(n=d,s=u,o=0,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),i=n,a=s,r=o,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),p=i,f=a,g=r,c=p*p+f*f+g*g,c<1e-20?c=0:c=1/Math.sqrt(c),n=p*c,s=f*c,o=g*c,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),i=n,a=s,r=o,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),_=i,b=a,j=r,n=u*j-m*b,s=m*_-d*j,o=d*b-u*_,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),i=n,a=s,r=o,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),y=i,v=a,w=r,n=u*w-m*v,s=m*y-d*w,o=d*v-u*y,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),i=n,a=s,r=o,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),C=i,E=a,k=r,n=C,s=E,o=k,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),O=new h(n,s,o),m<0?(n=0,s=0,o=-1,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),this.initDirection(O,new h(n,s,o))):this.initDirection(O)),t!=0&&(x=new In,x.initRotateAxis(d,u,m,t),this.multiply(x,this))},initDirection:function(e,t){var n,s,o,c,l,d,u,h,m,f,p,g,b,j,y,_,w,O,x,v=e,i=v.x,a=v.y,r=v.z;r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),c=n,h=s,m=o,l=c*c+h*h+m*m,l<1e-20?l=0:l=1/Math.sqrt(l),i=c*l,a=h*l,r=m*l,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),c=n,h=s,m=o,i=-h,a=c,r=0,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),f=n,d=s,p=o,t!=null&&(v=t,i=v.y*m-v.z*h,a=v.z*c-v.x*m,r=v.x*h-v.y*c,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),x=n,O=s,w=o,f=x,d=O,p=w),l=f*f+d*d+p*p,l<1e-20?l=0:l=1/Math.sqrt(l),f*=l,d*=l,p*=l,f*f+d*d+p*p<1e-20&&(f=h,d=m,p=c),i=h*p-m*d,a=m*f-c*p,r=c*d-h*f,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),j=n,y=s,b=o,_=c+d+b,_>0?(g=Math.sqrt(_+1)*2,u=1/g,this.x=(p-y)*u,this.y=(j-m)*u,this.z=(h-f)*u,this.w=.25*g):c>d&&c>b?(g=Math.sqrt(1+c-d-b)*2,u=1/g,this.x=.25*g,this.y=(f+h)*u,this.z=(j+m)*u,this.w=(p-y)*u):d>b?(g=Math.sqrt(1+d-c-b)*2,u=1/g,this.x=(f+h)*u,this.y=.25*g,this.z=(y+p)*u,this.w=(j-m)*u):(g=Math.sqrt(1+b-c-d)*2,u=1/g,this.x=(j+m)*u,this.y=(y+p)*u,this.z=.25*g,this.w=(h-f)*u)},initRotateAxis:function(e,t,n,s){var o=Math.sin(s/2),i=Math.cos(s/2);this.x=e*o,this.y=t*o,this.z=n*o,this.w=i*Math.sqrt(e*e+t*t+n*n),this.normalize()},initRotateMatrix:function(e){var t,n,s=e._11+e._22+e._33;s>0?(n=Math.sqrt(s+1)*2,t=1/n,this.x=(e._23-e._32)*t,this.y=(e._31-e._13)*t,this.z=(e._12-e._21)*t,this.w=.25*n):e._11>e._22&&e._11>e._33?(n=Math.sqrt(1+e._11-e._22-e._33)*2,t=1/n,this.x=.25*n,this.y=(e._21+e._12)*t,this.z=(e._31+e._13)*t,this.w=(e._23-e._32)*t):e._22>e._33?(n=Math.sqrt(1+e._22-e._11-e._33)*2,t=1/n,this.x=(e._21+e._12)*t,this.y=.25*n,this.z=(e._32+e._23)*t,this.w=(e._31-e._13)*t):(n=Math.sqrt(1+e._33-e._11-e._22)*2,t=1/n,this.x=(e._31+e._13)*t,this.y=(e._32+e._23)*t,this.z=.25*n,this.w=(e._12-e._21)*t)},normalize:function(){var e,t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;t<1e-20?(this.x=this.y=this.z=0,this.w=1):(e=1/Math.sqrt(t),this.x*=e,this.y*=e,this.z*=e,this.w*=e)},initRotation:function(e,t,n){var s=Math.sin(e*.5),o=Math.cos(e*.5),i=Math.sin(t*.5),a=Math.cos(t*.5),r=Math.sin(n*.5),c=Math.cos(n*.5),l=a*c,d=i*r;this.x=s*l-o*d,this.y=o*i*c+s*a*r,this.z=o*a*r-s*i*c,this.w=o*l+s*d},multiply:function(e,t){var n=e.x*t.w+e.w*t.x+e.y*t.z-e.z*t.y,s=e.w*t.y-e.x*t.z+e.y*t.w+e.z*t.x,o=e.w*t.z+e.x*t.y-e.y*t.x+e.z*t.w,i=e.w*t.w-e.x*t.x-e.y*t.y-e.z*t.z;this.x=n,this.y=s,this.z=o,this.w=i},toEuler:function(){return this.toMatrix().getEulerAngles()},lerp:function(e,t,n,s){s==null&&(s=!1);var i,a,r,c,o=1-n;s&&e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w<0&&(n=-n),i=e.x*o+t.x*n,a=e.y*o+t.y*n,r=e.z*o+t.z*n,c=e.w*o+t.w*n,this.x=i,this.y=a,this.z=r,this.w=c},slerp:function(e,t,n){var s,o,a,r,c,l,d,p,i=e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w,f=t.x,m=t.y,h=t.z,u=t.w;u==null&&(u=1),h==null&&(h=0),m==null&&(m=0),f==null&&(f=0),r=f,a=m,c=h,l=u,i<0&&(i=-i,r=-r,a=-a,c=-c,l=-l),1-i>1e-4?(d=Math.acos(i),p=Math.sin(d),o=Math.sin((1-n)*d)/p,s=Math.sin(n*d)/p):(o=1-n,s=n),this.x=o*e.x+s*r,this.y=o*e.y+s*a,this.z=o*e.z+s*c,this.w=o*e.w+s*l},conjugate:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},pow:function(e){var n,o,t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),s=t>1e-10?Math.atan2(t,this.w)/t:0;this.w=.5*Math.log(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z),this.x*=s,this.y*=s,this.z*=s,this.x*=e,this.y*=e,this.z*=e,this.w*=e,t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),o=Math.exp(this.w),n=t>1e-10?o*Math.sin(t)/t:0,this.w=o*Math.cos(t),this.x*=n,this.y*=n,this.z*=n},negate:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},getDirection:function(){var e=1-2*(this.y*this.y+this.z*this.z),t=2*(this.x*this.y+this.z*this.w),n=2*(this.x*this.z-this.y*this.w);return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},getUpAxis:function(){var e=2*(this.x*this.z+this.y*this.w),t=2*(this.y*this.z-this.x*this.w),n=1-2*(this.x*this.x+this.y*this.y);return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},toMatrix:function(e){e==null&&(e=new L);var t=this.x*this.x,n=this.x*this.y,s=this.x*this.z,o=this.x*this.w,i=this.y*this.y,a=this.y*this.z,r=this.y*this.w,c=this.z*this.z,l=this.z*this.w;return e._11=1-2*(i+c),e._12=2*(n+l),e._13=2*(s-r),e._14=0,e._21=2*(n-l),e._22=1-2*(t+c),e._23=2*(a+o),e._24=0,e._31=2*(s+r),e._32=2*(a-o),e._33=1-2*(t+i),e._34=0,e._41=0,e._42=0,e._43=0,e._44=1,e},toString:function(){return"{"+x.fmt(this.x)+","+x.fmt(this.y)+","+x.fmt(this.z)+","+x.fmt(this.w)+"}"},weightedBlend:function(e,t,n){this.x=0,this.y=0,this.z=0,this.w=0;var s,o,i,a,c,u,h,f,p,g,v,b,w,O,C,E,k,m=0,l=0,d=0,r=1,x=n.x,j=n.y,y=n.z,_=n.w;for(_==null&&(_=1),y==null&&(y=0),j==null&&(j=0),x==null&&(x=0),o=x,i=j,a=y,c=_,o=-o,i=-i,a=-a,f=0,w=e;f<w.length;)k=w[f],E=f++,C=E,s=k,h=t[C],p=o*s.w+c*s.x+i*s.z-a*s.y,b=c*s.y-o*s.z+i*s.w+a*s.x,v=c*s.z+o*s.y-i*s.x+a*s.w,g=c*s.w-o*s.x-i*s.y-a*s.z,m=p,l=b,d=v,r=g,r<0&&(m=-m,l=-l,d=-d,r=-r),r*=h,m*=h,l*=h,d*=h,this.w+=r,this.x+=m,this.y+=l,this.z+=d;O=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w,O<1e-20?(this.x=this.y=this.z=0,this.w=1):(u=1/Math.sqrt(O),this.x*=u,this.y*=u,this.z*=u,this.w*=u),p=n.x*this.w+n.w*this.x+n.y*this.z-n.z*this.y,b=n.w*this.y-n.x*this.z+n.y*this.w+n.z*this.x,v=n.w*this.z+n.x*this.y-n.y*this.x+n.z*this.w,g=n.w*this.w-n.x*this.x-n.y*this.y-n.z*this.z,this.x=p,this.y=b,this.z=v,this.w=g,this.w<0&&(this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w)},__class__:In},h=function(e,t,n){n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t,this.z=n},c["h3d.VectorImpl"]=h,h.__name__="h3d.VectorImpl",h.prototype={distance:function(e){var t=e.x-this.x,n=e.y-this.y,s=e.z-this.z;return Math.sqrt(t*t+n*n+s*s)},distanceSq:function(e){var t=e.x-this.x,n=e.y-this.y,s=e.z-this.z;return t*t+n*n+s*s},sub:function(e){var t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},add:function(e){var t=this.x+e.x,n=this.y+e.y,s=this.z+e.z;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},scaled:function(e){var t=this.x*e,n=this.y*e,s=this.z*e;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},equals:function(e){return this.x==e.x&&this.y==e.y&&this.z==e.z},cross:function(e){var t=this.y*e.z-this.z*e.y,n=this.z*e.x-this.x*e.z,s=this.x*e.y-this.y*e.x;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=this.x*this.x+this.y*this.y+this.z*this.z;e<1e-20?e=0:e=1/Math.sqrt(e),this.x*=e,this.y*=e,this.z*=e},normalized:function(){var t,n,s,e=this.x*this.x+this.y*this.y+this.z*this.z;return e<1e-20?e=0:e=1/Math.sqrt(e),t=this.x*e,n=this.y*e,s=this.z*e,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},packNormal:function(){this.x=this.x*.5+.5,this.y=this.y*.5+.5,this.z=this.z*.5+.5},unpackNormal:function(){this.x=this.x*2-1,this.y=this.y*2-1,this.z=this.z*2-1},normalStrength:function(e){var t=1/e;this.x*=t,this.y*=t,t=this.x*this.x+this.y*this.y+this.z*this.z,t<1e-20?t=0:t=1/Math.sqrt(t),this.x*=t,this.y*=t,this.z*=t},set:function(e,t,n){n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t,this.z=n},load:function(e){this.x=e.x,this.y=e.y,this.z=e.z},scale:function(e){this.x*=e,this.y*=e,this.z*=e},lerp:function(e,t,n){var s=e.x;this.x=s+n*(t.x-s),s=e.y,this.y=s+n*(t.y-s),s=e.z,this.z=s+n*(t.z-s)},transform:function(e){var t=this.x*e._11+this.y*e._21+this.z*e._31+e._41,n=this.x*e._12+this.y*e._22+this.z*e._32+e._42,s=this.x*e._13+this.y*e._23+this.z*e._33+e._43;this.x=t,this.y=n,this.z=s},transformed:function(e){var o=this.x*e._11+this.y*e._21+this.z*e._31+e._41,i=this.x*e._12+this.y*e._22+this.z*e._32+e._42,a=this.x*e._13+this.y*e._23+this.z*e._33+e._43,t=o,n=i,s=a;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},transform3x3:function(e){var t=this.x*e._11+this.y*e._21+this.z*e._31,n=this.x*e._12+this.y*e._22+this.z*e._32,s=this.x*e._13+this.y*e._23+this.z*e._33;this.x=t,this.y=n,this.z=s},transformed3x3:function(e){var o=this.x*e._11+this.y*e._21+this.z*e._31,i=this.x*e._12+this.y*e._22+this.z*e._32,a=this.x*e._13+this.y*e._23+this.z*e._33,t=o,n=i,s=a;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},clone:function(){var e=this.x,t=this.y,n=this.z;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},toVector4:function(){var e=this.x,t=this.y,n=this.z;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new j(e,t,n,1)},to2D:function(){var e=this.x,t=this.y;return t==null&&(t=0),e==null&&(e=0),new U(e,t)},toString:function(){return"{"+x.fmt(this.x)+","+x.fmt(this.y)+","+x.fmt(this.z)+"}"},reflect:function(e){var t=2*(this.x*e.x+this.y*e.y+this.z*e.z),n=this.x-t*e.x,s=this.y-t*e.y,o=this.z-t*e.z;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),new h(n,s,o)},project:function(e){var n=this.x*e._11+this.y*e._21+this.z*e._31+e._41,s=this.x*e._12+this.y*e._22+this.z*e._32+e._42,o=this.x*e._13+this.y*e._23+this.z*e._33+e._43,t=1/(this.x*e._14+this.y*e._24+this.z*e._34+e._44);this.x=n*t,this.y=s*t,this.z=o*t},get_r:function(){return this.x},get_g:function(){return this.y},get_b:function(){return this.z},set_r:function(e){return this.x=e},set_g:function(e){return this.y=e},set_b:function(e){return this.z=e},setColor:function(e){this.x=(e>>16&255)/255,this.y=(e>>8&255)/255,this.z=(e&255)/255},makeColor:function(e,t,n){n==null&&(n=.5),t==null&&(t=1);var s,o,i,a,r=e%6.2831853071795862;e=r>=0?r:r+6.2831853071795862,o=2*n-1,s=(1-(o<0?-o:o))*t,o=e*3/3.14159265358979323%2-1,i=s*(1-(o<0?-o:o)),a=n-s/2,e<1.0471975511965976?(this.x=s,this.y=i,this.z=0):e<2.0943951023931953?(this.x=i,this.y=s,this.z=0):e<3.14159265358979323?(this.x=0,this.y=s,this.z=i):e<4.1887902047863905?(this.x=0,this.y=i,this.z=s):e<5.2359877559829888?(this.x=i,this.y=0,this.z=s):(this.x=s,this.y=0,this.z=i),this.x+=a,this.y+=a,this.z+=a},toColor:function(){var e=this.x,t=this.y,n=this.z;return-16777216|((e<0?0:e>1?1:e)*255+.499|0)<<16|((t<0?0:t>1?1:t)*255+.499|0)<<8|((n<0?0:n>1?1:n)*255+.499|0)},toColorHSL:function(){var n,s,r,c,l,d,o=this.x,e=this.y,i=o<e?e:o,e=this.z,t=i<e?e:i,o=this.x,e=this.y,i=o>e?e:o,e=this.z,a=i>e?e:i,u=(t+a)/2;return t==a?(r=0,n=r):(s=t-a,r=u>.5?s/(2-t-a):s/(t+a),t==this.x?n=(this.y-this.z)/s+(this.y<this.z?6:0):t==this.y?n=(this.z-this.x)/s+2:n=(this.x-this.y)/s+4,n*=1.0471975511965976),c=n,l=r,d=u,d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),new h(c,l,d)},toColorHSV:function(){var n,s,r,c,l,d,o=this.x,e=this.y,i=o<e?e:o,e=this.z,t=i<e?e:i,o=this.x,e=this.y,i=o>e?e:o,e=this.z,a=i>e?e:i,u=t;return t==a?(r=0,n=r):(s=t-a,r=t+a>1?s/(2-t-a):s/(t+a),t==this.x?n=(this.y-this.z)/s+(this.y<this.z?6:0):t==this.y?n=(this.z-this.x)/s+2:n=(this.x-this.y)/s+4,n*=1.0471975511965976),c=n,l=r,d=u,d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),new h(c,l,d)},__class__:h},ss={},ss._new=function(e,t,n){return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},ss.sub=function(e,t){var n=e.x-t.x,s=e.y-t.y,o=e.z-t.z;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),new h(n,s,o)},ss.add=function(e,t){var n=e.x+t.x,s=e.y+t.y,o=e.z+t.z;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),new h(n,s,o)},ss.transform=function(e,t){var n=e.x*t._11+e.y*t._21+e.z*t._31+t._41,s=e.x*t._12+e.y*t._22+e.z*t._32+t._42,o=e.x*t._13+e.y*t._23+e.z*t._33+t._43;e.x=n,e.y=s,e.z=o},ss.transformed=function(e,t){var i=e.x*t._11+e.y*t._21+e.z*t._31+t._41,a=e.x*t._12+e.y*t._22+e.z*t._32+t._42,r=e.x*t._13+e.y*t._23+e.z*t._33+t._43,n=i,s=a,o=r;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),new h(n,s,o)},ss.toPoint=function(e){var t=e.x,n=e.y,s=e.z;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},ss.toVector=function(e){var t=e.x,n=e.y,s=e.z;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},ss.scale=function(e,t){e.x*=t,e.y*=t,e.z*=t},ss.scaled=function(e,t){var n=e.x*t,s=e.y*t,o=e.z*t;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),new h(n,s,o)},ss.scaledInv=function(e,t){var n=t.x*e,s=t.y*e,o=t.z*e;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),new h(n,s,o)},ss.fromColor=function(e,t){t==null&&(t=1);var n=t/255,s=(e>>16&255)*n,o=(e>>8&255)*n,i=(e&255)*n;return i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),new h(s,o,i)},ss.fromArray=function(e){var t=new h(0,0,0);return e.length>0&&(t.x=e[0]),e.length>1&&(t.y=e[1]),e.length>2&&(t.z=e[2]),t},j=function(e,t,n,s){s==null&&(s=1),n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t,this.z=n,this.w=s},c["h3d.Vector4Impl"]=j,j.__name__="h3d.Vector4Impl",j.prototype={dot4:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},dot3:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},scale3:function(e){this.x*=e,this.y*=e,this.z*=e},scale4:function(e){this.x*=e,this.y*=e,this.z*=e,this.w*=e},sub:function(e){var t=this.x-e.x,n=this.y-e.y,s=this.z-e.z,o=this.w-e.w;return o==null&&(o=1),s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new j(t,n,s,o)},add:function(e){var t=this.x+e.x,n=this.y+e.y,s=this.z+e.z,o=this.w+e.w;return o==null&&(o=1),s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new j(t,n,s,o)},equals:function(e){return this.x==e.x&&this.y==e.y&&this.z==e.z&&this.w==e.w},cross:function(e){var t=this.y*e.z-this.z*e.y,n=this.z*e.x-this.x*e.z,s=this.x*e.y-this.y*e.x,o=1;return o==null&&(o=1),s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new j(t,n,s,o)},set:function(e,t,n,s){s==null&&(s=1),n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t,this.z=n,this.w=s},load:function(e){this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w},lerp:function(e,t,n){var s=e.x;this.x=s+n*(t.x-s),s=e.y,this.y=s+n*(t.y-s),s=e.z,this.z=s+n*(t.z-s),s=e.w,this.w=s+n*(t.w-s)},transform:function(e){var t=this.x*e._11+this.y*e._21+this.z*e._31+this.w*e._41,n=this.x*e._12+this.y*e._22+this.z*e._32+this.w*e._42,s=this.x*e._13+this.y*e._23+this.z*e._33+this.w*e._43,o=this.x*e._14+this.y*e._24+this.z*e._34+this.w*e._44;this.x=t,this.y=n,this.z=s,this.w=o},transformed:function(e){var i=this.x*e._11+this.y*e._21+this.z*e._31+this.w*e._41,a=this.x*e._12+this.y*e._22+this.z*e._32+this.w*e._42,r=this.x*e._13+this.y*e._23+this.z*e._33+this.w*e._43,c=this.x*e._14+this.y*e._24+this.z*e._34+this.w*e._44,t=i,n=a,s=r,o=c;return o==null&&(o=1),s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new j(t,n,s,o)},transform3x4:function(e){var t=this.x*e._11+this.y*e._21+this.z*e._31+this.w*e._41,n=this.x*e._12+this.y*e._22+this.z*e._32+this.w*e._42,s=this.x*e._13+this.y*e._23+this.z*e._33+this.w*e._43;this.x=t,this.y=n,this.z=s},transformed3x4:function(e){var o=this.x*e._11+this.y*e._21+this.z*e._31+this.w*e._41,i=this.x*e._12+this.y*e._22+this.z*e._32+this.w*e._42,a=this.x*e._13+this.y*e._23+this.z*e._33+this.w*e._43,t=o,n=i,s=a;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new j(t,n,s,1)},transform3x3:function(e){var t=this.x*e._11+this.y*e._21+this.z*e._31,n=this.x*e._12+this.y*e._22+this.z*e._32,s=this.x*e._13+this.y*e._23+this.z*e._33;this.x=t,this.y=n,this.z=s},transformed3x3:function(e){var o=this.x*e._11+this.y*e._21+this.z*e._31,i=this.x*e._12+this.y*e._22+this.z*e._32,a=this.x*e._13+this.y*e._23+this.z*e._33,t=o,n=i,s=a;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new j(t,n,s,1)},clone:function(){var e=this.x,t=this.y,n=this.z,s=this.w;return s==null&&(s=1),n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new j(e,t,n,s)},toVector:function(){var e=this.x,t=this.y,n=this.z;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},toString:function(){return"{"+x.fmt(this.x)+","+x.fmt(this.y)+","+x.fmt(this.z)+","+x.fmt(this.w)+"}"},project:function(e){var n=this.x*e._11+this.y*e._21+this.z*e._31+this.w*e._41,s=this.x*e._12+this.y*e._22+this.z*e._32+this.w*e._42,o=this.x*e._13+this.y*e._23+this.z*e._33+this.w*e._43,t=1/(this.x*e._14+this.y*e._24+this.z*e._34+this.w*e._44);this.x=n*t,this.y=s*t,this.z=o*t,this.w=1},get_r:function(){return this.x},get_g:function(){return this.y},get_b:function(){return this.z},get_a:function(){return this.w},set_r:function(e){return this.x=e},set_g:function(e){return this.y=e},set_b:function(e){return this.z=e},set_a:function(e){return this.w=e},setColor:function(e){this.x=(e>>16&255)/255,this.y=(e>>8&255)/255,this.z=(e&255)/255,this.w=(e>>>24)/255},makeColor:function(e,t,n){n==null&&(n=.5),t==null&&(t=1);var s,o,i,a,r=e%6.2831853071795862;e=r>=0?r:r+6.2831853071795862,o=2*n-1,s=(1-(o<0?-o:o))*t,o=e*3/3.14159265358979323%2-1,i=s*(1-(o<0?-o:o)),a=n-s/2,e<1.0471975511965976?(this.x=s,this.y=i,this.z=0):e<2.0943951023931953?(this.x=i,this.y=s,this.z=0):e<3.14159265358979323?(this.x=0,this.y=s,this.z=i):e<4.1887902047863905?(this.x=0,this.y=i,this.z=s):e<5.2359877559829888?(this.x=i,this.y=0,this.z=s):(this.x=s,this.y=0,this.z=i),this.x+=a,this.y+=a,this.z+=a,this.w=1},toColor:function(){var e=this.w,t=this.x,n=this.y,s=this.z;return((e<0?0:e>1?1:e)*255+.499|0)<<24|((t<0?0:t>1?1:t)*255+.499|0)<<16|((n<0?0:n>1?1:n)*255+.499|0)<<8|((s<0?0:s>1?1:s)*255+.499|0)},toColorHSL:function(){var n,s,r,c,l,d,u,a=this.x,e=this.y,o=a<e?e:a,e=this.z,t=o<e?e:o,a=this.x,e=this.y,o=a>e?e:a,e=this.z,i=o>e?e:o,h=(t+i)/2;return t==i?(r=0,s=r):(n=t-i,r=h>.5?n/(2-t-i):n/(t+i),t==this.x?s=(this.y-this.z)/n+(this.y<this.z?6:0):t==this.y?s=(this.z-this.x)/n+2:s=(this.x-this.y)/n+4,s*=1.0471975511965976),c=s,l=r,d=h,u=this.w,u==null&&(u=1),d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),new j(c,l,d,u)},toColorHSV:function(){var n,s,r,c,l,d,u,a=this.x,e=this.y,o=a<e?e:a,e=this.z,t=o<e?e:o,a=this.x,e=this.y,o=a>e?e:a,e=this.z,i=o>e?e:o,h=t;return t==i?(r=0,s=r):(n=t-i,r=t+i>1?n/(2-t-i):n/(t+i),t==this.x?s=(this.y-this.z)/n+(this.y<this.z?6:0):t==this.y?s=(this.z-this.x)/n+2:s=(this.x-this.y)/n+4,s*=1.0471975511965976),c=s,l=r,d=h,u=this.w,u==null&&(u=1),d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),new j(c,l,d,u)},__class__:j},ki={},ki._new=function(e,t,n,s){return s==null&&(s=1),n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new j(e,t,n,s)},ki.sub=function(e,t){var n=e.x-t.x,s=e.y-t.y,o=e.z-t.z,i=e.w-t.w;return i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),new j(n,s,o,i)},ki.add=function(e,t){var n=e.x+t.x,s=e.y+t.y,o=e.z+t.z,i=e.w+t.w;return i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),new j(n,s,o,i)},ki.transform=function(e,t){var n=e.x*t._11+e.y*t._21+e.z*t._31+e.w*t._41,s=e.x*t._12+e.y*t._22+e.z*t._32+e.w*t._42,o=e.x*t._13+e.y*t._23+e.z*t._33+e.w*t._43,i=e.x*t._14+e.y*t._24+e.z*t._34+e.w*t._44;e.x=n,e.y=s,e.z=o,e.w=i},ki.transformed=function(e,t){var a=e.x*t._11+e.y*t._21+e.z*t._31+e.w*t._41,r=e.x*t._12+e.y*t._22+e.z*t._32+e.w*t._42,c=e.x*t._13+e.y*t._23+e.z*t._33+e.w*t._43,l=e.x*t._14+e.y*t._24+e.z*t._34+e.w*t._44,n=a,s=r,o=c,i=l;return i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),new j(n,s,o,i)},ki.fromColor=function(e,t){t==null&&(t=1);var n=t/255,s=(e>>16&255)*n,o=(e>>8&255)*n,i=(e&255)*n,a=(e>>>24)*n;return a==null&&(a=1),i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),new j(s,o,i,a)},ki.fromArray=function(e){var t=new j(0,0,0,1);return e.length>0&&(t.x=e[0]),e.length>1&&(t.y=e[1]),e.length>2&&(t.z=e[2]),e.length>3&&(t.w=e[3]),t},ws=function(e){this.objectName=e},c["h3d.anim.AnimatedObject"]=ws,ws.__name__="h3d.anim.AnimatedObject",ws.prototype={clone:function(){return new ws(this.objectName)},__class__:ws},Xt=function(e,t,n){this.name=e,this.frameCount=t,this.sampling=n,this.objects=[],this.lastEvent=-1,this.frame=0,this.speed=1,this.loop=!0,this.pause=!1},c["h3d.anim.Animation"]=Xt,Xt.__name__="h3d.anim.Animation",Xt.prototype={getDuration:function(){return this.frameCount/(this.sampling*this.speed)},frameToTime:function(e){return e/(this.sampling*this.speed)},getIFrame:function(){var e=this.frame|0,t=this.endFrame();return e==t&&--e,e},unbind:function(e){for(var t,n=0,s=this.objects;n<s.length;)if(t=s[n],++n,t.objectName==e){this.isSync=!1,t.targetObject=null,t.targetSkin=null;return}},setEvents:function(e){for(var t,n,a,s=[],o=0,i=this.frameCount;o<i;)a=o++,s.push(null);for(this.events=s,n=cl(e);n.hasNext();)t=n.next(),this.events[t.frame]==null&&(this.events[t.frame]=[]),this.events[t.frame].push(t.data)},addEvent:function(e,t){this.events==null&&(this.events=[]),this.events[e]==null?this.events[e]=[t]:this.events[e].push(t)},removeEvent:function(e,n){if(this.events==null||this.events[e]==null||this.events[e].indexOf(n)==-1)throw t.thrown("Can't delete event "+n+" because it doesn't exist at frame "+e);u.remove(this.events[e],n),this.events[e].length==0&&(this.events[e]=null)},getEvents:function(){return this.events},getObjects:function(){return this.objects},getEventTime:function(e){if(this.events==null)return null;for(var t,n,s=0,o=this.events.length;s<o;)if(t=s++,n=this.events[t],n!=null&&n.indexOf(e)>=0)return t/(this.sampling*this.speed);return null},setFrame:function(e){for(this.frame=e,this.lastEvent=-1;this.frame<0;)this.frame+=this.frameCount;for(;this.frame>this.frameCount;)this.frame-=this.frameCount},clone:function(e){return e==null&&(e=new Xt(this.name,this.frameCount,this.sampling)),e.objects=this.objects,e.speed=this.speed,e.loop=this.loop,e.pause=this.pause,e.events=this.events,e.resourcePath=this.resourcePath,e},initInstance:function(){this.isInstance=!0},createInstance:function(e){for(var t,i,s=[],n=0,o=this.objects;n<o.length;)t=o[n],++n,s.push(t.clone());return i=s,t=this.clone(),t.objects=i,t.bind(e),t.initInstance(),t},bind:function(e){for(var t,s,o,a,n=null,i=0,r=this.objects.slice();i<r.length;){if(t=r[i],++i,n!=null&&(a=n.skinData.namedJoints.h[t.objectName],a!=null)){t.targetSkin=n,t.targetJoint=a.index;continue}if(s=e.getObjectByName(t.objectName),s==null){u.remove(this.objects,t);continue}o=s instanceof yi?s:null,o!=null?(n=o.parent,t.targetSkin=n??o.skin,t.targetJoint=o.index):t.targetObject=s}this.isSync=!1},getPropValue:function(){return null},sync:function(e){throw e==null&&(e=!1),t.thrown("assert")},isPlaying:function(){return!this.pause&&(this.speed<0?-this.speed:this.speed)>1e-6},endFrame:function(){return this.frameCount},update:function(e){if(!this.isInstance)throw t.thrown("You must instantiate this animation first");if(!this.isPlaying())return 0;if(this.events!=null&&this.onEvent!=null){var n,s,o,i,r,c,l,d,u,h,m=this.frame|0,a=this.frame+e*this.speed*this.sampling|0;for(a>=this.frameCount&&(a=this.frameCount-1),r=m,l=a+1;r<l;){if(n=r++,n==this.lastEvent)continue;if(this.lastEvent=n,this.events[n]!=null){for(d=this.frame,u=e,e-=(n-this.frame)/(this.speed*this.sampling),this.frame=n,s=0,c=this.events[n];s<c.length;)h=c[s],++s,this.onEvent(h);if(this.frame==n&&n==this.frameCount-1){this.frame=d,e=u;break}return e}}}return this.onAnimEnd!=null&&(o=this.endFrame(),i=this.speed==0?0:(o-this.frame)/(this.speed*this.sampling),i<=e&&i>0)?(this.frame=o,e-=i,this.onAnimEnd(),this.frame==o&&this.isPlaying()&&(this.loop?this.frame=0:e=0),e):(this.frame+=e*this.speed*this.sampling,this.frame>=this.frameCount&&(this.loop?this.frame%=this.frameCount:this.frame=this.frameCount),0)},initAndBind:function(e){this.bind(e),this.initInstance(),this.pause=!0},toString:function(){return this.name},__class__:Xt},ae=_["h3d.anim.DataLayout"]={__ename__:!0,__constructs__:null,Position:{_hx_name:"Position",_hx_index:0,__enum__:"h3d.anim.DataLayout",toString:s},Rotation:{_hx_name:"Rotation",_hx_index:1,__enum__:"h3d.anim.DataLayout",toString:s},Scale:{_hx_name:"Scale",_hx_index:2,__enum__:"h3d.anim.DataLayout",toString:s},UV:{_hx_name:"UV",_hx_index:3,__enum__:"h3d.anim.DataLayout",toString:s},Alpha:{_hx_name:"Alpha",_hx_index:4,__enum__:"h3d.anim.DataLayout",toString:s},Property:{_hx_name:"Property",_hx_index:5,__enum__:"h3d.anim.DataLayout",toString:s},SingleFrame:{_hx_name:"SingleFrame",_hx_index:6,__enum__:"h3d.anim.DataLayout",toString:s}},ae.__constructs__=[ae.Position,ae.Rotation,ae.Scale,ae.UV,ae.Alpha,ae.Property,ae.SingleFrame],ae.__empty_constructs__=[ae.Position,ae.Rotation,ae.Scale,ae.UV,ae.Alpha,ae.Property,ae.SingleFrame],Ai=function(e,t){ws.call(this,e),this.dataOffset=t},c["h3d.anim.BufferObject"]=Ai,Ai.__name__="h3d.anim.BufferObject",Ai.__super__=ws,Ai.prototype=g(ws.prototype,{getStride:function(){var e=0;return(this.layout&1<<ae.Position._hx_index)!=0&&(e+=3),(this.layout&1<<ae.Rotation._hx_index)!=0&&(e+=3),(this.layout&1<<ae.Scale._hx_index)!=0&&(e+=3),(this.layout&1<<ae.UV._hx_index)!=0&&(e+=2),(this.layout&1<<ae.Alpha._hx_index)!=0&&++e,(this.layout&1<<ae.Property._hx_index)!=0&&++e,e},clone:function(){var e=new Ai(this.objectName,this.dataOffset);return e.layout=this.layout,e.propName=this.propName,e},__class__:Ai}),Oi=function(e,t,n){Xt.call(this,e,t,n),this.syncFrame=-1},c["h3d.anim.BufferAnimation"]=Oi,Oi.__name__="h3d.anim.BufferAnimation",Oi.__super__=Xt,Oi.prototype=g(Xt.prototype,{setData:function(e,t){this.data=e,this.stride=t},addObject:function(e,t){var n=new Ai(e,t);return this.objects.push(n),n},getPropValue:function(e,t){for(var n,s=0,o=this.objects;s<o.length;)if(n=o[s],++s,n.objectName==e&&n.propName==t)return n.propCurrentValue;return null},getFrames:function(){return this.objects},clone:function(e){e==null&&(e=new Oi(this.name,this.frameCount,this.sampling)),Xt.prototype.clone.call(this,e);var t=e instanceof Oi?e:null;return t.setData(this.data,this.stride),e},endFrame:function(){return this.loop?this.frameCount:this.frameCount-1},initInstance:function(){Xt.prototype.initInstance.call(this);for(var e,n,s,a,o=this.objects,i=0;i<o.length;){if(e=o[i],++i,(e.layout&1<<ae.Property._hx_index)!=0&&(e.propCurrentValue=this.data[e.dataOffset]),(e.layout&1<<ae.Alpha._hx_index)!=0?e.targetObject!=null?(a=e.targetObject,n=(a instanceof me?a:null)==null):n=!0:n=!1,n)throw t.thrown(e.objectName+" should be a mesh (for alpha animation)");((e.layout&1<<ae.Position._hx_index)!=0||(e.layout&1<<ae.Rotation._hx_index)!=0||(e.layout&1<<ae.Scale._hx_index)!=0)&&(e.matrix=new L,e.matrix.identity(),(e.layout&1<<ae.Position._hx_index)==0&&e.targetSkin!=null&&(s=e.targetSkin.getSkinData().allJoints[e.targetJoint].defMat,e.matrix._14=s._41,e.matrix._24=s._42,e.matrix._34=s._43))}o.sort(b(this,this.sortByFrameCountDesc))},sortByFrameCountDesc:function(e,t){return((t.layout&1<<ae.SingleFrame._hx_index)!=0?0:1)-((e.layout&1<<ae.SingleFrame._hx_index)!=0?0:1)},uvLerp:function(e,t,n){return e%=1,t%=1,e<t-.5?++e:e>t+.5&&--e,e*(1-n)+t*n},sync:function(e){e==null&&(e=!1);var p,ie,s,o,i,a,r,d,h,b,_,ee,O,x,C,D,J,oe,c,l,u,m,T,q,se,t,f,y,E,k,A,M,N,L,R,P,H,I,B,V,$,W,U,G,ne,te,g,v,j,w,S,F,z,K,Y,Q,Z,n=this;if(this.frame==this.syncFrame&&!e)return;for(p=this.frame|0,ie=this.endFrame(),p==ie&&--p,m=p,h=(m+1)%this.frameCount,o=this.frame-m,a=1-o,m<0?(h=0,m=h):this.frame>=this.frameCount?(h=this.frameCount-1,m=h):!this.loop&&h==0&&(h=this.frameCount-1),this.syncFrame=this.frame,e&&(this.isSync=!1),T=0,q=this.objects;T<q.length;){if(r=q[T],++T,r.targetObject==null&&r.targetSkin==null)continue;if(d=r.layout,i=this.stride*m+r.dataOffset,s=this.stride*h+r.dataOffset,se=m,R=h,(d&1<<ae.SingleFrame._hx_index)!=0){if(this.isSync)break;R=0,se=R,s=r.dataOffset,i=s}t=r.matrix,t!=null&&(Q=r.targetSkin,Z=Q!=null?Q.skinData:null,Z!=null&&!Z.allJoints[r.targetJoint].shouldReceiveAnimation()||((d&1<<ae.Position._hx_index)!=0?(t._41=n.data[i++]*a+n.data[s++]*o,t._42=n.data[i++]*a+n.data[s++]*o,t._43=n.data[i++]*a+n.data[s++]*o):(t._41=t._14,t._42=t._24,t._43=t._34),(d&1<<ae.Rotation._hx_index)!=0?(A=this.data[i++],k=this.data[i++],_=this.data[i++],p=1-(A*A+k*k+_*_),ee=Math.sqrt(p<0?-p:p),O=this.data[s++],x=this.data[s++],C=this.data[s++],D=1-(O*O+x*x+C*C),J=Math.sqrt(D<0?-D:D),oe=A*O+k*x+_*C+ee*J,y=oe<0?-o:o,u=A*a+O*y,c=k*a+x*y,l=_*a+C*y,f=ee*a+J*y,E=1/Math.sqrt(u*u+c*c+l*l+f*f),u*=E,c*=E,l*=E,f*=E,e?(t._12=u,t._13=c,t._21=l,t._23=f,(d&1<<ae.Scale._hx_index)!=0?(t._11=n.data[i++]*a+n.data[s++]*o,t._22=n.data[i++]*a+n.data[s++]*o,t._33=n.data[i++]*a+n.data[s++]*o):(t._11=1,t._22=1,t._33=1)):(K=u*u,U=u*c,W=u*l,Y=u*f,H=c*c,I=c*l,B=c*f,V=l*l,$=l*f,t._11=1-2*(H+V),t._12=2*(U+$),t._13=2*(W-B),t._21=2*(U-$),t._22=1-2*(K+V),t._23=2*(I+Y),t._31=2*(W+B),t._32=2*(I-Y),t._33=1-2*(K+H),(d&1<<ae.Scale._hx_index)!=0&&(M=n.data[i++]*a+n.data[s++]*o,L=n.data[i++]*a+n.data[s++]*o,N=n.data[i++]*a+n.data[s++]*o,t._11*=M,t._12*=M,t._13*=M,t._21*=L,t._22*=L,t._23*=L,t._31*=N,t._32*=N,t._33*=N))):(t._12=0,t._13=0,t._21=0,t._23=e?1:0,(d&1<<ae.Scale._hx_index)!=0?(t._11=n.data[i++]*a+n.data[s++]*o,t._22=n.data[i++]*a+n.data[s++]*o,t._33=n.data[i++]*a+n.data[s++]*o):(t._11=1,t._22=1,t._33=1))),r.targetSkin!=null?(r.targetSkin.jointsData[r.targetJoint].currentRelPos=t,r.targetSkin.jointsUpdated=!0):(b=r.targetObject,b.defaultTransform=t,P=1,G=!0,G?b.flags|=P:b.flags&=~P,ne=G,ne&&(b.flags&131072)!=0&&(te=262144,b.flags|=te))),(d&1<<ae.UV._hx_index)!=0&&(F=r.targetObject.toMesh().material,w=F.passes.getShader(Jn),w==null&&(w=F.passes.addShader(new Jn),F.get_texture().set_wrap(hs.Repeat)),g=this.data[i++],S=this.data[s++],g%=1,S%=1,g<S-.5?++g:g>S+.5&&--g,w.uvDelta__.x=g*(1-o)+S*o,v=this.data[i++],j=this.data[s++],v%=1,j%=1,v<j-.5?++v:v>j+.5&&--v,w.uvDelta__.y=v*(1-o)+j*o),(d&1<<ae.Alpha._hx_index)!=0&&(z=r.targetObject.toMesh().material,z.blendMode==X.None&&z.set_blendMode(X.Alpha),z.mshader.color__.w=n.data[i++]*a+n.data[s++]*o),(d&1<<ae.Property._hx_index)!=0&&(r.propCurrentValue=n.data[i++]*a+n.data[s++]*o)}e||(this.isSync=!0)},__class__:Oi}),Qr=function(){},c["h3d.anim.LinearFrame"]=Qr,Qr.__name__="h3d.anim.LinearFrame",Qr.prototype={toMatrix:function(){var e=new L;return new In(this.qx,this.qy,this.qz,this.qw).toMatrix(e),e.prependScale(this.sx,this.sy,this.sz),e.translate(this.tx,this.ty,this.tz),e},__class__:Qr},Ks=function(e){this.hasPosition=!0,ws.call(this,e)},c["h3d.anim.LinearObject"]=Ks,Ks.__name__="h3d.anim.LinearObject",Ks.__super__=ws,Ks.prototype=g(ws.prototype,{clone:function(){var e=new Ks(this.objectName);return e.hasPosition=this.hasPosition,e.hasRotation=this.hasRotation,e.hasScale=this.hasScale,e.frames=this.frames,e.alphas=this.alphas,e.uvs=this.uvs,e.propName=this.propName,e.propValues=this.propValues,e},__class__:Ks}),Fi=function(e,t,n){Xt.call(this,e,t,n),this.syncFrame=-1},c["h3d.anim.LinearAnimation"]=Fi,Fi.__name__="h3d.anim.LinearAnimation",Fi.__super__=Xt,Fi.prototype=g(Xt.prototype,{addCurve:function(e,t,n,s,o){var i=new Ks(e);i.frames=t,i.hasPosition=n,i.hasRotation=s,i.hasScale=o,this.objects.push(i)},addAlphaCurve:function(e,t){var n=new Ks(e);n.alphas=t,this.objects.push(n)},addUVCurve:function(e,t){var n=new Ks(e);n.uvs=t,this.objects.push(n)},addPropCurve:function(e,t,n){var s=new Ks(e);s.propName=t,s.propValues=n,this.objects.push(s)},getPropValue:function(e,t){for(var n,s=0,o=this.objects;s<o.length;)if(n=o[s],++s,n.objectName==e&&n.propName==t)return n.propCurrentValue;return null},getFrames:function(){return this.objects},clone:function(e){return e==null&&(e=new Fi(this.name,this.frameCount,this.sampling)),Xt.prototype.clone.call(this,e),e},endFrame:function(){return this.loop?this.frameCount:this.frameCount-1},initInstance:function(){Xt.prototype.initInstance.call(this);for(var e,n,i,s=this.objects,o=0;o<s.length;){if(e=s[o],++o,e.propValues!=null){e.propCurrentValue=e.propValues[0];continue}if(e.alphas!=null?e.targetObject!=null?(i=e.targetObject,n=(i instanceof me?i:null)==null):n=!0:n=!1,n)throw t.thrown(e.objectName+" should be a mesh (for alpha animation)");if(e.uvs!=null||e.alphas!=null)continue;e.matrix=new L,e.matrix.identity()}s.sort(b(this,this.sortByFrameCountDesc))},sortByFrameCountDesc:function(e,t){return(t.frames==null?10:t.frames.length)-(e.frames==null?10:e.frames.length)},uvLerp:function(e,t,n){return e%=1,t%=1,e<t-.5?++e:e>t+.5&&--e,e*(1-n)+t*n},sync:function(e){if(e==null&&(e=!1),this.frame==this.syncFrame&&!e)return;var t,n,s,o,i,a,r,c,l,d,u,h,m,f,p,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,B,V,$,W,g=this.frame|0,U=this.endFrame();for(g==U&&--g,c=g,r=(c+1)%this.frameCount,s=this.frame-c,a=1-s,c<0?(r=0,c=r):this.frame>=this.frameCount?(r=this.frameCount-1,c=r):!this.loop&&r==0&&(r=this.frameCount-1),this.syncFrame=this.frame,e&&(this.isSync=!1),k=0,I=this.objects;k<I.length;){if(n=I[k],++k,n.targetObject==null&&n.targetSkin==null)continue;if(n.alphas!=null){C=n.targetObject.toMesh().material,C.blendMode==X.None&&C.set_blendMode(X.Alpha),C.mshader.color__.w=n.alphas[c]*a+n.alphas[r]*s;continue}if(n.uvs!=null){x=n.targetObject.toMesh().material,b=x.passes.getShader(Jn),b==null&&(b=x.passes.addShader(new Jn),x.get_texture().set_wrap(hs.Repeat)),m=n.uvs[c<<1],_=n.uvs[r<<1],m%=1,_%=1,m<_-.5?++m:m>_+.5&&--m,b.uvDelta__.x=m*(1-s)+_*s,f=n.uvs[c<<1|1],y=n.uvs[r<<1|1],f%=1,y%=1,f<y-.5?++f:f>y+.5&&--f,b.uvDelta__.y=f*(1-s)+y*s;continue}if(n.propValues!=null){n.propCurrentValue=n.propValues[c]*a+n.propValues[r]*s;continue}if(S=c,A=r,n.frames.length==1){if(this.isSync)break;A=0,S=A}i=n.frames[S],o=n.frames[A],t=n.matrix,t._41=i.tx*a+o.tx*s,t._42=i.ty*a+o.ty*s,t._43=i.tz*a+o.tz*s,n.hasRotation?(V=i.qx*o.qx+i.qy*o.qy+i.qz*o.qz+i.qw*o.qw,v=V<0?-s:s,u=i.qx*a+o.qx*v,d=i.qy*a+o.qy*v,l=i.qz*a+o.qz*v,h=i.qw*a+o.qw*v,j=1/Math.sqrt(u*u+d*d+l*l+h*h),u*=j,d*=j,l*=j,h*=j,e?(t._12=u,t._13=d,t._21=l,t._23=h,n.hasScale?(t._11=i.sx*a+o.sx*s,t._22=i.sy*a+o.sy*s,t._33=i.sz*a+o.sz*s):(t._11=1,t._22=1,t._33=1)):(M=u*u,P=u*d,F=u*l,T=u*h,z=d*d,D=d*l,N=d*h,L=l*l,R=l*h,t._11=1-2*(z+L),t._12=2*(P+R),t._13=2*(F-N),t._21=2*(P-R),t._22=1-2*(M+L),t._23=2*(D+T),t._31=2*(F+N),t._32=2*(D-T),t._33=1-2*(M+z),n.hasScale&&(O=i.sx*a+o.sx*s,w=i.sy*a+o.sy*s,E=i.sz*a+o.sz*s,t._11*=O,t._12*=O,t._13*=O,t._21*=w,t._22*=w,t._23*=w,t._31*=E,t._32*=E,t._33*=E))):(t._12=0,t._13=0,t._21=0,t._23=e?1:0,n.hasScale?(t._11=i.sx*a+o.sx*s,t._22=i.sy*a+o.sy*s,t._33=i.sz*a+o.sz*s):(t._11=1,t._22=1,t._33=1)),n.targetSkin!=null?(n.targetSkin.jointsData[n.targetJoint].currentRelPos=n.matrix,n.targetSkin.jointsUpdated=!0):(p=n.targetObject,B=n.matrix,p.defaultTransform=B,g=1,H=!0,H?p.flags|=g:p.flags&=~g,$=H,$&&(p.flags&131072)!=0&&(W=262144,p.flags|=W))}e||(this.isSync=!0)},__class__:Fi}),ji=function(){this.bindIndex=-1,this.splitIndex=-1,this.subs=[]},c["h3d.anim.Joint"]=ji,ji.__name__="h3d.anim.Joint",ji.prototype={shouldReceiveAnimation:function(){return!0},makeRuntimeData:function(){return new us},__class__:ji},Un=function(){this.slackness=0,this.resistance=1,this.stiffness=1,this.damping=1;var e=0,t=0,n=0;n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.lockAxis=new h(e,t,n),this.additive=!1,e=0,t=0,n=0,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.globalForce=new h(e,t,n),ji.call(this)},c["h3d.anim.DynamicJoint"]=Un,Un.__name__="h3d.anim.DynamicJoint",Un.__super__=ji,Un.prototype=g(ji.prototype,{shouldReceiveAnimation:function(){return this.additive},makeRuntimeData:function(){return new J},__class__:Un}),Yr=function(){},c["h3d.anim._Skin.Permut"]=Yr,Yr.__name__="h3d.anim._Skin.Permut",Yr.prototype={__class__:Yr},Vr=function(e,t){this.j=e,this.w=t},c["h3d.anim._Skin.Influence"]=Vr,Vr.__name__="h3d.anim._Skin.Influence",Vr.prototype={__class__:Vr},Tr=function(e,t,n){this.name=e,this.vertexCount=t,this.bonesPerVertex=n,t>0&&(this.vertexJoints=new Array(t*n),this.vertexWeights=new Array(t*n),this.envelop=[])},c["h3d.anim.Skin"]=Tr,Tr.__name__="h3d.anim.Skin",Tr.prototype={setJoints:function(e,t){this.rootJoints=t,this.allJoints=e,this.namedJoints=new fe;for(var n,s=0;s<e.length;)n=e[s],++s,n.name!=null&&(this.namedJoints.h[n.name]=n)},addInfluence:function(e,t,n){var s=this.envelop[e];s==null&&(s=this.envelop[e]=[]),s.push(new Vr(t,n))},sortInfluences:function(e,t){return t.w>e.w?1:-1},isSplit:function(){return this.splitJoints!=null},initWeights:function(){this.boundJoints=[];for(var e,t,s,o,i,r,c,l,d,n=0,a=0,u=this.vertexCount;a<u;){for(r=a++,e=this.envelop[r],e==null&&(e=[]),et.sort(e,b(this,this.sortInfluences)),e.length>this.bonesPerVertex&&(e=e.slice(0,this.bonesPerVertex)),s=0,o=0;o<e.length;)c=e[o],++o,s+=c.w;for(s=1/s,i=0,l=this.bonesPerVertex;i<l;)d=i++,t=e[d],t==null?(this.vertexJoints[n]=0,this.vertexWeights[n]=0):(t.j.bindIndex==-1&&(t.j.bindIndex=this.boundJoints.length,this.boundJoints.push(t.j)),this.vertexJoints[n]=t.j.bindIndex,this.vertexWeights[n]=t.w*s),++n}this.envelop=null},sortByBindIndex:function(e,t){return e.bindIndex-t.bindIndex},isSub:function(e,t){for(var o,s=0,i=t.length,n=0;n<e.length;)for(o=e[n],++n;o!=t[s++];)if(s>=i)return!1;return!0},merge:function(e){for(var t,n,s,o,a,r,i=0;i<e.length;)for(t=e[i],++i,s=0;s<e.length;)if(n=e[s],++s,t!=n&&t.material==n.material&&this.isSub(t.joints,n.joints)){for(o=0,a=t.triangles;o<a.length;)r=a[o],++o,n.triangles.push(r);return u.remove(e,t),!0}return!1},jointsDiff:function(e,t){for(var o,i,a=0,n=0,s=0,r=e.joints.length,c=t.joints.length;n<r&&s<c;)o=e.joints[n],i=t.joints[s],o==i?(++n,++s):(++a,o.bindIndex<i.bindIndex?++n:++s);return a+(r-n)+(c-s)},split:function(e,n,s){if(this.splitJoints!=null)return!0;if(this.boundJoints.length<=e)return!1;this.splitJoints=[],this.triangleGroups=new Array(n.length/3|0);for(var i,r,l,d,h,m,f,p,g,v,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,B,V,a=[],o=0,c=n.length/3|0;o<c;){for(_=o++,T=_*3,A=s==null?0:s[_],l=[],r=0;r<3;)for(d=r++,I=n[T+d],p=0,g=this.bonesPerVertex;p<g;){if(V=p++,L=I*this.bonesPerVertex+V,this.vertexWeights[L]==0)continue;i=this.boundJoints[this.vertexJoints[L]],i.splitIndex!=T&&(i.splitIndex=T,l.push(i))}for(l.sort(b(this,this.sortByBindIndex)),f=0;f<a.length;)if(m=a[f],++f,m.material==A&&this.isSub(l,m.joints)){m.triangles.push(_),l=null;break}if(l==null)continue;for(h=0;h<a.length;)if(v=a[h],++h,v.material==A&&this.isSub(v.joints,l)){v.joints=l,v.triangles.push(_),l=null;break}if(l==null)continue;C=new Yr,C.joints=l,C.triangles=[_],C.material=A,a.push(C)}for(;!0;){for(;this.merge(a););for(z=1e5,M=1e5,F=null,P=null,o=0,c=a.length;o<c;){if(d=o++,y=a[d],y.joints.length==e)continue;for(r=d+1,p=a.length;r<p;){if(i=r++,m=a[i],m.joints.length==e||y.material!=m.material)continue;if(E=this.jointsDiff(y,m),O=E+(y.joints.length+m.joints.length-E>>1),O>e||O>M||O==M&&E>z)continue;z=E,M=O,F=y,P=m}}if(F==null)break;for(k=F,v=P,g=0,f=k.joints;g<f.length;)D=f[g],++g,u.remove(v.joints,D),v.joints.push(D);for(v.joints.sort(b(this,this.sortByBindIndex)),h=0,w=k.triangles;h<w.length;)B=w[h],++h,v.triangles.push(B);u.remove(a,k)}for(o=0,c=a.length;o<c;)for(d=o++,r=0,p=a[d].triangles;r<p.length;)_=p[r],++r,this.triangleGroups[_]=d;for(x=[],o=0,c=this.boundJoints;o<c.length;){for(i=c[o],++o,N=[],r=0;r<a.length;)j=a[r],++r,j.joints.indexOf(i)>=0&&N.push(j);x.push({j:i,pl:N,priority:0})}for(;!0;){for(x.sort(function(e,t){return t.pl.length+t.priority*100-(e.pl.length+e.priority*100)}),o=0;o<a.length;)j=a[o],++o,j.indexedJoints=[];for(R=!1,c=0;c<x.length;){for(i=x[c],++c,i.j.splitIndex=-1,r=0,p=e;r<p;){for(S=r++,H=!0,g=0,f=i.pl;g<f.length;)if(y=f[g],++g,y.indexedJoints[S]!=null){H=!1;break}if(H){for(i.j.splitIndex=S,h=0,w=i.pl;h<w.length;)m=w[h],++h,m.indexedJoints[S]=i.j;break}}if(i.j.splitIndex<0){if(i.priority++,i.priority>10)throw t.thrown("Failed to assign index while spliting skin");R=!0;break}}if(!R)break}for(this.splitJoints=[],o=0;o<a.length;){for(j=a[o],++o,l=[],c=0,r=j.indexedJoints.length;c<r;)d=c++,i=j.indexedJoints[d],i==null&&(i=this.boundJoints[0]),l.push(i);this.splitJoints.push({material:j.material,joints:l})}for(o=0,c=this.vertexJoints.length;o<c;)d=o++,this.vertexJoints[d]=this.boundJoints[this.vertexJoints[d]].splitIndex;return!0},__class__:Tr},ot=function(){},c["h3d.col.Collider"]=ot,ot.__name__="h3d.col.Collider",ot.prototype={__class__:ot},Ce=function(){this.xMin=1e20,this.xMax=-1e20,this.yMin=1e20,this.yMax=-1e20,this.zMin=1e20,this.zMax=-1e20},c["h3d.col.Bounds"]=Ce,Ce.__name__="h3d.col.Bounds",Ce.fromPoints=function(e,t){var n=new Ce;return n.xMin=e.x,n.yMin=e.y,n.zMin=e.z,n.xMax=t.x,n.yMax=t.y,n.zMax=t.z,n},Ce.fromValues=function(e,t,n,s,o,i){var a=new Ce;return a.xMin=e,a.yMin=t,a.zMin=n,a.xMax=e+s,a.yMax=t+o,a.zMax=n+i,a},Ce.__super__=ot,Ce.prototype=g(ot.prototype,{inFrustum:function(e,n){if(n!=null)throw t.thrown("Not implemented");return e.hasBounds(this)},inSphere:function(e){var t,n,s,o,i,a,r,u,h,m,f,p,g,v,b,j,c=e.x,d=e.y,l=e.z;return l==null&&(l=0),d==null&&(d=0),c==null&&(c=0),r=c,i=d,a=l,a==null&&(a=0),i==null&&(i=0),r==null&&(r=0),j=r,b=i,f=a,t=this.xMin,o=e.x,s=this.xMax,n=o>s?s:o,c=t<n?n:t,t=this.yMin,o=e.y,s=this.yMax,n=o>s?s:o,d=t<n?n:t,t=this.zMin,o=e.z,s=this.zMax,n=o>s?s:o,l=t<n?n:t,l==null&&(l=0),d==null&&(d=0),c==null&&(c=0),r=c,i=d,a=l,a==null&&(a=0),i==null&&(i=0),r==null&&(r=0),v=r,p=i,g=a,u=v-j,m=p-b,h=g-f,u*u+m*m+h*h<e.r*e.r},testPlane:function(e){var o,t=e.nx,n=e.ny,s=e.nz,i=t*(this.xMax+this.xMin)+n*(this.yMax+this.yMin)+s*(this.zMax+this.zMin);return t<0&&(t=-t),n<0&&(n=-n),s<0&&(s=-s),o=t*(this.xMax-this.xMin)+n*(this.yMax-this.yMin)+s*(this.zMax-this.zMin),i+o-e.d*2},rayIntersection:function(e){var c=(this.xMin-e.px)/e.lx,s=(this.yMin-e.py)/e.ly,o=(this.zMin-e.pz)/e.lz,i=(this.xMax-e.px)/e.lx,a=(this.yMax-e.py)/e.ly,r=(this.zMax-e.pz)/e.lz,l=c>i?i:c,f=s>a?a:s,d=o>r?r:o,u=c<i?i:c,h=s<a?a:s,m=o<r?r:o,n=u>h?h:u,g=n>m?m:n,n=l<f?f:l,p=n<d?d:n;return g<p?-1:p},inFrustumDetails:function(e,t){t==null&&(t=!0);var a,c=1,n=e._14+e._11,s=e._24+e._21,o=e._34+e._31,i=e._44+e._41,r=n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+o*(o>0?this.zMax:this.zMin);if(r+i<0)return-1;if(a=n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+o*(o>0?this.zMin:this.zMax),a+i<0&&(c=0),n=e._14-e._11,s=e._24-e._21,o=e._34-e._31,i=e._44-e._41,r=n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+o*(o>0?this.zMax:this.zMin),r+i<0)return-1;if(a=n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+o*(o>0?this.zMin:this.zMax),a+i<0&&(c=0),n=e._14+e._12,s=e._24+e._22,o=e._34+e._32,i=e._44+e._42,r=n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+o*(o>0?this.zMax:this.zMin),r+i<0)return-1;if(a=n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+o*(o>0?this.zMin:this.zMax),a+i<0&&(c=0),n=e._14-e._12,s=e._24-e._22,o=e._34-e._32,i=e._44-e._42,r=n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+o*(o>0?this.zMax:this.zMin),r+i<0)return-1;if(a=n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+o*(o>0?this.zMin:this.zMax),a+i<0&&(c=0),t){if(n=e._13,s=e._23,o=e._33,i=e._43,r=n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+o*(o>0?this.zMax:this.zMin),r+i<0)return-1;if(a=n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+o*(o>0?this.zMin:this.zMax),a+i<0&&(c=0),n=e._14-e._13,s=e._24-e._23,o=e._34-e._33,i=e._44-e._43,r=n*(n>0?this.xMax:this.xMin)+s*(s>0?this.yMax:this.yMin)+o*(o>0?this.zMax:this.zMin),r+i<0)return-1;a=n*(n>0?this.xMin:this.xMax)+s*(s>0?this.yMin:this.yMax)+o*(o>0?this.zMin:this.zMax),a+i<0&&(c=0)}return c},transform3x3:function(e){var t,n,s,o,i,a,r,c,l,h=this.xMin,p=this.yMin,f=this.zMin,m=this.xMax,d=this.yMax,u=this.zMax;this.xMin=1e20,this.xMax=-1e20,this.yMin=1e20,this.yMax=-1e20,this.zMin=1e20,this.zMax=-1e20,o=0,i=0,a=0,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,o=h,i=p,a=f,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31,c=t*e._12+s*e._22+n*e._32,l=t*e._13+s*e._23+n*e._33,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=h,i=p,a=u,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31,c=t*e._12+s*e._22+n*e._32,l=t*e._13+s*e._23+n*e._33,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=h,i=d,a=f,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31,c=t*e._12+s*e._22+n*e._32,l=t*e._13+s*e._23+n*e._33,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=h,i=d,a=u,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31,c=t*e._12+s*e._22+n*e._32,l=t*e._13+s*e._23+n*e._33,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=m,i=p,a=f,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31,c=t*e._12+s*e._22+n*e._32,l=t*e._13+s*e._23+n*e._33,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=m,i=p,a=u,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31,c=t*e._12+s*e._22+n*e._32,l=t*e._13+s*e._23+n*e._33,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=m,i=d,a=f,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31,c=t*e._12+s*e._22+n*e._32,l=t*e._13+s*e._23+n*e._33,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=m,i=d,a=u,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31,c=t*e._12+s*e._22+n*e._32,l=t*e._13+s*e._23+n*e._33,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n)},transform:function(e){var t,n,s,o,i,a,r,c,l,h=this.xMin,p=this.yMin,f=this.zMin,m=this.xMax,d=this.yMax,u=this.zMax;if(this.xMin=1e20,this.xMax=-1e20,this.yMin=1e20,this.yMax=-1e20,this.zMin=1e20,this.zMax=-1e20,m<h&&d<p&&u<f)return;o=0,i=0,a=0,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,o=h,i=p,a=f,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31+e._41,c=t*e._12+s*e._22+n*e._32+e._42,l=t*e._13+s*e._23+n*e._33+e._43,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=h,i=p,a=u,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31+e._41,c=t*e._12+s*e._22+n*e._32+e._42,l=t*e._13+s*e._23+n*e._33+e._43,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=h,i=d,a=f,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31+e._41,c=t*e._12+s*e._22+n*e._32+e._42,l=t*e._13+s*e._23+n*e._33+e._43,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=h,i=d,a=u,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31+e._41,c=t*e._12+s*e._22+n*e._32+e._42,l=t*e._13+s*e._23+n*e._33+e._43,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=m,i=p,a=f,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31+e._41,c=t*e._12+s*e._22+n*e._32+e._42,l=t*e._13+s*e._23+n*e._33+e._43,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=m,i=p,a=u,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31+e._41,c=t*e._12+s*e._22+n*e._32+e._42,l=t*e._13+s*e._23+n*e._33+e._43,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=m,i=d,a=f,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31+e._41,c=t*e._12+s*e._22+n*e._32+e._42,l=t*e._13+s*e._23+n*e._33+e._43,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n),o=m,i=d,a=u,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,s=i,n=a,r=t*e._11+s*e._21+n*e._31+e._41,c=t*e._12+s*e._22+n*e._32+e._42,l=t*e._13+s*e._23+n*e._33+e._43,t=r,s=c,n=l,t<this.xMin&&(this.xMin=t),t>this.xMax&&(this.xMax=t),s<this.yMin&&(this.yMin=s),s>this.yMax&&(this.yMax=s),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n)},collide:function(e){return!(this.xMin>e.xMax||this.yMin>e.yMax||this.zMin>e.zMax||this.xMax<e.xMin||this.yMax<e.yMin||this.zMax<e.zMin)},contains:function(e){return e.x>=this.xMin&&e.x<this.xMax&&e.y>=this.yMin&&e.y<this.yMax&&e.z>=this.zMin&&e.z<this.zMax},containsBounds:function(e){return this.xMin<=e.xMin&&this.yMin<=e.yMin&&this.zMin<=e.zMin&&this.xMax>=e.xMax&&this.yMax>=e.yMax&&this.zMax>=e.zMax},containsSphere:function(e){return this.xMin<=e.x-e.r&&this.yMin<=e.y-e.r&&this.zMin<=e.z-e.r&&this.xMax>=e.x+e.r&&this.yMax>=e.y+e.r&&this.zMax>=e.z+e.r},add:function(e){e.xMin<this.xMin&&(this.xMin=e.xMin),e.xMax>this.xMax&&(this.xMax=e.xMax),e.yMin<this.yMin&&(this.yMin=e.yMin),e.yMax>this.yMax&&(this.yMax=e.yMax),e.zMin<this.zMin&&(this.zMin=e.zMin),e.zMax>this.zMax&&(this.zMax=e.zMax)},addTransform:function(e,t){var n,s=new Ce;s.xMin=e.xMin,s.xMax=e.xMax,s.yMin=e.yMin,s.yMax=e.yMax,s.zMin=e.zMin,s.zMax=e.zMax,n=s,n.transform(t),n.xMin<this.xMin&&(this.xMin=n.xMin),n.xMax>this.xMax&&(this.xMax=n.xMax),n.yMin<this.yMin&&(this.yMin=n.yMin),n.yMax>this.yMax&&(this.yMax=n.yMax),n.zMin<this.zMin&&(this.zMin=n.zMin),n.zMax>this.zMax&&(this.zMax=n.zMax)},addPoint:function(e){e.x<this.xMin&&(this.xMin=e.x),e.x>this.xMax&&(this.xMax=e.x),e.y<this.yMin&&(this.yMin=e.y),e.y>this.yMax&&(this.yMax=e.y),e.z<this.zMin&&(this.zMin=e.z),e.z>this.zMax&&(this.zMax=e.z)},addPos:function(e,t,n){e<this.xMin&&(this.xMin=e),e>this.xMax&&(this.xMax=e),t<this.yMin&&(this.yMin=t),t>this.yMax&&(this.yMax=t),n<this.zMin&&(this.zMin=n),n>this.zMax&&(this.zMax=n)},addSphere:function(e){var n=e.x,s=e.y,o=e.z,t=e.r;n-t<this.xMin&&(this.xMin=n-t),n+t>this.xMax&&(this.xMax=n+t),s-t<this.yMin&&(this.yMin=s-t),s+t>this.yMax&&(this.yMax=s+t),o-t<this.zMin&&(this.zMin=o-t),o+t>this.zMax&&(this.zMax=o+t)},addSpherePos:function(e,t,n,s){e-s<this.xMin&&(this.xMin=e-s),e+s>this.xMax&&(this.xMax=e+s),t-s<this.yMin&&(this.yMin=t-s),t+s>this.yMax&&(this.yMax=t+s),n-s<this.zMin&&(this.zMin=n-s),n+s>this.zMax&&(this.zMax=n+s)},intersection:function(e,t){var n=e.xMin,s=t.xMin,o=n<s?s:n,n=e.yMin,s=t.yMin,i=n<s?s:n,n=e.zMin,s=t.zMin,a=n<s?s:n,n=e.xMax,s=t.xMax,r=n>s?s:n,n=e.yMax,s=t.yMax,c=n>s?s:n,n=e.zMax,s=t.zMax,l=n>s?s:n;this.xMin=o,this.xMax=r,this.yMin=i,this.yMax=c,this.zMin=a,this.zMax=l},offset:function(e,t,n){this.xMin+=e,this.xMax+=e,this.yMin+=t,this.yMax+=t,this.zMin+=n,this.zMax+=n},setMin:function(e){this.xMin=e.x,this.yMin=e.y,this.zMin=e.z},setMax:function(e){this.xMax=e.x,this.yMax=e.y,this.zMax=e.z},load:function(e){this.xMin=e.xMin,this.xMax=e.xMax,this.yMin=e.yMin,this.yMax=e.yMax,this.zMin=e.zMin,this.zMax=e.zMax},scalePivot:function(e){this.xMin*=e,this.yMin*=e,this.zMin*=e,this.xMax*=e,this.yMax*=e,this.zMax*=e},scaleCenter:function(e){var t=(this.xMax-this.xMin)*.5*e,n=(this.yMax-this.yMin)*.5*e,s=(this.zMax-this.zMin)*.5*e,o=(this.xMax+this.xMin)*.5,i=(this.yMax+this.yMin)*.5,a=(this.zMax+this.zMin)*.5;this.xMin=o-t,this.yMin=i-n,this.zMin=a-s,this.xMax=o+t,this.yMax=i+n,this.zMax=a+s},getMin:function(){var e=this.xMin,t=this.yMin,n=this.zMin;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},getCenter:function(){var e=(this.xMin+this.xMax)*.5,t=(this.yMin+this.yMax)*.5,n=(this.zMin+this.zMax)*.5;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},getSize:function(){var e=this.xMax-this.xMin,t=this.yMax-this.yMin,n=this.zMax-this.zMin;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},getMax:function(){var e=this.xMax,t=this.yMax,n=this.zMax;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},getVolume:function(){return(this.xMax-this.xMin)*(this.yMax-this.yMin)*(this.zMax-this.zMin)},get_xSize:function(){return this.xMax-this.xMin},get_ySize:function(){return this.yMax-this.yMin},get_zSize:function(){return this.zMax-this.zMin},set_xSize:function(e){return this.xMax=this.xMin+e,e},set_ySize:function(e){return this.yMax=this.yMin+e,e},set_zSize:function(e){return this.zMax=this.zMin+e,e},isEmpty:function(){return this.xMax<this.xMin||this.yMax<this.yMin||this.zMax<this.zMin},empty:function(){this.xMin=1e20,this.xMax=-1e20,this.yMin=1e20,this.yMax=-1e20,this.zMin=1e20,this.zMax=-1e20},all:function(){this.xMin=-1e20,this.xMax=1e20,this.yMin=-1e20,this.yMax=1e20,this.zMin=-1e20,this.zMax=1e20},clone:function(){var e=new Ce;return e.xMin=this.xMin,e.xMax=this.xMax,e.yMin=this.yMin,e.yMax=this.yMax,e.zMin=this.zMin,e.zMax=this.zMax,e},toString:function(){var s,e=this.xMin,t=this.yMin,n=this.zMin;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),s="Bounds{"+o.string(new h(e,t,n))+",",e=this.xMax-this.xMin,t=this.yMax-this.yMin,n=this.zMax-this.zMin,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),s+o.string(new h(e,t,n))+"}"},toSphere:function(){var e=this.xMax-this.xMin,t=this.yMax-this.yMin,n=this.zMax-this.zMin;return new Is((this.xMin+this.xMax)*.5,(this.yMin+this.yMax)*.5,(this.zMin+this.zMax)*.5,Math.sqrt(e*e+t*t+n*n)*.5)},dimension:function(){var e=this.xMax-this.xMin,t=this.yMax-this.yMin,n=this.zMax-this.zMin,s=t<n?n:t;return e<s?s:e},closestPoint:function(){throw t.thrown("Not implemented")},makeDebugObj:function(){var e=new Zn(this.xMax-this.xMin,this.yMax-this.yMin,this.zMax-this.zMin);return e.translate(this.xMin,this.yMin,this.zMin),e.addNormals(),new me(e)},__class__:Ce}),fi=function(e,t){this.a=e,this.b=t},c["h3d.col.OptimizedCollider"]=fi,fi.__name__="h3d.col.OptimizedCollider",fi.__super__=ot,fi.prototype=g(ot.prototype,{rayIntersection:function(e,t){if(this.a.rayIntersection(e,!1)<0){if(!this.checkInside)return-1;var n=e.px+0*e.lx,s=e.py+0*e.ly,o=e.pz+0*e.lz;if(o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),!this.a.contains(new h(n,s,o)))return-1}return this.b.rayIntersection(e,t)},contains:function(e){return!!this.a.contains(e)&&this.b.contains(e)},inFrustum:function(e,t){return!!this.a.inFrustum(e,t)&&this.b.inFrustum(e,t)},inSphere:function(e){return!!this.a.inSphere(e)&&this.b.inSphere(e)},dimension:function(){return Math.max(this.a.dimension(),this.b.dimension())},closestPoint:function(e){return this.b.closestPoint(e)},makeDebugObj:function(){var e,t=this.b.makeDebugObj(),n=this.a.makeDebugObj();return n==null&&t==null?null:(e=new se,n!=null&&e.addChild(n),t!=null&&e.addChild(t),e)},__class__:fi}),mi=function(e){this.colliders=e},c["h3d.col.GroupCollider"]=mi,mi.__name__="h3d.col.GroupCollider",mi.__super__=ot,mi.prototype=g(ot.prototype,{rayIntersection:function(e,t){for(var n,a,s=-1,o=0,i=this.colliders;o<i.length;)if(a=i[o],++o,n=a.rayIntersection(e,t),n>=0){if(!t)return n;(s<0||n<s)&&(s=n)}return s},contains:function(e){for(var s,t=0,n=this.colliders;t<n.length;)if(s=n[t],++t,s.contains(e))return!0;return!1},inFrustum:function(e,t){for(var o,n=0,s=this.colliders;n<s.length;)if(o=s[n],++n,o.inFrustum(e,t))return!0;return!1},inSphere:function(e){for(var s,t=0,n=this.colliders;t<n.length;)if(s=n[t],++t,s.inSphere(e))return!0;return!1},dimension:function(){for(var s,e=-(1/0),t=0,n=this.colliders;t<n.length;)s=n[t],++t,e=Math.max(e,s.dimension());return e},closestPoint:function(e){for(var t,s,o,i,a,r,u,c=null,l=1/0,n=0,d=this.colliders;n<d.length;)u=d[n],++n,s=u.closestPoint(e),t=s,o=e.x-t.x,i=e.y-t.y,a=e.z-t.z,r=o*o+i*i+a*a,r<l&&(c=s,l=r);return c},makeDebugObj:function(){for(var n,o,e=null,t=0,s=this.colliders;t<s.length;){if(o=s[t],++t,n=o.makeDebugObj(),n==null)continue;e==null&&(e=new se),e.addChild(n)}return e},__class__:mi}),gn=function(e,t,n){n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t,this.z=n},c["h3d.col.FPoint"]=gn,gn.__name__="h3d.col.FPoint",gn.prototype={set:function(e,t,n){n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t,this.z=n},sub:function(e){return new gn(this.x-e.x,this.y-e.y,this.z-e.z)},add:function(e){return new gn(this.x+e.x,this.y+e.y,this.z+e.z)},cross:function(e){return new gn(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},distanceSq:function(e){var t=e.x-this.x,n=e.y-this.y,s=e.z-this.z;return t*t+n*n+s*s},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},normalized:function(){var e=this.x*this.x+this.y*this.y+this.z*this.z;return e<1e-20?e=0:e=1/Math.sqrt(e),new gn(this.x*e,this.y*e,this.z*e)},scaled:function(e){return new gn(this.x*e,this.y*e,this.z*e)},toString:function(){return"FPoint{"+x.fmt(this.x)+","+x.fmt(this.y)+","+x.fmt(this.z)+"}"},__class__:gn},Ja=function(e){this.checkNearFar=!0,this.pleft=new Te(1,0,0,0),this.pright=new Te(1,0,0,0),this.ptop=new Te(1,0,0,0),this.pbottom=new Te(1,0,0,0),this.pnear=new Te(1,0,0,0),this.pfar=new Te(1,0,0,0),e!=null&&this.loadMatrix(e)},c["h3d.col.Frustum"]=Ja,Ja.__name__="h3d.col.Frustum",Ja.prototype={clone:function(){var n=new Ja,e=n.pleft,t=this.pleft;return e.nx=t.nx,e.ny=t.ny,e.nz=t.nz,e.d=t.d,e=n.pright,t=this.pright,e.nx=t.nx,e.ny=t.ny,e.nz=t.nz,e.d=t.d,e=n.ptop,t=this.ptop,e.nx=t.nx,e.ny=t.ny,e.nz=t.nz,e.d=t.d,e=n.pbottom,t=this.pbottom,e.nx=t.nx,e.ny=t.ny,e.nz=t.nz,e.d=t.d,e=n.pnear,t=this.pnear,e.nx=t.nx,e.ny=t.ny,e.nz=t.nz,e.d=t.d,e=n.pfar,t=this.pfar,e.nx=t.nx,e.ny=t.ny,e.nz=t.nz,e.d=t.d,n.checkNearFar=this.checkNearFar,n},loadMatrix:function(e){var n,t=this.pleft,s=e._14+e._11,o=e._24+e._21,i=e._34+e._31,a=-(e._44+e._41);t.nx=s,t.ny=o,t.nz=i,t.d=a,t=this.pright,s=e._14-e._11,o=e._24-e._21,i=e._34-e._31,a=e._41-e._44,t.nx=s,t.ny=o,t.nz=i,t.d=a,t=this.ptop,s=e._14-e._12,o=e._24-e._22,i=e._34-e._32,a=e._42-e._44,t.nx=s,t.ny=o,t.nz=i,t.d=a,t=this.pbottom,s=e._14+e._12,o=e._24+e._22,i=e._34+e._32,a=-(e._44+e._42),t.nx=s,t.ny=o,t.nz=i,t.d=a,t=this.pnear,s=e._13,o=e._23,i=e._33,a=-e._43,t.nx=s,t.ny=o,t.nz=i,t.d=a,t=this.pfar,s=e._14-e._13,o=e._24-e._23,i=e._34-e._33,a=e._43-e._44,t.nx=s,t.ny=o,t.nz=i,t.d=a,t=this.pleft,n=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=n,t.ny*=n,t.nz*=n,t.d*=n,t=this.pright,n=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=n,t.ny*=n,t.nz*=n,t.d*=n,t=this.ptop,n=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=n,t.ny*=n,t.nz*=n,t.d*=n,t=this.pbottom,n=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=n,t.ny*=n,t.nz*=n,t.d*=n,t=this.pnear,n=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=n,t.ny*=n,t.nz*=n,t.d*=n,t=this.pfar,n=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=n,t.ny*=n,t.nz*=n,t.d*=n},transform:function(e){var t,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,n=new L;n.initInverse(e),n.transpose(),t=this.pleft,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.pright,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.ptop,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.pbottom,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.pfar,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.pnear,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.pleft,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r,t=this.pright,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r,t=this.ptop,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r,t=this.pbottom,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r,t=this.pnear,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r,t=this.pfar,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r},transform3x3:function(e){var t,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,n=new L;n.initInverse3x3(e),n.transpose(),t=this.pleft,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.pright,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.ptop,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.pbottom,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.pfar,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.pnear,p=t.nx,f=t.ny,c=t.nz,m=-t.d,m==null&&(m=1),c==null&&(c=0),f==null&&(f=0),p==null&&(p=0),h=p,u=f,l=c,d=m,d==null&&(d=1),l==null&&(l=0),u==null&&(u=0),h==null&&(h=0),s=h,a=u,i=l,o=d,g=s*n._11+a*n._21+i*n._31+o*n._41,v=s*n._12+a*n._22+i*n._32+o*n._42,b=s*n._13+a*n._23+i*n._33+o*n._43,j=s*n._14+a*n._24+i*n._34+o*n._44,s=g,a=v,i=b,o=j,t.nx=s,t.ny=a,t.nz=i,t.d=-o,t=this.pleft,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r,t=this.pright,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r,t=this.ptop,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r,t=this.pbottom,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r,t=this.pnear,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r,t=this.pfar,r=1/Math.sqrt(t.nx*t.nx+t.ny*t.ny+t.nz*t.nz),t.nx*=r,t.ny*=r,t.nz*=r,t.d*=r},hasPoint:function(e){var t=this.pleft;if(t.nx*e.x+t.ny*e.y+t.nz*e.z-t.d<0)return!1;if(t=this.pright,t.nx*e.x+t.ny*e.y+t.nz*e.z-t.d<0)return!1;if(t=this.ptop,t.nx*e.x+t.ny*e.y+t.nz*e.z-t.d<0)return!1;if(t=this.pbottom,t.nx*e.x+t.ny*e.y+t.nz*e.z-t.d<0)return!1;if(this.checkNearFar){if(t=this.pnear,t.nx*e.x+t.ny*e.y+t.nz*e.z-t.d<0)return!1;if(t=this.pfar,t.nx*e.x+t.ny*e.y+t.nz*e.z-t.d<0)return!1}return!0},hasSphere:function(e){var t,n,s,o,i,a,r,c=e.x,l=e.y,d=e.z;if(d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),i=c,a=l,r=d,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,t=this.pleft,t.nx*n+t.ny*s+t.nz*o-t.d<-e.r)return!1;if(t=this.pright,t.nx*n+t.ny*s+t.nz*o-t.d<-e.r)return!1;if(t=this.ptop,t.nx*n+t.ny*s+t.nz*o-t.d<-e.r)return!1;if(t=this.pbottom,t.nx*n+t.ny*s+t.nz*o-t.d<-e.r)return!1;if(this.checkNearFar){if(t=this.pnear,t.nx*n+t.ny*s+t.nz*o-t.d<-e.r)return!1;if(t=this.pfar,t.nx*n+t.ny*s+t.nz*o-t.d<-e.r)return!1}return!0},hasBounds:function(e){var i,o=this.pleft,t=o.nx,n=o.ny,s=o.nz,a=t*(e.xMax+e.xMin)+n*(e.yMax+e.yMin)+s*(e.zMax+e.zMin);if(t<0&&(t=-t),n<0&&(n=-n),s<0&&(s=-s),i=t*(e.xMax-e.xMin)+n*(e.yMax-e.yMin)+s*(e.zMax-e.zMin),a+i-o.d*2<0)return!1;if(o=this.pright,t=o.nx,n=o.ny,s=o.nz,a=t*(e.xMax+e.xMin)+n*(e.yMax+e.yMin)+s*(e.zMax+e.zMin),t<0&&(t=-t),n<0&&(n=-n),s<0&&(s=-s),i=t*(e.xMax-e.xMin)+n*(e.yMax-e.yMin)+s*(e.zMax-e.zMin),a+i-o.d*2<0)return!1;if(o=this.ptop,t=o.nx,n=o.ny,s=o.nz,a=t*(e.xMax+e.xMin)+n*(e.yMax+e.yMin)+s*(e.zMax+e.zMin),t<0&&(t=-t),n<0&&(n=-n),s<0&&(s=-s),i=t*(e.xMax-e.xMin)+n*(e.yMax-e.yMin)+s*(e.zMax-e.zMin),a+i-o.d*2<0)return!1;if(o=this.pbottom,t=o.nx,n=o.ny,s=o.nz,a=t*(e.xMax+e.xMin)+n*(e.yMax+e.yMin)+s*(e.zMax+e.zMin),t<0&&(t=-t),n<0&&(n=-n),s<0&&(s=-s),i=t*(e.xMax-e.xMin)+n*(e.yMax-e.yMin)+s*(e.zMax-e.zMin),a+i-o.d*2<0)return!1;if(this.checkNearFar){if(o=this.pnear,t=o.nx,n=o.ny,s=o.nz,a=t*(e.xMax+e.xMin)+n*(e.yMax+e.yMin)+s*(e.zMax+e.zMin),t<0&&(t=-t),n<0&&(n=-n),s<0&&(s=-s),i=t*(e.xMax-e.xMin)+n*(e.yMax-e.yMin)+s*(e.zMax-e.zMin),a+i-o.d*2<0)return!1;if(o=this.pfar,t=o.nx,n=o.ny,s=o.nz,a=t*(e.xMax+e.xMin)+n*(e.yMax+e.yMin)+s*(e.zMax+e.zMin),t<0&&(t=-t),n<0&&(n=-n),s<0&&(s=-s),i=t*(e.xMax-e.xMin)+n*(e.yMax-e.yMin)+s*(e.zMax-e.zMin),a+i-o.d*2<0)return!1}return!0},hasOrientedBounds:function(e){var t,n,s,r,c,l,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,d=this.pleft,a=d.nx,i=d.ny,o=d.nz;if(o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,c=s,l=n,a=e.xx,i=e.xy,o=e.xz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),C=t,x=s,f=n,a=e.yx,i=e.yy,o=e.yz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),O=t,_=s,g=n,a=e.zx,i=e.zy,o=e.zz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),v=t,b=s,j=n,a=e.centerX,i=e.centerY,o=e.centerZ,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),y=t,p=s,w=n,u=r*C+c*x+l*f,m=r*O+c*_+l*g,h=r*v+c*b+l*j,E=e.hx*(u<0?-u:u)+e.hy*(m<0?-m:m)+e.hz*(h<0?-h:h),k=r*y+c*p+l*w-d.d,k+E<0)return!1;if(d=this.pright,a=d.nx,i=d.ny,o=d.nz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,c=s,l=n,a=e.xx,i=e.xy,o=e.xz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),C=t,x=s,f=n,a=e.yx,i=e.yy,o=e.yz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),O=t,_=s,g=n,a=e.zx,i=e.zy,o=e.zz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),v=t,b=s,j=n,a=e.centerX,i=e.centerY,o=e.centerZ,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),y=t,p=s,w=n,u=r*C+c*x+l*f,m=r*O+c*_+l*g,h=r*v+c*b+l*j,E=e.hx*(u<0?-u:u)+e.hy*(m<0?-m:m)+e.hz*(h<0?-h:h),k=r*y+c*p+l*w-d.d,k+E<0)return!1;if(d=this.ptop,a=d.nx,i=d.ny,o=d.nz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,c=s,l=n,a=e.xx,i=e.xy,o=e.xz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),C=t,x=s,f=n,a=e.yx,i=e.yy,o=e.yz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),O=t,_=s,g=n,a=e.zx,i=e.zy,o=e.zz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),v=t,b=s,j=n,a=e.centerX,i=e.centerY,o=e.centerZ,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),y=t,p=s,w=n,u=r*C+c*x+l*f,m=r*O+c*_+l*g,h=r*v+c*b+l*j,E=e.hx*(u<0?-u:u)+e.hy*(m<0?-m:m)+e.hz*(h<0?-h:h),k=r*y+c*p+l*w-d.d,k+E<0)return!1;if(d=this.pbottom,a=d.nx,i=d.ny,o=d.nz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,c=s,l=n,a=e.xx,i=e.xy,o=e.xz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),C=t,x=s,f=n,a=e.yx,i=e.yy,o=e.yz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),O=t,_=s,g=n,a=e.zx,i=e.zy,o=e.zz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),v=t,b=s,j=n,a=e.centerX,i=e.centerY,o=e.centerZ,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),y=t,p=s,w=n,u=r*C+c*x+l*f,m=r*O+c*_+l*g,h=r*v+c*b+l*j,E=e.hx*(u<0?-u:u)+e.hy*(m<0?-m:m)+e.hz*(h<0?-h:h),k=r*y+c*p+l*w-d.d,k+E<0)return!1;if(this.checkNearFar){if(d=this.pnear,a=d.nx,i=d.ny,o=d.nz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,c=s,l=n,a=e.xx,i=e.xy,o=e.xz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),C=t,x=s,f=n,a=e.yx,i=e.yy,o=e.yz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),O=t,_=s,g=n,a=e.zx,i=e.zy,o=e.zz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),v=t,b=s,j=n,a=e.centerX,i=e.centerY,o=e.centerZ,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),y=t,p=s,w=n,u=r*C+c*x+l*f,m=r*O+c*_+l*g,h=r*v+c*b+l*j,E=e.hx*(u<0?-u:u)+e.hy*(m<0?-m:m)+e.hz*(h<0?-h:h),k=r*y+c*p+l*w-d.d,k+E<0)return!1;if(d=this.pfar,a=d.nx,i=d.ny,o=d.nz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,c=s,l=n,a=e.xx,i=e.xy,o=e.xz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),C=t,x=s,f=n,a=e.yx,i=e.yy,o=e.yz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),O=t,_=s,g=n,a=e.zx,i=e.zy,o=e.zz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),v=t,b=s,j=n,a=e.centerX,i=e.centerY,o=e.centerZ,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),t=a,s=i,n=o,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),y=t,p=s,w=n,u=r*C+c*x+l*f,m=r*O+c*_+l*g,h=r*v+c*b+l*j,E=e.hx*(u<0?-u:u)+e.hy*(m<0?-m:m)+e.hz*(h<0?-h:h),k=r*y+c*p+l*w-d.d,k+E<0)return!1}return!0},__class__:Ja},nt=function(){},c["h3d.col.Ray"]=nt,nt.__name__="h3d.col.Ray",nt.fromPoints=function(e,t){var n=new nt;return n.px=e.x,n.py=e.y,n.pz=e.z,n.lx=t.x-e.x,n.ly=t.y-e.y,n.lz=t.z-e.z,n.normalize(),n},nt.fromValues=function(e,t,n,s,o,i){var a=new nt;return a.px=e,a.py=t,a.pz=n,a.lx=s,a.ly=o,a.lz=i,a.normalize(),a},nt.prototype={clone:function(){var e=new nt;return e.px=this.px,e.py=this.py,e.pz=this.pz,e.lx=this.lx,e.ly=this.ly,e.lz=this.lz,e},load:function(e){this.px=e.px,this.py=e.py,this.pz=e.pz,this.lx=e.lx,this.ly=e.ly,this.lz=e.lz},normalize:function(){var e=this.lx*this.lx+this.ly*this.ly+this.lz*this.lz;if(e==1)return;e<1e-20?e=0:e=1/Math.sqrt(e),this.lx*=e,this.ly*=e,this.lz*=e},transform:function(e){var t,n,s,r,c,l,d,u,h,m,f,p,o=this.px,i=this.py,a=this.pz;a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),r=t,c=n,l=s,m=r*e._11+c*e._21+l*e._31+e._41,f=r*e._12+c*e._22+l*e._32+e._42,p=r*e._13+c*e._23+l*e._33+e._43,r=m,c=f,l=p,this.px=r,this.py=c,this.pz=l,o=this.lx,i=this.ly,a=this.lz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),d=t,u=n,h=s,m=d*e._11+u*e._21+h*e._31,f=d*e._12+u*e._22+h*e._32,p=d*e._13+u*e._23+h*e._33,d=m,u=f,h=p,this.lx=d,this.ly=u,this.lz=h,this.normalize()},getPos:function(){var e=this.px,t=this.py,n=this.pz;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},getDir:function(){var e=this.lx,t=this.ly,n=this.lz;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},getPoint:function(e){var t=this.px+e*this.lx,n=this.py+e*this.ly,s=this.pz+e*this.lz;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},toString:function(){var s,e=this.px,t=this.py,n=this.pz;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),s="Ray{"+o.string(new h(e,t,n))+",",e=this.lx,t=this.ly,n=this.lz,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),s+o.string(new h(e,t,n))+"}"},distance:function(e){var t=this.lx*e.nx+this.ly*e.ny+this.lz*e.nz,n=e.d-(this.px*e.nx+this.py*e.ny+this.pz*e.nz);return(t<0?-t:t)<1e-10?(n<0?-n:n)<1e-10?0:-1:n/t},intersect:function(e){var t,n,s,a,o=this.lx*e.nx+this.ly*e.ny+this.lz*e.nz,i=e.d-(this.px*e.nx+this.py*e.ny+this.pz*e.nz);return(o<0?-o:o)<1e-10?(i<0?-i:i)<1e-10?(t=this.px,n=this.py,s=this.pz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)):null:(a=i/o,t=this.px+this.lx*a,n=this.py+this.ly*a,s=this.pz+this.lz*a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s))},collideFrustum:function(e){var t,n,s,o,i,a,r,c,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,l=this.px,u=this.py,d=this.pz;return d==null&&(d=0),u==null&&(u=0),l==null&&(l=0),r=l,i=u,a=d,a==null&&(a=0),i==null&&(i=0),r==null&&(r=0),n=r,o=i,s=a,C=n*e._11+o*e._21+s*e._31+e._41,O=n*e._12+o*e._22+s*e._32+e._42,x=n*e._13+o*e._23+s*e._33+e._43,c=1/(n*e._14+o*e._24+s*e._34+e._44),n=C*c,o=O*c,s=x*c,l=this.px+this.lx,u=this.py+this.ly,d=this.pz+this.lz,d==null&&(d=0),u==null&&(u=0),l==null&&(l=0),r=l,i=u,a=d,a==null&&(a=0),i==null&&(i=0),r==null&&(r=0),h=r,m=i,f=a,C=h*e._11+m*e._21+f*e._31+e._41,O=h*e._12+m*e._22+f*e._32+e._42,x=h*e._13+m*e._23+f*e._33+e._43,c=1/(h*e._14+m*e._24+f*e._34+e._44),h=C*c,m=O*c,f=x*c,M=h-n,T=m-o,F=f-s,A=1/M,k=1/T,E=1/F,b=(-1-n)*A,w=(1-n)*A,v=(-1-o)*k,_=(1-o)*k,y=(0-s)*E,j=(1-s)*E,g=b>w?w:b,t=v>_?_:v,p=g<t?t:g,t=y>j?j:y,z=p<t?t:p,g=b<w?w:b,t=v<_?_:v,p=g>t?t:g,t=y<j?j:y,S=p>t?t:p,!(S<0||z>S)},collide:function(e){var l=1/this.lx,u=1/this.ly,d=1/this.lz,s=(e.xMin-this.px)*l,o=(e.xMax-this.px)*l,i=(e.yMin-this.py)*u,a=(e.yMax-this.py)*u,r=(e.zMin-this.pz)*d,c=(e.zMax-this.pz)*d,t=s>o?o:s,e=i>a?a:i,n=t<e?e:t,e=r>c?c:r,m=n<e?e:n,t=s<o?o:s,e=i<a?a:i,n=t>e?e:t,e=r<c?c:r,h=n>e?e:n;return!(h<0)&&!(m>h)},__class__:nt},Wn=function(e,t){this.obj=e,this.collider=t},c["h3d.col.ObjectCollider"]=Wn,Wn.__name__="h3d.col.ObjectCollider",Wn.__super__=ot,Wn.prototype=g(ot.prototype,{rayIntersection:function(e,t){var n,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,s=Wn.TMP_RAY;return Wn.TMP_RAY=null,s.px=e.px,s.py=e.py,s.pz=e.pz,s.lx=e.lx,s.ly=e.ly,s.lz=e.lz,n=this.obj.getInvPos(),o=e.px,i=e.py,a=e.pz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,c=i,l=a,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),f=r,j=c,h=l,m=f*n._11+j*n._21+h*n._31+n._41,d=f*n._12+j*n._22+h*n._32+n._42,p=f*n._13+j*n._23+h*n._33+n._43,f=m,j=d,h=p,e.px=f,e.py=j,e.pz=h,o=e.lx,i=e.ly,a=e.lz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,c=i,l=a,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),g=r,v=c,b=l,m=g*n._11+v*n._21+b*n._31,d=g*n._12+v*n._22+b*n._32,p=g*n._13+v*n._23+b*n._33,g=m,v=d,b=p,e.lx=g,e.ly=v,e.lz=b,e.normalize(),u=this.collider.rayIntersection(e,t),u<0?(e.px=s.px,e.py=s.py,e.pz=s.pz,e.lx=s.lx,e.ly=s.ly,e.lz=s.lz,Wn.TMP_RAY=s,u):(o=e.px+u*e.lx,i=e.py+u*e.ly,a=e.pz+u*e.lz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,c=i,l=a,l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),y=r,_=c,w=l,n=this.obj.absPos,m=y*n._11+_*n._21+w*n._31+n._41,d=y*n._12+_*n._22+w*n._32+n._42,p=y*n._13+_*n._23+w*n._33+n._43,y=m,_=d,w=p,e.px=s.px,e.py=s.py,e.pz=s.pz,e.lx=s.lx,e.ly=s.ly,e.lz=s.lz,Wn.TMP_RAY=s,C=y-e.px,E=_-e.py,x=w-e.pz,x==null&&(x=0),O=x,O==null&&(O=0),Math.sqrt(C*C+E*E+O*O))},contains:function(e){var t,s,o,i,l,d,u,h,m,f,p,n=e,c=n.x,r=n.y,a=n.z;return a==null&&(a=0),r==null&&(r=0),c==null&&(c=0),i=c,s=r,o=a,o==null&&(o=0),s==null&&(s=0),i==null&&(i=0),l=i,d=s,u=o,t=this.obj.getInvPos(),h=e.x*t._11+e.y*t._21+e.z*t._31+t._41,m=e.x*t._12+e.y*t._22+e.z*t._32+t._42,f=e.x*t._13+e.y*t._23+e.z*t._33+t._43,e.x=h,e.y=m,e.z=f,p=this.collider.contains(e),n=e,n.x=l,n.y=d,n.z=u,p},inFrustum:function(e,t){if(t==null)return this.collider.inFrustum(e,this.obj.getAbsPos());var C=Wn.TMP_MAT,n=C,s=this.obj.getAbsPos(),w=t._11,x=t._12,O=t._13,m=t._21,_=t._22,f=t._23,j=t._31,b=t._32,v=t._33,y=t._41,p=t._42,g=t._43,o=s._11,h=s._12,u=s._13,d=s._21,l=s._22,c=s._23,r=s._31,a=s._32,i=s._33,E=s._41,k=s._42,A=s._43;return n._11=w*o+x*d+O*r,n._12=w*h+x*l+O*a,n._13=w*u+x*c+O*i,n._14=0,n._21=m*o+_*d+f*r,n._22=m*h+_*l+f*a,n._23=m*u+_*c+f*i,n._24=0,n._31=j*o+b*d+v*r,n._32=j*h+b*l+v*a,n._33=j*u+b*c+v*i,n._34=0,n._41=y*o+p*d+g*r+E,n._42=y*h+p*l+g*a+k,n._43=y*u+p*c+g*i+A,n._44=1,this.collider.inFrustum(e,C)},inSphere:function(e){var t,a,r,c,l,d,u,h,m,f,p,g,v,b,n=this.obj.getInvPos(),j=e.x,y=e.y,_=e.z,w=e.r,s=e.x,o=e.y,i=e.z;return i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),u=s,d=o,l=i,l==null&&(l=0),d==null&&(d=0),u==null&&(u=0),c=u,r=d,a=l,g=c*n._11+r*n._21+a*n._31+n._41,p=c*n._12+r*n._22+a*n._32+n._42,v=c*n._13+r*n._23+a*n._33+n._43,c=g,r=p,a=v,t=n,s=0,o=0,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),f=s,m=o,h=i,f=Math.sqrt(t._11*t._11+t._12*t._12+t._13*t._13),m=Math.sqrt(t._21*t._21+t._22*t._22+t._23*t._23),h=Math.sqrt(t._31*t._31+t._32*t._32+t._33*t._33),t._11*(t._22*t._33-t._23*t._32)+t._12*(t._23*t._31-t._21*t._33)+t._13*(t._21*t._32-t._22*t._31)<0&&(f*=-1,m*=-1,h*=-1),e.x=c,e.y=r,e.z=a,e.r*=Math.max(Math.max(f,m),h),b=this.collider.inSphere(e),e.x=j,e.y=y,e.z=_,e.r=w,b},dimension:function(){var t,n,s,e=this.obj.getAbsPos(),o=0,i=0,a=0;return a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,t=Math.sqrt(e._11*e._11+e._12*e._12+e._13*e._13),n=Math.sqrt(e._21*e._21+e._22*e._22+e._23*e._23),s=Math.sqrt(e._31*e._31+e._32*e._32+e._33*e._33),e._11*(e._22*e._33-e._23*e._32)+e._12*(e._23*e._31-e._21*e._33)+e._13*(e._21*e._32-e._22*e._31)<0&&(t*=-1,n*=-1,s*=-1),this.collider.dimension()*Math.max(Math.max(t,n),s)},closestPoint:function(){throw t.thrown("Not implemented")},makeDebugObj:function(){var e=this.collider.makeDebugObj();return e!=null&&e.set_follow(this.obj),e},__class__:Wn}),Or=function(){this.hz=.5,this.hy=.5,this.hx=.5,this.zz=1,this.zy=0,this.zx=0,this.yz=0,this.yy=1,this.yx=0,this.xz=0,this.xy=0,this.xx=1,this.centerZ=0,this.centerY=0,this.centerX=0},c["h3d.col.OrientedBounds"]=Or,Or.__name__="h3d.col.OrientedBounds",Or.__super__=ot,Or.prototype=g(ot.prototype,{setMatrix:function(e){var n,s,o,i,a,r,t=e,c=0,l=0,d=0;d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),n=c,s=l,o=d,n=Math.sqrt(t._11*t._11+t._12*t._12+t._13*t._13),s=Math.sqrt(t._21*t._21+t._22*t._22+t._23*t._23),o=Math.sqrt(t._31*t._31+t._32*t._32+t._33*t._33),t._11*(t._22*t._33-t._23*t._32)+t._12*(t._23*t._31-t._21*t._33)+t._13*(t._21*t._32-t._22*t._31)<0&&(n*=-1,s*=-1,o*=-1),i=1/n,a=1/s,r=1/o,this.centerX=e._41,this.centerY=e._42,this.centerZ=e._43,this.hx=n/2,this.hy=s/2,this.hz=o/2,this.xx=e._11*i,this.xy=e._12*i,this.xz=e._13*i,this.yx=e._21*a,this.yy=e._22*a,this.yz=e._23*a,this.zx=e._31*r,this.zy=e._32*r,this.zz=e._33*r},setEulerAngles:function(e,t,n){var s=Math.cos(e),o=Math.sin(e),c=Math.cos(t),i=Math.sin(t),a=Math.cos(n),r=Math.sin(n);this.xx=c*a,this.xy=o*i*a+s*r,this.xz=-s*i*a+o*r,this.yx=-c*r,this.yy=-o*i*r+s*a,this.yz=s*i*r+o*a,this.zx=i,this.zy=-o*c,this.zz=s*c},collideOrientedBounds:function(e){var t,n,s,o,c,l,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,B,V,$,W,U,K,q,Y,se,ne,te,ee,d,u,h,G,X,Q,Z,J,i=this.xx,a=this.xy,r=this.xz;return r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),D=n,N=s,L=o,i=this.yx,a=this.yy,r=this.yz,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),R=n,H=s,P=o,i=this.zx,a=this.zy,r=this.zz,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),T=n,z=s,F=o,i=e.xx,a=e.xy,r=e.xz,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),W=n,Y=s,q=o,i=e.yx,a=e.yy,r=e.yz,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),K=n,V=s,B=o,i=e.zx,a=e.zy,r=e.zz,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),I=n,U=s,$=o,C=D*W+N*Y+L*q,E=D*K+N*V+L*B,k=D*I+N*U+L*$,A=R*W+H*Y+P*q,S=R*K+H*V+P*B,M=R*I+H*U+P*$,p=T*W+z*Y+F*q,x=T*K+z*V+F*B,O=T*I+z*U+F*$,i=this.centerX,a=this.centerY,r=this.centerZ,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),se=n,ne=s,te=o,i=e.centerX,a=e.centerY,r=e.centerZ,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),ee=n,G=s,J=o,i=ee-se,a=G-ne,r=J-te,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n=i,s=a,o=r,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),d=n,u=s,h=o,Z=d*D+u*N+h*L,Q=d*R+u*H+h*P,X=d*T+u*z+h*F,d=Z,u=Q,h=X,m=(C<0?-C:C)+1e-10,b=(E<0?-E:E)+1e-10,v=(k<0?-k:k)+1e-10,g=(A<0?-A:A)+1e-10,w=(S<0?-S:S)+1e-10,j=(M<0?-M:M)+1e-10,y=(p<0?-p:p)+1e-10,_=(x<0?-x:x)+1e-10,f=(O<0?-O:O)+1e-10,l=this.hx,c=e.hx*m+e.hy*b+e.hz*v,t=d,!((t<0?-t:t)>l+c)&&(l=this.hy,c=e.hx*g+e.hy*w+e.hz*j,t=u,!((t<0?-t:t)>l+c)&&(l=this.hz,c=e.hx*y+e.hy*_+e.hz*f,t=h,!((t<0?-t:t)>l+c)&&(l=this.hx*m+this.hy*g+this.hz*y,c=e.hx,t=d*C+u*A+h*p,!((t<0?-t:t)>l+c)&&(l=this.hx*b+this.hy*w+this.hz*_,c=e.hy,t=d*E+u*S+h*x,!((t<0?-t:t)>l+c)&&(l=this.hx*v+this.hy*j+this.hz*f,c=e.hz,t=d*k+u*M+h*O,!((t<0?-t:t)>l+c)&&(l=this.hy*y+this.hz*g,c=e.hy*v+e.hz*b,t=h*A-u*p,!((t<0?-t:t)>l+c)&&(l=this.hy*_+this.hz*w,c=e.hx*v+e.hz*m,t=h*S-u*x,!((t<0?-t:t)>l+c)&&(l=this.hy*f+this.hz*j,c=e.hx*b+e.hy*m,t=h*M-u*O,!((t<0?-t:t)>l+c)&&(l=this.hx*y+this.hz*m,c=e.hy*j+e.hz*w,t=d*p-h*C,!((t<0?-t:t)>l+c)&&(l=this.hx*_+this.hz*b,c=e.hx*j+e.hz*g,t=d*x-h*E,!((t<0?-t:t)>l+c)&&(l=this.hx*f+this.hz*v,c=e.hx*w+e.hy*g,t=d*O-h*k,!((t<0?-t:t)>l+c)&&(l=this.hx*g+this.hy*m,c=e.hy*f+e.hz*_,t=u*C-d*A,!((t<0?-t:t)>l+c)&&(l=this.hx*w+this.hy*b,c=e.hx*f+e.hz*y,t=u*E-d*S,!((t<0?-t:t)>l+c)&&(l=this.hx*j+this.hy*v,c=e.hx*_+e.hy*y,t=u*k-d*M,!((t<0?-t:t)>l+c)))))))))))))))},rayIntersection:function(e){var n,s,i,r,f=e.px-this.centerX,g=e.py-this.centerY,p=e.pz-this.centerZ,c=f*this.xx+g*this.xy+p*this.xz,m=f*this.yx+g*this.yy+p*this.yz,h=f*this.zx+g*this.zy+p*this.zz,u=e.lx*this.xx+e.ly*this.xy+e.lz*this.xz,l=e.lx*this.yx+e.ly*this.yy+e.lz*this.yz,d=e.lx*this.zx+e.ly*this.zy+e.lz*this.zz,o=0,a=1/0;if((u<0?-u:u)<1e-10){if(c<-this.hx||c>this.hx)return-1}else if(i=1/u,s=(-this.hx-c)*i,n=(this.hx-c)*i,s>n&&(r=n,n=s,s=r),s>o&&(o=s),n<a&&(a=n),o>a)return-1;if((l<0?-l:l)<1e-10){if(m<-this.hy||m>this.hy)return-1}else if(i=1/l,s=(-this.hy-m)*i,n=(this.hy-m)*i,s>n&&(r=n,n=s,s=r),s>o&&(o=s),n<a&&(a=n),o>a)return-1;if((d<0?-d:d)<1e-10){if(h<-this.hz||h>this.hz)return-1}else if(i=1/d,s=(-this.hz-h)*i,n=(this.hz-h)*i,s>n&&(r=n,n=s,s=r),s>o&&(o=s),n<a&&(a=n),o>a)return-1;return o},contains:function(e){var c,n=e.x-this.centerX,s=e.y-this.centerY,o=e.z-this.centerZ,i=n*this.xx+s*this.xy+o*this.xz,a=n*this.yx+s*this.yy+o*this.yz,r=n*this.zx+s*this.zy+o*this.zz,t=this.hx;return(t<0?-t:t)-(i<0?-i:i)>-1e-10?(t=this.hy,c=(t<0?-t:t)-(a<0?-a:a)>-1e-10):c=!1,!!c&&(t=this.hz,(t<0?-t:t)-(r<0?-r:r)>-1e-10)},inFrustum:function(e,n){if(n!=null)throw t.thrown("Not implemented");return e.hasOrientedBounds(this)},inSphere:function(e){var t,n,s,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,o=e.x,i=e.y,a=e.z;return a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),N=t,D=n,z=s,T=e.r*e.r,A=-1,k=-1,E=-1,o=this.xx,i=this.xy,a=this.xz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),f=t,u=n,g=s,o=this.yx,i=this.yy,a=this.yz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),v=t,b=n,j=s,o=this.zx,i=this.zy,a=this.zz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),y=t,_=n,w=s,o=this.centerX,i=this.centerY,a=this.centerZ,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),C=t,x=n,O=s,r=A*this.hx,f*=r,u*=r,g*=r,r=k*this.hy,v*=r,b*=r,j*=r,r=E*this.hz,y*=r,_*=r,w*=r,o=C+f,i=x+u,a=O+g,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+v,i=c+b,a=d+j,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+y,i=c+_,a=d+w,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),S=t,M=n,F=s,p=N-S,h=D-M,m=z-F,!(p*p+h*h+m*m>T)&&(A=1,k=-1,E=-1,o=this.xx,i=this.xy,a=this.xz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),f=t,u=n,g=s,o=this.yx,i=this.yy,a=this.yz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),v=t,b=n,j=s,o=this.zx,i=this.zy,a=this.zz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),y=t,_=n,w=s,o=this.centerX,i=this.centerY,a=this.centerZ,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),C=t,x=n,O=s,r=A*this.hx,f*=r,u*=r,g*=r,r=k*this.hy,v*=r,b*=r,j*=r,r=E*this.hz,y*=r,_*=r,w*=r,o=C+f,i=x+u,a=O+g,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+v,i=c+b,a=d+j,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+y,i=c+_,a=d+w,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),S=t,M=n,F=s,p=N-S,h=D-M,m=z-F,!(p*p+h*h+m*m>T)&&(A=-1,k=1,E=-1,o=this.xx,i=this.xy,a=this.xz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),f=t,u=n,g=s,o=this.yx,i=this.yy,a=this.yz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),v=t,b=n,j=s,o=this.zx,i=this.zy,a=this.zz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),y=t,_=n,w=s,o=this.centerX,i=this.centerY,a=this.centerZ,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),C=t,x=n,O=s,r=A*this.hx,f*=r,u*=r,g*=r,r=k*this.hy,v*=r,b*=r,j*=r,r=E*this.hz,y*=r,_*=r,w*=r,o=C+f,i=x+u,a=O+g,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+v,i=c+b,a=d+j,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+y,i=c+_,a=d+w,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),S=t,M=n,F=s,p=N-S,h=D-M,m=z-F,!(p*p+h*h+m*m>T)&&(A=1,k=1,E=-1,o=this.xx,i=this.xy,a=this.xz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),f=t,u=n,g=s,o=this.yx,i=this.yy,a=this.yz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),v=t,b=n,j=s,o=this.zx,i=this.zy,a=this.zz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),y=t,_=n,w=s,o=this.centerX,i=this.centerY,a=this.centerZ,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),C=t,x=n,O=s,r=A*this.hx,f*=r,u*=r,g*=r,r=k*this.hy,v*=r,b*=r,j*=r,r=E*this.hz,y*=r,_*=r,w*=r,o=C+f,i=x+u,a=O+g,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+v,i=c+b,a=d+j,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+y,i=c+_,a=d+w,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),S=t,M=n,F=s,p=N-S,h=D-M,m=z-F,!(p*p+h*h+m*m>T)&&(A=-1,k=-1,E=1,o=this.xx,i=this.xy,a=this.xz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),f=t,u=n,g=s,o=this.yx,i=this.yy,a=this.yz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),v=t,b=n,j=s,o=this.zx,i=this.zy,a=this.zz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),y=t,_=n,w=s,o=this.centerX,i=this.centerY,a=this.centerZ,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),C=t,x=n,O=s,r=A*this.hx,f*=r,u*=r,g*=r,r=k*this.hy,v*=r,b*=r,j*=r,r=E*this.hz,y*=r,_*=r,w*=r,o=C+f,i=x+u,a=O+g,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+v,i=c+b,a=d+j,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+y,i=c+_,a=d+w,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),S=t,M=n,F=s,p=N-S,h=D-M,m=z-F,!(p*p+h*h+m*m>T)&&(A=1,k=-1,E=1,o=this.xx,i=this.xy,a=this.xz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),f=t,u=n,g=s,o=this.yx,i=this.yy,a=this.yz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),v=t,b=n,j=s,o=this.zx,i=this.zy,a=this.zz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),y=t,_=n,w=s,o=this.centerX,i=this.centerY,a=this.centerZ,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),C=t,x=n,O=s,r=A*this.hx,f*=r,u*=r,g*=r,r=k*this.hy,v*=r,b*=r,j*=r,r=E*this.hz,y*=r,_*=r,w*=r,o=C+f,i=x+u,a=O+g,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+v,i=c+b,a=d+j,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+y,i=c+_,a=d+w,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),S=t,M=n,F=s,p=N-S,h=D-M,m=z-F,!(p*p+h*h+m*m>T)&&(A=-1,k=1,E=1,o=this.xx,i=this.xy,a=this.xz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),f=t,u=n,g=s,o=this.yx,i=this.yy,a=this.yz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),v=t,b=n,j=s,o=this.zx,i=this.zy,a=this.zz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),y=t,_=n,w=s,o=this.centerX,i=this.centerY,a=this.centerZ,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),C=t,x=n,O=s,r=A*this.hx,f*=r,u*=r,g*=r,r=k*this.hy,v*=r,b*=r,j*=r,r=E*this.hz,y*=r,_*=r,w*=r,o=C+f,i=x+u,a=O+g,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+v,i=c+b,a=d+j,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+y,i=c+_,a=d+w,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),S=t,M=n,F=s,p=N-S,h=D-M,m=z-F,!(p*p+h*h+m*m>T)&&(A=1,k=1,E=1,o=this.xx,i=this.xy,a=this.xz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),f=t,u=n,g=s,o=this.yx,i=this.yy,a=this.yz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),v=t,b=n,j=s,o=this.zx,i=this.zy,a=this.zz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),y=t,_=n,w=s,o=this.centerX,i=this.centerY,a=this.centerZ,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),C=t,x=n,O=s,r=A*this.hx,f*=r,u*=r,g*=r,r=k*this.hy,v*=r,b*=r,j*=r,r=E*this.hz,y*=r,_*=r,w*=r,o=C+f,i=x+u,a=O+g,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+v,i=c+b,a=d+j,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l=t,c=n,d=s,o=l+y,i=c+_,a=d+w,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),S=t,M=n,F=s,p=N-S,h=D-M,m=z-F,!(p*p+h*h+m*m>T))))))))},dimension:function(){var e=this.hx,t=this.hy,n=this.hz,s=t<n?n:t;return 2*(e<s?s:e)},getVertice:function(e){var o,i,a,r,c,l,d,u,m,f,p,g,v,b,j,y,_,w,O,x=(e&1)*2-1,E=(e>>1&1)*2-1,C=(e>>2&1)*2-1,t=this.xx,n=this.xy,s=this.xz;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,y=i,j=a,t=this.yx,n=this.yy,s=this.yz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),u=o,p=i,g=a,t=this.zx,n=this.zy,s=this.zz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),v=o,b=i,m=a,t=this.centerX,n=this.centerY,s=this.centerZ,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),O=o,_=i,w=a,r=x*this.hx,f*=r,y*=r,j*=r,r=E*this.hy,u*=r,p*=r,g*=r,r=C*this.hz,v*=r,b*=r,m*=r,t=O+f,n=_+y,s=w+j,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+u,n=l+p,s=c+g,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+v,n=l+b,s=c+m,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},getVertices:function(e){var t,n,s,o,i,a,r,c,l,d,u,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k=e;return e=k??[],E=-1,C=-1,x=-1,t=this.xx,n=this.xy,s=this.xz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,j=i,u=a,t=this.yx,n=this.yy,s=this.yz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),p=o,g=i,v=a,t=this.zx,n=this.zy,s=this.zz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),b=o,m=i,y=a,t=this.centerX,n=this.centerY,s=this.centerZ,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),_=o,w=i,O=a,r=E*this.hx,f*=r,j*=r,u*=r,r=C*this.hy,p*=r,g*=r,v*=r,r=x*this.hz,b*=r,m*=r,y*=r,t=_+f,n=w+j,s=O+u,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+p,n=l+g,s=c+v,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+b,n=l+m,s=c+y,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.push(new h(t,n,s)),E=1,C=-1,x=-1,t=this.xx,n=this.xy,s=this.xz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,j=i,u=a,t=this.yx,n=this.yy,s=this.yz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),p=o,g=i,v=a,t=this.zx,n=this.zy,s=this.zz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),b=o,m=i,y=a,t=this.centerX,n=this.centerY,s=this.centerZ,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),_=o,w=i,O=a,r=E*this.hx,f*=r,j*=r,u*=r,r=C*this.hy,p*=r,g*=r,v*=r,r=x*this.hz,b*=r,m*=r,y*=r,t=_+f,n=w+j,s=O+u,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+p,n=l+g,s=c+v,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+b,n=l+m,s=c+y,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.push(new h(t,n,s)),E=-1,C=1,x=-1,t=this.xx,n=this.xy,s=this.xz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,j=i,u=a,t=this.yx,n=this.yy,s=this.yz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),p=o,g=i,v=a,t=this.zx,n=this.zy,s=this.zz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),b=o,m=i,y=a,t=this.centerX,n=this.centerY,s=this.centerZ,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),_=o,w=i,O=a,r=E*this.hx,f*=r,j*=r,u*=r,r=C*this.hy,p*=r,g*=r,v*=r,r=x*this.hz,b*=r,m*=r,y*=r,t=_+f,n=w+j,s=O+u,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+p,n=l+g,s=c+v,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+b,n=l+m,s=c+y,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.push(new h(t,n,s)),E=1,C=1,x=-1,t=this.xx,n=this.xy,s=this.xz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,j=i,u=a,t=this.yx,n=this.yy,s=this.yz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),p=o,g=i,v=a,t=this.zx,n=this.zy,s=this.zz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),b=o,m=i,y=a,t=this.centerX,n=this.centerY,s=this.centerZ,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),_=o,w=i,O=a,r=E*this.hx,f*=r,j*=r,u*=r,r=C*this.hy,p*=r,g*=r,v*=r,r=x*this.hz,b*=r,m*=r,y*=r,t=_+f,n=w+j,s=O+u,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+p,n=l+g,s=c+v,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+b,n=l+m,s=c+y,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.push(new h(t,n,s)),E=-1,C=-1,x=1,t=this.xx,n=this.xy,s=this.xz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,j=i,u=a,t=this.yx,n=this.yy,s=this.yz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),p=o,g=i,v=a,t=this.zx,n=this.zy,s=this.zz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),b=o,m=i,y=a,t=this.centerX,n=this.centerY,s=this.centerZ,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),_=o,w=i,O=a,r=E*this.hx,f*=r,j*=r,u*=r,r=C*this.hy,p*=r,g*=r,v*=r,r=x*this.hz,b*=r,m*=r,y*=r,t=_+f,n=w+j,s=O+u,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+p,n=l+g,s=c+v,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+b,n=l+m,s=c+y,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.push(new h(t,n,s)),E=1,C=-1,x=1,t=this.xx,n=this.xy,s=this.xz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,j=i,u=a,t=this.yx,n=this.yy,s=this.yz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),p=o,g=i,v=a,t=this.zx,n=this.zy,s=this.zz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),b=o,m=i,y=a,t=this.centerX,n=this.centerY,s=this.centerZ,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),_=o,w=i,O=a,r=E*this.hx,f*=r,j*=r,u*=r,r=C*this.hy,p*=r,g*=r,v*=r,r=x*this.hz,b*=r,m*=r,y*=r,t=_+f,n=w+j,s=O+u,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+p,n=l+g,s=c+v,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+b,n=l+m,s=c+y,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.push(new h(t,n,s)),E=-1,C=1,x=1,t=this.xx,n=this.xy,s=this.xz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,j=i,u=a,t=this.yx,n=this.yy,s=this.yz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),p=o,g=i,v=a,t=this.zx,n=this.zy,s=this.zz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),b=o,m=i,y=a,t=this.centerX,n=this.centerY,s=this.centerZ,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),_=o,w=i,O=a,r=E*this.hx,f*=r,j*=r,u*=r,r=C*this.hy,p*=r,g*=r,v*=r,r=x*this.hz,b*=r,m*=r,y*=r,t=_+f,n=w+j,s=O+u,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+p,n=l+g,s=c+v,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+b,n=l+m,s=c+y,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.push(new h(t,n,s)),E=1,C=1,x=1,t=this.xx,n=this.xy,s=this.xz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,j=i,u=a,t=this.yx,n=this.yy,s=this.yz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),p=o,g=i,v=a,t=this.zx,n=this.zy,s=this.zz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),b=o,m=i,y=a,t=this.centerX,n=this.centerY,s=this.centerZ,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),_=o,w=i,O=a,r=E*this.hx,f*=r,j*=r,u*=r,r=C*this.hy,p*=r,g*=r,v*=r,r=x*this.hz,b*=r,m*=r,y*=r,t=_+f,n=w+j,s=O+u,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+p,n=l+g,s=c+v,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,l=i,c=a,t=d+b,n=l+m,s=c+y,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.push(new h(t,n,s)),e},closestPoint:function(){throw t.thrown("not implemented")},testPlane:function(e){var t,n,s,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,o=e.nx,i=e.ny,a=e.nz;return a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),r=t,c=n,l=s,o=this.xx,i=this.xy,a=this.xz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),x=t,O=n,w=s,o=this.yx,i=this.yy,a=this.yz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),m=t,y=n,p=s,o=this.zx,i=this.zy,a=this.zz,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),g=t,v=n,b=s,o=this.centerX,i=this.centerY,a=this.centerZ,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),j=t,f=n,_=s,h=r*x+c*O+l*w,u=r*m+c*y+l*p,d=r*g+c*v+l*b,C=this.hx*(h<0?-h:h)+this.hy*(u<0?-u:u)+this.hz*(d<0?-d:d),E=r*j+c*f+l*_-e.d,E+C},makeDebugObj:function(){var t=new Gn,e=this.getVertices();return t.lineStyle(1,16777215,1),t.moveTo(e[0].x,e[0].y,e[0].z),t.lineTo(e[4].x,e[4].y,e[4].z),t.moveTo(e[1].x,e[1].y,e[1].z),t.lineTo(e[5].x,e[5].y,e[5].z),t.moveTo(e[2].x,e[2].y,e[2].z),t.lineTo(e[6].x,e[6].y,e[6].z),t.moveTo(e[3].x,e[3].y,e[3].z),t.lineTo(e[7].x,e[7].y,e[7].z),t.moveTo(e[0].x,e[0].y,e[0].z),t.lineTo(e[1].x,e[1].y,e[1].z),t.lineTo(e[3].x,e[3].y,e[3].z),t.lineTo(e[2].x,e[2].y,e[2].z),t.lineTo(e[0].x,e[0].y,e[0].z),t.moveTo(e[4].x,e[4].y,e[4].z),t.lineTo(e[5].x,e[5].y,e[5].z),t.lineTo(e[7].x,e[7].y,e[7].z),t.lineTo(e[6].x,e[6].y,e[6].z),t.lineTo(e[4].x,e[4].y,e[4].z),t},__class__:Or}),Te=function(e,t,n,s){this.nx=e,this.ny=t,this.nz=n,this.d=s},c["h3d.col.Plane"]=Te,Te.__name__="h3d.col.Plane",Te.fromPoints=function(e,t,n){var s,o,i,l,d,u,h,m,f,a=t.x-e.x,r=t.y-e.y,c=t.z-e.z;return c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),s=a,o=r,i=c,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),l=s,d=o,u=i,a=n.x-e.x,r=n.y-e.y,c=n.z-e.z,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),s=a,o=r,i=c,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),h=s,m=o,f=i,a=d*f-u*m,r=u*h-l*f,c=l*m-d*h,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),s=a,o=r,i=c,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),l=s,d=o,u=i,new Te(l,d,u,l*e.x+d*e.y+u*e.z)},Te.fromNormalPoint=function(e,t){var n=e;return new Te(e.x,e.y,e.z,n.x*t.x+n.y*t.y+n.z*t.z)},Te.X=function(e){return e==null&&(e=0),new Te(1,0,0,e)},Te.Y=function(e){return e==null&&(e=0),new Te(0,1,0,e)},Te.Z=function(e){return e==null&&(e=0),new Te(0,0,1,e)},Te.frustumLeft=function(e){return new Te(e._14+e._11,e._24+e._21,e._34+e._31,-(e._44+e._41))},Te.frustumRight=function(e){return new Te(e._14-e._11,e._24-e._21,e._34-e._31,e._41-e._44)},Te.frustumBottom=function(e){return new Te(e._14+e._12,e._24+e._22,e._34+e._32,-(e._44+e._42))},Te.frustumTop=function(e){return new Te(e._14-e._12,e._24-e._22,e._34-e._32,e._42-e._44)},Te.frustumNear=function(e){return new Te(e._13,e._23,e._33,-e._43)},Te.frustumFar=function(e){return new Te(e._14-e._13,e._24-e._23,e._34-e._33,e._43-e._44)},Te.prototype={getNormal:function(){var e=this.nx,t=this.ny,n=this.nz;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},getNormalDistance:function(){return this.d},load:function(e){this.nx=e.nx,this.ny=e.ny,this.nz=e.nz,this.d=e.d},transform:function(e){var n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,t=new L;t.initInverse(e),t.transpose(),m=this.nx,h=this.ny,u=this.nz,a=-this.d,a==null&&(a=1),u==null&&(u=0),h==null&&(h=0),m==null&&(m=0),d=m,r=h,c=u,l=a,l==null&&(l=1),c==null&&(c=0),r==null&&(r=0),d==null&&(d=0),n=d,i=r,o=c,s=l,f=n*t._11+i*t._21+o*t._31+s*t._41,p=n*t._12+i*t._22+o*t._32+s*t._42,g=n*t._13+i*t._23+o*t._33+s*t._43,v=n*t._14+i*t._24+o*t._34+s*t._44,n=f,i=p,o=g,s=v,this.nx=n,this.ny=i,this.nz=o,this.d=-s},transform3x3:function(e){var n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,t=new L;t.initInverse3x3(e),t.transpose(),m=this.nx,h=this.ny,u=this.nz,a=-this.d,a==null&&(a=1),u==null&&(u=0),h==null&&(h=0),m==null&&(m=0),d=m,r=h,c=u,l=a,l==null&&(l=1),c==null&&(c=0),r==null&&(r=0),d==null&&(d=0),n=d,i=r,o=c,s=l,f=n*t._11+i*t._21+o*t._31+s*t._41,p=n*t._12+i*t._22+o*t._32+s*t._42,g=n*t._13+i*t._23+o*t._33+s*t._43,v=n*t._14+i*t._24+o*t._34+s*t._44,n=f,i=p,o=g,s=v,this.nx=n,this.ny=i,this.nz=o,this.d=-s},transformInverseTranspose:function(e){var t,n,s,o,i,a,r,c,m,f,p,g,l=this.nx,h=this.ny,u=this.nz,d=-this.d;d==null&&(d=1),u==null&&(u=0),h==null&&(h=0),l==null&&(l=0),i=l,a=h,r=u,c=d,c==null&&(c=1),r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),t=i,o=a,s=r,n=c,m=t*e._11+o*e._21+s*e._31+n*e._41,f=t*e._12+o*e._22+s*e._32+n*e._42,p=t*e._13+o*e._23+s*e._33+n*e._43,g=t*e._14+o*e._24+s*e._34+n*e._44,t=m,o=f,s=p,n=g,this.nx=t,this.ny=o,this.nz=s,this.d=-n},normalize:function(){var e=1/Math.sqrt(this.nx*this.nx+this.ny*this.ny+this.nz*this.nz);this.nx*=e,this.ny*=e,this.nz*=e,this.d*=e},toString:function(){var e=this.nx,t=this.ny,n=this.nz;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),"Plane{"+o.string(new h(e,t,n))+","+x.fmt(this.d)+"}"},distance:function(e){return this.nx*e.x+this.ny*e.y+this.nz*e.z-this.d},side:function(e){return this.nx*e.x+this.ny*e.y+this.nz*e.z-this.d>=0},project:function(e){var t=this.nx*e.x+this.ny*e.y+this.nz*e.z-this.d,n=e.x-t*this.nx,s=e.y-t*this.ny,o=e.z-t*this.nz;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),new h(n,s,o)},projectTo:function(e,t){var n=this.nx*e.x+this.ny*e.y+this.nz*e.z-this.d;t.x=e.x-n*this.nx,t.y=e.y-n*this.ny,t.z=e.z-n*this.nz},__class__:Te},Os=function(e){e==null&&(e=!1),this.next=null,this.oriented=e},c["h3d.col.TriPlane"]=Os,Os.__name__="h3d.col.TriPlane",Os.__super__=ot,Os.prototype=g(ot.prototype,{init:function(e,t,n){this.p0x=e.x,this.p0y=e.y,this.p0z=e.z;var s,o,i,l,d,u,h,m,f,p,g,v,a=t.x-e.x,r=t.y-e.y,c=t.z-e.z;c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),s=a,o=r,i=c,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),l=s,d=o,u=i,a=n.x-e.x,r=n.y-e.y,c=n.z-e.z,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),s=a,o=r,i=c,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),h=s,m=o,f=i,a=d*f-u*m,r=u*h-l*f,c=l*m-d*h,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),s=a,o=r,i=c,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),p=s,g=o,v=i,this.d=p*e.x+g*e.y+v*e.z,this.nx=p,this.ny=g,this.nz=v,this.d1x=l,this.d1y=d,this.d1z=u,this.d2x=h,this.d2y=m,this.d2z=f,this.dot00=l*l+d*d+u*u,this.dot01=l*h+d*m+u*f,this.dot11=h*h+m*m+f*f,this.invDenom=1/(this.dot00*this.dot11-this.dot01*this.dot01)},clone:function(){var e=new Os(this.oriented);return e.p0x=this.p0x,e.p0y=this.p0y,e.p0z=this.p0z,e.d1x=this.d1x,e.d1y=this.d1y,e.d1z=this.d1z,e.d2x=this.d2x,e.d2y=this.d2y,e.d2z=this.d2z,e.dot00=this.dot00,e.dot01=this.dot01,e.dot11=this.dot11,e.invDenom=this.invDenom,e.nx=this.nx,e.ny=this.ny,e.nz=this.nz,e.d=this.d,this.next!=null&&(e.next=this.next.clone()),e},load:function(e){this.p0x=e.p0x,this.p0y=e.p0y,this.p0z=e.p0z,this.d1x=e.d1x,this.d1y=e.d1y,this.d1z=e.d1z,this.d2x=e.d2x,this.d2y=e.d2y,this.d2z=e.d2z,this.dot00=e.dot00,this.dot01=e.dot01,this.dot11=e.dot11,this.invDenom=e.invDenom,this.nx=e.nx,this.ny=e.ny,this.nz=e.nz,this.d=e.d},transform:function(e){var t,n,s,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,o=this.p0x,i=this.p0y,a=this.p0z;a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),r=t,c=n,l=s,o=this.d1x+this.p0x,i=this.d1y+this.p0y,a=this.d1z+this.p0z,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),j=t,_=n,x=s,o=this.d2x+this.p0x,i=this.d2y+this.p0y,a=this.d2z+this.p0z,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),O=t,w=n,g=s,y=r*e._11+c*e._21+l*e._31+e._41,v=r*e._12+c*e._22+l*e._32+e._42,b=r*e._13+c*e._23+l*e._33+e._43,r=y,c=v,l=b,y=j*e._11+_*e._21+x*e._31+e._41,v=j*e._12+_*e._22+x*e._32+e._42,b=j*e._13+_*e._23+x*e._33+e._43,j=y,_=v,x=b,y=O*e._11+w*e._21+g*e._31+e._41,v=O*e._12+w*e._22+g*e._32+e._42,b=O*e._13+w*e._23+g*e._33+e._43,O=y,w=v,g=b,this.p0x=r,this.p0y=c,this.p0z=l,o=j-r,i=_-c,a=x-l,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),d=t,u=n,p=s,o=O-r,i=w-c,a=g-l,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),f=t,m=n,h=s,o=u*h-p*m,i=p*f-d*h,a=d*m-u*f,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t=o,n=i,s=a,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),C=t,E=n,k=s,this.d=C*r+E*c+k*l,this.nx=C,this.ny=E,this.nz=k,this.d1x=d,this.d1y=u,this.d1z=p,this.d2x=f,this.d2y=m,this.d2z=h,this.dot00=d*d+u*u+p*p,this.dot01=d*f+u*m+p*h,this.dot11=f*f+m*m+h*h,this.invDenom=1/(this.dot00*this.dot11-this.dot01*this.dot01)},contains:function(e){var t,n,s,o,c,l,d,u,h,m,r=e.x-this.p0x,a=e.y-this.p0y,i=e.z-this.p0z;return i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),t=r,s=a,n=i,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),o=t,c=s,l=n,d=this.d1x*o+this.d1y*c+this.d1z*l,u=this.d2x*o+this.d2y*c+this.d2z*l,h=(this.dot11*d-this.dot01*u)*this.invDenom,m=(this.dot00*u-this.dot01*d)*this.invDenom,h>=0&&m>=0&&h+m<1},side:function(e){return this.nx*e.x+this.ny*e.y+this.nz*e.z-this.d>=0},inFrustum:function(){throw t.thrown("Not implemented")},inSphere:function(){throw t.thrown("Not implemented")},closestPoint:function(e){var o,i,a,r,c,l,d,u,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,B,V,$,W,U,K,q,Y,t=this.p0x,n=this.p0y,s=this.p0z;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),w=o,j=i,_=a,t=e.x-this.p0x,n=e.y-this.p0y,s=e.z-this.p0z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),z=o,R=i,F=a,I=this.d1x*z+this.d1y*R+this.d1z*F,T=this.d2x*z+this.d2y*R+this.d2z*F,B=(this.dot11*I-this.dot01*T)*this.invDenom,y=(this.dot00*T-this.dot01*I)*this.invDenom,B>=0&&y>=0&&B+y<1?(t=e.x-w,n=e.y-j,s=e.z-_,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,l=i,c=a,t=this.nx,n=this.ny,s=this.nz,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,m=i,u=a,p=f*f+m*m+u*u,p<1e-20?p=0:p=1/Math.sqrt(p),f*=p,m*=p,u*=p,y=r*f+l*m+c*u,t=f*y,n=m*y,s=u*y,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),g=o,v=i,b=a,t=r-g,n=l-v,s=c-b,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),V=o,U=i,K=a,t=w+V,n=j+U,s=_+K,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)):(t=this.d1x,n=this.d1y,s=this.d1z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,l=i,c=a,t=this.d2x,n=this.d2y,s=this.d2z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,m=i,u=a,t=this.p0x,n=this.p0y,s=this.p0z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),q=o,$=i,Y=a,t=q+r,n=$+l,s=Y+c,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),D=o,N=i,L=a,t=e.x-w,n=e.y-j,s=e.z-_,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),A=o,M=i,S=a,d=(A*r+M*l+S*c)/(r*r+l*l+c*c),d<0?d=0:d>1&&(d=1),t=r*d,n=l*d,s=c*d,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),g=o,v=i,b=a,t=w+g,n=j+v,s=_+b,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),O=new h(t,n,s),t=f-r,n=m-l,s=u-c,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,l=i,c=a,t=e.x-D,n=e.y-N,s=e.z-L,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),A=o,M=i,S=a,d=(A*r+M*l+S*c)/(r*r+l*l+c*c),d<0?d=0:d>1&&(d=1),t=r*d,n=l*d,s=c*d,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),g=o,v=i,b=a,t=D+g,n=N+v,s=L+b,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),x=new h(t,n,s),t=e.x-w,n=e.y-j,s=e.z-_,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,l=i,c=a,d=(r*f+l*m+c*u)/(f*f+m*m+u*u),d<0?d=0:d>1&&(d=1),t=f*d,n=m*d,s=u*d,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),g=o,v=i,b=a,t=w+g,n=j+v,s=_+b,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),C=new h(t,n,s),t=e.x-O.x,n=e.y-O.y,s=e.z-O.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,l=i,c=a,W=r*r+l*l+c*c,t=e.x-x.x,n=e.y-x.y,s=e.z-x.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,l=i,c=a,H=r*r+l*l+c*c,t=e.x-C.x,n=e.y-C.y,s=e.z-C.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,l=i,c=a,P=r*r+l*l+c*c,E=W,k=O,H<E&&(E=H,k=x),P<E&&(E=P,k=C),k)},rayIntersection:function(e){var n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y=e.lx*this.nx+e.ly*this.ny+e.lz*this.nz;return y>=0&&this.oriented?-1:(j=this.d-(e.px*this.nx+e.py*this.ny+e.pz*this.nz),n=j/y,n<0&&this.oriented?-1:(b=e.px+e.lx*n,v=e.py+e.ly*n,g=e.pz+e.lz*n,c=b-this.p0x,s=v-this.p0y,r=g-this.p0z,r==null&&(r=0),s==null&&(s=0),c==null&&(c=0),a=c,i=s,o=r,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),l=a,d=i,u=o,h=this.d1x*l+this.d1y*d+this.d1z*u,m=this.d2x*l+this.d2y*d+this.d2z*u,f=(this.dot11*h-this.dot01*m)*this.invDenom,p=(this.dot00*m-this.dot01*h)*this.invDenom,f>=0&&p>=0&&f+p<1?n:-1))},isPointInTriangle:function(e,t,n){var e,t,n,a,r,c,l,d,u,h,s=e-this.p0x,o=t-this.p0y,i=n-this.p0z;return i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),e=s,t=o,n=i,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),a=e,r=t,c=n,l=this.d1x*a+this.d1y*r+this.d1z*c,d=this.d2x*a+this.d2y*r+this.d2z*c,u=(this.dot11*l-this.dot01*d)*this.invDenom,h=(this.dot00*d-this.dot01*l)*this.invDenom,u>=0&&h>=0&&u+h<1},getPoints:function(){var s,o,e=this.p0x,t=this.p0y,n=this.p0z;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),s=new h(e,t,n),e=this.d1x+this.p0x,t=this.d1y+this.p0y,n=this.d1z+this.p0z,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),o=new h(e,t,n),e=this.d2x+this.p0x,t=this.d2y+this.p0y,n=this.d2z+this.p0z,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),[s,o,new h(e,t,n)]},makeDebugObj:function(){var s,o,i,a,r,c,l,d,u,m,f,p,g,e=this.p0x,t=this.p0y,n=this.p0z;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),s=new h(e,t,n),e=this.d1x,t=this.d1y,n=this.d1z,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),o=e,i=t,a=n,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),g=o,c=i,l=a,e=this.d2x,t=this.d2y,n=this.d2z,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),o=e,i=t,a=n,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,u=i,m=a,e=g+s.x,t=c+s.y,n=l+s.z,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),f=new h(e,t,n),e=d+s.x,t=u+s.y,n=m+s.z,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),p=[s,f,new h(e,t,n)],r=new tn(p),r.addNormals(),new me(r)},dimension:function(){throw t.thrown("Not implemented")},__class__:Os}),No=function(e){e==null&&(e=!1),this.oriented=e},c["h3d.col.Polygon"]=No,No.__name__="h3d.col.Polygon",No.fromPolygon2D=function(e,t,n){n==null&&(n=!0),t==null&&(t=0);var Q,Z,ae,G,te,ne,s,o,i,a,r,c,l,d,u,h,p,g,v,b,j,y,_,w,O,x,C,E,k,A,M,z,N,ce,le,de,m,f,S,F,T,D,L,W,ie,ue,he,R,P,H,I,B,V,$,U,K,q,Y,ee,X,J,oe,se=new No;if(re.isConvex(e))for(Q=e[0],Z=0,ae=e.length-2;Z<ae;)G=Z++,te=e[G+1],ne=e[G+2],s=new Os(n),A=Q.x,U=Q.y,W=t,W==null&&(W=0),U==null&&(U=0),A==null&&(A=0),z=A,p=U,N=W,N==null&&(N=0),p==null&&(p=0),z==null&&(z=0),d=z,h=p,u=N,g=te.x,v=te.y,b=t,b==null&&(b=0),v==null&&(v=0),g==null&&(g=0),j=g,y=v,_=b,_==null&&(_=0),y==null&&(y=0),j==null&&(j=0),ce=j,le=y,de=_,S=ne.x,f=ne.y,F=t,F==null&&(F=0),f==null&&(f=0),S==null&&(S=0),T=S,m=f,D=F,D==null&&(D=0),m==null&&(m=0),T==null&&(T=0),ie=T,ue=m,he=D,s.p0x=d,s.p0y=h,s.p0z=u,P=ce-d,H=le-h,I=de-u,I==null&&(I=0),H==null&&(H=0),P==null&&(P=0),B=P,V=H,$=I,$==null&&($=0),V==null&&(V=0),B==null&&(B=0),l=B,c=V,r=$,q=ie-d,Y=ue-h,M=he-u,M==null&&(M=0),Y==null&&(Y=0),q==null&&(q=0),K=q,R=Y,L=M,L==null&&(L=0),R==null&&(R=0),K==null&&(K=0),a=K,i=R,o=L,k=c*o-r*i,E=r*a-l*o,C=l*i-c*a,C==null&&(C=0),E==null&&(E=0),k==null&&(k=0),x=k,O=E,w=C,w==null&&(w=0),O==null&&(O=0),x==null&&(x=0),ee=x,J=O,X=w,s.d=ee*d+J*h+X*u,s.nx=ee,s.ny=J,s.nz=X,s.d1x=l,s.d1y=c,s.d1z=r,s.d2x=a,s.d2y=i,s.d2z=o,s.dot00=l*l+c*c+r*r,s.dot01=l*a+c*i+r*o,s.dot11=a*a+i*i+o*o,s.invDenom=1/(s.dot00*s.dot11-s.dot01*s.dot01),s.next=se.triPlanes,se.triPlanes=s;else for(oe=re.fastTriangulate(e),Z=0,ae=oe.length/3|0;Z<ae;)G=Z++,Q=e[oe[G*3]],te=e[oe[G*3+1]],ne=e[oe[G*3+2]],s=new Os(n),A=Q.x,U=Q.y,W=t,W==null&&(W=0),U==null&&(U=0),A==null&&(A=0),z=A,p=U,N=W,N==null&&(N=0),p==null&&(p=0),z==null&&(z=0),d=z,h=p,u=N,g=te.x,v=te.y,b=t,b==null&&(b=0),v==null&&(v=0),g==null&&(g=0),j=g,y=v,_=b,_==null&&(_=0),y==null&&(y=0),j==null&&(j=0),ce=j,le=y,de=_,S=ne.x,f=ne.y,F=t,F==null&&(F=0),f==null&&(f=0),S==null&&(S=0),T=S,m=f,D=F,D==null&&(D=0),m==null&&(m=0),T==null&&(T=0),ie=T,ue=m,he=D,s.p0x=d,s.p0y=h,s.p0z=u,P=ce-d,H=le-h,I=de-u,I==null&&(I=0),H==null&&(H=0),P==null&&(P=0),B=P,V=H,$=I,$==null&&($=0),V==null&&(V=0),B==null&&(B=0),l=B,c=V,r=$,q=ie-d,Y=ue-h,M=he-u,M==null&&(M=0),Y==null&&(Y=0),q==null&&(q=0),K=q,R=Y,L=M,L==null&&(L=0),R==null&&(R=0),K==null&&(K=0),a=K,i=R,o=L,k=c*o-r*i,E=r*a-l*o,C=l*i-c*a,C==null&&(C=0),E==null&&(E=0),k==null&&(k=0),x=k,O=E,w=C,w==null&&(w=0),O==null&&(O=0),x==null&&(x=0),ee=x,J=O,X=w,s.d=ee*d+J*h+X*u,s.nx=ee,s.ny=J,s.nz=X,s.d1x=l,s.d1y=c,s.d1z=r,s.d2x=a,s.d2y=i,s.d2z=o,s.dot00=l*l+c*c+r*r,s.dot01=l*a+c*i+r*o,s.dot11=a*a+i*i+o*o,s.invDenom=1/(s.dot00*s.dot11-s.dot01*s.dot01),s.next=se.triPlanes,se.triPlanes=s;return se},No.__super__=ot,No.prototype=g(ot.prototype,{addBuffers:function(e,t,n){n==null&&(n=3);for(var ce,s,o,i,a,r,c,l,d,u,h,f,p,g,v,b,j,y,_,w,z,N,L,$,W,U,X,re,ae,ie,m,O,x,C,E,k,A,S,M,F,T,D,Z,oe,se,ne,R,P,H,I,B,V,K,q,Y,G,Q,J,ee,te,le=0,de=t.length/3|0;le<de;)ce=le++,N=ce*3,s=new Os(this.oriented),L=t[N]*n,Z=t[N+1]*n,U=t[N+2]*n,W=e[L],$=e[L+1],z=e[L+2],z==null&&(z=0),$==null&&($=0),W==null&&(W=0),X=W,p=$,g=z,g==null&&(g=0),p==null&&(p=0),X==null&&(X=0),u=X,h=p,d=g,v=e[Z],b=e[Z+1],j=e[Z+2],j==null&&(j=0),b==null&&(b=0),v==null&&(v=0),y=v,_=b,w=j,w==null&&(w=0),_==null&&(_=0),y==null&&(y=0),re=y,ae=_,ie=w,A=e[U],S=e[U+1],M=e[U+2],M==null&&(M=0),S==null&&(S=0),A==null&&(A=0),F=A,T=S,m=M,m==null&&(m=0),T==null&&(T=0),F==null&&(F=0),oe=F,se=T,ne=m,s.p0x=u,s.p0y=h,s.p0z=d,R=re-u,P=ae-h,H=ie-d,H==null&&(H=0),P==null&&(P=0),R==null&&(R=0),I=R,B=P,V=H,V==null&&(V=0),B==null&&(B=0),I==null&&(I=0),l=I,c=B,r=V,K=oe-u,q=se-h,Y=ne-d,Y==null&&(Y=0),q==null&&(q=0),K==null&&(K=0),G=K,f=q,Q=Y,Q==null&&(Q=0),f==null&&(f=0),G==null&&(G=0),a=G,i=f,o=Q,D=c*o-r*i,k=r*a-l*o,E=l*i-c*a,E==null&&(E=0),k==null&&(k=0),D==null&&(D=0),C=D,x=k,O=E,O==null&&(O=0),x==null&&(x=0),C==null&&(C=0),J=C,ee=x,te=O,s.d=J*u+ee*h+te*d,s.nx=J,s.ny=ee,s.nz=te,s.d1x=l,s.d1y=c,s.d1z=r,s.d2x=a,s.d2y=i,s.d2z=o,s.dot00=l*l+c*c+r*r,s.dot01=l*a+c*i+r*o,s.dot11=a*a+i*i+o*o,s.invDenom=1/(s.dot00*s.dot11-s.dot01*s.dot01),s.next=this.triPlanes,this.triPlanes=s},isConvex:function(){return!0},clone:function(){var e,n,o=new No(this.oriented),t=this.triPlanes,s=new Os(t.oriented);return s.p0x=t.p0x,s.p0y=t.p0y,s.p0z=t.p0z,s.d1x=t.d1x,s.d1y=t.d1y,s.d1z=t.d1z,s.d2x=t.d2x,s.d2y=t.d2y,s.d2z=t.d2z,s.dot00=t.dot00,s.dot01=t.dot01,s.dot11=t.dot11,s.invDenom=t.invDenom,s.nx=t.nx,s.ny=t.ny,s.nz=t.nz,s.d=t.d,t.next!=null&&(e=t.next,n=new Os(e.oriented),n.p0x=e.p0x,n.p0y=e.p0y,n.p0z=e.p0z,n.d1x=e.d1x,n.d1y=e.d1y,n.d1z=e.d1z,n.d2x=e.d2x,n.d2y=e.d2y,n.d2z=e.d2z,n.dot00=e.dot00,n.dot01=e.dot01,n.dot11=e.dot11,n.invDenom=e.invDenom,n.nx=e.nx,n.ny=e.ny,n.nz=e.nz,n.d=e.d,e.next!=null&&(n.next=e.next.clone()),s.next=n),o.triPlanes=s,o},transform:function(e){for(var t=this.triPlanes;t!=null;)t.transform(e),t=t.next},getPoints:function(){for(var t=[],e=this.triPlanes;e!=null;)t=t.concat(e.getPoints()),e=e.next;return t},getBounds:function(e){e==null&&(e=new Ce),e.xMin=1e20,e.xMax=-1e20,e.yMin=1e20,e.yMax=-1e20,e.zMin=1e20,e.zMax=-1e20;for(var n,s,o,i,a,r,c,l,d,t=this.triPlanes;t!=null;)n=t.p0x,s=t.p0y,o=t.p0z,n<e.xMin&&(e.xMin=n),n>e.xMax&&(e.xMax=n),s<e.yMin&&(e.yMin=s),s>e.yMax&&(e.yMax=s),o<e.zMin&&(e.zMin=o),o>e.zMax&&(e.zMax=o),i=t.d1x+t.p0x,a=t.d1y+t.p0y,r=t.d1z+t.p0z,i<e.xMin&&(e.xMin=i),i>e.xMax&&(e.xMax=i),a<e.yMin&&(e.yMin=a),a>e.yMax&&(e.yMax=a),r<e.zMin&&(e.zMin=r),r>e.zMax&&(e.zMax=r),c=t.d2x+t.p0x,l=t.d2y+t.p0y,d=t.d2z+t.p0z,c<e.xMin&&(e.xMin=c),c>e.xMax&&(e.xMax=c),l<e.yMin&&(e.yMin=l),l>e.yMax&&(e.yMax=l),d<e.zMin&&(e.zMin=d),d>e.zMax&&(e.zMax=d),t=t.next;return e},contains:function(e){if(!this.isConvex())throw t.thrown("Not implemented for concave polygon");for(var n=this.triPlanes;n!=null;){if(n.nx*e.x+n.ny*e.y+n.nz*e.z-n.d>=0)return!1;n=n.next}return!0},rayIntersection:function(e,t){for(var s,o,i,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,n=this.triPlanes,a=-1;n!=null;){if(m=e.lx*n.nx+e.ly*n.ny+e.lz*n.nz,m>=0&&n.oriented?s=-1:(O=n.d-(e.px*n.nx+e.py*n.ny+e.pz*n.nz),o=O/m,o<0&&n.oriented?s=-1:(w=e.px+e.lx*o,_=e.py+e.ly*o,y=e.pz+e.lz*o,u=w-n.p0x,i=_-n.p0y,d=y-n.p0z,d==null&&(d=0),i==null&&(i=0),u==null&&(u=0),l=u,c=i,r=d,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),f=l,h=c,p=r,g=n.d1x*f+n.d1y*h+n.d1z*p,v=n.d2x*f+n.d2y*h+n.d2z*p,b=(n.dot11*g-n.dot01*v)*n.invDenom,j=(n.dot00*v-n.dot01*g)*n.invDenom,s=b>=0&&j>=0&&b+j<1?o:-1)),s>=0){if(!t)return s;(a<0||s<a)&&(a=s)}n=n.next}return a},inFrustum:function(){throw t.thrown("Not implemented")},inSphere:function(){throw t.thrown("Not implemented")},closestPoint:function(e){for(var t,s,o,i,a,r,n=this.triPlanes,c=1/0,l=null;n!=null;)t=n.closestPoint(e),s=e,o=t.x-s.x,i=t.y-s.y,a=t.z-s.z,r=o*o+i*i+a*a,r<c&&(c=r,l=t),n=n.next;return l},dimension:function(){var e=this.getBounds(),t=e.xMax-e.xMin,n=e.yMax-e.yMin,s=e.zMax-e.zMin,o=n<s?s:n;return t<o?o:t},makeDebugObj:function(){for(var t,n,s,o,i,a,r,c,l,d,u,m,f,p,g,v,b,j,y,_,w,O,C,E,k,A,S,M,F,T,x=[],e=this.triPlanes;e!=null;)i=e.p0x,v=e.p0y,o=e.p0z,o==null&&(o=0),v==null&&(v=0),i==null&&(i=0),t=new h(i,v,o),a=e.d1x,r=e.d1y,c=e.d1z,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),l=a,d=r,u=c,u==null&&(u=0),d==null&&(d=0),l==null&&(l=0),T=l,F=d,M=u,g=e.d2x,n=e.d2y,O=e.d2z,O==null&&(O=0),n==null&&(n=0),g==null&&(g=0),s=g,y=n,_=O,_==null&&(_=0),y==null&&(y=0),s==null&&(s=0),A=s,S=y,k=_,x.push(t),j=T+t.x,w=F+t.y,b=M+t.z,b==null&&(b=0),w==null&&(w=0),j==null&&(j=0),x.push(new h(j,w,b)),p=A+t.x,f=S+t.y,m=k+t.z,m==null&&(m=0),f==null&&(f=0),p==null&&(p=0),x.push(new h(p,f,m)),e=e.next;return C=new tn(x),C.addNormals(),E=new me(C),this.oriented||E.material.passes.set_culling(xt.None),E},__class__:No}),Do=function(){},c["h3d.col.PolygonBuffer"]=Do,Do.__name__="h3d.col.PolygonBuffer",Do.__super__=ot,Do.prototype=g(ot.prototype,{setData:function(e,t,n,s){s==null&&(s=-1),n==null&&(n=0),this.buffer=e,this.indexes=t,this.startIndex=n,this.triCount=s>=0?s:(t.length-n)/3|0},getBounds:function(){for(var t,n,s,o,c,a=this.startIndex,e=new Ce,i=0,r=this.triCount*3;i<r;)c=i++,o=this.indexes[a++]*3,t=this.buffer[o++],n=this.buffer[o++],s=this.buffer[o],t<e.xMin&&(e.xMin=t),t>e.xMax&&(e.xMax=t),n<e.yMin&&(e.yMin=n),n>e.yMax&&(e.yMax=n),s<e.zMin&&(e.zMin=s),s>e.zMax&&(e.zMax=s);return e},getPoints:function(){for(var e,s,a,r,c,l,n=1073741824,o=-1073741824,t=this.startIndex,i=this.startIndex+this.triCount*3;t<i;)s=t++,e=this.indexes[s],e<n&&(n=e),e>o&&(o=e);for(l=o+1-n,a=go._new(l),r=[],t=this.startIndex,i=this.startIndex+this.triCount*3;t<i;)s=t++,e=this.indexes[s],c=e-n,go.get(a,c)||(e*=3,r.push(new gn(this.buffer[e++],this.buffer[e++],this.buffer[e])),go.set(a,c));return r},contains:function(e){var o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,M,F,T,z,D,N,L,R,P,H,I,B,V,$,W,U,K,q,S=this.startIndex,n=e.x,s=e.y,t=e.z;for(t==null&&(t=0),s==null&&(s=0),n==null&&(n=0),P=n,V=s,B=t,M=0,R=this.triCount;M<R;)if(q=M++,u=this.indexes[S++]*3,n=this.buffer[u++],s=this.buffer[u++],t=this.buffer[u],t==null&&(t=0),s==null&&(s=0),n==null&&(n=0),h=n,m=s,f=t,p=this.indexes[S++]*3,g=this.buffer[p++],v=this.buffer[p++],b=this.buffer[p],b==null&&(b=0),v==null&&(v=0),g==null&&(g=0),I=g,H=v,L=b,w=this.indexes[S++]*3,o=this.buffer[w++],j=this.buffer[w++],x=this.buffer[w],x==null&&(x=0),j==null&&(j=0),o==null&&(o=0),U=o,W=j,$=x,O=I-h,_=H-m,y=L-f,y==null&&(y=0),_==null&&(_=0),O==null&&(O=0),T=O,z=_,N=y,i=U-h,d=W-m,l=$-f,l==null&&(l=0),d==null&&(d=0),i==null&&(i=0),D=i,F=d,C=l,c=z*C-N*F,r=N*D-T*C,a=T*F-z*D,a==null&&(a=0),r==null&&(r=0),c==null&&(c=0),A=c,k=r,E=a,K=A*h+k*m+E*f,A*P+k*V+E*B>=K)return!1;return!0},inFrustum:function(){throw t.thrown("Not implemented")},inSphere:function(){throw t.thrown("Not implemented")},dimension:function(){var e=this.getBounds(),t=e.xMax-e.xMin,n=e.yMax-e.yMin,s=e.zMax-e.zMin,o=n<s?s:n;return t<o?o:t},isPointInTriangle:function(e,t,n){var o=t.x*e.x+t.y*e.y+t.z*e.z,i=n.x*e.x+n.y*e.y+n.z*e.z,a=t.x*t.x+t.y*t.y+t.z*t.z,s=t.x*n.x+t.y*n.y+t.z*n.z,r=n.x*n.x+n.y*n.y+n.z*n.z,c=1/(a*r-s*s),l=(r*o-s*i)*c,d=(a*i-s*o)*c;return l>=0&&d>=0&&l+d<1},closestPointLine:function(e,t,n){var s,r,c,l,d,u,h,o=e.x-t.x,i=e.y-t.y,a=e.z-t.z;return a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),r=o,c=i,l=a,s=(r*n.x+c*n.y+l*n.z)/(n.x*n.x+n.y*n.y+n.z*n.z),s<0?s=0:s>1&&(s=1),o=n.x*s,i=n.y*s,a=n.z*s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,u=i,h=a,new gn(t.x+d,t.y+u,t.z+h)},closestPoint:function(e){var d,g,v,Je,T,oe,vt,Tt,Xt,Be,m,f,p,Ve,$e,We,Re,Ee,ue,ee,W,Y,G,X,Ht,It,Bt,n,u,C,L,R,pe,t,s,o,i,a,E,k,H,I,U,K,q,ct,lt,dt,x,ft,pt,gt,Ye,ie,ae,re,ce,le,de,y,B,he,me,fe,yt,jt,bt,be,je,ye,_e,At,St,Mt,Ce,D,ke,wt,Rt,Pt,Fe,Te,ze,Kt,qt,Yt,_,Pe,He,Ie,Gt,Vt,Dt,O,Ue,Ke,qe,w,A,S,Le,Ne,De,Ut,Wt,$t,j,Me,Se,Ae,Nt,_t,zt,M,xe,Oe,we,kt,Et,Ct,b,ve,ge,N,xt,Lt,Ot,F,se,ne,te,mt,ht,ut,Ft,Q,Z,J,rt,at,it,ot,P,V,$,st,nt,tt,et,z,Ze,Qe,Xe,Ge,l=e.x,r=e.y,c=e.z;for(c==null&&(c=0),r==null&&(r=0),l==null&&(l=0),v=l,g=r,d=c,Je=1/0,T=null,oe=this.startIndex,vt=0,Tt=this.triCount;vt<Tt;)Xt=vt++,Be=this.indexes[oe++]*3,l=this.buffer[Be++],r=this.buffer[Be++],c=this.buffer[Be],c==null&&(c=0),r==null&&(r=0),l==null&&(l=0),m=l,f=r,p=c,Ve=this.indexes[oe++]*3,$e=this.buffer[Ve++],We=this.buffer[Ve++],Re=this.buffer[Ve],Re==null&&(Re=0),We==null&&(We=0),$e==null&&($e=0),Ee=$e,ue=We,ee=Re,X=this.indexes[oe++]*3,G=this.buffer[X++],Y=this.buffer[X++],W=this.buffer[X],W==null&&(W=0),Y==null&&(Y=0),G==null&&(G=0),Ht=G,It=Y,Bt=W,u=null,R=Ee-m,L=ue-f,pe=ee-p,pe==null&&(pe=0),L==null&&(L=0),R==null&&(R=0),s=R,o=L,a=pe,H=Ht-m,I=It-f,B=Bt-p,B==null&&(B=0),I==null&&(I=0),H==null&&(H=0),t=H,i=I,n=B,U=v-m,K=g-f,q=d-p,q==null&&(q=0),K==null&&(K=0),U==null&&(U=0),k=U,E=K,C=q,ct=s*k+o*E+a*C,lt=t*k+i*E+n*C,dt=s*s+o*o+a*a,x=s*t+o*i+a*n,ft=t*t+i*i+n*n,pt=1/(dt*ft-x*x),gt=(ft*ct-x*lt)*pt,Ye=(dt*lt-x*ct)*pt,gt>=0&&Ye>=0&&gt+Ye<1?(ie=o*n-a*i,ae=a*t-s*n,re=s*i-o*t,re==null&&(re=0),ae==null&&(ae=0),ie==null&&(ie=0),ce=ie,le=ae,de=re,y=ce*ce+le*le+de*de,y<1e-20?y=0:y=1/Math.sqrt(y),he=ce*y,me=le*y,fe=de*y,fe==null&&(fe=0),me==null&&(me=0),he==null&&(he=0),yt=he,jt=me,bt=fe,be=k*yt+E*jt+C*bt,je=yt*be,ye=jt*be,_e=bt*be,_e==null&&(_e=0),ye==null&&(ye=0),je==null&&(je=0),At=je,St=ye,Mt=_e,Ce=k-At,D=E-St,ke=C-Mt,ke==null&&(ke=0),D==null&&(D=0),Ce==null&&(Ce=0),wt=Ce,Rt=D,Pt=ke,u=new gn(m+wt,f+Rt,p+Pt)):(Fe=v-m,Te=g-f,ze=d-p,ze==null&&(ze=0),Te==null&&(Te=0),Fe==null&&(Fe=0),Kt=Fe,qt=Te,Yt=ze,_=(Kt*s+qt*o+Yt*a)/(s*s+o*o+a*a),_<0?_=0:_>1&&(_=1),Pe=s*_,He=o*_,Ie=a*_,Ie==null&&(Ie=0),He==null&&(He=0),Pe==null&&(Pe=0),Gt=Pe,Vt=He,Dt=Ie,O=new gn(m+Gt,f+Vt,p+Dt),Ue=t-s,Ke=i-o,qe=n-a,qe==null&&(qe=0),Ke==null&&(Ke=0),Ue==null&&(Ue=0),A=Ue,w=Ke,S=qe,Le=v-Ee,Ne=g-ue,De=d-ee,De==null&&(De=0),Ne==null&&(Ne=0),Le==null&&(Le=0),Ut=Le,Wt=Ne,$t=De,j=(Ut*A+Wt*w+$t*S)/(A*A+w*w+S*S),j<0?j=0:j>1&&(j=1),Me=A*j,Se=w*j,Ae=S*j,Ae==null&&(Ae=0),Se==null&&(Se=0),Me==null&&(Me=0),Nt=Me,_t=Se,zt=Ae,M=new gn(Ee+Nt,ue+_t,ee+zt),xe=v-m,Oe=g-f,we=d-p,we==null&&(we=0),Oe==null&&(Oe=0),xe==null&&(xe=0),kt=xe,Et=Oe,Ct=we,b=(kt*t+Et*i+Ct*n)/(t*t+i*i+n*n),b<0?b=0:b>1&&(b=1),ve=t*b,ge=i*b,N=n*b,N==null&&(N=0),ge==null&&(ge=0),ve==null&&(ve=0),xt=ve,Lt=ge,Ot=N,F=new gn(m+xt,f+Lt,p+Ot),se=v-O.x,ne=g-O.y,te=d-O.z,te==null&&(te=0),ne==null&&(ne=0),se==null&&(se=0),mt=se,ht=ne,ut=te,Ft=mt*mt+ht*ht+ut*ut,J=v-M.x,Z=g-M.y,Q=d-M.z,Q==null&&(Q=0),Z==null&&(Z=0),J==null&&(J=0),rt=J,at=Z,it=Q,ot=rt*rt+at*at+it*it,$=v-F.x,V=g-F.y,P=d-F.z,P==null&&(P=0),V==null&&(V=0),$==null&&($=0),st=$,nt=V,tt=P,et=st*st+nt*nt+tt*tt,z=Ft,u=O,ot<z&&(z=ot,u=M),et<z&&(z=et,u=F)),Ze=u.x-v,Qe=u.y-g,Xe=u.z-d,Ge=Ze*Ze+Qe*Qe+Xe*Xe,Ge<Je&&(T=u,Je=Ge);return l=T.x,r=T.y,c=T.z,c==null&&(c=0),r==null&&(r=0),l==null&&(l=0),new h(l,r,c)},rayIntersection:function(e,t){var l,h,R,me,le,ce,i,d,Y,ae,fe,re,ie,u,k,A,S,M,de,ue,he,r,c,g,v,b,j,y,_,w,O,oe,m,f,p,x,C,E,F,T,z,D,N,L,P,H,I,B,V,$,W,U,K,q,G,X,Q,Z,ne,te,ee,a,J,se=this.startIndex,n=e.lx,s=e.ly,o=e.lz;for(o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),l=n,h=s,R=o,n=e.px,s=e.py,o=e.pz,o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),me=n,le=s,ce=o,i=-1,Y=0,ae=this.triCount;Y<ae;){if(fe=Y++,g=this.indexes[se++]*3,n=this.buffer[g++],s=this.buffer[g++],o=this.buffer[g],o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),v=n,b=s,j=o,y=this.indexes[se++]*3,_=this.buffer[y++],w=this.buffer[y++],O=this.buffer[y],O==null&&(O=0),w==null&&(w=0),_==null&&(_=0),oe=_,re=w,ie=O,k=this.indexes[se++]*3,A=this.buffer[k++],S=this.buffer[k++],M=this.buffer[k],M==null&&(M=0),S==null&&(S=0),A==null&&(A=0),de=A,ue=S,he=M,D=oe-v,r=re-b,L=ie-j,L==null&&(L=0),r==null&&(r=0),D==null&&(D=0),P=D,$=r,m=L,I=de-v,B=ue-b,V=he-j,V==null&&(V=0),B==null&&(B=0),I==null&&(I=0),c=I,W=B,U=V,K=h*U-R*W,q=R*c-l*U,N=l*W-h*c,N==null&&(N=0),q==null&&(q=0),K==null&&(K=0),G=K,X=q,Q=N,Z=P*G+$*X+m*Q,Z<1e-10)continue;if(z=1/Z,T=me-v,F=le-b,E=ce-j,E==null&&(E=0),F==null&&(F=0),T==null&&(T=0),C=T,x=F,p=E,f=(C*G+x*X+p*Q)*z,f<0||f>1)continue;if(H=x*m-p*$,u=p*P-C*m,d=C*$-x*P,d==null&&(d=0),u==null&&(u=0),H==null&&(H=0),ne=H,te=u,ee=d,J=(l*ne+h*te+R*ee)*z,J<0||f+J>1)continue;if(a=(c*ne+W*te+U*ee)*z,a<1e-10)continue;if(!t)return a;(i<0||a<i)&&(i=a)}return i},makeDebugObj:function(){for(var n,s,o,i,l,a=[],t=new Array(0),e=this.startIndex,r=0,c=this.triCount;r<c;)l=r++,t.push(this.indexes[e++]),t.push(this.indexes[e++]),t.push(this.indexes[e++]);for(e=0;e<this.buffer.length;)n=this.buffer[e++],s=this.buffer[e++],o=this.buffer[e++],o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),a.push(new h(n,s,o));return i=new tn(a,t),i.addNormals(),new me(i)},__class__:Do}),nr=function(e,t){this.lastBoundsFrame=-1,this.lastFrame=-1,this.obj=e,this.col=t,this.transform=new Do;var o=this.transform,n=t.buffer,s=new Array(n.length);il.blit(n,0,s,0,n.length),o.setData(s,t.indexes,t.startIndex,t.triCount),this.currentBounds=new Ce},c["h3d.col.SkinCollider"]=nr,nr.__name__="h3d.col.SkinCollider",nr.__super__=ot,nr.prototype=g(ot.prototype,{contains:function(e){this.checkBounds();var t=this.currentBounds;return e.x>=t.xMin&&e.x<t.xMax&&e.y>=t.yMin&&e.y<t.yMax&&e.z>=t.zMin&&e.z<t.zMax&&(this.applyTransform(),this.transform.contains(e))},inFrustum:function(e,n){this.checkBounds();var s=this.currentBounds;if(n!=null)throw t.thrown("Not implemented");if(!e.hasBounds(s))return!1;if(n!=null)throw t.thrown("Not implemented");return this.applyTransform(),this.transform.inFrustum(e)},inSphere:function(e){this.checkBounds();var n,s,o,i,a,r,c,m,f,p,g,v,b,j,y,_,h=this.currentBounds,u=e.x,d=e.y,l=e.z;if(l==null&&(l=0),d==null&&(d=0),u==null&&(u=0),c=u,a=d,r=l,r==null&&(r=0),a==null&&(a=0),c==null&&(c=0),_=c,g=a,y=r,n=h.xMin,i=e.x,o=h.xMax,s=i>o?o:i,u=n<s?s:n,n=h.yMin,i=e.y,o=h.yMax,s=i>o?o:i,d=n<s?s:n,n=h.zMin,i=e.z,o=h.zMax,s=i>o?o:i,l=n<s?s:n,l==null&&(l=0),d==null&&(d=0),u==null&&(u=0),c=u,a=d,r=l,r==null&&(r=0),a==null&&(a=0),c==null&&(c=0),j=c,v=a,b=r,m=j-_,p=v-g,f=b-y,!(m*m+p*p+f*f<e.r*e.r))return!1;throw this.applyTransform(),t.thrown("Not implemented")},rayIntersection:function(e,t){return this.checkBounds(),this.currentBounds.rayIntersection(e,!1)<0?-1:(this.applyTransform(),this.transform.rayIntersection(e,t))},dimension:function(){var e=this.currentBounds,t=e.xMax-e.xMin,n=e.yMax-e.yMin,s=e.zMax-e.zMin,o=n<s?s:n;return t<o?o:t},checkBounds:function(){if(!this.obj.jointsUpdated&&this.lastBoundsFrame==this.obj.lastFrame)return;this.lastBoundsFrame=this.obj.lastFrame,this.obj.syncJoints();var e=this.currentBounds;e.xMin=1e20,e.xMax=-1e20,e.yMin=1e20,e.yMax=-1e20,e.zMin=1e20,e.zMax=-1e20,this.obj.addBoundsRec(this.currentBounds,null)},applyTransform:function(){if(!this.obj.jointsUpdated&&this.lastFrame==this.obj.lastFrame)return;this.lastFrame=this.obj.lastFrame,this.obj.syncJoints();for(var e,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,_,w,O,x,C,E,k,S,M,F,T,z,y=0,t=0,N=this.obj.skinData.bonesPerVertex,A=0,D=this.obj.skinData.vertexCount;A<D;){for(z=A++,_=0,j=0,b=0,l=this.col.buffer[t],d=this.col.buffer[t+1],u=this.col.buffer[t+2],u==null&&(u=0),d==null&&(d=0),l==null&&(l=0),h=l,m=d,f=u,f==null&&(f=0),m==null&&(m=0),h==null&&(h=0),C=h,x=m,E=f,w=0,k=N;w<k;){if(T=w++,i=this.obj.skinData.vertexWeights[y],i==0){++y;continue}O=this.obj.skinData.vertexJoints[y++],v=C,g=x,p=E,p==null&&(p=0),g==null&&(g=0),v==null&&(v=0),c=v,a=g,r=p,r==null&&(r=0),a==null&&(a=0),c==null&&(c=0),o=c,s=a,n=r,e=this.obj.currentPalette[O],S=o*e._11+s*e._21+n*e._31+e._41,M=o*e._12+s*e._22+n*e._32+e._42,F=o*e._13+s*e._23+n*e._33+e._43,o=S,s=M,n=F,_+=o*i,j+=s*i,b+=n*i}this.transform.buffer[t++]=_,this.transform.buffer[t++]=j,this.transform.buffer[t++]=b}},closestPoint:function(){throw t.thrown("Not implemented")},makeDebugObj:function(){return new sr(this)},__class__:nr}),se=function(e){this.prevAbsPosFrame=-1,this.flags=32768,this.absPos=new L,this.absPos.identity(),this.x=0;var s,t=1,n=!0;n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.y=0,t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.z=0,t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.scaleX=1,t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.scaleY=1,t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.scaleZ=1,t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.qRot=new In,t=1,n=this.follow!=null,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),t=2,this.flags|=t,this.children=[],e!=null&&e.addChild(this)},c["h3d.scene.Object"]=se,se.__name__="h3d.scene.Object",se.prototype={set_cullingCollider:function(e){this.cullingCollider=e;var t=4096;return this.flags&=~t,e},get_visible:function(){return(this.flags&2)!=0},get_allocated:function(){return(this.flags&32)!=0},get_posChanged:function(){return(this.flags&1)!=0},get_culled:function(){return(this.flags&4)!=0},get_followPositionOnly:function(){return(this.flags&8)!=0},get_lightCameraCenter:function(){return(this.flags&16)!=0},get_alwaysSyncAnimation:function(){return(this.flags&64)!=0},get_inheritCulled:function(){return(this.flags&128)!=0},get_ignoreBounds:function(){return(this.flags&512)!=0},get_ignoreCollide:function(){return(this.flags&1024)!=0},get_modelRoot:function(){return(this.flags&256)!=0},get_ignoreParentTransform:function(){return(this.flags&2048)!=0},get_cullingColliderInherited:function(){return(this.flags&4096)!=0},get_fixedPosition:function(){return(this.flags&8192)!=0},get_alwaysSync:function(){return(this.flags&32768)!=0},get_drawn:function(){return(this.flags&65536)!=0},set_posChanged:function(e){var n,t=1,s=e||this.follow!=null;return s?this.flags|=t:this.flags&=~t,n=s,n&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),n},set_culled:function(e){var t=4;return e?this.flags|=t:this.flags&=~t,e},set_visible:function(e){var t=2;return e?this.flags|=t:this.flags&=~t,e},set_allocated:function(e){var t=32;return e?this.flags|=t:this.flags&=~t,e},set_followPositionOnly:function(e){var t=8;return e?this.flags|=t:this.flags&=~t,e},set_lightCameraCenter:function(e){var t=16;return e?this.flags|=t:this.flags&=~t,e},set_alwaysSyncAnimation:function(e){var t=64;return e?this.flags|=t:this.flags&=~t,e},set_ignoreBounds:function(e){var t=512;return e?this.flags|=t:this.flags&=~t,e},set_inheritCulled:function(e){var t=128;return e?this.flags|=t:this.flags&=~t,e},set_ignoreCollide:function(e){var t=1024;return e?this.flags|=t:this.flags&=~t,e},set_modelRoot:function(e){var t=256;return e?this.flags|=t:this.flags&=~t,e},set_ignoreParentTransform:function(e){if(e!=((this.flags&2048)!=0)){var s,t=1,n=!0;n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t)}return t=2048,e?this.flags|=t:this.flags&=~t,e},set_cullingColliderInherited:function(e){var t=4096;return e?this.flags|=t:this.flags&=~t,e},set_fixedPosition:function(e){var t=8192;return e?this.flags|=t:this.flags&=~t,e},set_alwaysSync:function(e){var t=32768;return e?this.flags|=t:this.flags&=~t,e},set_drawn:function(e){var t=65536;return e?this.flags|=t:this.flags&=~t,e},playAnimation:function(e){return this.currentAnimation=e.createInstance(this)},switchToAnimation:function(e){return this.currentAnimation=e},stopAnimation:function(e){if(e==null&&(e=!1),this.currentAnimation=null,e)for(var s,t=0,n=this.children;t<n.length;)s=n[t],++t,s.stopAnimation(!0)},applyAnimationTransform:function(e){if(e==null&&(e=!0),this.defaultTransform!=null){var t,s,o,i,a,r,c,l,m,n=this.defaultTransform,h=0,u=0,d=0;d==null&&(d=0),u==null&&(u=0),h==null&&(h=0),c=h,r=u,a=d,c=Math.sqrt(n._11*n._11+n._12*n._12+n._13*n._13),r=Math.sqrt(n._21*n._21+n._22*n._22+n._23*n._23),a=Math.sqrt(n._31*n._31+n._32*n._32+n._33*n._33),n._11*(n._22*n._33-n._23*n._32)+n._12*(n._23*n._31-n._21*n._33)+n._13*(n._21*n._32-n._22*n._31)<0&&(c*=-1,r*=-1,a*=-1),i=c,this.scaleX=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),i=r,this.scaleY=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),i=a,this.scaleZ=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.qRot.initRotateMatrix(this.defaultTransform),i=this.defaultTransform._41,this.x=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),i=this.defaultTransform._42,this.y=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),i=this.defaultTransform._43,this.z=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),i=null,this.defaultTransform=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t)}if(e)for(l=0,m=this.children;l<m.length;)o=m[l],++l,o.applyAnimationTransform()},getObjectsCount:function(){for(var s,t=0,e=0,n=this.children;e<n.length;)s=n[e],++e,t+=s.getObjectsCount()+1;return t},getMaterialByName:function(e){for(var n,o,t=0,s=this.children;t<s.length;)if(o=s[t],++t,n=o.getMaterialByName(e),n!=null)return n;return null},contains:function(e){for(;e!=null;)if(e=e.parent,e==this)return!0;return!1},find:function(e){var n,s,o,t=e(this);if(t!=null)return t;for(n=0,s=this.children;n<s.length;)if(o=s[n],++n,t=o.find(e),t!=null)return t;return null},findAll:function(e,t){t==null&&(t=[]);var n,s,i,o=e(this);for(o!=null&&t.push(o),n=0,s=this.children;n<s.length;)i=s[n],++n,i.findAll(e,t);return t},getMaterials:function(e,t){if(t==null&&(t=!0),e==null&&(e=[]),t)for(var o,n=0,s=this.children;n<s.length;)o=s[n],++n,o.getMaterials(e);return e},localToGlobal:function(e){this.syncPos(),e==null&&(e=new h(0,0,0));var t=this.absPos,n=e.x*t._11+e.y*t._21+e.z*t._31+t._41,s=e.x*t._12+e.y*t._22+e.z*t._32+t._42,o=e.x*t._13+e.y*t._23+e.z*t._33+t._43;return e.x=n,e.y=s,e.z=o,e},globalToLocal:function(e){var t=this.getInvPos(),n=e.x*t._11+e.y*t._21+e.z*t._31+t._41,s=e.x*t._12+e.y*t._22+e.z*t._32+t._42,o=e.x*t._13+e.y*t._23+e.z*t._33+t._43;return e.x=n,e.y=s,e.z=o,e},getInvPos:function(){return this.syncPos(),this.invPos==null&&(this.invPos=new L,this.invPos._44=0),this.invPos._44==0&&this.invPos.inverse3x4(this.absPos),this.invPos},getBounds:function(e,t){return e==null&&(e=new Ce),this.parent!=null&&this.parent!=t&&this.parent.syncPos(),this.addBoundsRec(e,t==null?null:t.getInvPos()),e},addBoundsRec:function(e,t){if((this.flags&1)!=0){for(var n,s,i,r,c,o=0,a=this.children;o<a.length;)n=a[o],++o,s=1,i=!0,i?n.flags|=s:n.flags&=~s,r=i,r&&(n.flags&131072)!=0&&(c=262144,n.flags|=c);s=1,i=this.follow!=null,i?this.flags|=s:this.flags&=~s,n=i,n&&(this.flags&131072)!=0&&(s=262144,this.flags|=s),this.calcAbsPos()}for(o=0,a=this.children;o<a.length;)n=a[o],++o,n.addBoundsRec(e,t)},getMeshes:function(e){e==null&&(e=[]);var t,n,o,s=this instanceof me?this:null;for(s!=null&&e.push(s),t=0,n=this.children;t<n.length;)o=n[t],++t,o.getMeshes(e);return e},getMeshByName:function(e){var t=this.getObjectByName(e);return t instanceof me?t:null},getObjectByName:function(e){if(this.name==e)return this;for(var n,o,t=0,s=this.children;t<s.length;)if(o=s[t],++t,n=o.getObjectByName(e),n!=null)return n;return null},clone:function(e){e==null&&(e=new se);var t,n,s,i,a,r,c,l,o=this.x;for(e.x=o,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),o=this.y,e.y=o,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),o=this.z,e.z=o,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),o=this.scaleX,e.scaleX=o,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),o=this.scaleY,e.scaleY=o,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),o=this.scaleZ,e.scaleZ=o,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),i=e.qRot,a=this.qRot,i.x=a.x,i.y=a.y,i.z=a.z,i.w=a.w,e.name=this.name,e.set_follow(this.follow),n=(this.flags&8)!=0,t=8,n?e.flags|=t:e.flags&=~t,n=(this.flags&2)!=0,t=2,n?e.flags|=t:e.flags&=~t,this.defaultTransform!=null&&(o=this.defaultTransform.clone(),e.defaultTransform=o,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t)),r=0,c=this.children;r<c.length;)s=c[r],++r,l=s.clone(),l.parent=e,e.children.push(l);return e},addChild:function(e){this.addChildAt(e,this.children.length)},addChildAt:function(e,n){n<0&&(n=0),n>this.children.length&&(n=this.children.length);for(var s,i,a,r,o=this;o!=null;){if(o==e)throw t.thrown("Recursive addChild");o=o.parent}e.parent!=null&&(a=(e.flags&32)!=0,s=32,e.flags&=~s,e.parent.removeChild(e),s=32,a?e.flags|=s:e.flags&=~s),this.children.splice(n,0,e),(this.flags&32)==0&&(e.flags&32)!=0&&e.onRemove(),e.parent=this,s=1,i=!0,i?e.flags|=s:e.flags&=~s,r=i,r&&(e.flags&131072)!=0&&(s=262144,e.flags|=s),(this.flags&32)!=0&&((e.flags&32)==0?e.onAdd():e.onParentChanged())},iterVisibleMeshes:function(e){if((this.flags&2)==0||(this.flags&4)!=0&&(this.flags&128)!=0)return;if((this.flags&4)==0){var t,n,o,s=this instanceof me?this:null;s!=null&&e(s)}for(t=0,n=this.children;t<n.length;)o=n[t],++t,o.iterVisibleMeshes(e)},onParentChanged:function(){for(var n,e=0,t=this.children;e<t.length;)n=t[e],++e,n.onParentChanged()},onAdd:function(){var e,t,n,s=32;for(this.flags|=s,e=0,t=this.children;e<t.length;)n=t[e],++e,n.onAdd()},onRemove:function(){var e,t=32;for(this.flags&=~t,e=this.children.length-1;e>=0;)this.children[e--].onRemove()},removeChild:function(e){if(u.remove(this.children,e)){(e.flags&32)!=0&&e.onRemove(),e.parent=null;var s,t=1,n=!0;n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t)}},removeChildren:function(){for(;this.children.length>0;)this.removeChild(this.children[0])},remove:function(){this.parent!=null&&this.parent.removeChild(this)},getScene:function(){for(var e=this;e.parent!=null;)e=e.parent;return e instanceof Ls?e:null},getAbsPos:function(){return this.syncPos(),this.absPos},getRelPos:function(e){if(e==null)return this.getAbsPos();this.syncPos();var t=new L;return t.multiply(this.absPos,e.getInvPos()),t},isMesh:function(){return(this instanceof me?this:null)!=null},toMesh:function(){var e=this instanceof me?this:null;if(e!=null)return e;throw t.thrown(o.string(this)+" is not a Mesh")},getCollider:function(){if((this.flags&1024)!=0)return null;var t,n,s,o,i,a,c,l,e=[],r=this.getGlobalCollider();for(r!=null&&e.push(r),n=0,o=this.children;n<o.length;){if(c=o[n],++n,t=c.getCollider(),t==null)continue;if(i=t instanceof mi?t:null,i!=null)for(s=0,a=i.colliders;s<a.length;)l=a[s],++s,e.push(l);else e.push(t)}return e.length==0?null:e.length==1?e[0]:new mi(e)},getGlobalCollider:function(){if((this.flags&1024)!=0)return null;var e=this.getLocalCollider();return e==null?null:new Wn(this,e)},getLocalCollider:function(){return null},draw:function(){},set_follow:function(e){var s,t=1,n=!0;return n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.follow=e},computeVelocity:function(){return this.prevAbsPosFrame!=-1},calcPrevAbsPos:function(){this.computeVelocity()?this.prevAbsPosFrame<N.frameCount&&(this.prevAbsPosFrame=N.frameCount,this.prevAbsPos==null?this.prevAbsPos=this.absPos.clone():this.prevAbsPos.load(this.absPos)):this.prevAbsPos=null},calcAbsPos:function(){if(this.calcPrevAbsPos(),this.qRot.toMatrix(this.absPos),this.absPos._11*=this.scaleX,this.absPos._12*=this.scaleX,this.absPos._13*=this.scaleX,this.absPos._21*=this.scaleY,this.absPos._22*=this.scaleY,this.absPos._23*=this.scaleY,this.absPos._31*=this.scaleZ,this.absPos._32*=this.scaleZ,this.absPos._33*=this.scaleZ,this.absPos._41=this.x,this.absPos._42=this.y,this.absPos._43=this.z,this.follow!=null)if(this.follow.syncPos(),(this.flags&8)!=0){var e=this.absPos,t=this.absPos,n=this.parent.absPos,O=t._11,w=t._12,_=t._13,h=t._21,y=t._22,m=t._23,b=t._31,v=t._32,g=t._33,p=t._41,j=t._42,f=t._43,s=n._11,u=n._12,d=n._13,l=n._21,c=n._22,r=n._23,a=n._31,i=n._32,o=n._33,x=n._41,C=n._42,E=n._43;e._11=O*s+w*l+_*a,e._12=O*u+w*c+_*i,e._13=O*d+w*r+_*o,e._14=0,e._21=h*s+y*l+m*a,e._22=h*u+y*c+m*i,e._23=h*d+y*r+m*o,e._24=0,e._31=b*s+v*l+g*a,e._32=b*u+v*c+g*i,e._33=b*d+v*r+g*o,e._34=0,e._41=p*s+j*l+f*a+x,e._42=p*u+j*c+f*i+C,e._43=p*d+j*r+f*o+E,e._44=1,this.absPos._41=this.x+this.follow.absPos._41,this.absPos._42=this.y+this.follow.absPos._42,this.absPos._43=this.z+this.follow.absPos._43}else this.absPos.multiply3x4(this.absPos,this.follow.absPos);else this.parent!=null&&(this.flags&2048)==0&&(e=this.absPos,t=this.absPos,n=this.parent.absPos,O=t._11,w=t._12,_=t._13,h=t._21,y=t._22,m=t._23,b=t._31,v=t._32,g=t._33,p=t._41,j=t._42,f=t._43,s=n._11,u=n._12,d=n._13,l=n._21,c=n._22,r=n._23,a=n._31,i=n._32,o=n._33,x=n._41,C=n._42,E=n._43,e._11=O*s+w*l+_*a,e._12=O*u+w*c+_*i,e._13=O*d+w*r+_*o,e._14=0,e._21=h*s+y*l+m*a,e._22=h*u+y*c+m*i,e._23=h*d+y*r+m*o,e._24=0,e._31=b*s+v*l+g*a,e._32=b*u+v*c+g*i,e._33=b*d+v*r+g*o,e._34=0,e._41=p*s+j*l+f*a+x,e._42=p*u+j*c+f*i+C,e._43=p*d+j*r+f*o+E,e._44=1);this.defaultTransform!=null&&(e=this.absPos,t=this.defaultTransform,n=this.absPos,O=t._11,w=t._12,_=t._13,h=t._21,y=t._22,m=t._23,b=t._31,v=t._32,g=t._33,p=t._41,j=t._42,f=t._43,s=n._11,u=n._12,d=n._13,l=n._21,c=n._22,r=n._23,a=n._31,i=n._32,o=n._33,x=n._41,C=n._42,E=n._43,e._11=O*s+w*l+_*a,e._12=O*u+w*c+_*i,e._13=O*d+w*r+_*o,e._14=0,e._21=h*s+y*l+m*a,e._22=h*u+y*c+m*i,e._23=h*d+y*r+m*o,e._24=0,e._31=b*s+v*l+g*a,e._32=b*u+v*c+g*i,e._33=b*d+v*r+g*o,e._34=0,e._41=p*s+j*l+f*a+x,e._42=p*u+j*c+f*i+C,e._43=p*d+j*r+f*o+E,e._44=1),this.invPos!=null&&(this.invPos._44=0)},sync:function(){},syncRec:function(e){if(this.currentAnimation!=null){for(var t,n,s,o,i,c,l,d,u,a=this.parent,r=e.elapsedTime;r>0&&this.currentAnimation!=null;)r=this.currentAnimation.update(r);if(this.currentAnimation!=null&&(e.visibleFlag&&(this.flags&2)!=0&&(this.flags&4)==0||(this.flags&64)!=0)&&this.currentAnimation.sync(),this.parent==null&&a!=null)return}if((this.flags&32768)==0&&((this.flags&4)!=0||(this.flags&2)==0||!e.visibleFlag))return;if(a=e.visibleFlag,((this.flags&2)==0||(this.flags&4)!=0&&(this.flags&128)!=0)&&(e.visibleFlag=!1),e.cullingCollider!=null&&(this.cullingCollider==null||(this.flags&4096)!=0)?(this.set_cullingCollider(e.cullingCollider),t=4096,this.flags|=t):(this.flags&4096)!=0&&this.set_cullingCollider(null),c=e.cullingCollider,(this.flags&128)!=0&&(e.cullingCollider=this.cullingCollider),s=(this.flags&1)!=0,s&&this.calcAbsPos(),(this.flags&8192)!=0){if((this.flags&16384)!=0&&!s&&!e.wasContextLost){e.visibleFlag=a,e.cullingCollider=c;return}t=16384,this.flags|=t}for(t=262144,this.flags&=~t,t=131072,this.flags|=t,this.sync(e),t=131072,this.flags&=~t,s=s||(this.flags&262144)!=0,(this.flags&262144)!=0&&this.calcAbsPos(),t=1,o=this.follow!=null,o?this.flags|=t:this.flags&=~t,n=o,n&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.lastFrame=e.frame,i=0,l=this.children.length;i<l;){if(n=this.children[i],n==null)break;n.lastFrame!=e.frame&&(s&&(t=1,o=!0,o?n.flags|=t:n.flags&=~t,d=o,d&&(n.flags&131072)!=0&&(u=262144,n.flags|=u)),n.syncRec(e)),this.children[i]!=n?(i=0,l=this.children.length):++i}e.visibleFlag=a,e.cullingCollider=c},syncPos:function(){if(this.parent!=null&&this.parent.syncPos(),(this.flags&1)!=0){var t,s,o,i,a,e=1,n=this.follow!=null;for(n?this.flags|=e:this.flags&=~e,t=n,t&&(this.flags&131072)!=0&&(e=262144,this.flags|=e),this.calcAbsPos(),s=0,o=this.children;s<o.length;)t=o[s],++s,e=1,n=!0,n?t.flags|=e:t.flags&=~e,i=n,i&&(t.flags&131072)!=0&&(a=262144,t.flags|=a)}},emit:function(){},emitRec:function(e){if((this.flags&2)==0||(this.flags&4)!=0&&(this.flags&128)!=0&&!e.computingStatic)return;if((this.flags&1)!=0){this.currentAnimation!=null&&this.currentAnimation.sync();var n,s,o,a,r,c,t=1,i=this.follow!=null;for(i?this.flags|=t:this.flags&=~t,n=i,n&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.calcAbsPos(),s=0,o=this.children;s<o.length;)n=o[s],++s,t=1,i=!0,i?n.flags|=t:n.flags&=~t,a=i,a&&(n.flags&131072)!=0&&(r=262144,n.flags|=r)}for(c=e.forcedScreenRatio,(this.flags&65536)==0||!e.computeVelocity||(this.flags&8192)!=0||(this.flags&4)!=0?this.prevAbsPosFrame=-1:this.computeVelocity()||(this.prevAbsPosFrame=0),this.calcPrevAbsPos(),((this.flags&4)==0||e.computingStatic)&&(this.emit(e),t=65536,this.flags&=~t),s=0,o=this.children;s<o.length;)n=o[s],++s,n.emitRec(e);e.forcedScreenRatio=c},set_x:function(e){this.x=e;var s,t=1,n=!0;return n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),e},set_y:function(e){this.y=e;var s,t=1,n=!0;return n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),e},set_z:function(e){this.z=e;var s,t=1,n=!0;return n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),e},set_scaleX:function(e){this.scaleX=e;var s,t=1,n=!0;return n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),e},set_scaleY:function(e){this.scaleY=e;var s,t=1,n=!0;return n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),e},set_scaleZ:function(e){this.scaleZ=e;var s,t=1,n=!0;return n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),e},set_defaultTransform:function(e){this.defaultTransform=e;var s,t=1,n=!0;return n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),e},setPosition:function(e,t,n){this.x=e;var i,s=1,o=!0;o?this.flags|=s:this.flags&=~s,i=o,i&&(this.flags&131072)!=0&&(s=262144,this.flags|=s),this.y=t,s=1,o=!0,o?this.flags|=s:this.flags&=~s,i=o,i&&(this.flags&131072)!=0&&(s=262144,this.flags|=s),this.z=n,s=1,o=!0,o?this.flags|=s:this.flags&=~s,i=o,i&&(this.flags&131072)!=0&&(s=262144,this.flags|=s),s=1,o=!0,o?this.flags|=s:this.flags&=~s,i=o,i&&(this.flags&131072)!=0&&(s=262144,this.flags|=s)},setTransform:function(e){var t,s,o,i,a,r,c,n=e,l=0,d=0,u=0;u==null&&(u=0),d==null&&(d=0),l==null&&(l=0),a=l,r=d,c=u,a=Math.sqrt(n._11*n._11+n._12*n._12+n._13*n._13),r=Math.sqrt(n._21*n._21+n._22*n._22+n._23*n._23),c=Math.sqrt(n._31*n._31+n._32*n._32+n._33*n._33),n._11*(n._22*n._33-n._23*n._32)+n._12*(n._23*n._31-n._21*n._33)+n._13*(n._21*n._32-n._22*n._31)<0&&(a*=-1,r*=-1,c*=-1),i=e._41,this.x=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),i=e._42,this.y=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),i=e._43,this.z=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),i=a,this.scaleX=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),i=r,this.scaleY=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),i=c,this.scaleZ=i,t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),se.tmpMat.load(e),se.tmpMat.prependScale(1/a,1/r,1/c),this.qRot.initRotateMatrix(se.tmpMat),t=1,s=!0,s?this.flags|=t:this.flags&=~t,o=s,o&&(this.flags&131072)!=0&&(t=262144,this.flags|=t)},getTransform:function(e){return e==null&&(e=new L),e.initScale(this.scaleX,this.scaleY,this.scaleZ),this.qRot.toMatrix(se.tmpMat),e.multiply3x4(e,se.tmpMat),e._41=this.x,e._42=this.y,e._43=this.z,e},rotate:function(e,t,n,s){s==null&&(s=new In),s.initRotation(e,t,n),this.qRot.multiply(s,this.qRot);var a,o=1,i=!0;i?this.flags|=o:this.flags&=~o,a=i,a&&(this.flags&131072)!=0&&(o=262144,this.flags|=o)},setRotation:function(e,t,n){this.qRot.initRotation(e,t,n);var i,s=1,o=!0;o?this.flags|=s:this.flags&=~s,i=o,i&&(this.flags&131072)!=0&&(s=262144,this.flags|=s)},setRotationAxis:function(e,t,n,s){this.qRot.initRotateAxis(e,t,n,s);var a,o=1,i=!0;i?this.flags|=o:this.flags&=~o,a=i,a&&(this.flags&131072)!=0&&(o=262144,this.flags|=o)},setDirection:function(e,t){this.qRot.initDirection(e,t);var o,n=1,s=!0;s?this.flags|=n:this.flags&=~n,o=s,o&&(this.flags&131072)!=0&&(n=262144,this.flags|=n)},getLocalDirection:function(){var e=this.qRot,t=1-2*(e.y*e.y+e.z*e.z),n=2*(e.x*e.y+e.z*e.w),s=2*(e.x*e.z-e.y*e.w);return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},getRotationQuat:function(){return this.qRot},setRotationQuat:function(e){this.qRot=e;var s,t=1,n=!0;n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t)},scale:function(e){var t,n,s,o=this.scaleX*e;this.scaleX=o,t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),o=this.scaleY*e,this.scaleY=o,t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),o=this.scaleZ*e,this.scaleZ=o,t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t)},setScale:function(e){this.scaleX=e;var s,t=1,n=!0;n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.scaleY=e,t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),this.scaleZ=e,t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t),t=1,n=!0,n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t)},toString:function(){var e=H.getClass(this);return e.__name__.split(".").pop()+(this.name==null?"":"("+this.name+")")},getChildAt:function(e){return this.children[e]},getChildIndex:function(e){for(var t,n=0,s=this.children.length;n<s;)if(t=n++,this.children[t]==e)return t;return-1},get_numChildren:function(){return this.children.length},iterator:function(){return new Fr(this.children)},__class__:se},sr=function(e){if(this.boxes=[],se.call(this,null),this.col=e,this.skin=e.obj,this.box=new Zo(16777215,e.currentBounds),this.addChild(this.box),!0!=((this.flags&2048)!=0)){var s,t=1,n=!0;n?this.flags|=t:this.flags&=~t,s=n,s&&(this.flags&131072)!=0&&(t=262144,this.flags|=t)}t=2048,this.flags|=t,this.createJoints()},c["h3d.col.SkinColliderDebugObj"]=sr,sr.__name__="h3d.col.SkinColliderDebugObj",sr.__super__=se,sr.prototype=g(se.prototype,{createJoints:function(){for(var e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,F,T,z,N,L,R,D=this.skin.getSkinData().allJoints,M=0;M<D.length;)l=D[M],++M,i=new Ce,i.xMin=-1,i.yMin=-1,i.zMin=-1,i.xMax=1,i.yMax=1,i.zMax=1,a=new Zo(10526880,i,null,this),l.offsets!=null?(c=a.bounds,c.xMin=1e20,c.xMax=-1e20,c.yMin=1e20,c.yMax=-1e20,c.zMin=1e20,c.zMax=-1e20,b=l.offsets,j=b.xMin,k=b.yMin,g=b.zMin,g==null&&(g=0),k==null&&(k=0),j==null&&(j=0),A=j,S=k,y=g,y==null&&(y=0),S==null&&(S=0),A==null&&(A=0),L=A,R=S,N=y,s=a.bounds,p=L,f=R,m=N,n=l.offsetRay,p-n<s.xMin&&(s.xMin=p-n),p+n>s.xMax&&(s.xMax=p+n),f-n<s.yMin&&(s.yMin=f-n),f+n>s.yMax&&(s.yMax=f+n),m-n<s.zMin&&(s.zMin=m-n),m+n>s.zMax&&(s.zMax=m+n),_=l.offsets,w=_.xMax,O=_.yMax,x=_.zMax,x==null&&(x=0),O==null&&(O=0),w==null&&(w=0),C=w,E=O,v=x,v==null&&(v=0),E==null&&(E=0),C==null&&(C=0),z=C,T=E,F=v,o=a.bounds,h=z,u=T,d=F,e=l.offsetRay,h-e<o.xMin&&(o.xMin=h-e),h+e>o.xMax&&(o.xMax=h+e),u-e<o.yMin&&(o.yMin=u-e),u+e>o.yMax&&(o.yMax=u+e),d-e<o.zMin&&(o.zMin=d-e),d+e>o.zMax&&(o.zMax=d+e)):(r=a.bounds,r.xMin=1e20,r.xMax=-1e20,r.yMin=1e20,r.yMax=-1e20,r.zMin=1e20,r.zMax=-1e20,t=a.bounds,-.1<t.xMin&&(t.xMin=-.1),.1>t.xMax&&(t.xMax=.1),-.1<t.yMin&&(t.yMin=-.1),.1>t.yMax&&(t.yMax=.1),-.1<t.zMin&&(t.zMin=-.1),.1>t.zMax&&(t.zMax=.1)),this.boxes.push(a)},updateJoints:function(){for(var e,t,n,o,s=0,i=this.boxes.length;s<i;)t=s++,e=this.skin.skinData.allJoints[t],n=this.boxes[t],e.offsets!=null?(o=this.skin.currentPalette[e.bindIndex],n.setTransform(o)):n.setTransform(this.skin.jointsData[e.index].currentRelPos)},sync:function(){this.col.checkBounds(),this.updateJoints()},__class__:sr}),Is=function(e,t,n,s){s==null&&(s=1),n==null&&(n=0),t==null&&(t=0),e==null&&(e=0);var o=e,i=t,a=n,r=s;r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),this.x=o,this.y=i,this.z=a,this.r=r},c["h3d.col.Sphere"]=Is,Is.__name__="h3d.col.Sphere",Is.__super__=ot,Is.prototype=g(ot.prototype,{load:function(e,t,n,s){s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.x=e,this.y=t,this.z=n,this.r=s},getCenter:function(){var e=this.x,t=this.y,n=this.z;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),new h(e,t,n)},distance:function(e){var n=e.x-this.x,s=e.y-this.y,o=e.z-this.z,t=n*n+s*s+o*o-this.r*this.r;return t<0?-Math.sqrt(-t):Math.sqrt(t)},distanceSq:function(e){var t=e.x-this.x,n=e.y-this.y,s=e.z-this.z;return t*t+n*n+s*s-this.r*this.r},contains:function(e){var t=e.x-this.x,n=e.y-this.y,s=e.z-this.z;return t*t+n*n+s*s-this.r*this.r<0},rayIntersection:function(e){var a,r,s=e.px-this.x,o=e.py-this.y,i=e.pz-this.z,n=s*e.lx+o*e.ly+i*e.lz,c=s*s+o*o+i*i-this.r*this.r;return c>0&&n>0?-1:(a=n*n-c,a<0?-1:(r=-n-Math.sqrt(a),r<0?0:r))},inFrustum:function(e,t){return t!=null?this.inFrustumMatrix(e,t):e.hasSphere(this)},inFrustumMatrix:function(e,t){var n,a,r,c,l,d,u,h,m,f,p,g,v,b,w=this.x,j=this.y,_=this.z,y=this.r,s=this.x,i=this.y,o=this.z;return o==null&&(o=0),i==null&&(i=0),s==null&&(s=0),m=s,d=i,u=o,u==null&&(u=0),d==null&&(d=0),m==null&&(m=0),a=m,r=d,c=u,g=a*t._11+r*t._21+c*t._31+t._41,p=a*t._12+r*t._22+c*t._32+t._42,v=a*t._13+r*t._23+c*t._33+t._43,a=g,r=p,c=v,this.x=a,this.y=r,this.z=c,n=t,s=0,i=0,o=0,o==null&&(o=0),i==null&&(i=0),s==null&&(s=0),l=s,f=i,h=o,l=Math.sqrt(n._11*n._11+n._12*n._12+n._13*n._13),f=Math.sqrt(n._21*n._21+n._22*n._22+n._23*n._23),h=Math.sqrt(n._31*n._31+n._32*n._32+n._33*n._33),n._11*(n._22*n._33-n._23*n._32)+n._12*(n._23*n._31-n._21*n._33)+n._13*(n._21*n._32-n._22*n._31)<0&&(l*=-1,f*=-1,h*=-1),this.r*=Math.abs(Math.max(Math.max(l,f),h)),b=e.hasSphere(this),this.x=w,this.y=j,this.z=_,this.r=y,b},transform:function(e){var n,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,t=e,s=0,o=0,i=0;i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),p=s,d=o,f=i,p=Math.sqrt(t._11*t._11+t._12*t._12+t._13*t._13),d=Math.sqrt(t._21*t._21+t._22*t._22+t._23*t._23),f=Math.sqrt(t._31*t._31+t._32*t._32+t._33*t._33),t._11*(t._22*t._33-t._23*t._32)+t._12*(t._23*t._31-t._21*t._33)+t._13*(t._21*t._32-t._22*t._31)<0&&(p*=-1,d*=-1,f*=-1),n=p,v=n<0?-n:n,n=d,a=n<0?-n:n,g=v<a?a:v,n=f,a=n<0?-n:n,b=g<a?a:g,this.r*=b,s=this.x,o=this.y,i=this.z,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=i,m==null&&(m=0),h==null&&(h=0),u==null&&(u=0),l=u,c=h,r=m,j=l*e._11+c*e._21+r*e._31+e._41,y=l*e._12+c*e._22+r*e._32+e._42,_=l*e._13+c*e._23+r*e._33+e._43,l=j,c=y,r=_,this.x=l,this.y=c,this.z=r},inSphere:function(e){var t,n,s,r,c,l,d,u,h,m,f,p,a=this.x,o=this.y,i=this.z;return i==null&&(i=0),o==null&&(o=0),a==null&&(a=0),t=a,n=o,s=i,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),d=t,p=n,f=s,a=e.x,o=e.y,i=e.z,i==null&&(i=0),o==null&&(o=0),a==null&&(a=0),t=a,n=o,s=i,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),m=t,u=n,h=s,r=m-d,l=u-p,c=h-f,r*r+l*l+c*c<(e.r+this.r)*(e.r+this.r)},toString:function(){var e=this.x,t=this.y,n=this.z;return n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),"Sphere{"+o.string(new h(e,t,n))+","+x.fmt(this.r)+"}"},dimension:function(){return this.r},closestPoint:function(e){var o,i,a,r,c,l,d,u,m,f,p,g,v,b,j,y,_,t=this.x,n=this.y,s=this.z;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,u=i,l=a,t=e.x-f,n=e.y-u,s=e.z-l,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),d=o,c=i,m=a,r=d*d+c*c+m*m,r<1e-20?r=0:r=1/Math.sqrt(r),t=d*r,n=c*r,s=m*r,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),g=o,v=i,b=a,p=this.r,t=g*p,n=v*p,s=b*p,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),j=o,y=i,_=a,t=this.x,n=this.y,s=this.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=t,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),f=o,u=i,l=a,t=j+f,n=y+u,s=_+l,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),new h(t,n,s)},clone:function(){var e=new Is;return e.x=this.x,e.y=this.y,e.z=this.z,e.r=this.r,e},makeDebugObj:function(){var t,n,s,a,r,c,l=Ps.defaultUnitSphere(),e=new me(l),i=this.r,o=e.scaleX*i;return e.scaleX=o,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),o=e.scaleY*i,e.scaleY=o,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),o=e.scaleZ*i,e.scaleZ=o,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),a=this.x,r=this.y,c=this.z,e.x=a,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),e.y=r,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),e.z=c,t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),t=1,n=!0,n?e.flags|=t:e.flags&=~t,s=n,s&&(e.flags&131072)!=0&&(t=262144,e.flags|=t),e},__class__:Is}),je=_["h3d.impl.Feature"]={__ename__:!0,__constructs__:null,StandardDerivatives:{_hx_name:"StandardDerivatives",_hx_index:0,__enum__:"h3d.impl.Feature",toString:s},FloatTextures:{_hx_name:"FloatTextures",_hx_index:1,__enum__:"h3d.impl.Feature",toString:s},AllocDepthBuffer:{_hx_name:"AllocDepthBuffer",_hx_index:2,__enum__:"h3d.impl.Feature",toString:s},HardwareAccelerated:{_hx_name:"HardwareAccelerated",_hx_index:3,__enum__:"h3d.impl.Feature",toString:s},MultipleRenderTargets:{_hx_name:"MultipleRenderTargets",_hx_index:4,__enum__:"h3d.impl.Feature",toString:s},Queries:{_hx_name:"Queries",_hx_index:5,__enum__:"h3d.impl.Feature",toString:s},SRGBTextures:{_hx_name:"SRGBTextures",_hx_index:6,__enum__:"h3d.impl.Feature",toString:s},ShaderModel3:{_hx_name:"ShaderModel3",_hx_index:7,__enum__:"h3d.impl.Feature",toString:s},BottomLeftCoords:{_hx_name:"BottomLeftCoords",_hx_index:8,__enum__:"h3d.impl.Feature",toString:s},Wireframe:{_hx_name:"Wireframe",_hx_index:9,__enum__:"h3d.impl.Feature",toString:s},InstancedRendering:{_hx_name:"InstancedRendering",_hx_index:10,__enum__:"h3d.impl.Feature",toString:s}},je.__constructs__=[je.StandardDerivatives,je.FloatTextures,je.AllocDepthBuffer,je.HardwareAccelerated,je.MultipleRenderTargets,je.Queries,je.SRGBTextures,je.ShaderModel3,je.BottomLeftCoords,je.Wireframe,je.InstancedRendering],je.__empty_constructs__=[je.StandardDerivatives,je.FloatTextures,je.AllocDepthBuffer,je.HardwareAccelerated,je.MultipleRenderTargets,je.Queries,je.SRGBTextures,je.ShaderModel3,je.BottomLeftCoords,je.Wireframe,je.InstancedRendering],li=_["h3d.impl.QueryKind"]={__ename__:!0,__constructs__:null,TimeStamp:{_hx_name:"TimeStamp",_hx_index:0,__enum__:"h3d.impl.QueryKind",toString:s},Samples:{_hx_name:"Samples",_hx_index:1,__enum__:"h3d.impl.QueryKind",toString:s},TimeElapsed:{_hx_name:"TimeElapsed",_hx_index:2,__enum__:"h3d.impl.QueryKind",toString:s}},li.__constructs__=[li.TimeStamp,li.Samples,li.TimeElapsed],li.__empty_constructs__=[li.TimeStamp,li.Samples,li.TimeElapsed],fa=_["h3d.impl.RenderFlag"]={__ename__:!0,__constructs__:null,CameraHandness:{_hx_name:"CameraHandness",_hx_index:0,__enum__:"h3d.impl.RenderFlag",toString:s}},fa.__constructs__=[fa.CameraHandness],fa.__empty_constructs__=[fa.CameraHandness],$n=function(){this.shaderCache=$n.SHADER_CACHE},c["h3d.impl.Driver"]=$n,$n.__name__="h3d.impl.Driver",$n.setShaderCache=function(e){$n.SHADER_CACHE=e},$n.prototype={hasFeature:function(){return!1},setRenderFlag:function(){},isSupportedFormat:function(){return!1},isDisposed:function(){return!0},dispose:function(){},begin:function(){},log:function(){},generateMipMaps:function(){throw t.thrown("Mipmaps auto generation is not supported on this platform")},getNativeShaderCode:function(){return null},logImpl:function(){},clear:function(){},captureRenderBuffer:function(){},capturePixels:function(){throw t.thrown("Can't capture pixels on this platform")},getDriverName:function(){return"Not available"},init:function(e,t){t==null&&(t=!1)},resize:function(){},selectShader:function(){return!1},selectMaterial:function(){},uploadShaderBuffers:function(){},flushShaderBuffers:function(){},selectBuffer:function(){},selectMultiBuffers:function(){},draw:function(){},drawInstanced:function(){},setRenderZone:function(){},setRenderTarget:function(e,t,n,s){s==null&&(s=ht.ReadWrite),n==null&&(n=0),t==null&&(t=0)},setRenderTargets:function(e,t){t==null&&(t=ht.ReadWrite)},setDepth:function(){},setDepthClamp:function(){},setDepthBias:function(){},allocDepthBuffer:function(){return null},disposeDepthBuffer:function(){},getDefaultDepthBuffer:function(){return null},present:function(){},end:function(){},setDebug:function(){},allocTexture:function(){return null},allocBuffer:function(){return null},allocInstanceBuffer:function(){},uploadInstanceBufferBytes:function(){},disposeTexture:function(){},disposeBuffer:function(){},disposeInstanceBuffer:function(){},uploadIndexData:function(){},uploadBufferData:function(){},uploadBufferBytes:function(){},uploadTextureBitmap:function(){},uploadTexturePixels:function(){},readBufferBytes:function(){},copyTexture:function(){return!1},allocQuery:function(){return null},deleteQuery:function(){},beginQuery:function(){},endQuery:function(){},queryResultAvailable:function(){return!0},queryResult:function(){return 0},computeDispatch:function(e,n,s,o){throw o==null&&(o=!0),s==null&&(s=1),n==null&&(n=1),e==null&&(e=1),t.thrown("Compute shaders are not implemented on this platform")},memoryBarrier:function(){throw t.thrown("Compute shaders are not implemented on this platform")},__class__:$n},Pc=function(e,t,n){this.s=e,this.kind=t,this.shader=n},c["h3d.impl._GlDriver.CompiledShader"]=Pc,Pc.__name__="h3d.impl._GlDriver.CompiledShader",Pc.prototype={__class__:Pc},mr=function(){},c["h3d.impl._GlDriver.CompiledAttribute"]=mr,mr.__name__="h3d.impl._GlDriver.CompiledAttribute",mr.prototype={__class__:mr},fr=function(){},c["h3d.impl._GlDriver.CompiledProgram"]=fr,fr.__name__="h3d.impl._GlDriver.CompiledProgram",fr.prototype={__class__:fr},$=function(e){e==null&&(e=0),this.features=new vo,this.maxCompressedTexturesSupport=0,this.hasMultiIndirect=!1,this.rightHanded=!1,this.firstShader=!0,this.boundTextures=[],this.curTargets=[],this.useDepthClamp=!1;var s,o,i,a,n=[];if(n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),n.push(0),this.currentDivisor=n,this.curColorMask=-1,this.lastActiveIndex=0,this.curStEnabled=!1,this.curStMaskBits=-1,this.curStOpBits=-1,this.curMatBits=-1,this.maxIdxCurAttribs=0,this.curAttribs=[],$n.call(this),this.canvas=pt.getInstance().canvas,a={alpha:!1,stencil:!0,antialias:e>0},$.ALLOW_WEBGL2&&(this.gl=this.canvas.getContext("webgl2",a)),this.gl==null&&(this.gl=Vc.getContextWebGL(this.canvas,a)),this.gl==null)throw t.thrown("Could not acquire GL context");typeof WebGLDebugUtils!="undefined"&&(this.gl=WebGLDebugUtils.makeDebugContext(this.gl),this.glDebug=!0),this.commonFB=this.gl.createFramebuffer(),this.programs=new le,this.defStencil=new Q,this.frame=N.frameCount,i=this.gl.getParameter(7938),s=new Ss("ES ([0-9]+\\.[0-9]+)",""),s.match(i)&&(this.glES=parseFloat(s.matched(1))),s=new Ss("[0-9]+\\.[0-9]+",""),i=this.gl.getParameter(35724),s.match(i)&&(this.glES=parseFloat(s.matched(0)),this.shaderVersion=Math.round(parseFloat(s.matched(0))*100)),this.drawMode=4,this.makeFeatures(),this.hasFeature(je.InstancedRendering)&&this.glES<3&&(o=this.gl.getExtension("ANGLE_instanced_arrays"),this.gl.vertexAttribDivisor=b(o,o.vertexAttribDivisorANGLE),this.gl.drawElementsInstanced=b(o,o.drawElementsInstancedANGLE)),st.UNROLL_LOOPS=!this.hasFeature(je.ShaderModel3),this.gl.pixelStorei(3333,1),this.gl.pixelStorei(3317,1)},c["h3d.impl.GlDriver"]=$,$.__name__="h3d.impl.GlDriver",$.__super__=$n,$.prototype=g($n.prototype,{setRenderFlag:function(e,t){this.rightHanded=t>0},logImpl:function(e){console.log(e)},setDebug:function(e){this.debug=e},begin:function(e){this.frame=e,this.resetStream(),this.gl.useProgram(null),this.curShader=null,this.curBuffer=null},makeCompiler:function(){var e=new _t;return e.glES=this.glES,e.version=this.shaderVersion,e.intelDriverFix=this.isIntelGpu,e},getNativeShaderCode:function(e){var t,s,n=this;return e.mode==Ft.Compute?(t=e.vertex.data,n.makeCompiler().run(t)):(t=e.vertex.data,s=`// vertex:
`+n.makeCompiler().run(t)+`// fragment:
`,t=e.fragment.data,s+n.makeCompiler().run(t))},getDriverName:function(e){var t=this.gl.getParameter(7937);return e?t+=" GLv"+o.string(this.gl.getParameter(7938)):t=t.split("/").shift(),t=t.split("WebGL ").join(""),"OpenGL "+t},compileShader:function(e,n){switch(n.kind._hx_index){case 0:c=35633;break;case 1:c=35632;break;case 4:throw t.thrown("Compute shader is not supported");default:throw t.thrown("assert")}var s,a,r,c,l,d,h,m,i=this.gl.createShader(c);if(n.code==null&&(n.code=e.run(n.data),n.data.funs=null),this.gl.shaderSource(i,n.code),this.gl.compileShader(i),this.gl.getShaderParameter(i,35713)!=1){for(l=this.gl.getShaderInfoLog(i),d=o.parseInt(u.substr(l,9,null)),s=d==null?null:n.code.split(`
`)[d-1],s==null?s="":s="("+M.trim(s)+")",a=n.code.split(`
`),h=0,m=a.length;h<m;)r=h++,a[r]=r+1+"	"+a[r];throw t.thrown("An error occurred compiling the shaders: "+l+s+`

`+a.join(`
`))}return new Pc(i,n.kind,n)},initShader:function(e,n,s,a){switch(n.kind._hx_index){case 0:m="vertex";break;case 1:m="fragment";break;default:m="compute"}n.globals=this.gl.getUniformLocation(e.p,m+"Globals"),n.params=this.gl.getUniformLocation(e.p,m+"Params"),n.textures=[];for(var r,c,l,d,h,m,p,g,v,y,O,x,C,E,k,A,M,F,T,z,D,w=0,j=null,b=0,S="",f=s.textures;f!=null;){switch(r=f.type,x=1,r._hx_index){case 15:c=r.size,c._hx_index==0&&(A=c.v,E=r.t,r=E,x=A);break;case 17:d=r.size,r=i.TSampler(Ke.T2D,!1);break;default:}if(j==null||!Y.enumEq(r,j)){switch(j=r,r._hx_index){case 10:switch(p=r.dim,v=r.isArray,p._hx_index){case 1:b=v?35866:3553;break;case 2:if(v==!1)b=32879;else throw t.thrown("Texture not supported "+o.string(r));break;case 3:if(v==!1)b=34067;else throw t.thrown("Texture not supported "+o.string(r));break;default:throw t.thrown("Texture not supported "+o.string(r))}S="Textures"+(p==Ke.T2D?"":u.substr(_[p.__enum__].__constructs__[p._hx_index]._hx_name,1,null))+(v?"Array":"");break;case 11:throw D=r.dim,z=r.isArray,T=r.channels,t.thrown("Texture not supported "+o.string(r));default:throw t.thrown("Unsupported texture type "+o.string(r))}w=0}for(h=0,k=x;h<k;){if(l=h++,y=this.gl.getUniformLocation(e.p,m+S+"["+w+"]"),y==null)throw t.thrown("Texture "+a.spec.instances[f.instance].shader.data.name+"."+f.name+" is missing from generated shader");n.textures.push({u:y,t:j,mode:b}),++w}f=f.next}if(s.bufferCount>0){for(n.bufferTypes=[],g=n.shader.buffers;g!=null;){if(c=g.type,c._hx_index==16)d=c.t,h=c.size,M=c.kind,C=M;else throw t.thrown("assert");n.bufferTypes.push(C),g=g.next}for(c=[],d=0,h=s.bufferCount;d<h;){switch(l=d++,n.bufferTypes[l]._hx_index){case 0:F=this.gl.getUniformBlockIndex(e.p,(s.kind==de.Vertex?"vertex_":"")+"uniform_buffer"+l);break;case 1:throw t.thrown("Storage buffer not supported in WebGL");case 2:throw t.thrown("RW buffer not supported in WebGL");default:throw t.thrown("assert")}c.push(F)}for(n.buffers=c,O=0,n.kind==de.Fragment&&(O=a.vertex.bufferCount),c=0,d=s.bufferCount;c<d;)switch(l=c++,n.bufferTypes[l]._hx_index){case 0:this.gl.uniformBlockBinding(e.p,n.buffers[l],l+O);break;case 1:case 2:break;default:throw t.thrown("assert")}}},selectShader:function(e){var s,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,n=this.programs.h[e.id];if(n==null){n=new fr,a=this.makeCompiler(),n.vertex=this.compileShader(a,e.vertex),e.fragment!=null&&(n.fragment=this.compileShader(a,e.fragment)),n.p=this.gl.createProgram(),this.gl.attachShader(n.p,n.vertex.s),n.fragment!=null&&this.gl.attachShader(n.p,n.fragment.s),c=null;try{this.gl.linkProgram(n.p),this.gl.getProgramParameter(n.p,35714)!=1&&(c=this.gl.getProgramInfoLog(n.p))}catch(e){throw b=t.caught(e).unwrap(),t.thrown("Shader linkage error: "+o.string(b)+" ("+this.getDriverName(!1)+")")}if(this.gl.deleteShader(n.vertex.s),n.fragment!=null&&this.gl.deleteShader(n.fragment.s),c!=null)throw this.gl.deleteProgram(n.p),t.thrown("Program linkage failure: "+c+`
Vertex=
`+e.vertex.code+(e.fragment==null?"":`

Fragment=
`+e.fragment.code));for(this.firstShader=!1,this.initShader(n,n.vertex,e.vertex,e),n.fragment!=null&&this.initShader(n,n.fragment,e.fragment,e),n.attribs=[],n.hasAttribIndex=0,h=[],d=0,m=e.vertex.data.vars;d<m.length;)if(i=m[d],++d,i.kind._hx_index==1){if(u=Pt.fromHXSL(i.type),r=this.gl.getAttribLocation(n.p,a.varNames.h.hasOwnProperty(i.id)?a.varNames.h[i.id]:i.name),r<0)continue;if(r>=32)throw t.thrown("assert");if(s=new mr,s.type=5126,s.index=r,s.size=u==H.__cast(9,St)?1:u,f=i.type,f._hx_index==9&&(v=f.size,s.type=5120,s.size=v),s.divisor=0,i.qualifiers!=null)for(l=0,p=i.qualifiers;l<p.length;)g=p[l],++l,g._hx_index==9&&(j=g.v,s.divisor=j);n.attribs.push(s),n.hasAttribIndex|=1<<s.index,h.push(new ce(i.name,u,0))}n.format=y.make(h),this.programs.h[e.id]=n}return this.curShader!=n&&(this.setProgram(n),!0)},setProgram:function(e){this.gl.useProgram(e.p);for(var n,o,i,t=0,s=e.attribs;t<s.length;)o=s[t],++t,this.curAttribs[o.index]||(this.gl.enableVertexAttribArray(o.index),this.curAttribs[o.index]=!0,this.maxIdxCurAttribs<o.index&&(this.maxIdxCurAttribs=o.index));for(i=0,t=0,s=this.maxIdxCurAttribs+1;t<s;)n=t++,this.curAttribs[n]&&(e.hasAttribIndex&1<<n)==0?(this.gl.disableVertexAttribArray(n),this.curAttribs[n]=!1):this.curAttribs[n]&&(i=n);for(this.maxIdxCurAttribs=i,this.curShader=e,this.curBuffer=null,t=0,s=this.boundTextures.length;t<s;)n=t++,this.boundTextures[n]=null},uploadShaderBuffers:function(e,t){this.uploadBuffer(e,this.curShader.vertex,e.vertex,t),this.curShader.fragment!=null&&this.uploadBuffer(e,this.curShader.fragment,e.fragment,t)},uploadBuffer:function(e,n,s,i){switch(i){case 0:if(n.globals!=null){var a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,C,E,x=s.globals.subarray(0,n.shader.globalsSize*4);this.gl.uniform4fv(n.globals,x)}break;case 1:n.params!=null&&(x=s.params.subarray(0,n.shader.paramsSize*4),this.gl.uniform4fv(n.params,x));break;case 2:for(E=0,u=0,m=n.textures.length;u<m;){if(r=u++,a=s.tex[r],c=n.textures[r],a==null||a.t==null&&(a.isDepth()||a.realloc==null))if(f=c.t,f._hx_index==10)switch(p=f.isArray,f.dim._hx_index){case 2:if(p==!1)a=_s.default3DTexture();else throw t.thrown("Missing texture");break;case 3:if(p==!1)a=S.defaultCubeTexture();else throw t.thrown("Missing texture");break;default:if(p==!1)C=Cn.loadingTextureColor,a=S.fromColor(C,(C>>>24)/255);else throw t.thrown("Missing texture")}else throw t.thrown("Missing texture");if(a!=null&&a.t==null&&a.realloc!=null&&(v=this.curShader,a.alloc(),a.realloc(),this.curShader!=v)){this.setProgram(v),this.uploadShaderBuffers(e,0),this.uploadShaderBuffers(e,1),this.uploadShaderBuffers(e,2);return}if(a.set_lastFrame(this.frame),c.u==null)continue;if(d=n.kind==de.Fragment?this.curShader.vertex.textures.length+r:r,this.boundTextures[d]!=a.t){if(this.boundTextures[d]=a.t,b=this.getBindType(a),b!=c.mode)throw t.thrown("Texture format mismatch: "+o.string(a)+" should be "+o.string(c.t));this.gl.activeTexture(33984+d),this.gl.uniform1i(c.u,d),this.gl.bindTexture(b,a.t.t),this.lastActiveIndex=d}j=a.mipMap._hx_index,y=a.filter._hx_index,_=a.wrap._hx_index,w=j|y<<3|_<<6,w!=a.t.bits&&(a.t.bits=w,O=$.TFILTERS[j][y],l=c.mode,this.gl.texParameteri(l,10240,O[0]),this.gl.texParameteri(l,10241,O[1]),this.gl.texParameteri(l,34892,0),g=$.TWRAP[_],this.gl.texParameteri(l,10242,g),this.gl.texParameteri(l,10243,g),this.gl.texParameteri(l,32882,g)),a.t.startMip!=a.startingMip&&(this.gl.texParameteri(c.mode,33084,a.startingMip),a.t.startMip=a.startingMip)}break;case 3:if(n.buffers!=null)for(h=0,n.kind==de.Fragment&&this.curShader.vertex.buffers!=null&&(h=this.curShader.vertex.buffers.length),u=0,m=n.buffers.length;u<m;)switch(r=u++,n.bufferTypes[r]._hx_index){case 0:this.gl.bindBufferBase(35345,r+h,s.buffers[r].vbuf);break;case 1:this.gl.bindBufferBase(37074,r+h,s.buffers[r].vbuf);break;case 2:if((s.buffers[r].flags&1<<ve.ReadWriteBuffer._hx_index)==0)throw t.thrown("Buffer was allocated without ReadWriteBuffer flag");this.gl.bindBufferBase(37074,r+h,s.buffers[r].vbuf);break;default:throw t.thrown("assert")}break}},selectMaterial:function(e){var n,o,i,s=e.bits;if(this.curTarget==null==this.rightHanded)switch(e.culling._hx_index){case 1:s=s&-4|2;break;case 2:s=s&-4|1;break;default:}if(this.selectMaterialBits(s),this.curColorMask!=e.colorMask){if(n=e.colorMask,this.gl.colorMask((n&1)!=0,(n&2)!=0,(n&4)!=0,(n&8)!=0),i=n>>4,i>0)throw t.thrown("GL ColorMaski support requires hlsdl 1.14+");this.curColorMask=n}o=this.defStencil,e.stencil==null?this.curStEnabled&&(this.gl.disable(2960),this.curStEnabled=!1):(o=e.stencil,this.curStEnabled||(this.gl.enable(2960),this.curStEnabled=!0)),this.selectStencilBits(o.opBits,o.maskBits)},selectMaterialBits:function(e){var n,s,o,i,a,r,c,l,d,u,t=e^this.curMatBits;if(this.curMatBits<0&&(t=-1),t==0)return;d=(e&536870912)!=0,u=!0,u&&(this.drawMode=d?3:4),(t&3)!=0&&(i=e&3,i==0?this.gl.disable(2884):((this.curMatBits<0||(this.curMatBits&3)==0)&&this.gl.enable(2884),this.gl.cullFace($.FACES[i]))),(t&8388480)!=0&&(n=e>>7&15,s=e>>11&15,a=e>>15&15,r=e>>19&15,n==a&&s==r?n==0&&s==1?this.gl.disable(3042):((this.curMatBits<0||(this.curMatBits>>7&15)==0&&(this.curMatBits>>11&15)==1)&&this.gl.enable(3042),this.gl.blendFunc($.BLEND[n],$.BLEND[s])):((this.curMatBits<0||(this.curMatBits>>7&15)==0&&(this.curMatBits>>11&15)==1)&&this.gl.enable(3042),this.gl.blendFuncSeparate($.BLEND[n],$.BLEND[s],$.BLEND[a],$.BLEND[r]))),(t&528482304)!=0&&(o=e>>23&7,c=e>>26&7,o==c?this.gl.blendEquation($.OP[o]):this.gl.blendEquationSeparate($.OP[o],$.OP[c])),(t&4)!=0&&this.gl.depthMask((e>>2&1)!=0),(t&112)!=0&&(l=e>>4&7,l==0?this.gl.disable(2929):((this.curMatBits<0||(this.curMatBits>>4&7)==0)&&this.gl.enable(2929),this.gl.depthFunc($.COMPARE[l]))),this.curMatBits=e},selectStencilBits:function(e,t){var o,n=e^this.curStOpBits,s=t^this.curStMaskBits;if((n|s)==0)return;(n&4088)!=0&&this.gl.stencilOpSeparate($.FACES[2],$.STENCIL_OP[e>>6&7],$.STENCIL_OP[e>>9&7],$.STENCIL_OP[e>>3&7]),(n&16744448)!=0&&this.gl.stencilOpSeparate($.FACES[1],$.STENCIL_OP[e>>18&7],$.STENCIL_OP[e>>21&7],$.STENCIL_OP[e>>15&7]),(n&7|s&16711935)!=0&&this.gl.stencilFuncSeparate($.FACES[2],$.COMPARE[e&7],t>>16&255,t&255),(n&28672|s&16711935)!=0&&this.gl.stencilFuncSeparate($.FACES[1],$.COMPARE[e>>12&7],t>>16&255,t&255),(s&65280)!=0&&(o=t>>8&255,this.gl.stencilMaskSeparate($.FACES[2],o),this.gl.stencilMaskSeparate($.FACES[1],o)),this.curStOpBits=e,this.curStMaskBits=t},clear:function(e,t,n){var s=0;e!=null&&(this.gl.colorMask(!0,!0,!0,!0),this.curColorMask=15,this.gl.clearColor(e.x,e.y,e.z,e.w),s|=16384),t!=null&&(this.gl.depthMask(!0),this.curMatBits>=0&&(this.curMatBits|=4),this.gl.clearDepth(t),s|=256),n!=null&&(this.selectStencilBits(this.defStencil.opBits,this.defStencil.maskBits),this.gl.clearStencil(n),s|=1024),s!=0&&this.gl.clear(s),this.curTarget!=null&&(this.curTarget.flags|=1<<w.WasCleared._hx_index)},resize:function(e,t){if(this.canvas.style.width==""){var n=e/window.devicePixelRatio|0;this.canvas.style.width=n+"px",n=t/window.devicePixelRatio|0,this.canvas.style.height=n+"px"}this.canvas.width=e,this.canvas.height=t,this.bufferWidth=e,this.bufferHeight=t,this.gl.viewport(0,0,e,t),this.defaultDepth!=null&&(this.disposeDepthBuffer(this.defaultDepth),this.defaultDepth.width=this.bufferWidth,this.defaultDepth.height=this.bufferHeight,this.defaultDepth.t=this.allocDepthBuffer(this.defaultDepth))},getChannels:function(e){switch(e.internalFmt){case 6407:return 6407;case 6408:return 6408;case 32857:return 6408;case 6403:case 33321:case 33322:case 33325:case 33326:return 6403;case 33319:case 33323:case 33324:case 33327:case 33328:return 33319;case 34836:case 34842:return 6408;case 35898:return 6407;case 35904:case 35905:return 6407;case 32859:case 33777:case 33778:case 33779:case 36492:return 6408;case 32852:case 34837:case 34843:case 36495:return 6407;default:throw t.thrown("Invalid format "+e.internalFmt)}},isSupportedFormat:function(e){switch(e._hx_index){case 2:return!0;case 3:case 4:return this.hasFeature(je.FloatTextures);case 14:case 15:return this.hasFeature(je.SRGBTextures);case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 16:case 17:return this.glES>=3;case 22:var t=e.v;return t<=this.maxCompressedTexturesSupport;default:return!1}},getBindType:function(e){if((e.flags&1<<w.Is3D._hx_index)!=0)return 32879;var t=(e.flags&1<<w.IsArray._hx_index)!=0;return(e.flags&1<<w.Cube._hx_index)!=0?34067:t?35866:3553},allocTexture:function(e){var n,s,i,a,r,c,l,u,d=this;switch($.outOfMemoryCheck&&this.gl.getError(),u=this.gl.createTexture(),i=this.getBindType(e),n={t:u,width:e.width,height:e.height,internalFmt:6408,pixelFmt:5121,bits:-1,bind:i,bias:0,startMip:e.startingMip},r=e.format,r._hx_index){case 1:n.internalFmt=32856;break;case 2:break;case 3:if(this.hasFeature(je.FloatTextures))n.pixelFmt=5131,n.internalFmt=34842;else throw t.thrown("Unsupported texture format "+o.string(e.format));break;case 4:if(this.hasFeature(je.FloatTextures))n.internalFmt=34836,n.pixelFmt=5126;else throw t.thrown("Unsupported texture format "+o.string(e.format));break;case 5:n.internalFmt=33321;break;case 6:n.internalFmt=33325,n.pixelFmt=5131;break;case 7:n.internalFmt=33326,n.pixelFmt=5126;break;case 8:n.internalFmt=33323;break;case 9:n.internalFmt=33327,n.pixelFmt=5131;break;case 10:n.internalFmt=33328,n.pixelFmt=5126;break;case 11:n.internalFmt=6407;break;case 12:n.internalFmt=34843,n.pixelFmt=5131;break;case 13:n.internalFmt=34837,n.pixelFmt=5126;break;case 14:n.internalFmt=35905;break;case 16:n.internalFmt=32857,n.pixelFmt=33640;break;case 17:n.internalFmt=35898,n.pixelFmt=35899;break;case 18:n.internalFmt=33322,n.pixelFmt=5123;break;case 19:n.internalFmt=33324,n.pixelFmt=5123;break;case 20:n.internalFmt=32852,n.pixelFmt=5123;break;case 21:n.internalFmt=32859,n.pixelFmt=5123;break;case 22:if(c=r.v,c<=this.maxCompressedTexturesSupport){if((e.width&3)!=0||(e.height&3)!=0)throw t.thrown("Compressed texture "+o.string(e)+" has size "+e.width+"x"+e.height+" - must be a multiple of 4");switch(c){case 1:n.internalFmt=33777;break;case 2:n.internalFmt=33778;break;case 3:n.internalFmt=33779;break;case 6:n.internalFmt=36495;break;case 7:n.internalFmt=36492;break;default:throw t.thrown("Unsupported texture format "+o.string(e.format))}}else throw t.thrown("Unsupported texture format "+o.string(e.format));break;default:throw t.thrown("Unsupported texture format "+o.string(e.format))}if(n.pixelFmt==5123&&!this.has16Bits)throw t.thrown("16 bit textures requires EXT_texture_norm16 extension");if(e.set_lastFrame(this.frame),e.flags&=-1-(1<<w.WasCleared._hx_index),this.gl.bindTexture(i,n.t),a=!1,this.gl.texParameteri(i,33084,e.startingMip),this.gl.texParameteri(i,33085,e.get_mipLevels()-1),l=n.internalFmt==6408?32856:n.internalFmt,((e.flags&1<<w.IsArray._hx_index)!=0||(e.flags&1<<w.Is3D._hx_index)!=0)&&(e.flags&1<<w.Cube._hx_index)==0){if(this.gl.texStorage3D(i,e.get_mipLevels(),l,n.width,n.height,e.get_layerCount()),$.outOfMemoryCheck)if(s=d.gl.getError(),s==1285)a=!0;else if(s!=0)throw t.thrown("Failed to alloc texture "+o.string(e.format)+"(error "+s+")")}else if(this.gl.texStorage2D(i,e.get_mipLevels(),l,n.width,n.height),$.outOfMemoryCheck)if(s=d.gl.getError(),s==1285)a=!0;else if(s!=0)throw t.thrown("Failed to alloc texture "+o.string(e.format)+"(error "+s+")");return this.restoreBind(),a?(this.gl.deleteTexture(n.t),null):n},restoreBind:function(){var e=this.boundTextures[this.lastActiveIndex];e==null?this.gl.bindTexture(3553,null):this.gl.bindTexture(e.bind,e.t)},allocDepthBuffer:function(e){var i=this.gl.createTexture(),n={t:i,width:e.width,height:e.height,internalFmt:6408,pixelFmt:5121,bits:-1,bind:3553,bias:0,startMip:0},s=6402;switch(e.format._hx_index){case 23:n.internalFmt=33189;break;case 24:if(this.glES>=3)n.internalFmt=6402;else throw t.thrown("Unsupported depth format "+o.string(e.format));break;case 25:n.internalFmt=35056,n.pixelFmt=34042,s=34041;break;case 26:n.internalFmt=36012;break;default:throw t.thrown("Unsupported depth format "+o.string(e.format))}return e.set_lastFrame(this.frame),e.flags&=-1-(1<<w.WasCleared._hx_index),this.gl.bindTexture(n.bind,n.t),this.gl.texParameteri(n.bind,10241,9728),this.gl.texParameteri(n.bind,10240,9728),this.gl.texParameteri(n.bind,10242,33071),this.gl.texParameteri(n.bind,10243,33071),this.gl.texImage2D(n.bind,0,n.internalFmt,n.width,n.height,0,s,n.pixelFmt,null),this.restoreBind(),n},disposeDepthBuffer:function(e){e.t!=null&&e.t.t!=null&&(this.gl.deleteTexture(e.t.t),e.t=null)},getDefaultDepthBuffer:function(){return this.defaultDepth!=null?this.defaultDepth:(this.defaultDepth=new S(0,0,null,f.Depth24Stencil8),this.defaultDepth.name="defaultDepthBuffer",this.defaultDepth.width=this.bufferWidth,this.defaultDepth.height=this.bufferHeight,this.defaultDepth.t=this.allocDepthBuffer(this.defaultDepth),this.defaultDepth)},discardError:function(){$.outOfMemoryCheck&&this.gl.getError()},allocBuffer:function(e){$.outOfMemoryCheck&&this.gl.getError();var o,i,a,n=this.gl.createBuffer(),s=(e.flags&1<<ve.IndexBuffer._hx_index)!=0?34963:34962;if(this.gl.bindBuffer(s,n),e.vertices*e.format.stride==0)throw t.thrown("assert");return o=e.vertices*e.format.strideBytes,a=(e.flags&1<<ve.UniformBuffer._hx_index)!=0,this.gl.bufferData(s,o,(e.flags&1<<ve.Dynamic._hx_index)!=0?35048:35044),i=$.outOfMemoryCheck&&this.gl.getError()==1285,this.gl.bindBuffer(s,null),(e.flags&1<<ve.IndexBuffer._hx_index)!=0&&(this.curIndexBuffer=null),i?(this.gl.deleteBuffer(n),null):n},disposeTexture:function(e){var n,s,o,t=e.t;if(t==null)return;for(e.t=null,n=0,o=this.boundTextures.length;n<o;)s=n++,this.boundTextures[s]==t&&(this.boundTextures[s]=null);this.gl.deleteTexture(t.t)},disposeBuffer:function(e){this.gl.deleteBuffer(e.vbuf)},generateMipMaps:function(e){var t=this.getBindType(e);this.gl.bindTexture(t,e.t.t),this.gl.generateMipmap(t),this.restoreBind()},uploadTextureBitmap:function(e,t,n,s){if(e.format!=f.RGBA||e.get_layerCount()!=1){var i,o=t.getPixels();this.uploadTexturePixels(e,o,n,s),o.dispose()}else i=t.ctx,this.gl.bindTexture(3553,e.t.t),this.gl.texSubImage2D(3553,n,0,0,this.getChannels(e.t),e.t.pixelFmt,i.getImageData(0,0,t.ctx.canvas.width,t.ctx.canvas.height)),this.restoreBind()},resetStream:function(){},streamData:function(e){return e},uploadTexturePixels:function(e,t,n,s){var o,a,r,c,l,u,d=(e.flags&1<<w.Cube._hx_index)!=0,i=3553;switch(d&&(i=$.CUBE_FACES[s]),(e.flags&1<<w.IsArray._hx_index)!=0?i=35866:(e.flags&1<<w.Is3D._hx_index)!=0&&(i=32879),l=this.getBindType(e),this.gl.bindTexture(l,e.t.t),t.convert(e.format),a=t.dataSize,e.format._hx_index){case 4:case 7:case 10:case 13:o=new Float32Array(t.bytes.b.buffer,t.offset,a>>2);break;case 16:case 17:o=new Uint32Array(t.bytes.b.buffer,t.offset,a>>2);break;case 3:case 6:case 9:case 12:case 18:case 19:case 20:case 21:o=new Uint16Array(t.bytes.b.buffer,t.offset,a>>1);break;default:o=new Uint8Array(t.bytes.b.buffer,t.offset,a)}r=e.format,r._hx_index==22?(u=r.v,c=!0):c=!1,c?(e.flags&1<<w.IsArray._hx_index)!=0||(e.flags&1<<w.Is3D._hx_index)!=0?this.gl.compressedTexSubImage3D(i,n,0,0,s,t.width,t.height,1,e.t.internalFmt,o):this.gl.compressedTexSubImage2D(i,n,0,0,t.width,t.height,e.t.internalFmt,o):(e.flags&1<<w.IsArray._hx_index)!=0||(e.flags&1<<w.Is3D._hx_index)!=0?this.gl.texSubImage3D(i,n,0,0,s,t.width,t.height,1,this.getChannels(e.t),e.t.pixelFmt,o):this.gl.texSubImage2D(i,n,0,0,t.width,t.height,this.getChannels(e.t),e.t.pixelFmt,o),e.flags|=1<<w.WasCleared._hx_index,this.restoreBind()},uploadBufferData:function(e,t,n,s,o){var a,r,i=e.format.strideBytes;this.gl.bindBuffer(34962,e.vbuf),a=s.array,r=new Float32Array(a.buffer,o*4,n*i>>2),this.gl.bufferSubData(34962,t*i,r),this.gl.bindBuffer(34962,null)},uploadBufferBytes:function(e,t,n,s,o){var r,a=e.format.strideBytes,i=(e.flags&1<<ve.IndexBuffer._hx_index)!=0?34963:34962;this.gl.bindBuffer(i,e.vbuf),r=new Uint8Array(s.b.bufferValue,o,n*a),this.gl.bufferSubData(i,t*a,r),this.gl.bindBuffer(i,null),(e.flags&1<<ve.IndexBuffer._hx_index)!=0&&(this.curIndexBuffer=null)},readBufferBytes:function(e,t,n,s,o){var a=e.format.strideBytes,r=n*a,i=(e.flags&1<<ve.IndexBuffer._hx_index)!=0?34963:34962;this.gl.bindBuffer(i,e.vbuf),this.gl.getBufferSubData(i,t*a,s.b,o,r),this.gl.bindBuffer(i,null)},uploadIndexData:function(e,t,n,s,o){var a,r,i=e.format.strideBytes>>1;this.gl.bindBuffer(34963,e.vbuf),a=new Uint16Array(s),r=new Uint16Array(a.buffer,o<<i,n),this.gl.bufferSubData(34963,t<<i,r),this.gl.bindBuffer(34963,null),this.curIndexBuffer=null},updateDivisor:function(e){this.currentDivisor[e.index]!=e.divisor&&(this.currentDivisor[e.index]=e.divisor,this.gl.vertexAttribDivisor(e.index,e.divisor))},selectBuffer:function(e){if(e==this.curBuffer)return;if(this.curShader==null)throw t.thrown("No shader selected");this.gl.bindBuffer(34962,e.vbuf),this.curBuffer=e;for(var n,s,o,a,c,l,d,u,h,m,f=e.format.strideBytes,p=e.format.resolveMapping(this.curShader.format),i=0,r=this.curShader.attribs;i<r.length;){switch(d=r[i],l=i++,c=l,n=d,a=p[c],o=!1,u=this.gl,h=n.index,m=n.size,a&7){case 0:s=n.type;break;case 1:s=5131;break;case 2:o=!0,s=5121;break;case 3:o=!0,s=5120;break}u.vertexAttribPointer(h,m,s,o,f,a>>16),this.currentDivisor[n.index]!=n.divisor&&(this.currentDivisor[n.index]=n.divisor,this.gl.vertexAttribDivisor(n.index,n.divisor))}},selectMultiBuffers:function(e,t){var n,s,o,i,a,r,c,d,u,h,f,p,g,v,m=this.curShader.format,l=e.mappings[m.uid];for(l==null&&(l=e.makeMapping(m)),f=l,a=0,c=this.curShader.attribs;a<c.length;){switch(h=c[a],u=a++,d=u,n=h,r=f[d],o=t[r>>3&255],this.curBuffer!=o&&(this.gl.bindBuffer(34962,o.vbuf),this.curBuffer=o),i=!1,p=this.gl,g=n.index,v=n.size,r&7){case 0:s=n.type;break;case 1:s=5131;break;case 2:i=!0,s=5121;break;case 3:i=!0,s=5120;break}p.vertexAttribPointer(g,v,s,i,o.format.strideBytes,r>>16),this.currentDivisor[n.index]!=n.divisor&&(this.currentDivisor[n.index]=n.divisor,this.gl.vertexAttribDivisor(n.index,n.divisor))}},draw:function(e,t,n){e!=this.curIndexBuffer&&(this.curIndexBuffer=e,this.gl.bindBuffer(34963,e.vbuf)),e.format.strideBytes==4?this.gl.drawElements(this.drawMode,n*3,5125,t*4):this.gl.drawElements(this.drawMode,n*3,5123,t*2)},allocInstanceBuffer:function(e,n){for(var s,a,r,c,l,d,u,o=[],i=0,h=e.commandCount;i<h;){if(a=i++,s=a*5*4,r=n.getInt32(s),c=n.getInt32(s+4),l=n.getInt32(s+8),d=n.getInt32(s+12),u=n.getInt32(s+16),d!=0||u!=0)throw t.thrown("baseVertex and baseInstance must be zero on this platform");o.push(r),o.push(l),o.push(c)}e.data=o},uploadInstanceBufferBytes:function(e,t,n,s,o){var i=20,a=34962,r=new Uint8Array(s.b.bufferValue,o,n*i);this.gl.bufferSubData(a,t*i,r),this.gl.bindBuffer(a,null)},disposeInstanceBuffer:function(e){e.data=null},drawInstanced:function(e,t){e!=this.curIndexBuffer&&(this.curIndexBuffer=e,this.gl.bindBuffer(34963,e.vbuf)),e.format.strideBytes==4?(s=5125,o=4):(s=5123,o=2);var s,o,i,a,r,c,n=t.data;if(n!=null)for(i=0,a=0,r=n.length/3|0;a<r;)c=a++,this.gl.drawElementsInstanced(this.drawMode,n[i++],s,n[i++]*o,n[i++]);else this.gl.drawElementsInstanced(this.drawMode,t.indexCount,s,t.startIndex*o,t.commandCount)},end:function(){},present:function(){},isDisposed:function(){return this.gl.isContextLost()},setRenderZone:function(e,t,n,s){e==0&&t==0&&n<0&&s<0?this.gl.disable(3089):(this.gl.enable(3089),this.curTarget==null&&(t=this.bufferHeight-(t+s)),this.gl.scissor(e,t,n,s))},setDrawBuffers:function(e){this.glES>=3?this.gl.drawBuffers($.CBUFFERS[e]):this.mrtExt!=null&&this.mrtExt.drawBuffersWEBGL($.CBUFFERS[e])},unbindTargets:function(){if(this.curTarget!=null&&this.numTargets>1){for(;this.numTargets>1;)this.gl.framebufferTexture2D(36160,36064+--this.numTargets,3553,null,0),this.curTargets[this.numTargets]=null;this.setDrawBuffers(1)}},capturePixels:function(e,t,n,s){s!=null?(s.xMax>e.width&&(s.xMax=e.width),s.yMax>e.height&&(s.yMax=e.height),s.xMin<0&&(s.xMin=0),s.yMin<0&&(s.yMin=0),o=s.xMax-s.xMin,i=s.yMax-s.yMin,d=s.xMin,u=s.yMin):(o=e.width,i=e.height,d=0,u=0),o>>=n,i>>=n,o==0&&(o=1),i==0&&(i=1);var o,i,r,c,l,d,u,h=G.alloc(o,i,e.format),m=this.curTarget,a=this.numTargets,f=this.curTargetLayer,p=this.curTargetMip;if(a>1)for(this.numTargets=1,r=1,l=a;r<l;)c=r++,this.curTargets[c]==e&&this.gl.framebufferTexture2D(36160,36064+c,3553,null,0);if(this.setRenderTarget(e,t,n),this.captureSubRenderBuffer(h,d,u),this.setRenderTarget(m,f,p),a>1){for(r=1,l=a;r<l;)c=r++,this.curTargets[c]==e&&this.gl.framebufferTexture2D(36160,36064+c,3553,e.t.t,0);this.setDrawBuffers(a),this.numTargets=a}return h},setRenderTarget:function(e,n,s,o){if(o==null&&(o=ht.ReadWrite),s==null&&(s=0),n==null&&(n=0),this.unbindTargets(),this.curTarget=e,e==null){this.gl.bindFramebuffer(36160,null),this.gl.viewport(0,0,this.bufferWidth,this.bufferHeight);return}if(e.depthBuffer!=null&&(e.depthBuffer.width!=e.width||e.depthBuffer.height!=e.height))throw t.thrown("Invalid depth buffer size : does not match render target size");if(s>0&&this.glES==1)throw t.thrown("Cannot render to mipLevel in WebGL1, use upload() instead");if(e.t==null&&e.alloc(),(e.flags&1<<w.MipMapped._hx_index)!=0&&(e.flags&1<<w.WasCleared._hx_index)==0){var i,a,r,c,d,u,l=this.getBindType(e);this.gl.bindTexture(l,e.t.t),this.gl.generateMipmap(l),this.restoreBind()}for(e.set_lastFrame(this.frame),this.curTargetLayer=n,this.curTargetMip=s,this.gl.bindFramebuffer(36160,this.commonFB),(e.flags&1<<w.IsArray._hx_index)!=0||(e.flags&1<<w.Is3D._hx_index)!=0?this.gl.framebufferTextureLayer(36160,36064,e.t.t,s,n):this.gl.framebufferTexture2D(36160,36064,(e.flags&1<<w.Cube._hx_index)!=0?$.CUBE_FACES[n]:3553,e.t.t,s),e.depthBuffer!=null&&o!=ht.NotBound?e.depthBuffer.hasStencil()&&e.depthBuffer.format==f.Depth24Stencil8?this.gl.framebufferTexture2D(36160,33306,3553,e.depthBuffer.t.t,0):(this.gl.framebufferTexture2D(36160,33306,3553,null,0),this.gl.framebufferTexture2D(36160,36096,3553,e.depthBuffer.t.t,0),this.gl.framebufferTexture2D(36160,36128,3553,e.depthBuffer.hasStencil()?e.depthBuffer.t.t:null,0)):(this.gl.framebufferTexture2D(36160,33306,3553,null,0),this.gl.framebufferTexture2D(36160,36096,3553,null,0),this.gl.framebufferTexture2D(36160,36128,3553,null,0)),i=e.width>>s,i==0&&(i=1),a=e.height>>s,a==0&&(a=1),this.gl.viewport(0,0,i,a),r=0,d=this.boundTextures.length;r<d;)u=r++,this.boundTextures[u]=null;if((e.flags&1<<w.WasCleared._hx_index)==0&&(e.flags|=1<<w.WasCleared._hx_index,this.clear($.BLACK)),this.glDebug&&(c=this.gl.checkFramebufferStatus(36160),c!=36053))throw t.thrown("Invalid frame buffer: "+c)},setRenderTargets:function(e,t){if(t==null&&(t=ht.ReadWrite),this.unbindTargets(),this.setRenderTarget(e[0],null,null,t),e.length<2)return;this.numTargets=e.length;for(var n,s,o=!1,i=1,a=e.length;i<a;)s=i++,n=e[s],n.t==null&&n.alloc(),this.gl.framebufferTexture2D(36160,36064+s,3553,n.t.t,0),this.curTargets[s]=n,n.set_lastFrame(this.frame),(n.flags&1<<w.WasCleared._hx_index)==0&&(n.flags|=1<<w.WasCleared._hx_index,o=!0);this.setDrawBuffers(e.length),o&&this.clear($.BLACK)},setDepth:function(e){this.unbindTargets(),this.curTarget=e,e.set_lastFrame(this.frame),this.curTargetLayer=0,this.curTargetMip=0,this.gl.bindFramebuffer(36160,this.commonFB),this.gl.framebufferTexture2D(36160,36064,3553,null,0),e.hasStencil()&&e.format==f.Depth24Stencil8?this.gl.framebufferTexture2D(36160,33306,3553,e.t.t,0):(this.gl.framebufferTexture2D(36160,33306,3553,null,0),this.gl.framebufferTexture2D(36160,36096,3553,e.t.t,0),this.gl.framebufferTexture2D(36160,36128,3553,e.hasStencil()?e.t.t:null,0));var n,o,i,a,r,s=e.width;for(s==0&&(s=1),n=e.height,n==0&&(n=1),this.gl.viewport(0,0,s,n),o=0,a=this.boundTextures.length;o<a;)r=o++,this.boundTextures[r]=null;if(this.glDebug&&(i=this.gl.checkFramebufferStatus(36160),i!=36053))throw t.thrown("Invalid frame buffer: "+i)},setDepthClamp:function(){},setDepthBias:function(e,t){e!=0||t!=0?(this.gl.enable(32823),this.gl.polygonOffset(t,e)):this.gl.disable(32823)},init:function(e,t){if(t==null&&(t=!1),window.document.readyState=="complete"){var n,s=e,o=!1;Us.delay(function(){s(o)},1)}else n=null,n=function(){window.removeEventListener("load",n),e(!1)},window.addEventListener("load",n)},hasFeature:function(e){return this.features.get(e)},makeFeatures:function(){for(var t,e=0,n=je.__empty_constructs__.slice();e<n.length;)t=n[e],++e,this.features.set(t,this.checkFeature(t));this.gl.getExtension("WEBGL_compressed_texture_s3tc")!=null&&(this.maxCompressedTexturesSupport=3,this.gl.getExtension("EXT_texture_compression_bptc")!=null&&(this.maxCompressedTexturesSupport=7)),this.glES<3&&this.gl.getExtension("WEBGL_depth_texture"),this.has16Bits=this.gl.getExtension("EXT_texture_norm16")!=null},checkFeature:function(e){switch(e._hx_index){case 0:return this.glES>=3||this.gl.getExtension("OES_standard_derivatives")!=null;break;case 1:return this.glES>=3?this.gl.getExtension("EXT_color_buffer_float")!=null&&this.gl.getExtension("OES_texture_float_linear")!=null:this.gl.getExtension("OES_texture_float")!=null&&this.gl.getExtension("OES_texture_float_linear")!=null&&this.gl.getExtension("OES_texture_half_float")!=null&&this.gl.getExtension("OES_texture_half_float_linear")!=null;break;case 4:return this.glES>=3||this.mrtExt!=null||(this.mrtExt=this.gl.getExtension("WEBGL_draw_buffers"))!=null;break;case 6:return this.glES>=3||this.gl.getExtension("EXT_sRGB")!=null;break;case 7:return this.glES>=3;break;case 2:case 3:case 8:case 9:return!0;case 10:return this.glES>=3||this.gl.getExtension("ANGLE_instanced_arrays")!=null;break;default:return!1}},uploadTextureVideoElement:function(e,n,s,o){var i,a=(e.flags&1<<w.Cube._hx_index)!=0,r=this.getBindType(e);if((e.flags&1<<w.IsArray._hx_index)!=0)throw t.thrown("TODO:texImage3D");i=a?$.CUBE_FACES[o]:3553,this.gl.bindTexture(r,e.t.t),this.gl.texSubImage2D(i,s,0,0,n.videoWidth,n.videoHeight,this.getChannels(e.t),e.t.pixelFmt,n),this.restoreBind()},captureRenderBuffer:function(e){this.captureSubRenderBuffer(e,0,0)},captureSubRenderBuffer:function(e,n,s){if(this.curTarget==null)throw t.thrown("Can't capture main render buffer in GL");this.gl.getError();var i,o=e.bytes.b;switch(this.curTarget.format._hx_index){case 4:case 7:case 10:case 13:o=new Float32Array(o.buffer);break;case 16:case 17:o=new Uint32Array(o.buffer);break;case 3:case 6:case 9:case 12:case 18:case 19:case 20:case 21:o=new Uint16Array(o.buffer);break;default:}if(this.gl.readPixels(n,s,e.width,e.height,this.getChannels(this.curTarget.t),this.curTarget.t.pixelFmt,o),i=this.gl.getError(),i!=0)throw t.thrown("Failed to capture pixels (error "+i+")");e.set_innerFormat(this.curTarget.format)},__class__:$}),Ji=function(){this.triCount=0,this.offset=0},c["h3d.impl.InstanceBuffer"]=Ji,Ji.__name__="h3d.impl.InstanceBuffer",Ji.prototype={setCommand:function(e,t,n){n==null&&(n=0),this.commandCount=e,this.indexCount=t,this.triCount=e*t/3|0,this.startIndex=n},updateTriCount:function(e,t){this.triCount=0;for(var n,o,i,a,s=0,r=e;s<r;)n=s++,o=t.getInt32(n*Ji.ELEMENT_SIZE),i=t.getInt32(n*Ji.ELEMENT_SIZE+4),a=o*i/3|0,this.triCount+=a},uploadBytes:function(e,t){this.updateTriCount(e,t),this.commandCount=e,this.indexCount=0,this.driver=K.CURRENT.driver,this.driver.uploadInstanceBufferBytes(this,0,e,t,0)},allocFromBytes:function(e,t){this.dispose(),this.updateTriCount(e,t),this.commandCount=this.maxCommandCount=e,this.indexCount=0,this.driver=K.CURRENT.driver,this.driver.allocInstanceBuffer(this,t)},dispose:function(){this.data!=null&&this.driver.disposeInstanceBuffer(this)},__class__:Ji},po=function(e){this.lastAutoDispose=0,this.autoDisposeCooldown=60,this.texMemory=0,this.usedMemory=0,this.driver=e},c["h3d.impl.MemoryManager"]=po,po.__name__="h3d.impl.MemoryManager",po.enableTrackAlloc=function(e){wn.ENABLED=e??!0},po.prototype={init:function(){this.textures=[],this.buffers=[],this.initIndexes()},initIndexes:function(){for(var t,s,o,e=new Array(0),n=0;n<65532;)s=n++,e.push(s);for(this.triIndexes16=rn.alloc(e),e=new Array(0),o=0,n=0;n<10922;)s=n++,t=s<<2,e.push(t),e.push(t+1),e.push(t+2),e.push(t+2),e.push(t+1),e.push(t+3);e.push(65532),this.quadIndexes16=rn.alloc(e)},garbage:function(){},getTriIndexes:function(e){if(e<=65532)return this.triIndexes16;if(this.triIndexes32==null||this.triIndexes32.vertices<e){for(var n,s,o,i,t=131072;t<e;)t<<=1;for(n=new A(new ArrayBuffer(t<<2)),s=0,i=t;s<i;)o=s++,n.setInt32(o<<2,o);this.triIndexes32!=null&&this.triIndexes32.dispose(),this.triIndexes32=rn._new(t,!0),this.triIndexes32.uploadBytes(n,0,t)}return this.triIndexes32},getQuadIndexes:function(e){var t,n,s,o,i,r,c,a=(e+3>>2)*6;if(a<=65532)return this.quadIndexes16;if(this.quadIndexes32==null||this.quadIndexes32.vertices<e){for(n=131072;n<a;)n<<=1;for(t=new A(new ArrayBuffer(n<<2)),s=0,i=0,r=n/6|0;i<r;)c=i++,o=c<<2,t.setInt32(s++<<2,o),t.setInt32(s++<<2,o+1),t.setInt32(s++<<2,o+2),t.setInt32(s++<<2,o+2),t.setInt32(s++<<2,o+1),t.setInt32(s++<<2,o+3);this.quadIndexes32!=null&&this.quadIndexes32.dispose(),this.quadIndexes32=rn._new(n,!0),this.quadIndexes32.uploadBytes(t,0,n)}return this.quadIndexes32},allocBuffer:function(e){if(e.vbuf!=null)return;var s,n=e.vertices*e.format.strideBytes;if(n==0)return;for(;this.usedMemory+n>6442450944||(e.vbuf=this.driver.allocBuffer(e))==null;){if(this.driver.isDisposed())return;if(s=this.usedMemory,this.garbage(),this.usedMemory==s)throw t.thrown("Memory full ("+Math.ceil(s/1024)+" KB,"+this.buffers.length+" buffers)")}this.usedMemory+=n,this.buffers.push(e)},freeBuffer:function(e){if(e.vbuf==null)return;this.driver.disposeBuffer(e),e.vbuf=null,u.remove(this.buffers,e)&&(this.usedMemory-=e.vertices*e.format.strideBytes)},memSize:function(e){if((e.flags&1<<w.AsyncLoading._hx_index)!=0&&(e.flags&1<<w.Loading._hx_index)!=0)return 4;var t,n,s,o,a,i=G.calcDataSize(e.width,e.height,e.format);if(e.get_mipLevels()>0)for(s=1,a=e.get_mipLevels();s<a;)o=s++,t=e.width>>o,t==0&&(t=1),n=e.height>>o,n==0&&(n=1),i+=G.calcDataSize(t,n,e.format);return i*e.get_layerCount()},cleanTextures:function(e){e==null&&(e=!0),this.textures.sort(b(this,this.sortByLRU));for(var t,n=0,s=this.textures;n<s.length;){if(t=s[n],++n,t.realloc==null||t.t==null&&(t.isDepth()||t.realloc==null))continue;if((e||t._lastFrame<N.frameCount-3600)&&t._lastFrame!=S.PREVENT_AUTO_DISPOSE)return t.dispose(),!0}return!1},sortByLRU:function(e,t){return e._lastFrame-t._lastFrame},deleteTexture:function(e){if(!u.remove(this.textures,e))return;this.driver.disposeTexture(e),this.texMemory-=this.memSize(e)},allocTexture:function(e){for(;!0;){var n=!0;if(N.frameCount>this.lastAutoDispose+this.autoDisposeCooldown&&(n=this.cleanTextures(!1),this.lastAutoDispose=N.frameCount),e.t=e.isDepth()?this.driver.allocDepthBuffer(e):this.driver.allocTexture(e),e.t!=null)break;if(this.driver.isDisposed())return;for(;this.cleanTextures(!1););if(!n&&!this.cleanTextures(!0))throw t.thrown("Maximum texture memory reached")}this.textures.push(e),this.texMemory+=this.memSize(e)},onContextLost:function(){this.dispose(),this.initIndexes()},dispose:function(){this.triIndexes16!=null&&this.triIndexes16.dispose(),this.quadIndexes16!=null&&this.quadIndexes16.dispose(),this.triIndexes32!=null&&this.triIndexes32.dispose(),this.quadIndexes32!=null&&this.quadIndexes32.dispose(),this.triIndexes16=null,this.quadIndexes16=null,this.triIndexes32=null,this.quadIndexes32=null;for(var n,s,e=0,t=this.textures.slice();e<t.length;)n=t[e],++e,n.dispose();for(e=0,t=this.buffers.slice();e<t.length;)s=t[e],++e,s.dispose();this.buffers=[],this.textures=[],this.usedMemory=0,this.texMemory=0},stats:function(){for(var t,n=0,e=0,s=this.buffers;e<s.length;)t=s[e],++e,n+=t.vertices*t.format.strideBytes;return{bufferCount:this.buffers.length,bufferMemory:n,totalMemory:this.usedMemory+this.texMemory,textureCount:this.textures.length,textureMemory:this.texMemory}},allocStats:function(){for(var e,t,n,s,o,i,a,r,l,m,u=Object.create(null),h=[],c=0,d=this.textures;c<d.length;){if(r=d[c],++c,r.allocPos==null)continue;for(a="$"+r.allocPos.position,e=u[a],e==null&&(e={position:r.allocPos.position,count:0,size:0,tex:!0,stacks:[]},u[a]=e,h.push(e)),e.count++,t=this.memSize(r),e.size+=t,m=r.name,o=e.stacks,s=r.allocPos.stack.join(`
`),i=0;i<o.length;)n=o[i],++i,n.stack==s&&(n.size+=t,n.count++,n.stats.push({name:m,size:t}),s=null);s!=null&&o.push({stats:[{name:m,size:t}],stack:s,count:1,size:t})}for(c=0,d=this.buffers;c<d.length;){if(l=d[c],++c,l.allocPos==null)continue;for(a=l.allocPos.position,e=u[a],e==null&&(e={position:a,count:0,size:0,tex:!1,stacks:[]},u[a]=e,h.push(e)),e.count++,t=l.vertices*l.format.stride*4,e.size+=t,o=e.stacks,s=l.allocPos.stack.join(`
`),i=0;i<o.length;)n=o[i],++i,n.stack==s&&(n.size+=t,n.count++,n.stats.push({name:"buffer",size:t}),s=null);s!=null&&o.push({stats:[{name:"buffer",size:t}],stack:s,count:1,size:t})}return h.sort(function(e,t){return e.size>t.size?1:e.size<t.size?-1:0}),h},__class__:po},ir=function(){$n.call(this)},c["h3d.impl.NullDriver"]=ir,ir.__name__="h3d.impl.NullDriver",ir.__super__=$n,ir.prototype=g($n.prototype,{hasFeature:function(){return!0},isSupportedFormat:function(){return!0},logImpl:function(e){be.trace(e,{fileName:"h3d/impl/NullDriver.hx",lineNumber:23,className:"h3d.impl.NullDriver",methodName:"logImpl"})},isDisposed:function(){return!1},getDriverName:function(){return"NullDriver"},init:function(e,t){t==null&&(t=!1),e(!1)},selectShader:function(e){return this.cur!=e&&(this.cur=e,!0)},allocTexture:function(){return{}},allocBuffer:function(){return{}},__class__:ir}),Dt=_["h3d.impl.Step"]={__ename__:!0,__constructs__:null,MainDraw:{_hx_name:"MainDraw",_hx_index:0,__enum__:"h3d.impl.Step",toString:s},Decals:{_hx_name:"Decals",_hx_index:1,__enum__:"h3d.impl.Step",toString:s},Shadows:{_hx_name:"Shadows",_hx_index:2,__enum__:"h3d.impl.Step",toString:s},Lighting:{_hx_name:"Lighting",_hx_index:3,__enum__:"h3d.impl.Step",toString:s},Forward:{_hx_name:"Forward",_hx_index:4,__enum__:"h3d.impl.Step",toString:s},BeforeTonemapping:{_hx_name:"BeforeTonemapping",_hx_index:5,__enum__:"h3d.impl.Step",toString:s},AfterTonemapping:{_hx_name:"AfterTonemapping",_hx_index:6,__enum__:"h3d.impl.Step",toString:s},Overlay:{_hx_name:"Overlay",_hx_index:7,__enum__:"h3d.impl.Step",toString:s},Custom:(a=function(e){return{_hx_index:8,name:e,__enum__:"h3d.impl.Step",toString:s}},a._hx_name="Custom",a.__params__=["name"],a)},Dt.__constructs__=[Dt.MainDraw,Dt.Decals,Dt.Shadows,Dt.Lighting,Dt.Forward,Dt.BeforeTonemapping,Dt.AfterTonemapping,Dt.Overlay,Dt.Custom],Dt.__empty_constructs__=[Dt.MainDraw,Dt.Decals,Dt.Shadows,Dt.Lighting,Dt.Forward,Dt.BeforeTonemapping,Dt.AfterTonemapping,Dt.Overlay],yr=function(){},c["h3d.impl.RendererFX"]=yr,yr.__name__="h3d.impl.RendererFX",yr.__isInterface__=!0,yr.prototype={__class__:yr},ea=function(e,t,n){n==null&&(n=0),this.file=e;var s=t;this.outputFile=s??e,this.mode=n,this.sourceFile=e+".source"},c["h3d.impl.ShaderCache"]=ea,ea.__name__="h3d.impl.ShaderCache",ea.prototype={disableSave:function(){this.outputFile=null},initEmpty:function(){this.data=new fe,this.sources=new fe},load:function(){this.data=new fe;try{this.loadFile(this.file)}catch{}if(this.outputFile!=this.file)try{this.loadFile(this.outputFile)}catch{}if(this.keepSource)try{this.loadSources()}catch{}},loadFile:function(){throw t.thrown("Cannot load shader cache with this platform")},loadSources:function(){throw t.thrown("Cannot load shader cache with this platform")},resolveShaderBinary:function(e,t){t==null&&(t=""),this.data==null&&this.load();var n=this.data,s=t+pn.encode(e);return n.h[s]},saveCompiledShader:function(e,t,n,s){if(s==null&&(s=!0),n==null&&(n=""),this.outputFile==null)return;this.data==null&&this.load();var o=n+pn.encode(e);if(this.data.h[o]==t&&(!this.keepSource||this.sources.h[o]==e))return;this.data.h[o]=t,s&&this.save(),this.keepSource&&(this.sources.h[o]=e,this.saveSources())},save:function(){var e=new zn,n=this.data,t=ha.array({iterator:function(){return new sa(n.h)}});switch(t.sort(q.compare),e.writeString("VERSION"),e.writeInt32(1),e.writeString("MODE"),e.writeInt32(this.mode),this.mode){case 0:this.writeCache(t,e);break;case 1:this.writeBinaryCache(t,e);break}},writeCache:function(e,t){for(var n,o,s=0;s<e.length;)n=e[s],++s,t.writeInt32(n.length),t.writeString(n),o=Nn.encode(this.data.h[n]),t.writeInt32(o.length),t.writeString(o),t.writeByte(10)},writeBinaryCache:function(e,t){for(var n,s,o=0;o<e.length;)n=e[o],++o,t.writeInt32(n.length),t.writeString(n),s=this.data.h[n],t.writeInt32(s.length),t.writeBytes(s,0,s.length)},saveSources:function(){var t,n,o,e=new zn,i=this.sources,s=ha.array({iterator:function(){return new sa(i.h)}});for(s.sort(q.compare),t=0;t<s.length;)n=s[t],++t,e.writeInt32(n.length),e.writeString(n),o=this.sources.h[n],e.writeInt32(o.length),e.writeString(o),e.writeByte(10),e.writeByte(10)},__class__:ea},Rn=function(){this.position=0,this.cache=[];var e,t,n,s,o=K.CURRENT;if(this.defaultFormat=S.nativeFormat,this.defaultDepthBuffer=S.getDefaultDepth(),Rn.checkFlags<0){for(t=0,n=[w.Cube,w.MipMapped,w.ManualMipMapGen,w.Dynamic,w.IsArray],e=0;e<n.length;)s=n[e],++e,t|=1<<s._hx_index;Rn.checkFlags=t}},c["h3d.impl.TextureCache"]=Rn,Rn.__name__="h3d.impl.TextureCache",Rn.prototype={get:function(e){return e==null&&(e=0),this.cache[e]},getNamed:function(e){for(var t,n=0,s=this.position;n<s;)if(t=n++,this.cache[t].name==e)return this.cache[t];return null},set:function(e,t){this.cache[t]=e},begin:function(){for(;this.cache.length>this.position;){var e=this.cache.pop();e!=null&&e.dispose()}this.position=0},matchTargetFlags:function(e,t){var n,o,s=0;if(t!=null)for(n=0;n<t.length;)o=t[n],++n,s|=1<<o._hx_index;return(e.flags&Rn.checkFlags)==(s&Rn.checkFlags)},lookupTarget:function(e,t,n,s,o){for(var i,r,c,l,d,h,a=this.cache[this.position],u=this.position+1,m=this.cache.length;u<m;)if(l=u++,i=this.cache[l],i!=null&&!(i.t==null&&(i.isDepth()||i.realloc==null))&&i.width==t&&i.height==n&&i.format==s){if(d=0,o!=null)for(c=0;c<o.length;)h=o[c],++c,d|=1<<h._hx_index;if((i.flags&Rn.checkFlags)!=(d&Rn.checkFlags))continue;return this.cache[this.position]=i,this.cache[l]=a,i}return a!=null&&a.name==e&&(a.dispose(),a=null),o==null&&(o=[]),o.indexOf(w.Target)==-1&&o.push(w.Target),r=new S(t,n,o,s),r.realloc=function(){},a!=null?this.cache.splice(this.position,0,r):this.cache[this.position]=r,r},allocTarget:function(e,t,n,s,o,i){s==null&&(s=!0);var r,c,l,d,a=this.cache[this.position];if(o==null&&(o=this.defaultFormat),r=!1,a==null||a.t==null&&(a.isDepth()||a.realloc==null)||a.width!=t||a.height!=n||a.format!=o)r=!0;else{if(l=0,i!=null)for(c=0;c<i.length;)d=i[c],++c,l|=1<<d._hx_index;r=(a.flags&Rn.checkFlags)!=(l&Rn.checkFlags)}return r&&(a=this.lookupTarget(e,t,n,o,i)),a.depthBuffer=s?this.defaultDepthBuffer:null,a.setName(e),this.position++,a},allocTargetScale:function(e,t,n,s){n==null&&(n=!0);var o=K.CURRENT;return this.allocTarget(e,Math.ceil(o.width*t),Math.ceil(o.height*t),n,s)},allocTileTarget:function(e,t,n,s){return n==null&&(n=!1),this.allocTarget(e,Math.ceil(t.width+t.x)-Math.floor(t.x),Math.ceil(t.height+t.y)-Math.floor(t.y),n,s)},dispose:function(){for(var n,e=0,t=this.cache;e<t.length;)n=t[e],++e,n.dispose();this.cache=[]},__class__:Rn},Qo=function(){},c["hxd.impl.AnyProps"]=Qo,Qo.__name__="hxd.impl.AnyProps",Qo.prototype={set_props:function(e){return this.props=e,this.refreshProps(),e},setDefaultProps:function(e){this.set_props(this.getDefaultProps(e))},getDefaultProps:function(){return{}},refreshProps:function(){},__class__:Qo},Ds=function(e){e!=null&&this.addPass(new F("default",null)).addShader(e)},c["h3d.mat.BaseMaterial"]=Ds,Ds.__name__="h3d.mat.BaseMaterial",Ds.__super__=Qo,Ds.prototype=g(Qo.prototype,{addPass:function(e){for(var n=null,t=this.passes;t!=null;)n=t,t=t.nextPass;return n==null?this.passes=e:n.nextPass=e,e.nextPass=null,e},removePass:function(e){for(var n=null,t=this.passes;t!=null;){if(t==e)return n==null?this.passes=e.nextPass:n.nextPass=e.nextPass,e.nextPass=null,!0;n=t,t=t.nextPass}return!1},get_mainPass:function(){return this.passes},getPasses:function(){for(var e=this.passes,t=[];e!=null;)t.push(e),e=e.nextPass;return t},getPass:function(e){for(var t=this.passes;t!=null;){if(t.name==e)return t;t=t.nextPass}return null},allocPass:function(e,t){t==null&&(t=!0);var n=this.getPass(e);return n??(n=new F(e,null,t?this.passes:null),t&&this.passes!=null&&n.set_batchMode(this.passes.batchMode),this.addPass(n),n)},clone:function(e){return e==null&&(e=new Ds),e.passes.load(this.passes),e.name=this.name,e.set_props(this.props),e},__class__:Ds}),xt=_["h3d.mat.Face"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"h3d.mat.Face",toString:s},Back:{_hx_name:"Back",_hx_index:1,__enum__:"h3d.mat.Face",toString:s},Front:{_hx_name:"Front",_hx_index:2,__enum__:"h3d.mat.Face",toString:s},Both:{_hx_name:"Both",_hx_index:3,__enum__:"h3d.mat.Face",toString:s}},xt.__constructs__=[xt.None,xt.Back,xt.Front,xt.Both],xt.__empty_constructs__=[xt.None,xt.Back,xt.Front,xt.Both],R=_["h3d.mat.Blend"]={__ename__:!0,__constructs__:null,One:{_hx_name:"One",_hx_index:0,__enum__:"h3d.mat.Blend",toString:s},Zero:{_hx_name:"Zero",_hx_index:1,__enum__:"h3d.mat.Blend",toString:s},SrcAlpha:{_hx_name:"SrcAlpha",_hx_index:2,__enum__:"h3d.mat.Blend",toString:s},SrcColor:{_hx_name:"SrcColor",_hx_index:3,__enum__:"h3d.mat.Blend",toString:s},DstAlpha:{_hx_name:"DstAlpha",_hx_index:4,__enum__:"h3d.mat.Blend",toString:s},DstColor:{_hx_name:"DstColor",_hx_index:5,__enum__:"h3d.mat.Blend",toString:s},OneMinusSrcAlpha:{_hx_name:"OneMinusSrcAlpha",_hx_index:6,__enum__:"h3d.mat.Blend",toString:s},OneMinusSrcColor:{_hx_name:"OneMinusSrcColor",_hx_index:7,__enum__:"h3d.mat.Blend",toString:s},OneMinusDstAlpha:{_hx_name:"OneMinusDstAlpha",_hx_index:8,__enum__:"h3d.mat.Blend",toString:s},OneMinusDstColor:{_hx_name:"OneMinusDstColor",_hx_index:9,__enum__:"h3d.mat.Blend",toString:s},ConstantColor:{_hx_name:"ConstantColor",_hx_index:10,__enum__:"h3d.mat.Blend",toString:s},ConstantAlpha:{_hx_name:"ConstantAlpha",_hx_index:11,__enum__:"h3d.mat.Blend",toString:s},OneMinusConstantColor:{_hx_name:"OneMinusConstantColor",_hx_index:12,__enum__:"h3d.mat.Blend",toString:s},OneMinusConstantAlpha:{_hx_name:"OneMinusConstantAlpha",_hx_index:13,__enum__:"h3d.mat.Blend",toString:s},SrcAlphaSaturate:{_hx_name:"SrcAlphaSaturate",_hx_index:14,__enum__:"h3d.mat.Blend",toString:s}},R.__constructs__=[R.One,R.Zero,R.SrcAlpha,R.SrcColor,R.DstAlpha,R.DstColor,R.OneMinusSrcAlpha,R.OneMinusSrcColor,R.OneMinusDstAlpha,R.OneMinusDstColor,R.ConstantColor,R.ConstantAlpha,R.OneMinusConstantColor,R.OneMinusConstantAlpha,R.SrcAlphaSaturate],R.__empty_constructs__=[R.One,R.Zero,R.SrcAlpha,R.SrcColor,R.DstAlpha,R.DstColor,R.OneMinusSrcAlpha,R.OneMinusSrcColor,R.OneMinusDstAlpha,R.OneMinusDstColor,R.ConstantColor,R.ConstantAlpha,R.OneMinusConstantColor,R.OneMinusConstantAlpha,R.SrcAlphaSaturate],Ae=_["h3d.mat.Compare"]={__ename__:!0,__constructs__:null,Always:{_hx_name:"Always",_hx_index:0,__enum__:"h3d.mat.Compare",toString:s},Never:{_hx_name:"Never",_hx_index:1,__enum__:"h3d.mat.Compare",toString:s},Equal:{_hx_name:"Equal",_hx_index:2,__enum__:"h3d.mat.Compare",toString:s},NotEqual:{_hx_name:"NotEqual",_hx_index:3,__enum__:"h3d.mat.Compare",toString:s},Greater:{_hx_name:"Greater",_hx_index:4,__enum__:"h3d.mat.Compare",toString:s},GreaterEqual:{_hx_name:"GreaterEqual",_hx_index:5,__enum__:"h3d.mat.Compare",toString:s},Less:{_hx_name:"Less",_hx_index:6,__enum__:"h3d.mat.Compare",toString:s},LessEqual:{_hx_name:"LessEqual",_hx_index:7,__enum__:"h3d.mat.Compare",toString:s}},Ae.__constructs__=[Ae.Always,Ae.Never,Ae.Equal,Ae.NotEqual,Ae.Greater,Ae.GreaterEqual,Ae.Less,Ae.LessEqual],Ae.__empty_constructs__=[Ae.Always,Ae.Never,Ae.Equal,Ae.NotEqual,Ae.Greater,Ae.GreaterEqual,Ae.Less,Ae.LessEqual],Le=_["h3d.mat.StencilOp"]={__ename__:!0,__constructs__:null,Keep:{_hx_name:"Keep",_hx_index:0,__enum__:"h3d.mat.StencilOp",toString:s},Zero:{_hx_name:"Zero",_hx_index:1,__enum__:"h3d.mat.StencilOp",toString:s},Replace:{_hx_name:"Replace",_hx_index:2,__enum__:"h3d.mat.StencilOp",toString:s},Increment:{_hx_name:"Increment",_hx_index:3,__enum__:"h3d.mat.StencilOp",toString:s},IncrementWrap:{_hx_name:"IncrementWrap",_hx_index:4,__enum__:"h3d.mat.StencilOp",toString:s},Decrement:{_hx_name:"Decrement",_hx_index:5,__enum__:"h3d.mat.StencilOp",toString:s},DecrementWrap:{_hx_name:"DecrementWrap",_hx_index:6,__enum__:"h3d.mat.StencilOp",toString:s},Invert:{_hx_name:"Invert",_hx_index:7,__enum__:"h3d.mat.StencilOp",toString:s}},Le.__constructs__=[Le.Keep,Le.Zero,Le.Replace,Le.Increment,Le.IncrementWrap,Le.Decrement,Le.DecrementWrap,Le.Invert],Le.__empty_constructs__=[Le.Keep,Le.Zero,Le.Replace,Le.Increment,Le.IncrementWrap,Le.Decrement,Le.DecrementWrap,Le.Invert],ds=_["h3d.mat.MipMap"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"h3d.mat.MipMap",toString:s},Nearest:{_hx_name:"Nearest",_hx_index:1,__enum__:"h3d.mat.MipMap",toString:s},Linear:{_hx_name:"Linear",_hx_index:2,__enum__:"h3d.mat.MipMap",toString:s}},ds.__constructs__=[ds.None,ds.Nearest,ds.Linear],ds.__empty_constructs__=[ds.None,ds.Nearest,ds.Linear],Dn=_["h3d.mat.Filter"]={__ename__:!0,__constructs__:null,Nearest:{_hx_name:"Nearest",_hx_index:0,__enum__:"h3d.mat.Filter",toString:s},Linear:{_hx_name:"Linear",_hx_index:1,__enum__:"h3d.mat.Filter",toString:s}},Dn.__constructs__=[Dn.Nearest,Dn.Linear],Dn.__empty_constructs__=[Dn.Nearest,Dn.Linear],hs=_["h3d.mat.Wrap"]={__ename__:!0,__constructs__:null,Clamp:{_hx_name:"Clamp",_hx_index:0,__enum__:"h3d.mat.Wrap",toString:s},Repeat:{_hx_name:"Repeat",_hx_index:1,__enum__:"h3d.mat.Wrap",toString:s}},hs.__constructs__=[hs.Clamp,hs.Repeat],hs.__empty_constructs__=[hs.Clamp,hs.Repeat],rt=_["h3d.mat.Operation"]={__ename__:!0,__constructs__:null,Add:{_hx_name:"Add",_hx_index:0,__enum__:"h3d.mat.Operation",toString:s},Sub:{_hx_name:"Sub",_hx_index:1,__enum__:"h3d.mat.Operation",toString:s},ReverseSub:{_hx_name:"ReverseSub",_hx_index:2,__enum__:"h3d.mat.Operation",toString:s},Min:{_hx_name:"Min",_hx_index:3,__enum__:"h3d.mat.Operation",toString:s},Max:{_hx_name:"Max",_hx_index:4,__enum__:"h3d.mat.Operation",toString:s}},rt.__constructs__=[rt.Add,rt.Sub,rt.ReverseSub,rt.Min,rt.Max],rt.__empty_constructs__=[rt.Add,rt.Sub,rt.ReverseSub,rt.Min,rt.Max],w=_["h3d.mat.TextureFlags"]={__ename__:!0,__constructs__:null,Target:{_hx_name:"Target",_hx_index:0,__enum__:"h3d.mat.TextureFlags",toString:s},Cube:{_hx_name:"Cube",_hx_index:1,__enum__:"h3d.mat.TextureFlags",toString:s},MipMapped:{_hx_name:"MipMapped",_hx_index:2,__enum__:"h3d.mat.TextureFlags",toString:s},ManualMipMapGen:{_hx_name:"ManualMipMapGen",_hx_index:3,__enum__:"h3d.mat.TextureFlags",toString:s},IsNPOT:{_hx_name:"IsNPOT",_hx_index:4,__enum__:"h3d.mat.TextureFlags",toString:s},NoAlloc:{_hx_name:"NoAlloc",_hx_index:5,__enum__:"h3d.mat.TextureFlags",toString:s},Dynamic:{_hx_name:"Dynamic",_hx_index:6,__enum__:"h3d.mat.TextureFlags",toString:s},AlphaPremultiplied:{_hx_name:"AlphaPremultiplied",_hx_index:7,__enum__:"h3d.mat.TextureFlags",toString:s},WasCleared:{_hx_name:"WasCleared",_hx_index:8,__enum__:"h3d.mat.TextureFlags",toString:s},Loading:{_hx_name:"Loading",_hx_index:9,__enum__:"h3d.mat.TextureFlags",toString:s},Serialize:{_hx_name:"Serialize",_hx_index:10,__enum__:"h3d.mat.TextureFlags",toString:s},IsArray:{_hx_name:"IsArray",_hx_index:11,__enum__:"h3d.mat.TextureFlags",toString:s},AsyncLoading:{_hx_name:"AsyncLoading",_hx_index:12,__enum__:"h3d.mat.TextureFlags",toString:s},LazyLoading:{_hx_name:"LazyLoading",_hx_index:13,__enum__:"h3d.mat.TextureFlags",toString:s},Writable:{_hx_name:"Writable",_hx_index:14,__enum__:"h3d.mat.TextureFlags",toString:s},Is3D:{_hx_name:"Is3D",_hx_index:15,__enum__:"h3d.mat.TextureFlags",toString:s}},w.__constructs__=[w.Target,w.Cube,w.MipMapped,w.ManualMipMapGen,w.IsNPOT,w.NoAlloc,w.Dynamic,w.AlphaPremultiplied,w.WasCleared,w.Loading,w.Serialize,w.IsArray,w.AsyncLoading,w.LazyLoading,w.Writable,w.Is3D],w.__empty_constructs__=[w.Target,w.Cube,w.MipMapped,w.ManualMipMapGen,w.IsNPOT,w.NoAlloc,w.Dynamic,w.AlphaPremultiplied,w.WasCleared,w.Loading,w.Serialize,w.IsArray,w.AsyncLoading,w.LazyLoading,w.Writable,w.Is3D],Cn=function(){},c["h3d.mat.Defaults"]=Cn,Cn.__name__="h3d.mat.Defaults",Cn.get_shadowShader=function(){var e=Cn.shadowShader;return e==null&&(e=new vi,Cn.set_shadowShader(e),Cn.shadowShader.setPriority(-1)),e},Cn.set_shadowShader=function(e){return Cn.shadowShader=e},Cn.makeVolumeDecal=function(e){return new no(e.xMax-e.xMin,e.yMax-e.yMin)},Rs=function(e){this.mshader=new xo,this.set_blendMode(X.None),Ds.call(this,this.mshader),this.set_texture(e)},c["h3d.mat.Material"]=Rs,Rs.__name__="h3d.mat.Material",Rs.create=function(e){var t=rs.current.createMaterial();return t.set_texture(e),t.set_props(t.getDefaultProps()),t},Rs.__super__=Ds,Rs.prototype=g(Ds.prototype,{get_specularPower:function(){return this.mshader.specularPower__},set_specularPower:function(e){return this.mshader.specularPower__=e},get_specularAmount:function(){return this.mshader.specularAmount__},set_specularAmount:function(e){return this.mshader.specularAmount__=e},get_color:function(){return this.mshader.color__},set_color:function(e){return this.mshader.color__=e},get_shadows:function(){return!!this.castShadows&&this.receiveShadows},set_shadows:function(e){return this.set_castShadows(e),this.set_receiveShadows(e),e},set_castShadows:function(e){return this.castShadows==e?e:(this.passes!=null&&(e?this.addPass(new F("shadow",null,this.passes)).set_isStatic(this.staticShadows):this.removePass(this.getPass("shadow"))),this.castShadows=e)},set_receiveShadows:function(e){if(e==this.receiveShadows)return e;if(this.passes!=null){var t=Cn.get_shadowShader();e?this.passes.addShader(t):this.passes.removeShader(t)}return this.receiveShadows=e},set_staticShadows:function(e){var t=this.getPass("shadow");return t!=null&&t.set_isStatic(e),this.staticShadows=e},clone:function(e){var n,s,o,i,a,r,t=e??new Rs;return Ds.prototype.clone.call(this,t),t.set_castShadows(this.castShadows),t.set_receiveShadows(this.receiveShadows),t.set_texture(this.get_texture()),t.set_specularTexture(this.get_specularTexture()),t.set_normalMap(this.get_normalMap()),this.textureShader!=null&&(n=t.textureShader,n.constModified=!0,n.additive__=this.textureShader.additive__,n=t.textureShader,n.constModified=!0,n.killAlpha__=this.textureShader.killAlpha__,t.textureShader.killAlphaThreshold__=this.textureShader.killAlphaThreshold__),n=this.mshader.color__,s=n.x,o=n.y,i=n.z,a=n.w,a==null&&(a=1),i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),r=new j(s,o,i,a),t.mshader.color__=r,t.set_blendMode(this.blendMode),t},set_blendMode:function(e){if(this.passes!=null)switch(this.passes.setBlendMode(e),e._hx_index){case 0:this.passes.set_depthWrite(!0),this.passes.setPassName("default");break;case 1:this.passes.set_depthWrite(!0),this.passes.setPassName("alpha");break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:this.passes.set_depthWrite(!1),this.passes.setPassName("additive");break}return this.blendMode=e},get_specularTexture:function(){return this.specularShader==null?null:this.specularShader.texture__},get_texture:function(){return this.textureShader==null?null:this.textureShader.texture__},set_texture:function(e){return e==null?this.textureShader!=null&&(this.passes.removeShader(this.textureShader),this.textureShader=null):(this.textureShader==null&&(this.textureShader=new oo,this.passes.addShader(this.textureShader)),this.textureShader.texture__=e),e},get_normalMap:function(){return this.normalShader==null?null:this.normalShader.texture__},set_normalMap:function(e){return e==null?this.normalShader!=null&&(this.passes.removeShader(this.normalShader),this.normalShader=null):(this.normalShader==null&&(this.normalShader=new uo,this.textureShader!=null?this.passes.addShaderAtIndex(this.normalShader,this.passes.getShaderIndex(this.textureShader)+1):this.passes.addShader(this.normalShader)),this.normalShader.texture__=e),e},set_specularTexture:function(e){return e==null?this.specularShader!=null&&(this.passes.removeShader(this.specularShader),this.specularShader=null):(this.specularShader==null&&(this.specularShader=new ao,this.passes.addShader(this.specularShader)),this.specularShader.texture__=e),e},getDefaultModelProps:function(){var e=this.getDefaultProps();switch(this.blendMode._hx_index){case 0:break;case 1:e.kind="Alpha";break;case 2:e.kind="Add",e.culling=!1,e.shadows=!1,e.light=!1;break;default:throw t.thrown("Unsupported HMD material "+o.string(this.blendMode))}return e},getDefaultProps:function(e){var t;if(e==null)t={kind:"Opaque",shadows:!0,culling:!0,light:!0};else switch(e){case"particles3D":case"trail3D":t={kind:"Alpha",shadows:!1,culling:!1,light:!0};break;case"ui":t={kind:"Alpha",shadows:!1,culling:!1,light:!1};break;default:t={kind:"Opaque",shadows:!0,culling:!0,light:!0}}return t},refreshProps:function(){if(this.props==null||this.passes==null)return;var t,n,e=this.props;switch(e.kind){case"Add":this.set_blendMode(X.Add);break;case"Alpha":this.set_blendMode(X.Alpha);break;case"AlphaKill":case"Hidden":case"Opaque":this.set_blendMode(X.None);break;case"SoftAdd":this.set_blendMode(X.SoftAdd);break}t=this.textureShader,t!=null&&(t.constModified=!0,t.killAlpha__=e.kind=="AlphaKill",t.killAlphaThreshold__=.5),this.passes.set_culling(e.kind=="Hidden"?xt.Both:e.culling?xt.Back:xt.None),this.passes.set_enableLights(e.light),n=e.shadows,this.set_castShadows(n),this.set_receiveShadows(n),this.castShadows&&this.receiveShadows&&this.getPass("shadow").set_culling(this.passes.culling)},__class__:Rs}),Gr=function(){this.db=new fe},c["h3d.mat.MaterialDatabase"]=Gr,Gr.__name__="h3d.mat.MaterialDatabase",Gr.prototype={getFilePath:function(e){var t=e.entry.get_directory(),n="materials.props";return t==null||t==""?n:e.entry.get_directory()+"/"+n},getModelData:function(e){if(e==null)return null;var n,a,r,s=this.db,o=e.entry.get_directory(),i=s.h[o];if(i!=null)return i.v;a=this.getFilePath(e);try{r=Kt.currentInstance.load(a),n=JSON.parse(r.toText())}catch(e){if(t.caught(e).unwrap()instanceof Lo)n={};else throw e}return s=this.db,o=e.entry.get_directory(),s.h[o]={v:n},n},saveData:function(e){var s=this.getFilePath(e);throw t.thrown("Can't save material props database "+s)},loadMatProps:function(e,t){var s,n=this.getModelData(e.model);return n==null?n:(n=n.materials,n==null?n:(n=q.field(n,t.name),n==null?n:e.model!=null&&(s=q.field(n,e.name+"/"+e.model.entry.name),s!=null)?s:q.field(n,e.name)))},saveMatProps:function(e,t,n){var a,r,c,l,d,u,h,m,f,p,g,v,b,i=["materials",t.name,e.name],s=this.getModelData(e.model);if(s==null)return;for(c=s,m=[],u=0,v=i.length-1;u<v;)d=u++,r=q.field(s,i[d]),r==null&&(r={},s[i[d]]=r),m.push(s),s=r;if(a=e.props,h=a.__refMode=="modelSpec",l=i.pop(),h||q.deleteField(s,l),f=l+"/"+(e.model!=null?e.model.entry.name:""),q.deleteField(s,f),n==null&&(n=e.getDefaultProps()),a==null||(n==null?"null":o.string(n))==(a==null?"null":o.string(a)))for(;i.length>0;){if(p=i.pop(),g=m.pop(),q.fields(q.field(g,p)).length!=0)break;q.deleteField(g,p)}else s[h?f:l]=a;b=this.getFilePath(e.model),q.fields(c).length==0&&(c=null),this.saveData(e.model,c)},__class__:Gr},rs=function(e){this.database==null&&(this.database=new Gr),this.name=e},c["h3d.mat.MaterialSetup"]=rs,rs.__name__="h3d.mat.MaterialSetup",rs.prototype={createRenderer:function(){return new La},createLightSystem:function(){return new Mi},createMaterial:function(){return new Rs},getDefaults:function(e){return this.emptyMat==null&&(this.emptyMat=this.createMaterial()),this.emptyMat.getDefaultProps(e)},loadMaterialProps:function(e){return this.database.loadMatProps(e,this)},saveMaterialProps:function(e,t){this.database.saveMatProps(e,this,t)},customMeshInit:function(){},__class__:rs},F=function(e,t,n){this.layer=0,this.rendererFlags=0,this.bits=0,this.parentPass=n,this.shaders=t,this.setPassName(e),this.set_culling(xt.Back);var s=R.One,o=R.Zero;this.set_blendSrc(s),this.set_blendAlphaSrc(s),this.set_blendDst(o),this.set_blendAlphaDst(o),this.depth(!0,Ae.Less),this.set_blendOp(this.set_blendAlphaOp(rt.Add)),this.colorMask=15},c["h3d.mat.Pass"]=F,F.__name__="h3d.mat.Pass",F.getEnableLights=function(e){return e&1},F.getDynamicParameters=function(e){return e>>1&1},F.getIsStatic=function(e){return e>>2&1},F.getCulled=function(e){return e>>3&1},F.getBatchMode=function(e){return e>>4&1},F.getCulling=function(e){return e&3},F.getDepthWrite=function(e){return e>>2&1},F.getDepthClamp=function(e){return e>>3&1},F.getDepthTest=function(e){return e>>4&7},F.getBlendSrc=function(e){return e>>7&15},F.getBlendDst=function(e){return e>>11&15},F.getBlendAlphaSrc=function(e){return e>>15&15},F.getBlendAlphaDst=function(e){return e>>19&15},F.getBlendOp=function(e){return e>>23&7},F.getBlendAlphaOp=function(e){return e>>26&7},F.getWireframe=function(e){return e>>29&1},F.getReserved=function(e){return e>>30&1},F.prototype={load:function(e){this.name=e.name,this.passId=e.passId,this.bits=e.bits,this.set_enableLights(e.enableLights),this.set_dynamicParameters(e.dynamicParameters),this.set_culling(e.culling),this.set_depthWrite(e.depthWrite),this.set_depthClamp(e.depthClamp),this.set_depthTest(e.depthTest),this.set_blendSrc(e.blendSrc),this.set_blendDst(e.blendDst),this.set_blendOp(e.blendOp),this.set_blendAlphaSrc(e.blendAlphaSrc),this.set_blendAlphaDst(e.blendAlphaDst),this.set_blendAlphaOp(e.blendAlphaOp),this.colorMask=e.colorMask,e.stencil!=null&&(this.stencil==null&&(this.stencil=new Q),this.stencil.load(e.stencil))},setPassName:function(e){this.name=e,this.passId=ie.allocID(e)},blend:function(e,t){this.set_blendSrc(e),this.set_blendAlphaSrc(e),this.set_blendDst(t),this.set_blendAlphaDst(t)},setBlendMode:function(e){switch(this.set_blendOp(rt.Add),this.set_blendAlphaOp(rt.Add),e._hx_index){case 0:var n=R.One,t=R.Zero;this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t);break;case 1:n=R.SrcAlpha,t=R.OneMinusSrcAlpha,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t),this.set_blendAlphaSrc(R.One);break;case 2:n=R.SrcAlpha,t=R.One,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t),this.set_blendAlphaSrc(R.One);break;case 3:n=R.One,t=R.OneMinusSrcAlpha,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t);break;case 4:n=R.OneMinusDstColor,t=R.One,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t),this.set_blendAlphaSrc(R.One);break;case 5:n=R.DstColor,t=R.Zero,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t),this.set_blendAlphaSrc(R.One);break;case 6:n=R.DstColor,t=R.OneMinusSrcAlpha,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t);break;case 7:n=R.Zero,t=R.OneMinusSrcColor,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t);break;case 8:n=R.One,t=R.OneMinusSrcColor,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t);break;case 9:n=R.SrcAlpha,t=R.One,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t),this.set_blendOp(rt.ReverseSub),this.set_blendAlphaOp(rt.ReverseSub);break;case 10:n=R.One,t=R.One,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t),this.set_blendAlphaOp(rt.Max),this.set_blendOp(rt.Max);break;case 11:n=R.One,t=R.One,this.set_blendSrc(n),this.set_blendAlphaSrc(n),this.set_blendDst(t),this.set_blendAlphaDst(t),this.set_blendAlphaOp(rt.Min),this.set_blendOp(rt.Min);break}},depth:function(e,t,n){n==null&&(n=!1),this.set_depthWrite(e),this.set_depthTest(t),this.set_depthClamp(n)},setColorMask:function(e,t,n,s){this.colorMask=(e?1:0)|(t?2:0)|(n?4:0)|(s?8:0)},setColorChannel:function(e){switch(e._hx_index){case 1:this.setColorMask(!0,!1,!1,!1);break;case 2:this.setColorMask(!1,!0,!1,!1);break;case 3:this.setColorMask(!1,!1,!0,!1);break;case 4:this.setColorMask(!1,!1,!1,!0);break;default:throw t.thrown("Unsupported channel "+o.string(e))}},setColorMaski:function(e,n,s,o,i){if(i>8)throw t.thrown("Color mask i supports 8 Render target");var a=(e?1:0)|(n?2:0)|(s?4:0)|(o?8:0);a<<=i*4,this.colorMask|=a},resetRendererFlags:function(){this.rendererFlags=0},addShader:function(e){return e==null?null:(this.shaders=Ge.addSort(e,this.shaders),this.resetRendererFlags(),e)},addSelfShader:function(e){return e==null?null:(this.selfShadersChanged=!0,this.selfShaders=Ge.addSort(e,this.selfShaders),this.resetRendererFlags(),e)},addShaderAtIndex:function(e,t){for(var s=null,n=this.shaders;t>0&&n!=this.parentShaders;)s=n,n=n.next,--t;return s==null?this.shaders=new Ge(e,n):s.next=new Ge(e,n),e},getShaderIndex:function(e){for(var n=0,t=this.shaders;t!=this.parentShaders;){if(t.s==e)return n;t=t.next,++n}return-1},removeShader:function(e){for(var t=this.shaders,n=null,s=!1;t!=null;){if(t.s==e){this.resetRendererFlags(),this.selfShadersCache==t&&(this.selfShadersCache=this.selfShadersCache.next),n==null?this.shaders=t.next:n.next=t.next,s=!0;break}n=t,t=t.next}for(t=this.selfShaders,n=null;t!=null;){if(t.s==e)return this.resetRendererFlags(),this.selfShadersCache==t&&(this.selfShadersCache=this.selfShadersCache.next),n==null?this.selfShaders=t.next:n.next=t.next,!0;n=t,t=t.next}return s},removeShaders:function(e){for(var t=this.shaders,n=null;t!=null;)H.__instanceof(t.s,e)?(this.resetRendererFlags(),this.selfShadersCache==t&&(this.selfShadersCache=this.selfShadersCache.next),n==null?this.shaders=t.next:n.next=t.next):n=t,t=t.next;for(t=this.selfShaders,n=null;t!=null;)H.__instanceof(t.s,e)?(this.resetRendererFlags(),this.selfShadersCache==t&&(this.selfShadersCache=this.selfShadersCache.next),n==null?this.selfShaders=t.next:n.next=t.next):n=t,t=t.next},getShader:function(e){var t=this._getShader(e,this.shaders);return t??this._getShader(e,this.selfShaders)},_getShader:function(e,t){for(;t!=null&&t!=this.parentShaders;){var s=t.s,n=H.__downcastCheck(s,e)?s:null;if(n!=null)return n;t=t.next}return null},getShaderByName:function(e){var t=this._getShaderByName(e,this.shaders);return t??this._getShaderByName(e,this.selfShaders)},_getShaderByName:function(e,t){for(;t!=null&&t!=this.parentShaders;){if(t.s.shader.data.name==e)return t.s;t=t.next}return null},getShaders:function(){return new Go(this.shaders,this.parentShaders)},checkInfiniteLoop:function(){for(var n,o,s=[],e=this.selfShaders;e!=null;){for(n=0;n<s.length;)if(o=s[n],++n,o==e)throw t.thrown("infinite loop");s.push(e),e=e.next}},selfShadersRec:function(e){if(this.selfShaders==null)return this.shaders;if(!this.selfShadersChanged&&!e&&this.shaders==this.selfShadersCache)return this.selfShaders;for(var t=this.selfShaders,n=null;t!=null&&t!=this.selfShadersCache;)n=t,t=t.next;return this.selfShadersCache=this.shaders,n!=null?n.next=this.selfShadersCache:this.selfShaders=this.shaders,this.selfShaders},getShadersRec:function(){if(this.parentPass==null||this.parentShaders==this.parentPass.shaders)return this.selfShadersRec(!1);for(var e=this.shaders,t=null;e!=null&&e!=this.parentShaders;)t=e,e=e.next;return e!=this.parentShaders&&(t=null),this.parentShaders=this.parentPass.shaders,t==null?this.shaders=this.parentShaders:t.next=this.parentShaders,this.selfShadersRec(!0)},reverseDepthTest:function(){var e;switch(this.depthTest._hx_index){case 4:e=Ae.Less;break;case 5:e=Ae.LessEqual;break;case 6:e=Ae.Greater;break;case 7:e=Ae.GreaterEqual;break;default:e=this.depthTest}this.set_depthTest(e)},clone:function(){var e=new F(this.name,this.shaders.clone());return e.selfShaders=this.selfShaders,e.bits=this.bits,e.set_enableLights(this.enableLights),this.stencil!=null&&(e.stencil=this.stencil.clone()),e},set_enableLights:function(e){return this.flags=this.flags&-2|(e?1:0),this.enableLights=e},set_dynamicParameters:function(e){return this.flags=this.flags&-3|(e?1:0)<<1,this.dynamicParameters=e},set_isStatic:function(e){return this.flags=this.flags&-5|(e?1:0)<<2,this.isStatic=e},set_culled:function(e){return this.flags=this.flags&-9|(e?1:0)<<3,this.culled=e},set_batchMode:function(e){return this.flags=this.flags&-17|(e?1:0)<<4,this.batchMode=e},set_culling:function(e){return this.bits=this.bits&-4|e._hx_index,this.culling=e},set_depthWrite:function(e){return this.bits=this.bits&-5|(e?1:0)<<2,this.depthWrite=e},set_depthClamp:function(e){return this.bits=this.bits&-9|(e?1:0)<<3,this.depthClamp=e},set_depthTest:function(e){return this.bits=this.bits&-113|e._hx_index<<4,this.depthTest=e},set_blendSrc:function(e){return this.bits=this.bits&-1921|e._hx_index<<7,this.blendSrc=e},set_blendDst:function(e){return this.bits=this.bits&-30721|e._hx_index<<11,this.blendDst=e},set_blendAlphaSrc:function(e){return this.bits=this.bits&-491521|e._hx_index<<15,this.blendAlphaSrc=e},set_blendAlphaDst:function(e){return this.bits=this.bits&-7864321|e._hx_index<<19,this.blendAlphaDst=e},set_blendOp:function(e){return this.bits=this.bits&-58720257|e._hx_index<<23,this.blendOp=e},set_blendAlphaOp:function(e){return this.bits=this.bits&-469762049|e._hx_index<<26,this.blendAlphaOp=e},set_wireframe:function(e){return this.bits=this.bits&-536870913|(e?1:0)<<29,this.wireframe=e},set_reserved:function(e){return this.bits=this.bits&-1073741825|(e?1:0)<<30,this.reserved=e},loadFlags:function(e){this.flags=e,this.set_enableLights((this.flags&1)!=0),this.set_dynamicParameters((this.flags>>1&1)!=0),this.set_isStatic((this.flags>>2&1)!=0),this.set_culled((this.flags>>3&1)!=0),this.set_batchMode((this.flags>>4&1)!=0)},loadBits:function(e){this.bits=e,this.set_culling(Y.createEnumIndex(xt,this.bits&3)),this.set_depthWrite((this.bits>>2&1)!=0),this.set_depthClamp((this.bits>>3&1)!=0),this.set_depthTest(Y.createEnumIndex(Ae,this.bits>>4&7)),this.set_blendSrc(Y.createEnumIndex(R,this.bits>>7&15)),this.set_blendDst(Y.createEnumIndex(R,this.bits>>11&15)),this.set_blendAlphaSrc(Y.createEnumIndex(R,this.bits>>15&15)),this.set_blendAlphaDst(Y.createEnumIndex(R,this.bits>>19&15)),this.set_blendOp(Y.createEnumIndex(rt,this.bits>>23&7)),this.set_blendAlphaOp(Y.createEnumIndex(rt,this.bits>>26&7)),this.set_wireframe((this.bits>>29&1)!=0),this.set_reserved((this.bits>>30&1)!=0)},__class__:F},Q=function(){this.opBits=0,this.maskBits=0,this.setOp(Le.Keep,Le.Keep,Le.Keep),this.setFunc(Ae.Always)},c["h3d.mat.Stencil"]=Q,Q.__name__="h3d.mat.Stencil",Q.getReadMask=function(e){return e&255},Q.getWriteMask=function(e){return e>>8&255},Q.getReference=function(e){return e>>16&255},Q.getFrontTest=function(e){return e&7},Q.getFrontPass=function(e){return e>>3&7},Q.getFrontSTfail=function(e){return e>>6&7},Q.getFrontDPfail=function(e){return e>>9&7},Q.getBackTest=function(e){return e>>12&7},Q.getBackPass=function(e){return e>>15&7},Q.getBackSTfail=function(e){return e>>18&7},Q.getBackDPfail=function(e){return e>>21&7},Q.prototype={setFront:function(e,t,n){this.set_frontSTfail(e),this.set_frontDPfail(t),this.set_frontPass(n)},setBack:function(e,t,n){this.set_backSTfail(e),this.set_backDPfail(t),this.set_backPass(n)},setOp:function(e,t,n){this.setFront(e,t,n),this.setBack(e,t,n)},setFunc:function(e,t,n,s){s==null&&(s=255),n==null&&(n=255),t==null&&(t=0),this.set_frontTest(this.set_backTest(e)),this.set_reference(t),this.set_readMask(n),this.set_writeMask(s)},clone:function(){var e=new Q;return e.opBits=this.opBits,e.maskBits=this.maskBits,e},load:function(e){this.opBits=e.opBits,this.maskBits=e.maskBits},set_readMask:function(e){return this.maskBits=this.maskBits&-256|e&255,this.readMask=e},set_writeMask:function(e){return this.maskBits=this.maskBits&-65281|(e&255)<<8,this.writeMask=e},set_reference:function(e){return this.maskBits=this.maskBits&-16711681|(e&255)<<16,this.reference=e},set_frontTest:function(e){return this.opBits=this.opBits&-8|e._hx_index,this.frontTest=e},set_frontPass:function(e){return this.opBits=this.opBits&-57|e._hx_index<<3,this.frontPass=e},set_frontSTfail:function(e){return this.opBits=this.opBits&-449|e._hx_index<<6,this.frontSTfail=e},set_frontDPfail:function(e){return this.opBits=this.opBits&-3585|e._hx_index<<9,this.frontDPfail=e},set_backTest:function(e){return this.opBits=this.opBits&-28673|e._hx_index<<12,this.backTest=e},set_backPass:function(e){return this.opBits=this.opBits&-229377|e._hx_index<<15,this.backPass=e},set_backSTfail:function(e){return this.opBits=this.opBits&-1835009|e._hx_index<<18,this.backSTfail=e},set_backDPfail:function(e){return this.opBits=this.opBits&-14680065|e._hx_index<<21,this.backDPfail=e},loadOpBits:function(e){this.opBits=e,this.set_frontTest(Y.createEnumIndex(Ae,this.opBits&7)),this.set_frontPass(Y.createEnumIndex(Le,this.opBits>>3&7)),this.set_frontSTfail(Y.createEnumIndex(Le,this.opBits>>6&7)),this.set_frontDPfail(Y.createEnumIndex(Le,this.opBits>>9&7)),this.set_backTest(Y.createEnumIndex(Ae,this.opBits>>12&7)),this.set_backPass(Y.createEnumIndex(Le,this.opBits>>15&7)),this.set_backSTfail(Y.createEnumIndex(Le,this.opBits>>18&7)),this.set_backDPfail(Y.createEnumIndex(Le,this.opBits>>21&7))},loadMaskBits:function(e){this.maskBits=e,this.set_readMask(this.maskBits&255),this.set_writeMask(this.maskBits>>8&255),this.set_reference(this.maskBits>>16&255)},__class__:Q},Xo=function(){},c["haxe.IMap"]=Xo,Xo.__name__="haxe.IMap",Xo.__isInterface__=!0,le=function(){this.h={}},c["haxe.ds.IntMap"]=le,le.__name__="haxe.ds.IntMap",le.__interfaces__=[Xo],le.prototype={remove:function(e){return!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){var t,e=[];for(t in this.h)this.h.hasOwnProperty(t)&&e.push(+t);return new Ws(e)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var e=this.it.next();return this.ref[e]}}},__class__:le},fe=function(){this.h=Object.create(null)},c["haxe.ds.StringMap"]=fe,fe.__name__="haxe.ds.StringMap",fe.__interfaces__=[Xo],fe.prototype={iterator:function(){return new ac(this.h)},__class__:fe},f=_["hxd.PixelFormat"]={__ename__:!0,__constructs__:null,ARGB:{_hx_name:"ARGB",_hx_index:0,__enum__:"hxd.PixelFormat",toString:s},BGRA:{_hx_name:"BGRA",_hx_index:1,__enum__:"hxd.PixelFormat",toString:s},RGBA:{_hx_name:"RGBA",_hx_index:2,__enum__:"hxd.PixelFormat",toString:s},RGBA16F:{_hx_name:"RGBA16F",_hx_index:3,__enum__:"hxd.PixelFormat",toString:s},RGBA32F:{_hx_name:"RGBA32F",_hx_index:4,__enum__:"hxd.PixelFormat",toString:s},R8:{_hx_name:"R8",_hx_index:5,__enum__:"hxd.PixelFormat",toString:s},R16F:{_hx_name:"R16F",_hx_index:6,__enum__:"hxd.PixelFormat",toString:s},R32F:{_hx_name:"R32F",_hx_index:7,__enum__:"hxd.PixelFormat",toString:s},RG8:{_hx_name:"RG8",_hx_index:8,__enum__:"hxd.PixelFormat",toString:s},RG16F:{_hx_name:"RG16F",_hx_index:9,__enum__:"hxd.PixelFormat",toString:s},RG32F:{_hx_name:"RG32F",_hx_index:10,__enum__:"hxd.PixelFormat",toString:s},RGB8:{_hx_name:"RGB8",_hx_index:11,__enum__:"hxd.PixelFormat",toString:s},RGB16F:{_hx_name:"RGB16F",_hx_index:12,__enum__:"hxd.PixelFormat",toString:s},RGB32F:{_hx_name:"RGB32F",_hx_index:13,__enum__:"hxd.PixelFormat",toString:s},SRGB:{_hx_name:"SRGB",_hx_index:14,__enum__:"hxd.PixelFormat",toString:s},SRGB_ALPHA:{_hx_name:"SRGB_ALPHA",_hx_index:15,__enum__:"hxd.PixelFormat",toString:s},RGB10A2:{_hx_name:"RGB10A2",_hx_index:16,__enum__:"hxd.PixelFormat",toString:s},RG11B10UF:{_hx_name:"RG11B10UF",_hx_index:17,__enum__:"hxd.PixelFormat",toString:s},R16U:{_hx_name:"R16U",_hx_index:18,__enum__:"hxd.PixelFormat",toString:s},RG16U:{_hx_name:"RG16U",_hx_index:19,__enum__:"hxd.PixelFormat",toString:s},RGB16U:{_hx_name:"RGB16U",_hx_index:20,__enum__:"hxd.PixelFormat",toString:s},RGBA16U:{_hx_name:"RGBA16U",_hx_index:21,__enum__:"hxd.PixelFormat",toString:s},S3TC:(a=function(e){return{_hx_index:22,v:e,__enum__:"hxd.PixelFormat",toString:s}},a._hx_name="S3TC",a.__params__=["v"],a),Depth16:{_hx_name:"Depth16",_hx_index:23,__enum__:"hxd.PixelFormat",toString:s},Depth24:{_hx_name:"Depth24",_hx_index:24,__enum__:"hxd.PixelFormat",toString:s},Depth24Stencil8:{_hx_name:"Depth24Stencil8",_hx_index:25,__enum__:"hxd.PixelFormat",toString:s},Depth32:{_hx_name:"Depth32",_hx_index:26,__enum__:"hxd.PixelFormat",toString:s}},f.__constructs__=[f.ARGB,f.BGRA,f.RGBA,f.RGBA16F,f.RGBA32F,f.R8,f.R16F,f.R32F,f.RG8,f.RG16F,f.RG32F,f.RGB8,f.RGB16F,f.RGB32F,f.SRGB,f.SRGB_ALPHA,f.RGB10A2,f.RG11B10UF,f.R16U,f.RG16U,f.RGB16U,f.RGBA16U,f.S3TC,f.Depth16,f.Depth24,f.Depth24Stencil8,f.Depth32],f.__empty_constructs__=[f.ARGB,f.BGRA,f.RGBA,f.RGBA16F,f.RGBA32F,f.R8,f.R16F,f.R32F,f.RG8,f.RG16F,f.RG32F,f.RGB8,f.RGB16F,f.RGB32F,f.SRGB,f.SRGB_ALPHA,f.RGB10A2,f.RG11B10UF,f.R16U,f.RG16U,f.RGB16U,f.RGBA16U,f.Depth16,f.Depth24,f.Depth24Stencil8,f.Depth32],S=function(e,t,n,s){if(this.lodBias=0,this.startingMip=0,s==null&&(s=S.nativeFormat),this.id=++S.UID,this.format=s,this.flags=0,n!=null)for(var o,i,r,c,a=0;a<n.length;)r=n[a],++a,this.flags|=1<<r._hx_index;for(c=K.CURRENT,this.mem=c.mem,o=1,i=1;o<e;)o<<=1;for(;i<t;)i<<=1;(o!=e||i!=t)&&(this.flags|=1<<w.IsNPOT._hx_index),this.width=e,this.height=t,(this.flags&1<<w.MipMapped._hx_index)!=0?this.set_mipMap(S.TRILINEAR_FILTERING_ENABLED?ds.Linear:ds.Nearest):this.set_mipMap(ds.None),this.set_filter(Dn.Linear),this.set_wrap(S.DEFAULT_WRAP),this.bits&=32767,this.allocPos=wn.make(),(this.flags&1<<w.NoAlloc._hx_index)==0&&this.width>0&&this.alloc()},c["h3d.mat.Texture"]=S,S.__name__="h3d.mat.Texture",S.getDefaultDepth=function(){return K.CURRENT.driver.getDefaultDepthBuffer()},S.fromBitmap=function(e){var t=new S(e.ctx.canvas.width,e.ctx.canvas.height);return t.uploadBitmap(e),t},S.fromPixels=function(e,t){var n=new S(e.width,e.height,null,t??e.innerFormat);return n.uploadPixels(e),n},S.fromColor=function(e,t){t==null&&(t=1);var n,o,i=K.CURRENT,s=t*255|0;return s<0?s=0:s>255&&(s=255),o=e&16777215|s<<24,n=i.textureColorCache.h[o],n??(n=new S(1,1,null),n.clear(e,t),n.realloc=function(){n.clear(e,t)},i.textureColorCache.h[o]=n,n)},S.genDisc=function(e,t,n){return n==null&&(n=1),S.genTexture(0,e,t,n)},S.genTexture=function(e,t,n,s){var o,i,r,c=K.CURRENT,a=s*255|0;return a<0?a=0:a>255&&(a=255),n=n&16777215|a<<24,r=(t<<16|e)+","+n,i=S.genTextureKeys.h[r],o=i==null?null:c.resCache.h[i.__id__],o??(i==null&&(i={},S.genTextureKeys.h[r]=i),o=new S(t,t,[w.Target]),o.realloc=function(){S.drawGenTexture(o,n,e)},S.drawGenTexture(o,n,e),c.resCache.set(i,o),o)},S.drawGenTexture=function(e,t,n){var o=new Je(new jo),i=K.CURRENT,s=o.shader;s.constModified=!0,s.mode__=n,s=o.shader.color__,s.x=(t>>16&255)/255,s.y=(t>>8&255)/255,s.z=(t&255)/255,s.w=(t>>>24)/255,i.pushTarget(e),o.render(),i.popTarget()},S.defaultCubeTexture=function(){var t=K.CURRENT,e=t.resCache.h[S.__id__];return e??(e=new S(1,1,[w.Cube]),e.clear(2105376),e.realloc=function(){e.clear(2105376)},t.resCache.set(S,e),e)},S.genChecker=function(e){var o,i,s=K.CURRENT,n=S.checkerTextureKeys.h[e],t=n==null?null:s.resCache.h[n.__id__];return t!=null&&!(t.t==null&&(t.isDepth()||t.realloc==null))?t:(n==null&&(n={},S.checkerTextureKeys.h[e]=n),t=new S(e,e,[w.NoAlloc]),o=t,i=e,t.realloc=function(){S.allocChecker(o,i)},s.resCache.set(n,t),t)},S.genNoise=function(e){var o,i,s=K.CURRENT,n=S.noiseTextureKeys.h[e],t=n==null?null:s.resCache.h[n.__id__];return t!=null&&!(t.t==null&&(t.isDepth()||t.realloc==null))?t:(n==null&&(n={},S.noiseTextureKeys.h[e]=n),t=new S(e,e,[w.NoAlloc]),o=t,i=e,t.realloc=function(){S.allocNoise(o,i)},s.resCache.set(n,t),t)},S.allocNoise=function(e,t){for(var s,i,r,c,l,n=new ns(t,t),a=0,d=t;a<d;)for(r=a++,i=0,c=t;i<c;)l=i++,s=o.random(256),n.setPixel(r,l,-16777216|s|s<<8|s<<16);e.uploadBitmap(n),n.ctx=null,n.pixel=null},S.allocChecker=function(e,t){var s,o,i,a,r,c,n=new ns(t,t);for(n.clear(-1),s=0,r=t>>1;s<r;)for(o=s++,i=0,c=t>>1;i<c;)a=i++,n.setPixel(o,a,-16777216),n.setPixel(o+(t>>1),a+(t>>1),-16777216);e.uploadBitmap(n),n.ctx=null,n.pixel=null},S.prototype={set_lastFrame:function(e){return this._lastFrame!=S.PREVENT_AUTO_DISPOSE&&(this._lastFrame=e),this._lastFrame},get_lastFrame:function(){return this._lastFrame},get_mipLevels:function(){if((this.flags&1<<w.MipMapped._hx_index)==0)return 1;if(this.customMipLevels>0)return this.customMipLevels;for(var e=1,t=this.width,n=this.height;t>>e>=1||n>>e>=1;)++e;return e},get_layerCount:function(){return(this.flags&1<<w.Cube._hx_index)!=0?6:1},alloc:function(){this.t==null&&this.mem.allocTexture(this)},isSRGB:function(){switch(this.format._hx_index){case 14:case 15:return!0;default:return!1}},checkAlloc:function(){this.t==null&&this.realloc!=null&&(this.alloc(),this.realloc())},clone:function(){if(this.checkAlloc(),this.t==null)throw t.thrown("Can't clone disposed texture");var e,n,s,o=this._lastFrame;return this.preventAutoDispose(),n=[],e=w.Target,(this.flags&1<<e._hx_index)!=0&&n.push(e),e=w.Cube,(this.flags&1<<e._hx_index)!=0&&n.push(e),e=w.MipMapped,(this.flags&1<<e._hx_index)!=0&&n.push(e),e=w.IsArray,(this.flags&1<<e._hx_index)!=0&&n.push(e),s=new S(this.width,this.height,n,this.format),s.name=this.name,(this.flags&1<<w.Cube._hx_index)!=0?Xs.run(this,s):Gt.run(this,s),this.set_lastFrame(o),s},preventAutoDispose:function(){this.set_lastFrame(S.PREVENT_AUTO_DISPOSE)},preventForcedDispose:function(){this.set_lastFrame(S.PREVENT_FORCED_DISPOSE)},waitLoad:function(e){if((this.flags&1<<w.Loading._hx_index)==0){e();return}this.waitLoads==null&&(this.waitLoads=[]),this.waitLoads.push(e)},toString:function(){var e=this.name;return this.name==null&&(e="Texture_"+this.id,this.allocPos!=null&&(e+="("+this.allocPos.position+")")),(this.flags&1<<w.Is3D._hx_index)!=0?e+="("+this.width+"x"+this.height+"x"+this.get_layerCount()+")":e+="("+this.width+"x"+this.height+")",e},setName:function(e){this.name=e},set_mipMap:function(e){return this.bits=this.bits&-4|e._hx_index,this.mipMap=e},set_filter:function(e){return this.bits=this.bits&-25|e._hx_index<<3,this.filter=e},set_wrap:function(e){return this.bits=this.bits&-193|e._hx_index<<6,this.wrap=e},isDisposed:function(){return this.t==null&&(!!this.isDepth()||this.realloc==null)},resize:function(e,t){this.dispose();for(var n=1,s=1;n<e;)n<<=1;for(;s<t;)s<<=1;n!=e||s!=t?this.flags|=1<<w.IsNPOT._hx_index:this.flags&=-1-(1<<w.IsNPOT._hx_index),this.width=e,this.height=t,(this.flags&1<<w.NoAlloc._hx_index)==0&&this.alloc()},clearF:function(e,n,s,o,i){if(i==null&&(i=-1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),e==null&&(e=0),this.alloc(),(this.flags&1<<w.Target._hx_index)==0)throw t.thrown("Texture should be target");var u,h,m,f,a=K.CURRENT,r=e,c=n,l=s,d=o;if(d==null&&(d=1),l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),u=new j(r,c,l,d),i<0)for(h=0,m=this.get_layerCount();h<m;)f=h++,a.pushTarget(this,f),a.clearF(u),a.popTarget();else a.pushTarget(this,i),a.clearF(u),a.popTarget()},clear:function(e,n,s){if(s==null&&(s=-1),n==null&&(n=1),this.alloc(),this.width==0||this.height==0)return;if(this.width!=1||this.height!=1){var o,i,r,c,l,d,u,h,m,f,a=K.CURRENT;if(e|=((n<0?0:n>1?1:n)*255|0)<<24,s<0)for(o=0,r=this.get_layerCount();o<r;)l=o++,a.pushTarget(this,l),a.clear(e),a.popTarget();else a.pushTarget(this,s),a.clear(e),a.popTarget()}else{switch(i=G.alloc(this.width,this.height,S.nativeFormat),d=0,u=e&255,m=e>>8&255,h=e>>16&255,c=n*255|0,c<0?c=0:c>255&&(c=255),S.nativeFormat._hx_index){case 1:f=h,h=u,u=f;break;case 2:break;default:throw t.thrown("TODO")}for(o=0,r=this.width*this.height;o<r;)l=o++,i.bytes.b[d++]=h,i.bytes.b[d++]=m,i.bytes.b[d++]=u,i.bytes.b[d++]=c;if(s<0)for(o=0,r=this.get_layerCount();o<r;)l=o++,this.uploadPixels(i,0,l);else this.uploadPixels(i,0,s);i.dispose()}},checkSize:function(e,n,s){var o,i=this.width>>s;if(i==0&&(i=1),o=this.height>>s,o==0&&(o=1),e!=i||n!=o)throw t.thrown("Invalid upload size : "+e+"x"+n+" should be "+i+"x"+o)},checkMipMapGen:function(e,t){e==0&&(this.flags&1<<w.MipMapped._hx_index)!=0&&(this.flags&1<<w.ManualMipMapGen._hx_index)==0&&t==this.get_layerCount()-1&&this.mem.driver.generateMipMaps(this)},uploadBitmap:function(e,t,n){n==null&&(n=0),t==null&&(t=0),this.alloc(),this.checkSize(e.ctx.canvas.width,e.ctx.canvas.height,t),this.mem.driver.uploadTextureBitmap(this,e,t,n),this.flags|=1<<w.WasCleared._hx_index,this.checkMipMapGen(t,n)},uploadPixels:function(e,t,n){n==null&&(n=0),t==null&&(t=0),this.alloc(),this.checkSize(e.width,e.height,t),this.mem.driver.uploadTexturePixels(this,e,t,n),this.flags|=1<<w.WasCleared._hx_index,this.checkMipMapGen(t,n)},dispose:function(){this.t!=null&&this.mem.deleteTexture(this)},hasStencil:function(){return this.format._hx_index==25},isDepth:function(){switch(this.format._hx_index){case 23:case 24:case 25:case 26:return!0;default:return!1}},capturePixels:function(e,t,n){t==null&&(t=0),e==null&&(e=0);var s,o=this._lastFrame;return this.preventAutoDispose(),s=this.mem.driver.capturePixels(this,e,t,n),this.set_lastFrame(o),s},__class__:S},_s=function(e,t,n,s,o){this.depth=n,s==null&&(s=[]),s.push(w.Is3D),S.call(this,e,t,s,o)},c["h3d.mat.Texture3D"]=_s,_s.__name__="h3d.mat.Texture3D",_s.default3DTexture=function(){var t=K.CURRENT,e=t.resCache.h[_s.__id__];return e??(e=new _s(1,1,1,null,f.R8),e.setName("default3DTexture"),t.resCache.set(_s,e),e)},_s.__super__=S,_s.prototype=g(S.prototype,{get_layerCount:function(){return this.depth},clone:function(){var e,t=this._lastFrame;return this.preventAutoDispose(),e=new _s(this.width,this.height,this.depth,null,this.format),Gt.run(this,e),this.set_lastFrame(t),e},toString:function(){return S.prototype.toString.call(this)+"x("+this.depth+")"},__class__:_s}),oa=function(e,t,n,s,o){this.layers=n,s==null&&(s=[]),s.push(w.IsArray),S.call(this,e,t,s,o)},c["h3d.mat.TextureArray"]=oa,oa.__name__="h3d.mat.TextureArray",oa.__super__=S,oa.prototype=g(S.prototype,{get_layerCount:function(){return this.layers},clone:function(){var e,t=this._lastFrame;return this.preventAutoDispose(),e=new oa(this.width,this.height,this.layers,null,this.format),Gt.run(this,e),this.set_lastFrame(t),e},toString:function(){return S.prototype.toString.call(this)+"["+this.layers+"]"},__class__:oa}),Je=function(e,t){this.shader=e,this.output=new Ei(t),this.pass=new F("screenfx",new Ge(e)),this.pass.set_culling(xt.None),this.pass.depth(!1,Ae.Always)},c["h3d.pass.ScreenFx"]=Je,Je.__name__="h3d.pass.ScreenFx",Je.run=function(e,t,n){var s=K.CURRENT;s.pushTarget(t,n),new Je(e).render(),s.popTarget()},Je.prototype={get_engine:function(){return this._engine==null&&(this._engine=K.CURRENT),this._engine},copy:function(e,t){Gt.run(e,t)},addShader:function(e){return this.pass.addShader(e)},removeShader:function(e){return this.pass.removeShader(e)},getShader:function(e){return this.pass.getShader(e)},render:function(){this.primitive==null&&(this.primitive=Fs.get()),this.shader.flipY__=this.get_engine().driver.hasFeature(je.BottomLeftCoords)&&this.get_engine().getCurrentTarget()!=null?-1:1;var t,n,s=this.pass.shaders,e=Ie.get(),o=!1;e==null&&(o=!0,e=new Ie,e.setCurrent()),t=this.output.compileShaders(e.globals,s),this.get_engine().selectMaterial(this.pass),this.get_engine().selectShader(t),n=e.shaderBuffers,n.vertex.grow(t.vertex),t.fragment!=null&&n.fragment.grow(t.fragment),e.fillGlobals(n,t),e.fillParams(n,t,s),this.get_engine().uploadShaderBuffers(n,0),this.get_engine().uploadInstanceShaderBuffers(n),this.primitive.render(this.get_engine()),o&&e.clearCurrent()},dispose:function(){},__class__:Je},aa=function(e,t,n,s){s==null&&(s=1),n==null&&(n=0),t==null&&(t=1),e==null&&(e=1),this.cubeDir=[Be.L([0,0,-1,0,0,-1,0,0,1,0,0,0]),Be.L([0,0,1,0,0,-1,0,0,-1,0,0,0]),Be.L([1,0,0,0,0,0,1,0,0,1,0,0]),Be.L([1,0,0,0,0,0,-1,0,0,-1,0,0]),Be.L([1,0,0,0,0,-1,0,0,0,0,1,0]),Be.L([-1,0,0,0,0,-1,0,0,0,0,-1,0])],Je.call(this,new Oo),this.set_radius(e),this.set_quality(s),this.set_gain(t),this.set_linear(n)},c["h3d.pass.Blur"]=aa,aa.__name__="h3d.pass.Blur",aa.__super__=Je,aa.prototype=g(Je.prototype,{set_radius:function(e){return this.radius==e?e:(this.values=null,this.radius=e)},set_quality:function(e){return this.quality==e?e:(this.values=null,this.quality=e)},set_gain:function(e){return this.gain==e?e:(this.values=null,this.gain=e)},set_linear:function(e){return this.linear==e?e:(this.values=null,this.linear=e)},gauss:function(e,t){if(t<=0)return e==0?1:0;var n=t*t,s=2.718281828459**(-(e*e)/(2*n));return s/Math.sqrt(2*Math.PI*n)},calcValues:function(){this.values=[],this.offsets=[];var e,t,n,s,i,r,l,d,u,h,m,f,p,g,v,o=0,c=this.quality,a=(c<0?0:c>1?1:c)*.7+.3;for(this.radius>0?(n=this.radius-1,l=Math.ceil((n<1?1:n)*a/2)):l=0,m=Math.sqrt(this.radius),t=0,s=l+1;t<s;)e=t++,r=e*2,d=e==0?0:e*2-1,u=this.gauss(r,m),h=this.gauss(d,m),i=u+h,this.values[e]=i,this.offsets[e]=e==0?0:(u*r+h*d)/(i*e*Math.sqrt(a)),o+=i,e>0&&(o+=i);for(g=this.values[0]*(.01/a);this.values.length>2;){if(f=this.values[this.values.length-1],f>g)break;o-=f*2,this.values.pop()}for(o/=this.gain,t=0,s=this.values.length;t<s;)e=t++,this.values[e]/=o;if(this.linear>0)for(v=this.gain/(this.values.length*2-1),t=0,s=this.values.length;t<s;)e=t++,n=this.values[e],this.values[e]=n+this.linear*(v-n),p=this.offsets[e],this.offsets[e]=p+this.linear*((e==0?0:(e*2-.5)/(e*a))-p)},getKernelSize:function(){return this.values==null&&this.calcValues(),this.radius<=0?0:this.values.length*2-1},apply:function(e,t,n){if(this.radius<=0&&this.shader.fixedColor__==null){n!=null&&Gt.run(t,n);return}n==null&&(n=t),this.values==null&&this.calcValues();var o,i,r,c,l,h,a=(t.flags&1<<w.Cube._hx_index)!=0,u=a?6:1,d=e.textures.allocTarget(t.name+"BlurTmp",t.width,t.height,!1,t.format,a?[w.Cube]:null),s=this.shader;for(s.constModified=!0,s.Quality__=this.values.length,this.shader.values__=this.values,this.shader.offsets__=this.offsets,a?(this.shader.cubeTexture__=t,s=this.shader,s.constModified=!0,s.isCube__=!0):(this.shader.texture__=t,s=this.shader,s.constModified=!0,s.isCube__=!1),s=this.shader.pixel__,o=1/t.width,i=0,i==null&&(i=0),o==null&&(o=0),s.x=o,s.y=i,s.z=0,r=0,l=u;r<l;)c=r++,this.get_engine().pushTarget(d,c),a&&(this.shader.cubeDir__=this.cubeDir[c]),this.render(),this.get_engine().popTarget();for(a?this.shader.cubeTexture__=d:this.shader.texture__=d,s=this.shader.pixel__,o=0,i=1/t.height,i==null&&(i=0),o==null&&(o=0),s.x=o,s.y=i,s.z=0,h=n.depthBuffer,n.depthBuffer=null,r=0,l=u;r<l;)c=r++,this.get_engine().pushTarget(n,c),a&&(this.shader.cubeDir__=this.cubeDir[c]),this.render(),this.get_engine().popTarget();n.depthBuffer=h},__class__:aa}),P=function(){this.priority=0,this.initialize()},c["hxsl.Shader"]=P,P.__name__="hxsl.Shader",P.prototype={initialize:function(){if(this.constModified=!0,this.shader!=null)return;var e,n=H.getClass(this);if(this.shader=n._SHADER,this.shader==null){for(e=n;e!=null&&e.SRC==null;)e=e.__super__;if(e==null)throw t.thrown(n.__name__+" has no shader source");this.shader=e._SHADER,this.shader==null&&(this.shader=new st(e.SRC,e._MODULE),e._SHADER=this.shader)}},setPriority:function(e){this.priority=e},getParamValue:function(){throw t.thrown("assert")},getParamFloatValue:function(){throw t.thrown("assert")},setParamIndexValue:function(){throw t.thrown("assert")},setParamIndexFloatValue:function(){throw t.thrown("assert")},updateConstants:function(){throw t.thrown("assert")},updateConstantsFinal:function(e){for(var s,o,i,a,r,c,l,d,u,h,n=this.shader.consts;n!=null;){if(n.globalId==0){n=n.next;continue}switch(i=e.map.h[n.globalId],r=n.v.type,r._hx_index){case 1:if(a=i,a>>>n.bits!=0)throw t.thrown("Constant "+n.v.name+" is outside range ("+a+" > "+((1<<n.bits)-1)+")");this.constBits|=a<<n.pos;break;case 2:u=i,u&&(this.constBits|=1<<n.pos);break;case 17:if(h=r.size,i==null){n=n.next;continue}if(o=i,s=o.channel,o.texture==null)s=Re.Unknown;else if(s==null||s==Re.Unknown)switch(h){case 1:if(o.texture.format==S.nativeFormat)s=Re.PackedFloat;else throw t.thrown("Constant "+n.v.name+" does not define channel select value");break;case 3:if(o.texture.format==S.nativeFormat)s=Re.PackedNormal;else throw t.thrown("Constant "+n.v.name+" does not define channel select value");break;default:throw t.thrown("Constant "+n.v.name+" does not define channel select value")}this.constBits|=(e.allocChannelID(o.texture)<<3|s._hx_index)<<n.pos;break;default:throw t.thrown("assert")}n=n.next}c=this.shader,l=this.constBits,d=c.instanceCache.h[l],this.instance=d??c.makeInstance(l)},clone:function(){return this},toString:function(){var e=H.getClass(this);return e.__name__},__class__:P},Fe=function(){this.flipY__=0,P.call(this)},c["h3d.shader.ScreenShader"]=Fe,Fe.__name__="h3d.shader.ScreenShader",Fe.__super__=P,Fe.prototype=g(P.prototype,{get_flipY:function(){return this.flipY__},set_flipY:function(e){return this.flipY__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){return e==0?this.flipY__:null},getParamFloatValue:function(e){return e==0?this.flipY__:0},setParamIndexValue:function(e,t){e==0&&(this.flipY__=t)},setParamIndexFloatValue:function(e,t){e==0&&(this.flipY__=t)},clone:function(){var e=Object.create(Fe.prototype);return e.shader=this.shader,e.flipY__=this.flipY__,e},__class__:Fe}),ro=function(){this.color__=new j(0,0,0,1),Fe.call(this)},c["h3d.pass._Border.BorderShader"]=ro,ro.__name__="h3d.pass._Border.BorderShader",ro.__super__=Fe,ro.prototype=g(Fe.prototype,{get_color:function(){return this.color__},set_color:function(e){return this.color__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.flipY__;case 1:return this.color__;default:}return null},getParamFloatValue:function(e){return e==0?this.flipY__:0},clone:function(){var e=Object.create(ro.prototype);return e.shader=this.shader,e.flipY__=this.flipY__,e.color__=this.color__,e},__class__:ro}),ra=function(e,t,n){n==null&&(n=1),Je.call(this,new ro),this.width=e,this.height=t,this.size=n;var s=this.shader.color__,o=1,i=1,a=1,r=1;r==null&&(r=1),a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),s.x=o,s.y=i,s.z=a,s.w=r},c["h3d.pass.Border"]=ra,ra.__name__="h3d.pass.Border",ra.__super__=Je,ra.prototype=g(Je.prototype,{createPrimitive:function(){var t,n,i,o=this,e=Tt._new(0),s=0/o.width*2-1;e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-0/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=this.width/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-0/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,i=this.size,s=0/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-i/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,i=this.size,s=this.width/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-i/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=0/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-0/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=this.size/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-0/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,i=this.height,s=0/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-i/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,i=this.height,s=this.size/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-i/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,i=this.height-this.size,s=0/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-i/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,i=this.height-this.size,s=this.width/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-i/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,i=this.height,s=0/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-i/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,i=this.height,s=this.width/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-i/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=(this.width-this.size)/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-0/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=this.width/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-0/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,i=this.height,s=(this.width-this.size)/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-i/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,i=this.height,s=this.width/o.width*2-1,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,s=1-i/o.height*2,e.pos==e.array.length&&(t=e.array.length<<1,t<128&&(t=128),n=new Float32Array(t),n.set(e.array),e.array=n),e.array[e.pos++]=s,this.primitive=new tr({vbuf:e,format:y.make([new ce("position",2,0)])},!0)},render:function(){this.primitive==null&&this.createPrimitive(),Je.prototype.render.call(this)},dispose:function(){this.primitive!=null&&this.primitive.dispose(),Je.prototype.dispose.call(this)},__class__:ra}),io=function(){this.layer__=0,Fe.call(this)},c["h3d.pass._Copy.ArrayCopyShader"]=io,io.__name__="h3d.pass._Copy.ArrayCopyShader",io.__super__=Fe,io.prototype=g(Fe.prototype,{get_texture:function(){return this.texture__},set_texture:function(e){return this.texture__=e},get_layer:function(){return this.layer__},set_layer:function(e){return this.layer__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.flipY__;case 1:return this.texture__;case 2:return this.layer__;default:}return null},getParamFloatValue:function(e){switch(e){case 0:return this.flipY__;case 2:return this.layer__;default:}return 0},clone:function(){var e=Object.create(io.prototype);return e.shader=this.shader,e.flipY__=this.flipY__,e.texture__=this.texture__,e.layer__=this.layer__,e},__class__:io}),eo=function(){Je.call(this,new io)},c["h3d.pass.ArrayCopy"]=eo,eo.__name__="h3d.pass.ArrayCopy",eo.run=function(e,t,n,s,o,i){var a,r=K.CURRENT;if(n!=null&&e!=null&&(s==null||s==X.None)&&o==null&&r.driver.copyTexture(e,n))return;a=r.resCache.h[eo.__id__],a==null&&(a=new eo,r.resCache.set(eo,a)),a.apply(e,t,n,s,o,i)},eo.__super__=Je,eo.prototype=g(Je.prototype,{apply:function(e,t,n,s,o,i){if(n!=null&&this.get_engine().pushTarget(n,i??0),this.shader.texture__=e,this.shader.layer__=t,o!=null){s!=null&&o.setBlendMode(s);for(var r,a=o.shaders;a.next!=null;)a=a.next;a.next=this.pass.shaders,r=this.pass,this.pass=o,this.render(),this.pass=r,a.next=null}else this.pass.setBlendMode(s??X.None),this.render();this.shader.texture__=null,this.shader.layer__=0,n!=null&&this.get_engine().popTarget()},__class__:eo}),Js=function(){Fe.call(this)},c["h3d.pass._Copy.CopyShader"]=Js,Js.__name__="h3d.pass._Copy.CopyShader",Js.__super__=Fe,Js.prototype=g(Fe.prototype,{get_texture:function(){return this.texture__},set_texture:function(e){return this.texture__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.flipY__;case 1:return this.texture__;default:}return null},getParamFloatValue:function(e){return e==0?this.flipY__:0},clone:function(){var e=Object.create(Js.prototype);return e.shader=this.shader,e.flipY__=this.flipY__,e.texture__=this.texture__,e},__class__:Js}),Gt=function(){Je.call(this,new Js)},c["h3d.pass.Copy"]=Gt,Gt.__name__="h3d.pass.Copy",Gt.run=function(e,t,n,s,o){var i,a=K.CURRENT;if(t!=null&&e!=null&&(n==null||n==X.None)&&s==null&&o==null&&a.driver.copyTexture(e,t))return;i=a.resCache.h[Gt.__id__],i==null&&(i=new Gt,a.resCache.set(Gt,i)),i.apply(e,t,n,s,o)},Gt.__super__=Je,Gt.prototype=g(Je.prototype,{apply:function(e,t,n,s,o){if(t!=null&&this.get_engine().pushTarget(t,o??0,null,ht.NotBound),this.shader.texture__=e,s!=null){n!=null&&s.setBlendMode(n);for(var a,i=s.shaders;i.next!=null;)i=i.next;i.next=this.pass.shaders,a=this.pass,this.pass=s,this.render(),this.pass=a,i.next=null}else this.pass.setBlendMode(n??X.None),this.render();this.shader.texture__=null,t!=null&&this.get_engine().popTarget()},__class__:Gt}),Zs=function(){this.mat__=new L,Fe.call(this)},c["h3d.pass._CubeCopy.CubeCopyShader"]=Zs,Zs.__name__="h3d.pass._CubeCopy.CubeCopyShader",Zs.__super__=Fe,Zs.prototype=g(Fe.prototype,{get_texture:function(){return this.texture__},set_texture:function(e){return this.texture__=e},get_mat:function(){return this.mat__},set_mat:function(e){return this.mat__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.flipY__;case 1:return this.texture__;case 2:return this.mat__;default:}return null},getParamFloatValue:function(e){return e==0?this.flipY__:0},clone:function(){var e=Object.create(Zs.prototype);return e.shader=this.shader,e.flipY__=this.flipY__,e.texture__=this.texture__,e.mat__=this.mat__,e},__class__:Zs}),Xs=function(){this.cubeDir=[Be.L([0,0,-1,0,0,-1,0,0,1,0,0,0]),Be.L([0,0,1,0,0,-1,0,0,-1,0,0,0]),Be.L([1,0,0,0,0,0,1,0,0,1,0,0]),Be.L([1,0,0,0,0,0,-1,0,0,-1,0,0]),Be.L([1,0,0,0,0,-1,0,0,0,0,1,0]),Be.L([-1,0,0,0,0,-1,0,0,0,0,-1,0])],Je.call(this,new Zs)},c["h3d.pass.CubeCopy"]=Xs,Xs.__name__="h3d.pass.CubeCopy",Xs.run=function(e,t,n,s){s==null&&(s=0);var o,i=K.CURRENT;if(t!=null&&e!=null&&(n==null||n==X.None)&&s==0&&i.driver.copyTexture(e,t))return;o=i.resCache.h[Xs.__id__],o==null&&(o=new Xs,i.resCache.set(Xs,o)),o.apply(e,t,n,s)},Xs.__super__=Je,Xs.prototype=g(Je.prototype,{apply:function(e,t,n,s){s==null&&(s=0),this.shader.texture__=e,t!=null&&this.get_engine().pushTarget(t,0,s),this.shader.mat__=this.cubeDir[0],this.pass.setBlendMode(n??X.None),this.render(),t!=null&&this.get_engine().popTarget(),t!=null&&this.get_engine().pushTarget(t,1,s),this.shader.mat__=this.cubeDir[1],this.pass.setBlendMode(n??X.None),this.render(),t!=null&&this.get_engine().popTarget(),t!=null&&this.get_engine().pushTarget(t,2,s),this.shader.mat__=this.cubeDir[2],this.pass.setBlendMode(n??X.None),this.render(),t!=null&&this.get_engine().popTarget(),t!=null&&this.get_engine().pushTarget(t,3,s),this.shader.mat__=this.cubeDir[3],this.pass.setBlendMode(n??X.None),this.render(),t!=null&&this.get_engine().popTarget(),t!=null&&this.get_engine().pushTarget(t,4,s),this.shader.mat__=this.cubeDir[4],this.pass.setBlendMode(n??X.None),this.render(),t!=null&&this.get_engine().popTarget(),t!=null&&this.get_engine().pushTarget(t,5,s),this.shader.mat__=this.cubeDir[5],this.pass.setBlendMode(n??X.None),this.render(),t!=null&&this.get_engine().popTarget(),this.shader.texture__=null},__class__:Xs}),zt=function(e,t){this.defaultSort=(a=new Jr,b(a,a.sort)),this.name=e,this.output=new Ei(t)},c["h3d.pass.Output"]=zt,zt.__name__="h3d.pass.Output",zt.prototype={get_globals:function(){return this.ctx.globals},setContext:function(e){this.ctx=e},dispose:function(){},processShaders:function(e,t){for(var e=this.ctx.extraShaders;e!=null;)t=this.ctx.allocShaderList(e.s,t),e=e.next;return t},setupShaders:function(e){for(var n,s,i,a,r,l,d,u,h,m,f,p,g,b,j,y,_,w,v=!1,c=e.current;c!=null;)if(b=c,c=c.next,n=b,i=n.pass.getShadersRec(),i=this.processShaders(n,i),n.pass.enableLights&&this.ctx.lightSystem!=null&&(v||(this.ctx.lightSystem.initGlobals(this.ctx.globals),v=!0),i=this.ctx.lightSystem.computeLight(n.obj,i)),n.shader=this.output.compileShaders(this.ctx.globals,i,n.pass.batchMode?Ft.Batch:Ft.Default),n.shaders=i,s=n.shader.fragment.textures,s!=null?(d=s.type,d._hx_index==15?(_=d.t,y=d.size,l=!0):l=!1):l=!0,l)n.texture=0;else{if(m=this.ctx,r=!0,r==null&&(r=!1),s.perObjectGlobal!=null){if(u=m.globals.map.h[s.perObjectGlobal.gid],u==null)throw t.thrown("Missing global value "+s.perObjectGlobal.path+" for shader "+m.shaderInfo(i,s.perObjectGlobal.path));f=s.type,f._hx_index==17?(w=f.size,p=!0):p=!1,h=p?u.texture:u}else{for(a=i,j=s.instance;--j>0;)a=a.next;if(g=a.s.getParamValue(s.index),g==null&&!r)throw t.thrown("Missing param value "+o.string(a.s)+"."+s.name);h=g}n.texture=h==null?0:h.id}},log:function(){},drawObject:function(e){this.ctx.drawPass=e,this.ctx.useReverseDepth?(e.pass.reverseDepthTest(),this.ctx.engine.selectMaterial(e.pass),e.pass.reverseDepthTest()):this.ctx.engine.selectMaterial(e.pass);var t=e.obj,n=65536;t.flags|=n,e.obj.draw(this.ctx)},draw:function(e,n){if(e.current==null)return;this.ctx.setupTarget(),this.setupShaders(e),n==null?this.defaultSort(e):n(e);for(var s,i,a,c,l,d,u,h,m,f,p,o=this.ctx.shaderBuffers,g=null,r=e.current;r!=null;){if(u=r,r=r.next,s=u,i=this.ctx,l=s.obj.prevAbsPos,m=l??s.obj.absPos,i.globals.map.h[i.globalPreviousModelView_id]=m,c=this.ctx,h=s.obj.absPos,c.globals.map.h[c.globalModelView_id]=h,s.shader.globals.h.hasOwnProperty(this.ctx.globalModelViewInverse_id)&&(d=this.ctx,f=s.obj.getInvPos(),d.globals.map.h[d.globalModelViewInverse_id]=f),g!=s.shader){if(g=s.shader,zt.onShaderError!=null)try{this.ctx.engine.selectShader(s.shader)}catch(e){p=t.caught(e).unwrap(),zt.onShaderError(p,s);continue}else this.ctx.engine.selectShader(s.shader);a=s.shader,o.vertex.grow(a.vertex),a.fragment!=null&&o.fragment.grow(a.fragment),this.ctx.fillGlobals(o,s.shader),this.ctx.engine.uploadShaderBuffers(o,0)}s.pass.dynamicParameters||(this.ctx.fillParams(o,s.shader,s.shaders),this.ctx.engine.uploadInstanceShaderBuffers(o)),this.drawObject(s)}i=this.ctx,i.cachedPos=0,i.drawPass=null},__class__:zt},ms=function(e){this.pcfScale=1,this.pcfQuality=1,this.bias=.01,this.power=30,this.samplingKind=cs.None,this.size=1024,this.mode=Ye.None,this.enabled=!0,this.updateStatic=!1,this.format==null&&(this.format=f.R16F),K.CURRENT.driver.isSupportedFormat(this.format)||(this.format=S.nativeFormat),zt.call(this,"shadow",this.getOutputs()),this.light=e,this.blur=new aa(5),this.blur.set_quality(.5);var t=this.blur.shader;t.constModified=!0,t.isDepth__=this.format==S.nativeFormat},c["h3d.pass.Shadows"]=ms,ms.__name__="h3d.pass.Shadows",ms.__super__=zt,ms.prototype=g(zt.prototype,{set_mode:function(e){if(e!=Ye.None)throw t.thrown("Shadow mode "+o.string(e)+" not supported for "+o.string(this.light));return this.mode=e},set_enabled:function(e){return this.enabled=e},set_size:function(e){return e!=this.size&&this.staticTexture!=null&&(this.staticTexture.dispose(),this.staticTexture=null),this.size=e},dispose:function(){zt.prototype.dispose.call(this),this.blur.dispose(),this.staticTexture!=null&&this.staticTexture.dispose()},getShadowProj:function(){return this.lightCamera.m},getShadowTex:function(){return null},isUsingWorldDist:function(){return!1},getOutputs:function(){return this.isUsingWorldDist()?[vt.Swiz(vt.Value("output.worldDist",1),[B.X,B.X,B.X,B.X])]:this.format==S.nativeFormat?[vt.PackFloat(vt.Value("output.depth"))]:[vt.Swiz(vt.Value("output.depth",1),[B.X,B.X,B.X,B.X])]},loadStaticData:function(){return!1},saveStaticData:function(){return null},computeStatic:function(){throw t.thrown("Not implemented")},needStaticUpdate:function(){switch(this.mode._hx_index){case 1:case 3:this.updateStatic=!0;break;case 0:case 2:break}},createDefaultShadowMap:function(){var e=S.fromColor(16777215);return e.name="defaultShadowMap",e},syncEarlyExit:function(){this.syncShader(this.staticTexture==null?this.createDefaultShadowMap():this.staticTexture)},syncShader:function(){},filterPasses:function(e){if(this.ctx.computingStatic||this.updateStatic)switch(this.mode._hx_index){case 0:return!1;case 1:for(var i=null,s=null,o=e.discarded,n=e.lastDisc,t=e.current;t!=null;)t.pass.isStatic==!0?i==null?(s=t,i=s):(s.next=t,s=t):o==null?(n=t,o=n):(n.next=t,n=t),t=t.next;return s!=null&&(s.next=null),n!=null&&(n.next=null),e.current=i,e.discarded=o,e.lastDisc=n,!0;case 2:return!1;case 3:for(i=null,s=null,o=e.discarded,n=e.lastDisc,t=e.current;t!=null;)t.pass.isStatic==!0?i==null?(s=t,i=s):(s.next=t,s=t):o==null?(n=t,o=n):(n.next=t,n=t),t=t.next;return s!=null&&(s.next=null),n!=null&&(n.next=null),e.current=i,e.discarded=o,e.lastDisc=n,!0}else switch(this.mode._hx_index){case 0:return!1;case 1:return this.syncEarlyExit(),!1;case 2:return!0;case 3:for(i=null,s=null,o=e.discarded,n=e.lastDisc,t=e.current;t!=null;)t.pass.isStatic==!1?i==null?(s=t,i=s):(s.next=t,s=t):o==null?(n=t,o=n):(n.next=t,n=t),t=t.next;return s!=null&&(s.next=null),n!=null&&(n.next=null),e.current=i,e.discarded=o,e.lastDisc=n,!0}},cullPasses:function(e,t){for(var i,c,l=null,d=!0,a=null,o=null,r=e.discarded,s=e.lastDisc,n=e.current;n!=null;)i=n.obj.cullingCollider,i==null?c=!0:(i!=l&&(l=i,d=t(i)),c=d),c?a==null?(o=n,a=o):(o.next=n,o=n):r==null?(s=n,r=s):(s.next=n,s=n),n=n.next;o!=null&&(o.next=null),s!=null&&(s.next=null),e.current=a,e.discarded=r,e.lastDisc=s},__class__:ms}),to=function(e){this.minDist=-1,this.maxDist=-1,this.autoZPlanes=!1,this.autoShrink=!0,this.mergePass=new Je(new mo),ms.call(this,e),this.lightCamera=new Ci,this.lightCamera.orthoBounds=new Ce,this.shader=this.dshader=new _o,this.border=new ra(this.size,this.size)},c["h3d.pass.DirShadowMap"]=to,to.__name__="h3d.pass.DirShadowMap",to.__super__=ms,to.prototype=g(ms.prototype,{set_mode:function(e){var t=this.dshader;return t.constModified=!0,t.enable__=e!=Ye.None,this.mode=e},set_enabled:function(e){var t=this.dshader;return t.constModified=!0,t.enable__=e&&this.mode!=Ye.None,this.enabled=e},set_size:function(e){return this.border!=null&&this.size!=e&&(this.border.dispose(),this.border=new ra(e,e)),ms.prototype.set_size.call(this,e)},dispose:function(){ms.prototype.dispose.call(this),this.depth!=null&&this.depth.dispose(),this.border!=null&&this.border.dispose()},getShadowTex:function(){return this.dshader.shadowMap__},calcShadowBounds:function(e){var t,n,s,o,i,a,r,c,d,u,h,m,f,p,g,v,b,j,y,w,O,x,C,E,k,A,S,M,F,T,z,D,N,R,P,H,I,B,V,W,U,K,q,G,X,Q,Z,_=this,l=e.orthoBounds,$=-1e9,Y=1e9;this.autoShrink?(h=new L,Q=Be.I(),q=this.autoZPlanes?new Ce:null,Z=this.boundingObject!=null?this.boundingObject:this.ctx.scene,Z.iterVisibleMeshes(function(t){if(t.primitive==null||!t.material.castShadows)return;var n,s,o,i,a,r,c,d,u,f,p,g,v,m=t.primitive.getBounds();if(m.xMin>m.xMax)return;v=t.primitive instanceof Va?Q:t.getAbsPos(),_.autoZPlanes&&(q.load(m),q.transform(v),q.zMax>$&&($=q.zMax),q.zMin<Y&&(Y=q.zMin)),h.multiply3x4(v,e.mcam),u=m.xMin,i=m.yMin,a=m.zMin,a==null&&(a=0),i==null&&(i=0),u==null&&(u=0),r=u,c=i,d=a,d==null&&(d=0),c==null&&(c=0),r==null&&(r=0),n=r,o=c,s=d,f=n*h._11+o*h._21+s*h._31+h._41,p=n*h._12+o*h._22+s*h._32+h._42,g=n*h._13+o*h._23+s*h._33+h._43,n=f,o=p,s=g,n<l.xMin&&(l.xMin=n),n>l.xMax&&(l.xMax=n),o<l.yMin&&(l.yMin=o),o>l.yMax&&(l.yMax=o),s<l.zMin&&(l.zMin=s),s>l.zMax&&(l.zMax=s),u=m.xMin,i=m.yMin,a=m.zMax,a==null&&(a=0),i==null&&(i=0),u==null&&(u=0),r=u,c=i,d=a,d==null&&(d=0),c==null&&(c=0),r==null&&(r=0),n=r,o=c,s=d,f=n*h._11+o*h._21+s*h._31+h._41,p=n*h._12+o*h._22+s*h._32+h._42,g=n*h._13+o*h._23+s*h._33+h._43,n=f,o=p,s=g,n<l.xMin&&(l.xMin=n),n>l.xMax&&(l.xMax=n),o<l.yMin&&(l.yMin=o),o>l.yMax&&(l.yMax=o),s<l.zMin&&(l.zMin=s),s>l.zMax&&(l.zMax=s),u=m.xMin,i=m.yMax,a=m.zMin,a==null&&(a=0),i==null&&(i=0),u==null&&(u=0),r=u,c=i,d=a,d==null&&(d=0),c==null&&(c=0),r==null&&(r=0),n=r,o=c,s=d,f=n*h._11+o*h._21+s*h._31+h._41,p=n*h._12+o*h._22+s*h._32+h._42,g=n*h._13+o*h._23+s*h._33+h._43,n=f,o=p,s=g,n<l.xMin&&(l.xMin=n),n>l.xMax&&(l.xMax=n),o<l.yMin&&(l.yMin=o),o>l.yMax&&(l.yMax=o),s<l.zMin&&(l.zMin=s),s>l.zMax&&(l.zMax=s),u=m.xMin,i=m.yMax,a=m.zMax,a==null&&(a=0),i==null&&(i=0),u==null&&(u=0),r=u,c=i,d=a,d==null&&(d=0),c==null&&(c=0),r==null&&(r=0),n=r,o=c,s=d,f=n*h._11+o*h._21+s*h._31+h._41,p=n*h._12+o*h._22+s*h._32+h._42,g=n*h._13+o*h._23+s*h._33+h._43,n=f,o=p,s=g,n<l.xMin&&(l.xMin=n),n>l.xMax&&(l.xMax=n),o<l.yMin&&(l.yMin=o),o>l.yMax&&(l.yMax=o),s<l.zMin&&(l.zMin=s),s>l.zMax&&(l.zMax=s),u=m.xMax,i=m.yMin,a=m.zMin,a==null&&(a=0),i==null&&(i=0),u==null&&(u=0),r=u,c=i,d=a,d==null&&(d=0),c==null&&(c=0),r==null&&(r=0),n=r,o=c,s=d,f=n*h._11+o*h._21+s*h._31+h._41,p=n*h._12+o*h._22+s*h._32+h._42,g=n*h._13+o*h._23+s*h._33+h._43,n=f,o=p,s=g,n<l.xMin&&(l.xMin=n),n>l.xMax&&(l.xMax=n),o<l.yMin&&(l.yMin=o),o>l.yMax&&(l.yMax=o),s<l.zMin&&(l.zMin=s),s>l.zMax&&(l.zMax=s),u=m.xMax,i=m.yMin,a=m.zMax,a==null&&(a=0),i==null&&(i=0),u==null&&(u=0),r=u,c=i,d=a,d==null&&(d=0),c==null&&(c=0),r==null&&(r=0),n=r,o=c,s=d,f=n*h._11+o*h._21+s*h._31+h._41,p=n*h._12+o*h._22+s*h._32+h._42,g=n*h._13+o*h._23+s*h._33+h._43,n=f,o=p,s=g,n<l.xMin&&(l.xMin=n),n>l.xMax&&(l.xMax=n),o<l.yMin&&(l.yMin=o),o>l.yMax&&(l.yMax=o),s<l.zMin&&(l.zMin=s),s>l.zMax&&(l.zMax=s),u=m.xMax,i=m.yMax,a=m.zMin,a==null&&(a=0),i==null&&(i=0),u==null&&(u=0),r=u,c=i,d=a,d==null&&(d=0),c==null&&(c=0),r==null&&(r=0),n=r,o=c,s=d,f=n*h._11+o*h._21+s*h._31+h._41,p=n*h._12+o*h._22+s*h._32+h._42,g=n*h._13+o*h._23+s*h._33+h._43,n=f,o=p,s=g,n<l.xMin&&(l.xMin=n),n>l.xMax&&(l.xMax=n),o<l.yMin&&(l.yMin=o),o>l.yMax&&(l.yMax=o),s<l.zMin&&(l.zMin=s),s>l.zMax&&(l.zMax=s),u=m.xMax,i=m.yMax,a=m.zMax,a==null&&(a=0),i==null&&(i=0),u==null&&(u=0),r=u,c=i,d=a,d==null&&(d=0),c==null&&(c=0),r==null&&(r=0),n=r,o=c,s=d,f=n*h._11+o*h._21+s*h._31+h._41,p=n*h._12+o*h._22+s*h._32+h._42,g=n*h._13+o*h._23+s*h._33+h._43,n=f,o=p,s=g,n<l.xMin&&(l.xMin=n),n>l.xMax&&(l.xMax=n),o<l.yMin&&(l.yMin=o),o>l.yMax&&(l.yMax=o),s<l.zMin&&(l.zMin=s),s>l.zMax&&(l.zMax=s)})):this.mode==Ye.Dynamic&&(l.xMin=-1e20,l.xMax=1e20,l.yMin=-1e20,l.yMax=1e20,l.zMin=-1e20,l.zMax=1e20),this.mode==Ye.Dynamic&&(u=new Ce,G=this.minDist<0?this.ctx.camera.zNear:this.minDist,X=this.maxDist<0?this.ctx.camera.zFar:this.maxDist,F=G,m=_.ctx.camera.unproject(-1,-1,_.ctx.camera.distanceToDepth(F)),t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),f=r,g=a,p=i,_.autoShrink&&_.autoZPlanes&&(m=_.ctx.camera.pos,t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),M=r,A=a,z=i,d=new nt,d.px=M,d.py=A,d.pz=z,d.lx=f-M,d.ly=g-A,d.lz=p-z,d.normalize(),c=d,j=$,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),y=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,C=1,y>0&&y*C>F*C&&(t=c.px+y*c.lx,s=c.py+y*c.ly,n=c.pz+y*c.lz,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),D=r,N=a,R=i,f=D,g=N,p=R)),o=e.mcam,E=f*o._11+g*o._21+p*o._31+o._41,k=f*o._12+g*o._22+p*o._32+o._42,S=f*o._13+g*o._23+p*o._33+o._43,f=E,g=k,p=S,t=f,s=g,n=p,t<u.xMin&&(u.xMin=t),t>u.xMax&&(u.xMax=t),s<u.yMin&&(u.yMin=s),s>u.yMax&&(u.yMax=s),n<u.zMin&&(u.zMin=n),n>u.zMax&&(u.zMax=n),F=G,m=_.ctx.camera.unproject(-1,1,_.ctx.camera.distanceToDepth(F)),t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),f=r,g=a,p=i,_.autoShrink&&_.autoZPlanes&&(m=_.ctx.camera.pos,t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),M=r,A=a,z=i,d=new nt,d.px=M,d.py=A,d.pz=z,d.lx=f-M,d.ly=g-A,d.lz=p-z,d.normalize(),c=d,j=$,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),y=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,C=1,y>0&&y*C>F*C&&(t=c.px+y*c.lx,s=c.py+y*c.ly,n=c.pz+y*c.lz,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),D=r,N=a,R=i,f=D,g=N,p=R)),o=e.mcam,E=f*o._11+g*o._21+p*o._31+o._41,k=f*o._12+g*o._22+p*o._32+o._42,S=f*o._13+g*o._23+p*o._33+o._43,f=E,g=k,p=S,t=f,s=g,n=p,t<u.xMin&&(u.xMin=t),t>u.xMax&&(u.xMax=t),s<u.yMin&&(u.yMin=s),s>u.yMax&&(u.yMax=s),n<u.zMin&&(u.zMin=n),n>u.zMax&&(u.zMax=n),F=G,m=_.ctx.camera.unproject(1,-1,_.ctx.camera.distanceToDepth(F)),t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),f=r,g=a,p=i,_.autoShrink&&_.autoZPlanes&&(m=_.ctx.camera.pos,t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),M=r,A=a,z=i,d=new nt,d.px=M,d.py=A,d.pz=z,d.lx=f-M,d.ly=g-A,d.lz=p-z,d.normalize(),c=d,j=$,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),y=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,C=1,y>0&&y*C>F*C&&(t=c.px+y*c.lx,s=c.py+y*c.ly,n=c.pz+y*c.lz,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),D=r,N=a,R=i,f=D,g=N,p=R)),o=e.mcam,E=f*o._11+g*o._21+p*o._31+o._41,k=f*o._12+g*o._22+p*o._32+o._42,S=f*o._13+g*o._23+p*o._33+o._43,f=E,g=k,p=S,t=f,s=g,n=p,t<u.xMin&&(u.xMin=t),t>u.xMax&&(u.xMax=t),s<u.yMin&&(u.yMin=s),s>u.yMax&&(u.yMax=s),n<u.zMin&&(u.zMin=n),n>u.zMax&&(u.zMax=n),F=G,m=_.ctx.camera.unproject(1,1,_.ctx.camera.distanceToDepth(F)),t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),f=r,g=a,p=i,_.autoShrink&&_.autoZPlanes&&(m=_.ctx.camera.pos,t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),M=r,A=a,z=i,d=new nt,d.px=M,d.py=A,d.pz=z,d.lx=f-M,d.ly=g-A,d.lz=p-z,d.normalize(),c=d,j=$,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),y=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,C=1,y>0&&y*C>F*C&&(t=c.px+y*c.lx,s=c.py+y*c.ly,n=c.pz+y*c.lz,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),D=r,N=a,R=i,f=D,g=N,p=R)),o=e.mcam,E=f*o._11+g*o._21+p*o._31+o._41,k=f*o._12+g*o._22+p*o._32+o._42,S=f*o._13+g*o._23+p*o._33+o._43,f=E,g=k,p=S,t=f,s=g,n=p,t<u.xMin&&(u.xMin=t),t>u.xMax&&(u.xMax=t),s<u.yMin&&(u.yMin=s),s>u.yMax&&(u.yMax=s),n<u.zMin&&(u.zMin=n),n>u.zMax&&(u.zMax=n),F=X,m=_.ctx.camera.unproject(-1,-1,_.ctx.camera.distanceToDepth(F)),t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),f=r,g=a,p=i,_.autoShrink&&_.autoZPlanes&&(m=_.ctx.camera.pos,t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),M=r,A=a,z=i,d=new nt,d.px=M,d.py=A,d.pz=z,d.lx=f-M,d.ly=g-A,d.lz=p-z,d.normalize(),c=d,j=Y,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),y=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,C=-1,y>0&&y*C>F*C&&(t=c.px+y*c.lx,s=c.py+y*c.ly,n=c.pz+y*c.lz,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),D=r,N=a,R=i,f=D,g=N,p=R)),o=e.mcam,E=f*o._11+g*o._21+p*o._31+o._41,k=f*o._12+g*o._22+p*o._32+o._42,S=f*o._13+g*o._23+p*o._33+o._43,f=E,g=k,p=S,t=f,s=g,n=p,t<u.xMin&&(u.xMin=t),t>u.xMax&&(u.xMax=t),s<u.yMin&&(u.yMin=s),s>u.yMax&&(u.yMax=s),n<u.zMin&&(u.zMin=n),n>u.zMax&&(u.zMax=n),F=X,m=_.ctx.camera.unproject(-1,1,_.ctx.camera.distanceToDepth(F)),t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),f=r,g=a,p=i,_.autoShrink&&_.autoZPlanes&&(m=_.ctx.camera.pos,t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),M=r,A=a,z=i,d=new nt,d.px=M,d.py=A,d.pz=z,d.lx=f-M,d.ly=g-A,d.lz=p-z,d.normalize(),c=d,j=Y,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),y=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,C=-1,y>0&&y*C>F*C&&(t=c.px+y*c.lx,s=c.py+y*c.ly,n=c.pz+y*c.lz,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),D=r,N=a,R=i,f=D,g=N,p=R)),o=e.mcam,E=f*o._11+g*o._21+p*o._31+o._41,k=f*o._12+g*o._22+p*o._32+o._42,S=f*o._13+g*o._23+p*o._33+o._43,f=E,g=k,p=S,t=f,s=g,n=p,t<u.xMin&&(u.xMin=t),t>u.xMax&&(u.xMax=t),s<u.yMin&&(u.yMin=s),s>u.yMax&&(u.yMax=s),n<u.zMin&&(u.zMin=n),n>u.zMax&&(u.zMax=n),F=X,m=_.ctx.camera.unproject(1,-1,_.ctx.camera.distanceToDepth(F)),t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),f=r,g=a,p=i,_.autoShrink&&_.autoZPlanes&&(m=_.ctx.camera.pos,t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),M=r,A=a,z=i,d=new nt,d.px=M,d.py=A,d.pz=z,d.lx=f-M,d.ly=g-A,d.lz=p-z,d.normalize(),c=d,j=Y,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),y=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,C=-1,y>0&&y*C>F*C&&(t=c.px+y*c.lx,s=c.py+y*c.ly,n=c.pz+y*c.lz,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),D=r,N=a,R=i,f=D,g=N,p=R)),o=e.mcam,E=f*o._11+g*o._21+p*o._31+o._41,k=f*o._12+g*o._22+p*o._32+o._42,S=f*o._13+g*o._23+p*o._33+o._43,f=E,g=k,p=S,t=f,s=g,n=p,t<u.xMin&&(u.xMin=t),t>u.xMax&&(u.xMax=t),s<u.yMin&&(u.yMin=s),s>u.yMax&&(u.yMax=s),n<u.zMin&&(u.zMin=n),n>u.zMax&&(u.zMax=n),F=X,m=_.ctx.camera.unproject(1,1,_.ctx.camera.distanceToDepth(F)),t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),f=r,g=a,p=i,_.autoShrink&&_.autoZPlanes&&(m=_.ctx.camera.pos,t=m.x,s=m.y,n=m.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),M=r,A=a,z=i,d=new nt,d.px=M,d.py=A,d.pz=z,d.lx=f-M,d.ly=g-A,d.lz=p-z,d.normalize(),c=d,j=Y,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),y=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,C=-1,y>0&&y*C>F*C&&(t=c.px+y*c.lx,s=c.py+y*c.ly,n=c.pz+y*c.lz,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),D=r,N=a,R=i,f=D,g=N,p=R)),o=e.mcam,E=f*o._11+g*o._21+p*o._31+o._41,k=f*o._12+g*o._22+p*o._32+o._42,S=f*o._13+g*o._23+p*o._33+o._43,f=E,g=k,p=S,t=f,s=g,n=p,t<u.xMin&&(u.xMin=t),t>u.xMax&&(u.xMax=t),s<u.yMin&&(u.yMin=s),s>u.yMax&&(u.yMax=s),n<u.zMin&&(u.zMin=n),n>u.zMax&&(u.zMax=n),this.autoShrink?(u.zMin=l.zMin,l.intersection(l,u),this.autoZPlanes&&(m=e.target,j=e.pos,t=m.x-j.x,s=m.y-j.y,n=m.z-j.z,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),f=r,g=a,p=i,C=f*f+g*g+p*p,C<1e-20?C=0:C=1/Math.sqrt(C),t=f*C,s=g*C,n=p*C,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),D=r,N=a,R=i,V=1e9,E=l.xMin,k=l.yMin,t=E,s=k,n=l.zMin,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),I=r,H=a,P=i,o=e.getInverseView(),E=I*o._11+H*o._21+P*o._31+o._41,k=I*o._12+H*o._22+P*o._32+o._42,S=I*o._13+H*o._23+P*o._33+o._43,t=E,s=k,n=S,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),W=r,U=a,K=i,d=new nt,d.px=W,d.py=U,d.pz=K,d.lx=D,d.ly=N,d.lz=R,d.normalize(),c=d,j=$,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),B=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,B<V&&(V=B),E=l.xMin,k=l.yMax,t=E,s=k,n=l.zMin,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),I=r,H=a,P=i,o=e.getInverseView(),E=I*o._11+H*o._21+P*o._31+o._41,k=I*o._12+H*o._22+P*o._32+o._42,S=I*o._13+H*o._23+P*o._33+o._43,t=E,s=k,n=S,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),W=r,U=a,K=i,d=new nt,d.px=W,d.py=U,d.pz=K,d.lx=D,d.ly=N,d.lz=R,d.normalize(),c=d,j=$,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),B=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,B<V&&(V=B),E=l.xMax,k=l.yMin,t=E,s=k,n=l.zMin,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),I=r,H=a,P=i,o=e.getInverseView(),E=I*o._11+H*o._21+P*o._31+o._41,k=I*o._12+H*o._22+P*o._32+o._42,S=I*o._13+H*o._23+P*o._33+o._43,t=E,s=k,n=S,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),W=r,U=a,K=i,d=new nt,d.px=W,d.py=U,d.pz=K,d.lx=D,d.ly=N,d.lz=R,d.normalize(),c=d,j=$,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),B=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,B<V&&(V=B),E=l.xMax,k=l.yMax,t=E,s=k,n=l.zMin,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),I=r,H=a,P=i,o=e.getInverseView(),E=I*o._11+H*o._21+P*o._31+o._41,k=I*o._12+H*o._22+P*o._32+o._42,S=I*o._13+H*o._23+P*o._33+o._43,t=E,s=k,n=S,n==null&&(n=0),s==null&&(s=0),t==null&&(t=0),r=t,a=s,i=n,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),W=r,U=a,K=i,d=new nt,d.px=W,d.py=U,d.pz=K,d.lx=D,d.ly=N,d.lz=R,d.normalize(),c=d,j=$,j==null&&(j=0),x=0,O=0,w=1,T=j,b=c.lx*x+c.ly*O+c.lz*w,v=T-(c.px*x+c.py*O+c.pz*w),B=(b<0?-b:b)<1e-10?(v<0?-v:v)<1e-10?0:-1:v/b,B<V&&(V=B),l.zMin+=V)):l.load(u)),l.scaleCenter(1.01)},syncShader:function(e){var n,s,t=this.dshader;t.constModified=!0,t.shadowMap__=e,t=this.dshader,t.constModified=!0,t.shadowMapChannel__=this.format==S.nativeFormat?Re.PackedFloat:Re.R,this.dshader.shadowBias__=this.bias,this.dshader.shadowPower__=this.power,this.dshader.shadowProj__=this.getShadowProj(),t=this.dshader,t.constModified=!0,t.USE_ESM__=this.samplingKind==cs.ESM,this.dshader.shadowPower__=this.power,t=this.dshader,t.constModified=!0,t.USE_PCF__=this.samplingKind==cs.PCF,t=this.dshader.shadowRes__,n=e.width,s=e.height,s==null&&(s=0),n==null&&(n=0),t.x=n,t.y=s,t.z=0,this.dshader.pcfScale__=this.pcfScale,this.dshader.set_pcfQuality(this.pcfQuality)},saveStaticData:function(){if(this.mode!=Ye.Mixed&&this.mode!=Ye.Static)return null;if(this.staticTexture==null)throw t.thrown("Data not computed");var n=Cr.run(this.staticTexture.capturePixels().bytes,9),e=new Kn;return e.addInt32(this.staticTexture.width),e.addFloat(this.lightCamera.pos.x),e.addFloat(this.lightCamera.pos.y),e.addFloat(this.lightCamera.pos.z),e.addFloat(this.lightCamera.target.x),e.addFloat(this.lightCamera.target.y),e.addFloat(this.lightCamera.target.z),e.addFloat(this.lightCamera.orthoBounds.xMin),e.addFloat(this.lightCamera.orthoBounds.yMin),e.addFloat(this.lightCamera.orthoBounds.zMin),e.addFloat(this.lightCamera.orthoBounds.xMax),e.addFloat(this.lightCamera.orthoBounds.yMax),e.addFloat(this.lightCamera.orthoBounds.zMax),e.addInt32(n.length),e.add(n),e.getBytes()},loadStaticData:function(e){if(this.mode!=Ye.Mixed&&this.mode!=Ye.Static||e==null)return!1;var s,o,t=new Nt(e),n=t.readInt32();return n==this.size&&(this.lightCamera.pos.x=t.readFloat(),this.lightCamera.pos.y=t.readFloat(),this.lightCamera.pos.z=t.readFloat(),this.lightCamera.target.x=t.readFloat(),this.lightCamera.target.y=t.readFloat(),this.lightCamera.target.z=t.readFloat(),this.lightCamera.orthoBounds.xMin=t.readFloat(),this.lightCamera.orthoBounds.yMin=t.readFloat(),this.lightCamera.orthoBounds.zMin=t.readFloat(),this.lightCamera.orthoBounds.xMax=t.readFloat(),this.lightCamera.orthoBounds.yMax=t.readFloat(),this.lightCamera.orthoBounds.zMax=t.readFloat(),this.lightCamera.update(),s=t.readInt32(),o=new G(n,n,dc.run(t.read(s)),this.format),this.staticTexture!=null&&this.staticTexture.dispose(),this.staticTexture=new S(n,n,[w.Target],this.format),this.staticTexture.uploadPixels(o),this.staticTexture.name="staticTexture",this.staticTexture.preventAutoDispose(),this.syncShader(this.staticTexture),!0)},processShadowMap:function(e,n,s){var i,a,r,c,o=this.ctx,l=o.globals.map.h[o.cameraViewProj_id],o=this.ctx,d=this.getShadowProj();if(o.globals.map.h[o.cameraViewProj_id]=d,n.isDepth()?(this.ctx.engine.pushDepth(n),this.ctx.engine.clear(null,1)):(this.ctx.engine.pushTarget(n),this.ctx.engine.clear(16777215,1)),ms.prototype.draw.call(this,e,s),a=this.ctx.computingStatic||this.updateStatic,r=this.blur.radius>0&&(this.mode!=Ye.Mixed||!a),this.border!=null&&!r&&this.border.render(),this.ctx.engine.popTarget(),this.mode==Ye.Mixed&&!a&&this.staticTexture!=null?(o=this.staticTexture,i=o.t!=null||!o.isDepth()&&o.realloc!=null):i=!1,i){if(this.staticTexture.width!=n.width)throw t.thrown("Static shadow map doesnt match dynamic shadow map");c=this.ctx.textures.allocTarget("mergedDirShadowMap",this.size,this.size,!1,this.format),this.mergePass.shader.texA__=n,this.mergePass.shader.texB__=this.staticTexture,this.ctx.engine.pushTarget(c),this.mergePass.render(),this.ctx.engine.popTarget(),n=c}return r&&(n.isDepth()&&(i=this.ctx.textures.allocTarget("dirShadowMapFloat",this.size,this.size,!1,this.format),Gt.run(n,i),n=i),this.blur.apply(this.ctx,n),this.border!=null&&(this.ctx.engine.pushTarget(n),this.border.render(),this.ctx.engine.popTarget())),o=this.ctx,o.globals.map.h[o.cameraViewProj_id]=l,n},draw:function(e,t){var n,s,o,i,a,r,c,l,d,u,h,m,p,g,v,b,j,y,_,w,O=this;if(!this.enabled)return;if(!this.filterPasses(e))return;for(w=this.ctx.computingStatic||this.updateStatic,(this.mode!=Ye.Mixed||w)&&(d=this.ctx.camera.target,y=this.light==null?this.ctx.lightSystem.shadowLight:this.light,h=y==null?null:y.getShadowDirection(),h==null?(n=this.lightCamera.target,i=0,a=0,r=-1,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n.x=i,n.y=a,n.z=r):(n=this.lightCamera.target,i=h.x,a=h.y,r=h.z,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),n.x=i,n.y=a,n.z=r,n=this.lightCamera.target,o=n.x*n.x+n.y*n.y+n.z*n.z,o<1e-20?o=0:o=1/Math.sqrt(o),n.x*=o,n.y*=o,n.z*=o),this.lightCamera.target.x+=d.x,this.lightCamera.target.y+=d.y,this.lightCamera.target.z+=d.z,n=this.lightCamera.pos,n.x=d.x,n.y=d.y,n.z=d.z,this.lightCamera.update(),n=this.lightCamera.orthoBounds,n.xMin=1e20,n.xMax=-1e20,n.yMin=1e20,n.yMax=-1e20,n.zMin=1e20,n.zMax=-1e20,e.current!=null&&this.calcShadowBounds(this.lightCamera),this.lightCamera.update()),_=function(e){return e.inFrustum(O.lightCamera.frustum)},j=null,b=!0,v=null,u=null,g=e.discarded,c=e.lastDisc,s=e.current;s!=null;)m=s.obj.cullingCollider,m==null?l=!0:(m!=j&&(j=m,b=_(m)),l=b),l?v==null?(u=s,v=u):(u.next=s,u=s):g==null?(c=s,g=c):(c.next=s,c=s),s=s.next;u!=null&&(u.next=null),c!=null&&(c.next=null),e.current=v,e.discarded=g,e.lastDisc=c,p=this.ctx.textures.allocTarget("dirShadowMap",this.size,this.size,!1,this.format),this.depth==null||this.depth.width!=this.size||this.depth.height!=this.size?l=!0:(n=this.depth,l=n.t==null&&(n.isDepth()||n.realloc==null)),l&&(this.depth!=null&&this.depth.dispose(),this.depth=new S(this.size,this.size,null,f.Depth24Stencil8),this.depth.name="dirShadowMapDepth"),p.depthBuffer=this.depth,p=this.processShadowMap(e,p,t),this.syncShader(p),this.updateStatic=!1},computeStatic:function(e){if(this.mode!=Ye.Static&&this.mode!=Ye.Mixed)return;this.draw(e);var t,s=this.dshader.shadowMap__,n=this.staticTexture;this.staticTexture=s.clone(),this.staticTexture.name="StaticDirShadowMap",this.staticTexture.preventAutoDispose(),t=this.dshader,t.constModified=!0,t.shadowMap__=this.staticTexture,n!=null&&n.dispose()},drawDebug:function(){if(this.g==null){this.g=new Gn(this.ctx.scene),this.g.name="frustumDebug",this.g.material.passes.setPassName("overlay");var e=this.g,t=512;e.flags|=t}if(!this.debug)return;this.g.clear(),this.drawBounds(this.lightCamera.getInverseViewProj(),16777215)},drawBounds:function(e,t){var n,o,c,l,d,u,m,f,p,g,v,b,j,y,_,w,s=this,r=-1,a=1,i=0;for(i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),w=new h(r,a,i),n=w,l=n.x*e._11+n.y*e._21+n.z*e._31+e._41,d=n.x*e._12+n.y*e._22+n.z*e._32+e._42,u=n.x*e._13+n.y*e._23+n.z*e._33+e._43,o=1/(n.x*e._14+n.y*e._24+n.z*e._34+e._44),n.x=l*o,n.y=d*o,n.z=u*o,r=1,a=1,i=0,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),_=new h(r,a,i),n=_,l=n.x*e._11+n.y*e._21+n.z*e._31+e._41,d=n.x*e._12+n.y*e._22+n.z*e._32+e._42,u=n.x*e._13+n.y*e._23+n.z*e._33+e._43,o=1/(n.x*e._14+n.y*e._24+n.z*e._34+e._44),n.x=l*o,n.y=d*o,n.z=u*o,r=1,a=-1,i=0,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),y=new h(r,a,i),n=y,l=n.x*e._11+n.y*e._21+n.z*e._31+e._41,d=n.x*e._12+n.y*e._22+n.z*e._32+e._42,u=n.x*e._13+n.y*e._23+n.z*e._33+e._43,o=1/(n.x*e._14+n.y*e._24+n.z*e._34+e._44),n.x=l*o,n.y=d*o,n.z=u*o,r=-1,a=-1,i=0,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),j=new h(r,a,i),n=j,l=n.x*e._11+n.y*e._21+n.z*e._31+e._41,d=n.x*e._12+n.y*e._22+n.z*e._32+e._42,u=n.x*e._13+n.y*e._23+n.z*e._33+e._43,o=1/(n.x*e._14+n.y*e._24+n.z*e._34+e._44),n.x=l*o,n.y=d*o,n.z=u*o,f=[w,_,y,j],r=-1,a=1,i=1,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),w=new h(r,a,i),n=w,l=n.x*e._11+n.y*e._21+n.z*e._31+e._41,d=n.x*e._12+n.y*e._22+n.z*e._32+e._42,u=n.x*e._13+n.y*e._23+n.z*e._33+e._43,o=1/(n.x*e._14+n.y*e._24+n.z*e._34+e._44),n.x=l*o,n.y=d*o,n.z=u*o,r=1,a=1,i=1,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),_=new h(r,a,i),n=_,l=n.x*e._11+n.y*e._21+n.z*e._31+e._41,d=n.x*e._12+n.y*e._22+n.z*e._32+e._42,u=n.x*e._13+n.y*e._23+n.z*e._33+e._43,o=1/(n.x*e._14+n.y*e._24+n.z*e._34+e._44),n.x=l*o,n.y=d*o,n.z=u*o,r=1,a=-1,i=1,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),y=new h(r,a,i),n=y,l=n.x*e._11+n.y*e._21+n.z*e._31+e._41,d=n.x*e._12+n.y*e._22+n.z*e._32+e._42,u=n.x*e._13+n.y*e._23+n.z*e._33+e._43,o=1/(n.x*e._14+n.y*e._24+n.z*e._34+e._44),n.x=l*o,n.y=d*o,n.z=u*o,r=-1,a=-1,i=1,i==null&&(i=0),a==null&&(a=0),r==null&&(r=0),j=new h(r,a,i),n=j,l=n.x*e._11+n.y*e._21+n.z*e._31+e._41,d=n.x*e._12+n.y*e._22+n.z*e._32+e._42,u=n.x*e._13+n.y*e._23+n.z*e._33+e._43,o=1/(n.x*e._14+n.y*e._24+n.z*e._34+e._44),n.x=l*o,n.y=d*o,n.z=u*o,p=[w,_,y,j],this.g.lineStyle(1,t),g=f[f.length-1],s.g.moveTo(g.x-s.ctx.scene.x,g.y-s.ctx.scene.y,g.z-s.ctx.scene.z),v=0;v<f.length;)b=f[v],++v,s.g.lineTo(b.x-s.ctx.scene.x,b.y-s.ctx.scene.y,b.z-s.ctx.scene.z);for(g=p[p.length-1],s.g.moveTo(g.x-s.ctx.scene.x,g.y-s.ctx.scene.y,g.z-s.ctx.scene.z),v=0;v<p.length;)b=p[v],++v,s.g.lineTo(b.x-s.ctx.scene.x,b.y-s.ctx.scene.y,b.z-s.ctx.scene.z);m=f[0],c=p[0],s.g.moveTo(m.x-s.ctx.scene.x,m.y-s.ctx.scene.y,m.z-s.ctx.scene.z),s.g.lineTo(c.x-s.ctx.scene.x,c.y-s.ctx.scene.y,c.z-s.ctx.scene.z),m=f[1],c=p[1],s.g.moveTo(m.x-s.ctx.scene.x,m.y-s.ctx.scene.y,m.z-s.ctx.scene.z),s.g.lineTo(c.x-s.ctx.scene.x,c.y-s.ctx.scene.y,c.z-s.ctx.scene.z),m=f[2],c=p[2],s.g.moveTo(m.x-s.ctx.scene.x,m.y-s.ctx.scene.y,m.z-s.ctx.scene.z),s.g.lineTo(c.x-s.ctx.scene.x,c.y-s.ctx.scene.y,c.z-s.ctx.scene.z),m=f[3],c=p[3],s.g.moveTo(m.x-s.ctx.scene.x,m.y-s.ctx.scene.y,m.z-s.ctx.scene.z),s.g.lineTo(c.x-s.ctx.scene.x,c.y-s.ctx.scene.y,c.z-s.ctx.scene.z)},__class__:to}),Sa=function(e,t){e==null&&(e=1024),t!=null&&(this.format=t),to.call(this,null),this.set_size(e),this.color=new h(0,0,0),this.set_mode(Ye.Dynamic),this.shadowMapId=ie.allocID("shadow.map"),this.shadowProjId=ie.allocID("shadow.proj"),this.shadowColorId=ie.allocID("shadow.color"),this.shadowPowerId=ie.allocID("shadow.power"),this.shadowBiasId=ie.allocID("shadow.bias")},c["h3d.pass.DefaultShadowMap"]=Sa,Sa.__name__="h3d.pass.DefaultShadowMap",Sa.__super__=to,Sa.prototype=g(to.prototype,{draw:function(e,t){to.prototype.draw.call(this,e,t),this.ctx.globals.map.h[this.shadowMapId]={texture:this.dshader.shadowMap__,channel:this.format==S.nativeFormat?Re.PackedFloat:Re.R};var n=this.ctx.globals,s=this.shadowProjId,o=this.getShadowProj();n.map.h[s]=o,this.ctx.globals.map.h[this.shadowColorId]=this.color,this.ctx.globals.map.h[this.shadowPowerId]=this.power,this.ctx.globals.map.h[this.shadowBiasId]=this.bias},__class__:Sa}),Ei=function(e){this.shaderCache=Mn.get(),this.currentOutput=new Ge(null),this.setOutput(e)},c["h3d.pass.OutputShader"]=Ei,Ei.__name__="h3d.pass.OutputShader",Ei.prototype={setOutput:function(e){e==null&&(e=[vt.Value("output.color")]),this.currentOutput.s=this.shaderCache.getLinkShader(e)},compileShaders:function(e,t,n){n==null&&(n=Ft.Default),e.maxChannels=0;for(var o,i,s=t,a=null;s!=a;)o=s.s,s=s.next,i=o,i.updateConstants(e);return this.currentOutput.next=t,o=this.shaderCache.link(this.currentOutput,n),this.currentOutput.next=null,o},__class__:Ei},ka=function(e){this.o=e},c["h3d.pass.PassListIterator"]=ka,ka.__name__="h3d.pass.PassListIterator",ka.prototype={hasNext:function(){return this.o!=null},next:function(){var e=this.o;return this.o=this.o.next,e},__class__:ka},ya=function(e){this.current=e,this.discarded=this.lastDisc=null},c["h3d.pass.PassList"]=ya,ya.__name__="h3d.pass.PassList",ya.prototype={init:function(e){this.current=e,this.discarded=this.lastDisc=null},reset:function(){this.discarded!=null&&(this.lastDisc.next=this.current,this.current=this.discarded,this.discarded=this.lastDisc=null)},count:function(){for(var e=this.current,t=0;e!=null;)++t,e=e.next;return t},save:function(){return this.lastDisc},load:function(e){this.lastDisc!=e&&(this.lastDisc.next=this.current,e==null?(this.current=this.discarded,this.discarded=null):(this.current=e.next,e.next=null),this.lastDisc=e)},isEmpty:function(){return this.current==null},clear:function(){if(this.current==null)return;this.discarded==null?this.discarded=this.current:this.lastDisc.next=this.current;for(var e=this.current;e.next!=null;)e=e.next;this.lastDisc=e,this.current=null},sort:function(e){var t,n,s,o,i,a,c,l,d,u,h,m,r=this.current;if(r==null)d=null;else{for(c=1,i=0,s=0;!0;){for(n=r,r=null,a=null,l=0;n!=null;){for(++l,t=n,i=0,u=0,h=c;u<h;)if(m=u++,++i,t=t.next,t==null)break;for(s=c;i>0||s>0&&t!=null;)i==0?(o=t,t=t.next,--s):s==0||t==null||e(n,t)<=0?(o=n,n=n.next,--i):(o=t,t=t.next,--s),a!=null?a.next=o:r=o,a=o;n=t}if(a.next=null,l<=1)break;c*=2}d=r}this.current=d},filter:function(e){for(var o=null,s=null,i=this.discarded,n=this.lastDisc,t=this.current;t!=null;)e(t)?o==null?(s=t,o=s):(s.next=t,s=t):i==null?(n=t,i=n):(n.next=t,n=t),t=t.next;s!=null&&(s.next=null),n!=null&&(n.next=null),this.current=o,this.discarded=i,this.lastDisc=n},iterator:function(){return new ka(this.current)},getFiltered:function(){return new ka(this.discarded)},__class__:ya},lc=function(){this.texture=0},c["h3d.pass.PassObject"]=lc,lc.__name__="h3d.pass.PassObject",lc.prototype={__class__:lc},Ye=_["h3d.pass.RenderMode"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"h3d.pass.RenderMode",toString:s},Static:{_hx_name:"Static",_hx_index:1,__enum__:"h3d.pass.RenderMode",toString:s},Dynamic:{_hx_name:"Dynamic",_hx_index:2,__enum__:"h3d.pass.RenderMode",toString:s},Mixed:{_hx_name:"Mixed",_hx_index:3,__enum__:"h3d.pass.RenderMode",toString:s}},Ye.__constructs__=[Ye.None,Ye.Static,Ye.Dynamic,Ye.Mixed],Ye.__empty_constructs__=[Ye.None,Ye.Static,Ye.Dynamic,Ye.Mixed],cs=_["h3d.pass.ShadowSamplingKind"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"h3d.pass.ShadowSamplingKind",toString:s},PCF:{_hx_name:"PCF",_hx_index:1,__enum__:"h3d.pass.ShadowSamplingKind",toString:s},ESM:{_hx_name:"ESM",_hx_index:2,__enum__:"h3d.pass.ShadowSamplingKind",toString:s}},cs.__constructs__=[cs.None,cs.PCF,cs.ESM],cs.__empty_constructs__=[cs.None,cs.PCF,cs.ESM],Jr=function(){this.textureCount=1,this.shaderCount=1,this.shaderIdMap=[],this.textureIdMap=[]},c["h3d.pass.SortByMaterial"]=Jr,Jr.__name__="h3d.pass.SortByMaterial",Jr.prototype={sort:function(e){for(var t,n,s,o,i,a,r,c,l,h,m,f,p,g,v,b,d=this,j=this.shaderCount,y=this.textureCount,u=e.current;u!=null;)i=u,u=u.next,t=i,(this.shaderIdMap[t.shader.id]<j||this.shaderIdMap[t.shader.id]==null)&&(this.shaderIdMap[t.shader.id]=this.shaderCount++),(this.textureIdMap[t.texture]<y||this.textureIdMap[t.shader.id]==null)&&(this.textureIdMap[t.texture]=this.textureCount++);if(r=e.current,r==null)i=null;else{for(l=1,o=0,s=0;!0;){for(t=r,r=null,c=null,h=0;t!=null;){for(++h,n=t,o=0,g=0,v=l;g<v;)if(b=g++,++o,n=n.next,n==null)break;for(s=l;o>0||s>0&&n!=null;)o==0?(a=n,n=n.next,--s):(s==0||n==null?m=!0:(t.pass.layer!=n.pass.layer?f=t.pass.layer-n.pass.layer:(p=d.shaderIdMap[t.shader.id]-d.shaderIdMap[n.shader.id],f=p!=0?p:d.textureIdMap[t.texture]-d.textureIdMap[n.texture]),m=f<=0),m?(a=t,t=t.next,--o):(a=n,n=n.next,--s)),c!=null?c.next=a:r=a,c=a;t=n}if(c.next=null,h<=1)break;l*=2}i=r}e.current=i},__class__:Jr},bt=function(){this.refCount=0,this.forcedLod=-1},c["h3d.prim.Primitive"]=bt,bt.__name__="h3d.prim.Primitive",bt.prototype={triCount:function(){return this.indexes!=null?this.indexes.vertices/3|0:this.buffer==null?0:this.buffer.vertices/3|0},vertexCount:function(){return 0},getCollider:function(){throw t.thrown("not implemented for "+o.string(this))},getBounds:function(){throw t.thrown("not implemented for "+o.string(this))},incref:function(){this.refCount++},decref:function(){this.refCount--,this.refCount<=0&&(this.refCount=0,this.dispose())},alloc:function(){throw t.thrown("not implemented")},selectMaterial:function(){},getMaterialIndexes:function(e,t){return t==null&&(t=0),t!=0?{start:0,count:0}:{start:this.getMaterialIndexStart(e,t),count:this.getMaterialIndexCount(e,t)}},getMaterialIndexStart:function(e,t){return t==null&&(t=0),0},getMaterialIndexCount:function(e,t){return t==null&&(t=0),this.indexes==null?this.triCount()*3:this.indexes.vertices},buildNormalsDisplay:function(){throw t.thrown("not implemented for "+o.string(this))},render:function(e){if((this.buffer==null||this.buffer.vbuf==null)&&this.alloc(e),this.indexes==null){var t=this.buffer;e.renderBuffer(t,e.mem.getTriIndexes(t.vertices),3,0,-1)}else e.renderIndexed(this.buffer,this.indexes)},dispose:function(){this.buffer!=null&&(this.buffer.dispose(),this.buffer=null),this.indexes!=null&&(this.indexes.dispose(),this.indexes=null)},toString:function(){var e=H.getClass(this);return e.__name__.split(".").pop()},lodCount:function(){return 1},screenRatioToLod:function(){return 0},__class__:bt},nn=function(e,n){if(this.isStatic=!0,this.hasTangents=!1,this.startIndex=0,this.idxPos=0,this.bufPos=0,bt.call(this),this.format=e,this.buffers=[],this.allIndexes=[],this.bounds=new Ce,this.allocator=n,e.stride<3)throw t.thrown("Minimum stride = 3");this.allocPos=wn.make()},c["h3d.prim.BigPrimitive"]=nn,nn.__name__="h3d.prim.BigPrimitive",nn.__super__=bt,nn.prototype=g(bt.prototype,{begin:function(e,n){if(this.startIndex=this.bufPos/this.format.stride|0,this.startIndex+e>=65535){if(e>=65535)throw t.thrown("Too many vertices in begin()");this.flush()}if(this.tmpBuf==null&&(this.tmpBuf=nn.PREV_BUFFER,this.tmpBuf==null?this.tmpBuf=Tt._new(0):nn.PREV_BUFFER=null,this.isStatic))for(var o,i,r,l,d,s=this.tmpBuf,a=s.pos,c=65535*this.format.stride;a<c;)l=a++,s.pos==s.array.length&&(o=s.array.length<<1,o<128&&(o=128),i=new Float32Array(o),i.set(s.array),s.array=i),s.array[s.pos++]=0;if(!this.isStatic)for(s=this.tmpBuf,a=s.pos,c=e*this.format.stride+this.bufPos;a<c;)l=a++,s.pos==s.array.length&&(o=s.array.length<<1,o<128&&(o=128),i=new Float32Array(o),i.set(s.array),s.array=i),s.array[s.pos++]=0;if(this.tmpIdx==null&&(this.tmpIdx=nn.PREV_INDEX,this.tmpIdx==null?this.tmpIdx=new Array(0):nn.PREV_INDEX=null),this.idxPos+n>this.tmpIdx.length){for(r=this.tmpIdx.length==0?1024:this.tmpIdx.length,d=this.idxPos+n;r<d;)r<<=1;for(s=this.tmpIdx;s.length<r;)s.push(0)}},addPoint:function(e,t,n){this.tmpBuf.array[this.bufPos++]=e,this.tmpBuf.array[this.bufPos++]=t,this.tmpBuf.array[this.bufPos++]=n;var s=this.bounds;e<s.xMin&&(s.xMin=e),e>s.xMax&&(s.xMax=e),t<s.yMin&&(s.yMin=t),t>s.yMax&&(s.yMax=t),n<s.zMin&&(s.zMin=n),n>s.zMax&&(s.zMax=n)},addBounds:function(e,t,n){var s=this.bounds;e<s.xMin&&(s.xMin=e),e>s.xMax&&(s.xMax=e),t<s.yMin&&(s.yMin=t),t>s.yMax&&(s.yMax=t),n<s.zMin&&(s.zMin=n),n>s.zMax&&(s.zMax=n)},addVertexValue:function(e){this.tmpBuf.array[this.bufPos++]=e},addIndex:function(e){this.tmpIdx[this.idxPos++]=e+this.startIndex},triCount:function(){for(var s,e=0,t=0,n=this.allIndexes;t<n.length;)s=n[t],++t,e+=s.vertices;return e+=this.idxPos,e/3|0},vertexCount:function(){for(var s,e=0,t=0,n=this.buffers;t<n.length;)s=n[t],++t,e+=s.vertices;return e+=this.bufPos/this.format.stride|0,e},flush:function(){if(this.tmpBuf!=null){if(this.bufPos>0&&this.idxPos>0){this.flushing=!0,this.allocator!=null?e=this.allocator.ofSubFloats(this.tmpBuf,this.bufPos/this.format.stride|0,this.format):e=wt.ofSubFloats(this.tmpBuf,this.bufPos/this.format.stride|0,this.format),this.buffers.push(e);var e,n,t=this.allocator!=null?this.allocator.ofIndexes(this.tmpIdx,this.idxPos):rn.alloc(this.tmpIdx,0,this.idxPos);this.allIndexes.push(t),this.flushing=!1,e.allocPos=this.allocPos,n=t,n.allocPos=this.allocPos}(nn.PREV_BUFFER==null||nn.PREV_BUFFER.pos<this.tmpBuf.pos)&&(nn.PREV_BUFFER=this.tmpBuf),(nn.PREV_INDEX==null||nn.PREV_INDEX.length<this.tmpIdx.length)&&(nn.PREV_INDEX=this.tmpIdx),this.tmpBuf=null,this.tmpIdx=null,this.bufPos=0,this.idxPos=0,this.startIndex=0}},render:function(e){this.tmpBuf!=null&&this.flush();for(var t,n=0,s=this.buffers.length;n<s;)t=n++,e.renderIndexed(this.buffers[t],this.allIndexes[t])},getBounds:function(){return this.bounds},dispose:function(){this.clear()},clear:function(){if(this.flushing)throw t.thrown("Cannot clear() BigPrimitive while it's flushing");var e,s,o,i,n=this.bounds;for(n.xMin=1e20,n.xMax=-1e20,n.yMin=1e20,n.yMax=-1e20,n.zMin=1e20,n.zMax=-1e20,e=0,s=this.buffers;e<s.length;)o=s[e],++e,this.allocator!=null?this.allocator.disposeBuffer(o):o.dispose();for(e=0,s=this.allIndexes;e<s.length;)i=s[e],++e,this.allocator!=null?this.allocator.disposeIndexBuffer(i):i.dispose();this.buffers=[],this.allIndexes=[],this.bufPos=0,this.idxPos=0,this.tmpBuf=null,this.tmpIdx=null},add:function(e,t,n,s,o,i,a,r){r==null&&(r=-1),a==null&&(a=1),i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),this.addSub(e,t,0,0,e.pos/(r<0?this.format.stride:r)|0,t.length/3|0,n,s,o,i,a,r)},addSub:function(e,n,s,o,i,a,r,c,l,d,u,h,m,f,p,g){if(p==null&&(p=1),f==null&&(f=0),m==null&&(m=0),h==null&&(h=-1),u==null&&(u=1),d==null&&(d=0),l==null&&(l=0),c==null&&(c=0),r==null&&(r=0),h<0&&(h=this.format.stride),h<this.format.stride)throw t.thrown("only stride >= "+this.format.stride+" allowed");this.begin(i,a*3);for(var j,V,$,W,me,ae,ie,oe,te,C,E,k,q,Y,_e,Oe,Te,y,Se,xe,_,z,L,R,P,G,X,ue,Z,J,ee,I,ne,se,A,S,M,ve,je,we,T,Ae,Ne,de,B,pe,le,ce,re,w,O,x,U,K,Q,Ce,Ee,ke,be,F,Me,Fe,fe,ze,Pe,he,Le,Re,De,ye=this.startIndex,N=Math.cos(d),D=Math.sin(d),v=this.bufPos,b=this.tmpBuf,H=0,ge=i;H<ge;)switch(V=H++,j=(V+s)*h,$=e.array[j++],W=e.array[j++],me=e.array[j++],g!=null?(ae=$,ie=W,oe=me,oe==null&&(oe=0),ie==null&&(ie=0),ae==null&&(ae=0),te=ae,Y=ie,q=oe,q==null&&(q=0),Y==null&&(Y=0),te==null&&(te=0),E=te,C=Y,k=q,_e=E*g._11+C*g._21+k*g._31+g._41,Oe=E*g._12+C*g._22+k*g._32+g._42,Te=E*g._13+C*g._23+k*g._33+g._43,E=_e,C=Oe,k=Te,b.array[v++]=E,b.array[v++]=C,b.array[v++]=k,y=this.bounds,E<y.xMin&&(y.xMin=E),E>y.xMax&&(y.xMax=E),C<y.yMin&&(y.yMin=C),C>y.yMax&&(y.yMax=C),k<y.zMin&&(y.zMin=k),k>y.zMax&&(y.zMax=k)):(Se=($*N-W*D)*u,xe=($*D+W*N)*u,P=r+Se,R=c+xe,L=l+me*u,b.array[v++]=P,b.array[v++]=R,b.array[v++]=L,_=this.bounds,P<_.xMin&&(_.xMin=P),P>_.xMax&&(_.xMax=P),R<_.yMin&&(_.yMin=R),R>_.yMax&&(_.yMax=R),L<_.zMin&&(_.zMin=L),L>_.zMax&&(_.zMax=L)),z=this.format.stride,z>=6&&(G=e.array[j++],X=e.array[j++],ue=e.array[j++],g!=null?(Z=G,J=X,ee=ue,ee==null&&(ee=0),J==null&&(J=0),Z==null&&(Z=0),I=Z,ne=J,se=ee,se==null&&(se=0),ne==null&&(ne=0),I==null&&(I=0),M=I,S=ne,A=se,ve=M*g._11+S*g._21+A*g._31,je=M*g._12+S*g._22+A*g._32,we=M*g._13+S*g._23+A*g._33,M=ve,S=je,A=we,T=M*M+S*S+A*A,T<1e-20?T=0:T=1/Math.sqrt(T),M*=T,S*=T,A*=T,b.array[v++]=M,b.array[v++]=S,b.array[v++]=A):(Ae=G*N-X*D,Ne=G*D+X*N,b.array[v++]=Ae,b.array[v++]=Ne,b.array[v++]=ue)),this.hasTangents&&(de=e.array[j++],B=e.array[j++],pe=e.array[j++],g!=null?(le=de,ce=B,re=pe,re==null&&(re=0),ce==null&&(ce=0),le==null&&(le=0),Q=le,K=ce,U=re,U==null&&(U=0),K==null&&(K=0),Q==null&&(Q=0),O=Q,w=K,x=U,Ce=O*O+w*w+x*x,Ee=O*g._11+w*g._21+x*g._31,ke=O*g._12+w*g._22+x*g._32,be=O*g._13+w*g._23+x*g._33,O=Ee,w=ke,x=be,F=O*O+w*w+x*x,F<1e-20?F=0:F=1/Math.sqrt(F),O*=F,w*=F,x*=F,Ce<.5&&(O*=.5,w*=.5,x*=.5),b.array[v++]=O,b.array[v++]=w,b.array[v++]=x):(Me=de*N-B*D,Fe=de*D+B*N,b.array[v++]=Me,b.array[v++]=Fe,b.array[v++]=pe),z-=3),z){case 3:case 6:continue;case 4:case 7:b.array[v++]=e.array[j++]+m;break;case 5:case 8:case 9:case 10:for(b.array[v++]=e.array[j++]+m,b.array[v++]=e.array[j++]+f,fe=8,ze=z;fe<ze;)Pe=fe++,b.array[v++]=e.array[j++];break;default:for(b.array[v++]=e.array[j++]+m,b.array[v++]=e.array[j++]+f,b.array[v++]=e.array[j++]*p,b.array[v++]=e.array[j++]*p,b.array[v++]=e.array[j++]*p,he=11,Le=z;he<Le;)Re=he++,b.array[v++]=e.array[j++]}for(this.bufPos=v,ye-=s,H=0,ge=a*3;H<ge;)V=H++,De=n[V+o*3]+ye,this.tmpIdx[this.idxPos++]=De},__class__:nn}),Xr=function(e){if(this.shapesBytes=[],this.inputMapping=[],this.hmdModel=e,e.get_data().vertexFormat.hasLowPrecision)throw t.thrown("Blend shape doesn't support low precision");for(var n,s,i,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,S,M,F,z,D,N,L,R=e.get_data().vertexFormat,T=0,o=0,a=e.lib.header.geometries;o<a.length;)F=a[o],L=o++,z=L,N=F,N==e.get_data()&&(T=z);for(n=[],s=0,c=e.lib.header.shapes;s<c.length;)i=c[s],++s,i.geom==T&&n.push(i);for(this.shapes=n,n=0,s=this.shapes.length;n<s;)i=n++,f=this.shapes[i],u=f.vertexCount*f.vertexFormat.strideBytes,w=new A(new ArrayBuffer(u)),e.lib.resource.entry.readBytes(w,0,e.dataPosition+f.vertexPosition,u),u=e.get_data().vertexCount<<2,k=new A(new ArrayBuffer(u)),e.lib.resource.entry.readBytes(k,0,e.dataPosition+f.remapPosition,u),this.shapesBytes.push({vertexBytes:w,remapBytes:k}),this.inputMapping.push(new fe);for(o=0,a=R.inputs;o<a.length;)for(r=a[o++],n=0,s=this.shapes.length;n<s;)for(i=n++,m=0,y=0,_=this.shapes[i].vertexFormat.inputs;y<_.length;)j=_[y++],j.name==r.name&&(this.inputMapping[i].h[j.name]=m),d=j.type,m+=d==H.__cast(9,St)?1:d;for(this.weightsBuffer=Ut.get().allocFloats(this.shapes.length),this.offsetsBuffer=Ut.get().allocFloats(3*e.get_data().vertexCount*this.shapes.length),x=31,C=0,n=0,s=this.shapes.length;n<s;)for(l=n++,v=this.shapesBytes[l],b=0,h=0;b<this.shapes[l].indexCount;){for(p=v.remapBytes.getInt32(h<<2),g=!1;!g;){for(g=p>>x!=0,g&&(p^=1<<x),M=0,S=0,o=0,a=this.shapes[l].vertexFormat.inputs;o<a.length;){for(r=a[o++],c=0,d=r.type,D=d==H.__cast(9,St)?1:d;c<D;){if(E=c++,r.name!="position")continue;m=v.vertexBytes.getFloat(b*this.shapes[l].vertexFormat.stride+S+E<<2),C=l*e.get_data().vertexCount*3+p*3+E,this.offsetsBuffer.array[C]=m}O=r.type,S+=O==H.__cast(9,St)?1:O,++M}++h,h<e.get_data().vertexCount&&(p=v.remapBytes.getInt32(h<<2))}++b}},c["h3d.prim.Blendshape"]=Xr,Xr.__name__="h3d.prim.Blendshape",Xr.prototype={setBlendShapeWeight:function(e,t,n,s){s==null&&(s=!0);for(var o,i,r,c,l,h,m,d=Ut.get(),a=0,u=e.getMaterials(null,!1);a<u.length;){for(r=u[a],++a,o=null,c=r.passes,i=c.shaders,h=c.parentShaders;i!=h;)if(m=i.s,i=i.next,l=m,l instanceof Ts){o=l;break}o==null&&(o=new Ts,o.shapeCount__=this.shapes.length,o.vcount__=this.hmdModel.get_data().vertexCount,o.offsets__=d.ofFloats(this.offsetsBuffer,y.get_POS3D(),3),o.weights__=d.ofFloats(this.weightsBuffer,y.get_INDEX32(),3),r.passes.addShader(o)),this.weightsBuffer.array[t]=n,o.weights__.uploadFloats(this.weightsBuffer,0,this.shapes.length,0)}},getBlendShapeIndex:function(e){for(var s,o,i,a,t=0,n=this.shapes;t<n.length;)if(s=n[t],o=t++,i=o,a=s,a.name==e)return i;return-1},getBlendshapeCount:function(){return this.hmdModel.lib.header.shapes==null?0:this.shapes.length},__class__:Xr},na=function(e,t){this.hmdModel=e,this.data=t},c["h3d.prim.Collider"]=na,na.__name__="h3d.prim.Collider",na.fromHmd=function(e){for(var s,t=e.lib.header,n=0,o=t.models;n<o.length;)if(s=o[n],++n,t.geometries[s.geometry]==e.get_data())return new na(e,t.colliders[s.collider]);return null},na.prototype={getBuffers:function(){for(var e,t,n,s,o,i,a,r,c,l,d,u,h,m,f,p,j,y,w,g=this.hmdModel.dataPosition+this.data.vertexPosition,v=this.hmdModel.dataPosition+this.data.indexPosition,b=[],_=0,O=this.data.vertexCounts.length;_<O;){for(h=_++,n=this.data.vertexCounts[h],t=this.data.indexCounts[h],a=n>65536,i=n*3*4,d=new A(new ArrayBuffer(i)),this.hmdModel.lib.resource.entry.readBytes(d,0,g,i),e=new Ea,e.vertexes=new Array(3*n),r=0,y=3*n;r<y;)f=r++,e.vertexes[f]=d.getFloat(f*4);if(o=t*(a?4:2),s=new A(new ArrayBuffer(o)),this.hmdModel.lib.resource.entry.readBytes(s,0,v,o),e.indexes=new Array(t),c=a?4:2,a)for(p=0,j=t;p<j;)m=p++,e.indexes[m]=s.getInt32(m*c);else for(u=0,w=t;u<w;)l=u++,e.indexes[l]=s.getUInt16(l*c);b.push(e),g+=i,v+=o}return b},__class__:na},Pn=function(){bt.call(this)},c["h3d.prim.MeshPrimitive"]=Pn,Pn.__name__="h3d.prim.MeshPrimitive",Pn.__super__=bt,Pn.prototype=g(bt.prototype,{hasInput:function(e){return this.resolveBuffer(e)!=null},resolveBuffer:function(e){if(this.buffers!=null){for(var n,t=0,s=this.buffers;t<s.length;)if(n=s[t],++t,n.format.hasInput(e))return n;return null}return this.buffer!=null&&this.buffer.format.hasInput(e)?this.buffer:null},removeBuffer:function(e){this.buffers!=null?(u.remove(this.buffers,e),e==this.buffer&&(this.buffer=this.buffers[this.buffers.length-1]),this.buffers.length==1&&(this.buffers=null,this.formats=null)):this.buffer==e&&(this.buffer=null)},addBuffer:function(e){if(this.buffer==null)this.buffer=e;else{if(this.buffers==null){if(e==this.buffer)throw t.thrown("Duplicate addBuffer()");this.buffers=[this.buffer]}else if(this.buffers.indexOf(e)>=0)throw t.thrown("Duplicate addBuffer()");this.buffers.unshift(e);for(var i,s=[],n=0,o=this.buffers;n<o.length;)i=o[n],++n,s.push(i.format);this.formats=Ln.make(s)}},dispose:function(){if(bt.prototype.dispose.call(this),this.buffers!=null){for(var n,e=0,t=this.buffers;e<t.length;)n=t[e],++e,n.dispose();this.buffers=null,this.formats=null}},render:function(e){(this.indexes==null||this.indexes.vbuf==null||this.buffer==null||this.buffer.vbuf==null)&&this.alloc(e),this.buffers!=null?e.renderMultiBuffers(this.formats,this.buffers,this.indexes):e.renderIndexed(this.buffer,this.indexes)},__class__:Pn}),tn=function(e,t){this.translatedZ=0,this.translatedY=0,this.translatedX=0,this.scaled=1,Pn.call(this),this.points=e,this.idx=t},c["h3d.prim.Polygon"]=tn,tn.__name__="h3d.prim.Polygon",tn.__super__=Pn,tn.prototype=g(Pn.prototype,{getBounds:function(){for(var t,e=new Ce,n=0,s=this.points;n<s.length;)t=s[n],++n,t.x<e.xMin&&(e.xMin=t.x),t.x>e.xMax&&(e.xMax=t.x),t.y<e.yMin&&(e.yMin=t.y),t.y>e.yMax&&(e.yMax=t.y),t.z<e.zMin&&(e.zMin=t.z),t.z>e.zMax&&(e.zMax=t.z);return e},alloc:function(){this.dispose();var t,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,B,V,$,W,U,K,q,Y,G,X,Q,Z,J,n=y.get_POS3D();for(this.normals!=null&&(n=n.append("normal",3)),this.tangents!=null&&(n=n.append("tangent",3)),this.uvs!=null&&(n=n.append("uv",2)),this.colors!=null&&(n=n.append("color",3)),t=Tt._new(0),A=0,G=this.points.length;A<G;)s=A++,a=this.points[s],K=a.x,t.pos==t.array.length&&(c=t.array.length<<1,c<128&&(c=128),D=new Float32Array(c),D.set(t.array),t.array=D),t.array[t.pos++]=K,V=a.y,t.pos==t.array.length&&(o=t.array.length<<1,o<128&&(o=128),M=new Float32Array(o),M.set(t.array),t.array=M),t.array[t.pos++]=V,$=a.z,t.pos==t.array.length&&(f=t.array.length<<1,f<128&&(f=128),O=new Float32Array(f),O.set(t.array),t.array=O),t.array[t.pos++]=$,this.normals!=null&&(g=this.normals[s],q=g.x,t.pos==t.array.length&&(b=t.array.length<<1,b<128&&(b=128),S=new Float32Array(b),S.set(t.array),t.array=S),t.array[t.pos++]=q,J=g.y,t.pos==t.array.length&&(w=t.array.length<<1,w<128&&(w=128),C=new Float32Array(w),C.set(t.array),t.array=C),t.array[t.pos++]=J,I=g.z,t.pos==t.array.length&&(u=t.array.length<<1,u<128&&(u=128),E=new Float32Array(u),E.set(t.array),t.array=E),t.array[t.pos++]=I),this.tangents!=null&&(_=this.tangents[s],Z=_.x,t.pos==t.array.length&&(j=t.array.length<<1,j<128&&(j=128),x=new Float32Array(j),x.set(t.array),t.array=x),t.array[t.pos++]=Z,X=_.y,t.pos==t.array.length&&(v=t.array.length<<1,v<128&&(v=128),z=new Float32Array(v),z.set(t.array),t.array=z),t.array[t.pos++]=X,W=_.z,t.pos==t.array.length&&(i=t.array.length<<1,i<128&&(i=128),L=new Float32Array(i),L.set(t.array),t.array=L),t.array[t.pos++]=W),this.uvs!=null&&(R=this.uvs[s],H=R.u,t.pos==t.array.length&&(h=t.array.length<<1,h<128&&(h=128),P=new Float32Array(h),P.set(t.array),t.array=P),t.array[t.pos++]=H,B=R.v,t.pos==t.array.length&&(d=t.array.length<<1,d<128&&(d=128),N=new Float32Array(d),N.set(t.array),t.array=N),t.array[t.pos++]=B),this.colors!=null&&(l=this.colors[s],U=l.x,t.pos==t.array.length&&(r=t.array.length<<1,r<128&&(r=128),T=new Float32Array(r),T.set(t.array),t.array=T),t.array[t.pos++]=U,Y=l.y,t.pos==t.array.length&&(m=t.array.length<<1,m<128&&(m=128),F=new Float32Array(m),F.set(t.array),t.array=F),t.array[t.pos++]=Y,Q=l.z,t.pos==t.array.length&&(p=t.array.length<<1,p<128&&(p=128),k=new Float32Array(p),k.set(t.array),t.array=k),t.array[t.pos++]=Q);this.buffer=wt.ofFloats(t,n),this.idx!=null&&(this.indexes=rn.alloc(this.idx))},unindex:function(){if(this.idx!=null&&this.points.length!=this.idx.length){for(var e,t,n,s,i,r,c,l=[],o=0,a=this.idx.length;o<a;)i=o++,e=this.points[this.idx[i]],t=e.x,n=e.y,s=e.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),l.push(new h(t,n,s));if(this.normals!=null){for(r=[],o=0,a=this.idx.length;o<a;)i=o++,e=this.normals[this.idx[i]],t=e.x,n=e.y,s=e.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),r.push(new h(t,n,s));this.normals=r}if(this.tangents!=null){for(c=[],o=0,a=this.idx.length;o<a;)i=o++,e=this.tangents[this.idx[i]],t=e.x,n=e.y,s=e.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),c.push(new h(t,n,s));this.tangents=c}if(this.colors!=null){for(r=[],o=0,a=this.idx.length;o<a;)i=o++,e=this.colors[this.idx[i]],t=e.x,n=e.y,s=e.z,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),r.push(new h(t,n,s));this.colors=r}if(this.uvs!=null){for(c=[],o=0,a=this.idx.length;o<a;)i=o++,c.push(this.uvs[this.idx[i]].clone());this.uvs=c}this.points=l,this.idx=null}},translate:function(e,t,n){this.translatedX+=e,this.translatedY+=t,this.translatedZ+=n;for(var s,o=0,i=this.points;o<i.length;)s=i[o],++o,s.x+=e,s.y+=t,s.z+=n},scale:function(e){this.scaled*=e;for(var t,n=0,s=this.points;n<s.length;)t=s[n],++n,t.x*=e,t.y*=e,t.z*=e},addNormals:function(){this.normals=[];for(var e,t,s,o,a,r,c,l,d,u,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,n=0,i=this.points.length;n<i;)H=n++,this.normals[H]=new h(0,0,0);for(e=0,n=0,i=this.triCount();n<i;)H=n++,this.idx==null?(++e,a=e-1,++e,r=e-1,++e,c=e-1):(a=this.idx[e++],r=this.idx[e++],c=this.idx[e++]),o=this.points[a],v=this.points[r],_=this.points[c],T=v.x-o.x,u=v.y-o.y,m=v.z-o.z,m==null&&(m=0),u==null&&(u=0),T==null&&(T=0),f=T,p=u,g=m,g==null&&(g=0),p==null&&(p=0),f==null&&(f=0),P=f,R=p,L=g,y=_.x-o.x,l=_.y-o.y,w=_.z-o.z,w==null&&(w=0),l==null&&(l=0),y==null&&(y=0),O=y,x=l,C=w,C==null&&(C=0),x==null&&(x=0),O==null&&(O=0),N=O,D=x,z=C,S=R*z-L*D,M=L*N-P*z,F=P*D-R*N,F==null&&(F=0),M==null&&(M=0),S==null&&(S=0),d=S,A=M,k=F,k==null&&(k=0),A==null&&(A=0),d==null&&(d=0),E=d,j=A,b=k,this.normals[a].x+=E,this.normals[a].y+=j,this.normals[a].z+=b,this.normals[r].x+=E,this.normals[r].y+=j,this.normals[r].z+=b,this.normals[c].x+=E,this.normals[c].y+=j,this.normals[c].z+=b;for(n=0,i=this.normals;n<i.length;)I=i[n],++n,t=I,s=t.x*t.x+t.y*t.y+t.z*t.z,s<1e-20?s=0:s=1/Math.sqrt(s),t.x*=s,t.y*=s,t.z*=s},addTangents:function(){this.normals==null&&this.addNormals(),this.uvs==null&&this.addUVs(),this.tangents=[];for(var e,t,n,s,o,a,c,l,d,u,m,f,p,v,b,_,F,K,Z,ee,r,j,y,w,O,x,C,E,k,A,S,M,T,z,D,N,L,R,P,H,I,B,V,$,W,U,q,Y,G,X,Q,J,i=0,g=this.points.length;i<g;)Z=i++,this.tangents[Z]=new h(0,0,0);for(o=0,i=0,g=this.triCount();i<g;)Z=i++,this.idx==null?(++o,a=o-1,++o,u=o-1,++o,d=o-1):(a=this.idx[o++],u=this.idx[o++],d=this.idx[o++]),l=this.points[a],_=this.points[u],F=this.points[d],K=this.uvs[a],ee=this.uvs[u],J=this.uvs[d],r=this.normals[a],H=_.x-l.x,P=_.y-l.y,k=_.z-l.z,k==null&&(k=0),P==null&&(P=0),H==null&&(H=0),L=H,j=P,y=k,y==null&&(y=0),j==null&&(j=0),L==null&&(L=0),Q=L,X=j,G=y,x=F.x-l.x,C=F.y-l.y,E=F.z-l.z,E==null&&(E=0),C==null&&(C=0),x==null&&(x=0),v=x,A=C,S=E,S==null&&(S=0),A==null&&(A=0),v==null&&(v=0),Y=v,q=A,U=S,z=J.v-K.v,Q*=z,X*=z,G*=z,D=ee.v-K.v,Y*=D,q*=D,U*=D,N=Q-Y,b=X-q,R=G-U,R==null&&(R=0),b==null&&(b=0),N==null&&(N=0),e=new h(N,b,R),t=r,I=t.y*e.z-t.z*e.y,B=t.z*e.x-t.x*e.z,V=t.x*e.y-t.y*e.x,V==null&&(V=0),B==null&&(B=0),I==null&&(I=0),$=I,W=B,T=V,T==null&&(T=0),W==null&&(W=0),$==null&&($=0),p=$,f=W,m=T,n=p*p+f*f+m*m,n<1e-20?n=0:n=1/Math.sqrt(n),p*=n,f*=n,m*=n,M=f*r.z-m*r.y,O=m*r.x-p*r.z,w=p*r.y-f*r.x,w==null&&(w=0),O==null&&(O=0),M==null&&(M=0),e=new h(M,O,w),s=e,c=s.x*s.x+s.y*s.y+s.z*s.z,c<1e-20?c=0:c=1/Math.sqrt(c),s.x*=c,s.y*=c,s.z*=c,this.tangents[a].x+=e.x,this.tangents[a].y+=e.y,this.tangents[a].z+=e.z,this.tangents[u].x+=e.x,this.tangents[u].y+=e.y,this.tangents[u].z+=e.z,this.tangents[d].x+=e.x,this.tangents[d].y+=e.y,this.tangents[d].z+=e.z;for(i=0,g=this.tangents;i<g.length;)e=g[i],++i,t=e,n=t.x*t.x+t.y*t.y+t.z*t.z,n<1e-20?n=0:n=1/Math.sqrt(n),t.x*=n,t.y*=n,t.z*=n},addUVs:function(){this.uvs=[];for(var e,t=0,n=this.points.length;t<n;)e=t++,this.uvs[e]=new oe(this.points[e].x,this.points[e].y)},uvScale:function(e,n){if(this.uvs==null)throw t.thrown("Missing UVs");for(var s,i=new Rt,o=0,a=this.uvs;o<a.length;){if(s=a[o],++o,i.h.__keys__[s.__id__]!=null)continue;i.set(s,!0),s.u*=e,s.v*=n}},triCount:function(){var e=Pn.prototype.triCount.call(this);return e!=0?e:(this.idx==null?this.points.length:this.idx.length)/3|0},vertexCount:function(){return this.points.length},getCollider:function(){for(var s,i,a,t=new Array(this.points.length*3),r=new Array(this.idx.length),o=0,e=0,n=this.points;e<n.length;)s=n[e],++e,t[o++]=s.x,t[o++]=s.y,t[o++]=s.z;for(e=0,n=this.idx.length;e<n;)i=e++,r[i]=this.idx[i];return a=new No,a.addBuffers(t,r),a},render:function(e){(this.buffer==null||this.buffer.vbuf==null)&&this.alloc(e);var t=this.indexes,n=this.triCount();t==null&&(t=e.mem.getTriIndexes(n*3)),this.buffers!=null?e.renderMultiBuffers(this.formats,this.buffers,t,0,n):e.renderIndexed(this.buffer,t,0,n)},__class__:tn}),Zn=function(e,t,n,s){s==null&&(s=!1),n==null&&(n=1),t==null&&(t=1),e==null&&(e=1),this.sizeX=e,this.sizeY=t,this.sizeZ=n;var o,c,l,d,u,m,f,p,g,i=0,a=0,r=0;r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),c=new h(i,a,r),i=e,a=0,r=0,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),l=new h(i,a,r),i=0,a=t,r=0,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),d=new h(i,a,r),i=0,a=0,r=n,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),u=new h(i,a,r),i=e,a=t,r=0,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),m=new h(i,a,r),i=e,a=0,r=n,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),f=new h(i,a,r),i=0,a=t,r=n,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),p=new h(i,a,r),i=e,a=t,r=n,r==null&&(r=0),a==null&&(a=0),i==null&&(i=0),g=[c,l,d,u,m,f,p,new h(i,a,r)],o=new Array(0),o.push(0),o.push(1),o.push(5),o.push(0),o.push(5),o.push(3),o.push(1),o.push(4),o.push(7),o.push(1),o.push(7),o.push(5),o.push(3),o.push(5),o.push(7),o.push(3),o.push(7),o.push(6),o.push(0),o.push(6),o.push(2),o.push(0),o.push(3),o.push(6),o.push(2),o.push(7),o.push(4),o.push(2),o.push(6),o.push(7),o.push(0),o.push(4),o.push(1),o.push(0),o.push(2),o.push(4),tn.call(this,g,o),s&&this.translate(-e*.5,-t*.5,-n*.5)},c["h3d.prim.Cube"]=Zn,Zn.__name__="h3d.prim.Cube",Zn.defaultUnitCube=function(){var t=K.CURRENT,e=t.resCache.h[Zn.__id__];return e??(e=new Zn(1,1,1),e.translate(-.5,-.5,-.5),e.unindex(),e.addNormals(),e.addUniformUVs(1),e.addTangents(),t.resCache.set(Zn,e),e)},Zn.__super__=tn,Zn.prototype=g(tn.prototype,{addUVs:function(){this.unindex();var e=new oe(0,1),t=new oe(1,1),n=new oe(0,0),s=new oe(1,0);this.uvs=[t,e,n,t,n,s,t,e,n,t,n,s,t,e,n,t,n,s,e,s,t,e,n,s,e,s,t,e,n,s,e,s,t,e,n,s]},addUniformUVs:function(e){e==null&&(e=1),this.unindex();var t=e;this.uvs=[new oe(t*this.sizeX,t*this.sizeZ),new oe(0,t*this.sizeZ),new oe(0,0),new oe(t*this.sizeX,t*this.sizeZ),new oe(0,0),new oe(t*this.sizeX,0),new oe(t*this.sizeY,t*this.sizeZ),new oe(0,t*this.sizeZ),new oe(0,0),new oe(t*this.sizeY,t*this.sizeZ),new oe(0,0),new oe(t*this.sizeY,0),new oe(t*this.sizeX,t*this.sizeY),new oe(0,t*this.sizeY),new oe(0,0),new oe(t*this.sizeX,t*this.sizeY),new oe(0,0),new oe(t*this.sizeX,0),new oe(0,t*this.sizeZ),new oe(t*this.sizeY,0),new oe(t*this.sizeY,t*this.sizeZ),new oe(0,t*this.sizeZ),new oe(0,0),new oe(t*this.sizeY,0),new oe(0,t*this.sizeZ),new oe(t*this.sizeX,0),new oe(t*this.sizeX,t*this.sizeZ),new oe(0,t*this.sizeZ),new oe(0,0),new oe(t*this.sizeX,0),new oe(0,t*this.sizeY),new oe(t*this.sizeX,0),new oe(t*this.sizeX,t*this.sizeY),new oe(0,t*this.sizeY),new oe(0,0),new oe(t*this.sizeX,0)]},getCollider:function(){var t=this.translatedX,n=this.translatedY,s=this.translatedZ,o=this.sizeX*this.scaled,i=this.sizeY*this.scaled,a=this.sizeZ*this.scaled,e=new Ce;return e.xMin=t,e.yMin=n,e.zMin=s,e.xMax=t+o,e.yMax=n+i,e.zMax=s+a,e},__class__:Zn}),Mo=function(e,t,n,s){if(this.lodConfig=null,Pn.call(this),this.lods=[e],s!=null)for(var i,o=0;o<s.length;)i=s[o],++o,this.lods.push(n.header.geometries[i.geometry]);this.dataPosition=t,this.lib=n,n.header.shapes!=null&&n.header.shapes.length>0&&(this.blendshape=new Xr(this)),n.header.colliders!=null&&n.header.colliders.length>0&&(this.colliderData=na.fromHmd(this))},c["h3d.prim.HMDModel"]=Mo,Mo.__name__="h3d.prim.HMDModel",Mo.__super__=Pn,Mo.prototype=g(Pn.prototype,{get_data:function(){return this.lods[0]},getPath:function(){return this.lib.resource.entry.get_path()},hasInput:function(e){return!!Pn.prototype.hasInput.call(this,e)||this.get_data().vertexFormat.hasInput(e)},triCount:function(){return this.get_data().get_indexCount()/3|0},vertexCount:function(){return this.get_data().vertexCount},getBounds:function(){return this.get_data().bounds},selectMaterial:function(e,t){this.curMaterial=e+t*this.get_data().indexCounts.length},getMaterialIndexStart:function(e,t){return t==null&&(t=0),this.indexesTriPos[e+t*this.get_data().indexCounts.length]*3},getMaterialIndexCount:function(e,t){return t==null&&(t=0),this.lods[t].indexCounts[e]},getDataBuffers:function(e,t,n){return this.getLodBuffers(e,0,t,n)},getLodBuffers:function(e,t,n,s){return this.lib.getBuffers(this.lods[t],e,n,s)},loadSkin:function(e){this.lib.loadSkin(this.get_data(),e)},alloc:function(e){this.dispose();var n,s,o,i,a,r,c,l,d,u,h,m,f,p,v,b,y,_,w,O,x,C,E,k,S,M,F,T,z,D,N,L,j=0,g=this.get_data().vertexFormat;for(this.indexCount=0,this.indexesTriPos=[],i=0,d=this.lods;i<d.length;)for(n=d[i],++i,j+=n.vertexCount,a=0,f=n.indexCounts;a<f.length;)N=f[a],++a,this.indexesTriPos.push(this.indexCount/3|0),this.indexCount+=N;for(this.buffer=new wt(j,g),p=j>65536,this.indexes=rn._new(this.indexCount,p),D=p?4:2,E=this.lib.resource.entry,s=0,O=0,v=0,y=this.lods;v<y.length;){if(z=y[v],k=v++,T=k,n=z,n.vertexFormat!=g){for(l="LOD"+T+" has a different vertex format, has ",_=0,w=n.vertexFormat.inputs;_<w.length;)F=w[_++],l+=F.name+" ";for(l+=", wants ",x=0,C=g.inputs;x<C.length;)M=C[x++],l+=M.name+" ";throw t.thrown(l)}if(b=n.vertexCount*g.strideBytes,S=E.fetchBytes(this.dataPosition+n.vertexPosition,b),e.driver.uploadBufferBytes(this.buffer,s,n.vertexCount,S,0),o=n.get_indexCount(),m=n.vertexCount>65536,b=(m?4:2)*o,r=E.fetchBytes(this.dataPosition+n.indexPosition,b),c=p!=m?new A(new ArrayBuffer(o*D)):r,p)for(i=0,d=o;i<d;)u=i++,m?c.setInt32(u<<2,r.getInt32(u<<2)+s):c.setInt32(u<<2,r.getUInt16(u<<1)+s);else for(a=0,f=o;a<f;)h=a++,m?c.setUInt16(h<<1,r.getInt32(h<<2)+s):c.setUInt16(h<<1,r.getUInt16(h<<1)+s);e.driver.uploadBufferBytes(this.indexes,O,o,c,0),s+=n.vertexCount,O+=o}this.normalsRecomputed!=null&&(L=this.normalsRecomputed,this.normalsRecomputed=null,this.recomputeNormals(L))},recomputeNormals:function(e){if(this.normalsRecomputed!=null)return;if(e!=null&&this.get_data().vertexFormat.hasInput(e))return;e==null&&(e="normal");for(var n,s,o,i,a,r,c,l,d,u,m,f,p,g,v,b,j,_,w,O,x,C,E,k,A,S,M,F,z,D,N,L,R,P,H,B,V,t=Tt._new(0),T=0,I=this.lods;T<I.length;){for(o=I[T],++T,i=this.lib.getBuffers(o,y.get_POS3D()),a=[],s=[],E={},k=0,L=o.vertexCount;k<L;){if(u=k++,D=!1,f=i.vertexes[u*3],p=i.vertexes[u*3+1],g=i.vertexes[u*3+2],F=(f+p+g)*10.01|0,n=E[F],n==null)n=[],E[F]=n;else for(j=0;j<n.length;)if(C=n[j],++j,w=s[C],w.x==f&&w.y==p&&w.z==g){a.push(C),D=!0;break}D||(a.push(s.length),n.push(s.length),r=f,c=p,_=g,_==null&&(_=0),c==null&&(c=0),r==null&&(r=0),s.push(new h(r,c,_)))}for(O=new Array(0),b=0,A=i.indexes;b<A.length;)R=A[b],++b,O.push(a[R]);for(M=new tn(s,O),M.addNormals(),v=t.pos,x=t.pos,N=o.vertexCount*3;x<N;)V=x++,t.pos==t.array.length&&(m=t.array.length<<1,m<128&&(m=128),z=new Float32Array(m),z.set(t.array),t.array=z),t.array[t.pos++]=0;for(d=0,S=0,P=o.vertexCount;S<P;)H=S++,l=M.normals[a[H]],t.array[v+d++]=l.x,t.array[v+d++]=l.y,t.array[v+d++]=l.z}B=wt.ofFloats(t,y.make([new ce(e,3,0)])),this.addBuffer(B),this.normalsRecomputed=e},addTangents:function(){if(this.hasInput("tangent"))return;for(var t,n,s,o,i,a,r,c,l,d,u,m,f,p,g,v,b,_,w,O,x,C,E,k,A,S,M,T,z,D,N,L,R,P,H,e=Tt._new(0),j=0,F=this.lods;j<F.length;){for(s=F[j],++j,o=this.lib.getBuffers(s,y.get_POS3D()),n=[],t=[],E=0,z=s.vertexCount;E<z;){for(l=E++,v=!1,M=o.vertexes[l*3],x=o.vertexes[l*3+1],w=o.vertexes[l*3+2],_=0,T=t.length;_<T;)if(S=_++,g=t[S],g.x==M&&g.y==x&&g.z==w){n.push(S),v=!0;break}v||(n.push(t.length),i=M,p=x,f=w,f==null&&(f=0),p==null&&(p=0),i==null&&(i=0),t.push(new h(i,p,f)))}for(O=new Array(0),m=0,C=o.indexes;m<C.length;)R=C[m],++m,O.push(n[R]);for(u=new tn(t,O),u.addNormals(),u.addTangents(),d=e.pos,b=e.pos,D=s.vertexCount*3;b<D;)H=b++,e.pos==e.array.length&&(a=e.array.length<<1,a<128&&(a=128),A=new Float32Array(a),A.set(e.array),e.array=A),e.array[e.pos++]=0;for(c=0,k=0,N=s.vertexCount;k<N;)L=k++,r=u.tangents[n[L]],e.array[d+c++]=r.x,e.array[d+c++]=r.y,e.array[d+c++]=r.z}P=wt.ofFloats(e,y.make([new ce("tangent",3,0)])),this.addBuffer(P)},render:function(e){if(this.curMaterial<0){Pn.prototype.render.call(this,e);return}var t=this.get_data().indexCounts.length,n=this.curMaterial/this.get_data().indexCounts.length|0;(this.indexes==null||this.indexes.vbuf==null)&&this.alloc(e),this.buffers==null?e.renderIndexed(this.buffer,this.indexes,this.indexesTriPos[this.curMaterial],this.lods[n].indexCounts[this.curMaterial%t]/3|0):e.renderMultiBuffers(this.formats,this.buffers,this.indexes,this.indexesTriPos[this.curMaterial],this.lods[n].indexCounts[this.curMaterial%t]/3|0),this.curMaterial=-1},initCollider:function(e){var n,s,o,i,a,r,u,h,m,p,t=this.get_data().bounds,f=t.xMax-t.xMin,d=t.yMax-t.yMin,l=t.zMax-t.zMin,c=new Is((t.xMin+t.xMax)*.5,(t.yMin+t.yMax)*.5,(t.zMin+t.zMax)*.5,Math.sqrt(f*f+d*d+l*l)*.5);if(this.colliderData==null)n=this.lib.getBuffers(this.get_data(),y.get_POS3D()),e.setData(n.vertexes,n.indexes),this.collider==null&&(this.collider=new fi(c,e));else{for(r=this.colliderData.getBuffers(),i=[],i.length=r.length,o=0,a=r;o<a.length;)u=a[o],h=o++,m=h,n=u,s=new Do,s.source=e.source,s.setData(n.vertexes,n.indexes),i[m]=s;p=new mi(i),this.collider=new fi(c,p)}},getCollider:function(){if(this.collider!=null)return this.collider;var e,n,s,t=new Do;for(t.source={entry:this.lib.resource.entry,geometryName:null},e=0,n=this.lib.header.models;e<n.length;)if(s=n[e],++e,this.lib.header.geometries[s.geometry]==this.get_data()){t.source.geometryName=s.name;break}return this.initCollider(t),this.collider},lodCount:function(){return this.lods.length},screenRatioToLod:function(e){var t,s,o,i,a,r,c,l,n=this.lodCount();if(this.forcedLod>=0)return o=this.forcedLod,o>n?n:o;if(n==1)return 0;if(t=this.getLodConfig(),t!=null){if(i=t.length>n-1,i&&e<t[t.length-1])return n;for(s=0,c=i?n-1:t.length,a=0,l=c;a<l;){if(r=a++,t[r]==0)return s;if(t[r]>e)++s;else break}return s}return 0},getLodConfig:function(){return this.lodConfig},__class__:Mo}),Va=function(){bt.call(this),this.bounds=new Ce;var e=this.bounds;0<e.xMin&&(e.xMin=0),0>e.xMax&&(e.xMax=0),0<e.yMin&&(e.yMin=0),0>e.yMax&&(e.yMax=0),0<e.zMin&&(e.zMin=0),0>e.zMax&&(e.zMax=0),this.tmpBounds=new Ce},c["h3d.prim.Instanced"]=Va,Va.__name__="h3d.prim.Instanced",Va.__super__=bt,Va.prototype=g(bt.prototype,{setMesh:function(e){this.refCount>0&&(this.primitive!=null&&this.primitive.decref(),e.incref()),this.primitive=e,this.baseBounds=e.getBounds(),(e.buffer==null||e.indexes==null)&&e.alloc(K.CURRENT)},initBounds:function(){var e=this.bounds;e.xMin=1e20,e.xMax=-1e20,e.yMin=1e20,e.yMax=-1e20,e.zMin=1e20,e.zMax=-1e20},addInstanceBounds:function(e){this.tmpBounds.load(this.baseBounds),this.tmpBounds.transform(e);var t=this.bounds,n=this.tmpBounds;n.xMin<t.xMin&&(t.xMin=n.xMin),n.xMax>t.xMax&&(t.xMax=n.xMax),n.yMin<t.yMin&&(t.yMin=n.yMin),n.yMax>t.yMax&&(t.yMax=n.yMax),n.zMin<t.zMin&&(t.zMin=n.zMin),n.zMax>t.zMax&&(t.zMax=n.zMax)},dispose:function(){},incref:function(){this.refCount==0&&this.primitive!=null&&this.primitive.incref(),bt.prototype.incref.call(this)},decref:function(){bt.prototype.decref.call(this),this.refCount==0&&this.primitive!=null&&this.primitive.decref()},getBounds:function(){return this.bounds},screenRatioToLod:function(e){return this.primitive.screenRatioToLod(e)},setCommand:function(e,t,n){if(t>this.primitive.lodCount()-1){this.commands.setCommand(0,0,0);return}this.commands.setCommand(n,this.primitive.getMaterialIndexCount(e,t),this.primitive.getMaterialIndexStart(e,t))},render:function(e){(this.primitive.buffer==null||this.primitive.buffer.vbuf==null)&&this.primitive.alloc(e),e.needFlushTarget&&e.doFlushTarget(),this.primitive.buffers==null?e.driver.selectBuffer(this.primitive.buffer):e.driver.selectMultiBuffers(this.primitive.formats,this.primitive.buffers);var t=this.primitive.indexes;t==null&&(t=e.mem.getTriIndexes(this.triCount()*3)),e.renderInstanced(t,this.commands)},__class__:Va}),ze=function(){},c["h3d.prim.ModelDatabase"]=ze,ze.__name__="h3d.prim.ModelDatabase",ze.customizeLodConfig=function(e){return e},ze.prototype={get_baseDir:function(){return""},getFilePath:function(e){return e==null||e==""?ze.FILE_NAME:e+"/"+ze.FILE_NAME},getRootData:function(e){if(e==null)return null;var n,s,o,i=ze.db.h[e];if(i!=null)return i;s=this.getFilePath(e),n=Kt.currentInstance.fs,o=n instanceof Yo?n:null,o!=null&&ge.isAbsolute(s)&&(s=u.substr(s,o.baseDir.length,null));try{n=JSON.parse(Kt.currentInstance.load(s).toText())}catch(e){if(t.caught(e).unwrap()instanceof Lo)n={};else throw e}return ze.db.h[e]=n,n},getModelData:function(e,t,n){var s=t+"/"+n,o=this.getRootData(e);return this.cleanOldModelData(o,s),q.field(o,s)},cleanOldModelData:function(e,t){var s,o,a,r,c,i=""+t+"_LOD0",n=q.field(e,ze.LOD_CONFIG);if(n!=null){for(o=0,a=q.fields(n);o<a.length;){if(s=a[o],++o,t.indexOf(s)<0&&i.indexOf(s)<0)continue;r=q.field(n,s),c={lodConfig:r},e[t]=c,q.deleteField(n,s),e[ze.LOD_CONFIG]=n}(n==null||q.fields(n).length==0)&&q.deleteField(e,ze.LOD_CONFIG)}n=q.field(e,i),n!=null&&(q.deleteField(e,i),e[t]=n)},saveModelData:function(e,n,s,o){var r=this.getFilePath(e),i=this.getRootData(e),a=n+"/"+s;throw o==null||q.fields(o).length==0?q.deleteField(i,a):i[a]=o,t.thrown("Can't save model props database "+r)},loadLodConfig:function(e,t){var n=q.field(t,ze.LOD_CONFIG);if(n==null||e.hmd==null)return;e.hmd.lodConfig=n},loadDynamicBonesConfig:function(e,t){var n,s,o,i,a,r,c,l,d,m,f,p,g,v,b,j,y,_,O,x,C,E,k,A,S,w=q.field(t,ze.DYN_BONES_CONFIG);if(w==null||e.skin==null)return;for(A=function(e){for(var n,t=0;t<w.length;)if(n=w[t],++t,n.name==e.name)return n;return null},c=e.skin.getSkinData(),r=0,O=c.allJoints;r<O.length;){if(s=O[r],++r,o=A(s),o==null)continue;if(n=new Un,n.index=s.index,n.name=s.name,n.bindIndex=s.bindIndex,n.splitIndex=s.splitIndex,n.defMat=s.defMat,n.transPos=s.transPos,n.parent=s.parent,n.follow=s.follow,n.subs=s.subs,n.offsets=s.offsets,n.offsetRay=s.offsetRay,n.retargetAnim=s.retargetAnim,n.damping=o.damping,n.resistance=o.resistance,n.slackness=o.slackness,n.stiffness=o.stiffness,n.additive=o.additive,o.lockAxis==null?(m=0,f=0,p=0,p==null&&(p=0),f==null&&(f=0),m==null&&(m=0),x=new h(m,f,p)):(_=o.lockAxis,v=_!=null?_.x:null,j=o.lockAxis,b=j!=null?j.y:null,y=o.lockAxis,g=y!=null?y.z:null,g==null&&(g=0),b==null&&(b=0),v==null&&(v=0),x=new h(v,b,g)),n.lockAxis=x,i=o.globalForce.x,a=o.globalForce.y,d=o.globalForce.z,d==null&&(d=0),a==null&&(a=0),i==null&&(i=0),n.globalForce=new h(i,a,d),c.allJoints[s.index]=n,C=s.parent,C!=null&&C.subs.push(n),E=s.parent,E!=null&&u.remove(E.subs,s),n.subs!=null)for(l=0,k=n.subs;l<k.length;)S=k[l],++l,S.parent=n}e.skin.setSkinData(c)},saveLodConfig:function(e,t){var n,s,o,i,a=!0,r=es.getDefaultLodConfig(e.resourceDirectory);if(e.hmd.lodConfig!=null)for(r.length!=e.hmd.lodConfig.length&&(a=!1),s=0,o=e.hmd.lodConfig.length;s<o;)if(n=s++,r[n]!=e.hmd.lodConfig[n]){a=!1;break}if(a)q.deleteField(t,ze.LOD_CONFIG);else{for(i=[],s=0,o=e.hmd.lodCount();s<o;)n=s++,n>=e.hmd.lodConfig.length?i[n]=0:i[n]=e.hmd.lodConfig[n];t[ze.LOD_CONFIG]=i}},saveDynamicBonesConfig:function(e,t){if(e.skin==null)return;for(var n,i,s=[],o=0,a=e.skin.getSkinData().allJoints;o<a.length;){if(i=a[o],++o,n=i instanceof Un?i:null,n==null)continue;s.push({name:n.name,slackness:n.slackness,stiffness:n.stiffness,resistance:n.resistance,damping:n.damping,additive:n.additive,globalForce:n.globalForce,lockAxis:n.lockAxis})}if(s.length==0){q.deleteField(t,ze.DYN_BONES_CONFIG);return}t[ze.DYN_BONES_CONFIG]=s},saveCollideConfig:function(e,t){Object.prototype.hasOwnProperty.call(e.collide,"collide")?t.collide=q.field(e.collide,"collide"):q.deleteField(t,"collide")},loadModelProps:function(e){var t=this.getModelData(e.resourceDirectory,e.resourceName,e.objectName);if(t==null)return;this.loadLodConfig(e,t),this.loadDynamicBonesConfig(e,t)},saveModelProps:function(e){var t=this.getModelData(e.resourceDirectory,e.resourceName,e.objectName);t==null&&(t={}),this.saveLodConfig(e,t),this.saveDynamicBonesConfig(e,t),this.saveCollideConfig(e,t),this.saveModelData(e.resourceDirectory,e.resourceName,e.objectName,t)},__class__:ze},Fs=function(){bt.call(this)},c["h3d.prim.Plane2D"]=Fs,Fs.__name__="h3d.prim.Plane2D",Fs.get=function(){var t=K.CURRENT,e=t.resCache.h[Fs.__id__];return e==null&&(e=new Fs,t.resCache.set(Fs,e)),e},Fs.__super__=bt,Fs.prototype=g(bt.prototype,{triCount:function(){return 2},vertexCount:function(){return 4},alloc:function(){var n,s,t=Tt._new(0);t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=-1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=-1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=0,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=-1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=0,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=0,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=-1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=1,t.pos==t.array.length&&(n=t.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(t.array),t.array=s),t.array[t.pos++]=0,this.buffer=wt.ofFloats(t,y.get_XY_UV())},render:function(e){(this.buffer==null||this.buffer.vbuf==null)&&this.alloc(e);var t=this.buffer;e.renderBuffer(t,e.mem.getQuadIndexes(t.vertices),2,0,-1)},__class__:Fs}),tr=function(e,t){t==null&&(t=!1),bt.call(this),this.onContextLost=function(){return e},this.bounds=e.bounds,this.alloc(null),t||(this.onContextLost=null)},c["h3d.prim.RawPrimitive"]=tr,tr.__name__="h3d.prim.RawPrimitive",tr.__super__=bt,tr.prototype=g(bt.prototype,{alloc:function(){if(this.onContextLost==null)throw t.thrown("Cannot realloc "+o.string(this));var n=this.onContextLost();this.buffer=wt.ofFloats(n.vbuf,n.format),this.vcount=this.buffer.vertices,this.tcount=n.ibuf!=null?n.ibuf.length/3|0:this.vcount/3|0,n.ibuf!=null?this.indexes=rn.alloc(n.ibuf):this.indexes!=null&&(this.indexes.dispose(),this.indexes=null)},getBounds:function(){if(this.bounds==null)throw t.thrown("Bounds not defined for "+o.string(this));return this.bounds},triCount:function(){return this.tcount},vertexCount:function(){return this.vcount},__class__:tr}),Ps=function(e,t,n,s){s==null&&(s=1),n==null&&(n=6),t==null&&(t=8),e==null&&(e=1),this.ray=e,this.segsH=n,this.segsW=t,this.portion=s;for(var o,a,r,l,d,u,m,f,g,v,b,j,y,_,w,x,C,E=Math.PI*2/t,O=[],i=new Array(0),c=0,p=n+1;c<p;)for(o=c++,j=o/n*Math.PI*s,g=Math.sin(j),C=Math.cos(j),d=0,a=0,u=t+1;a<u;)r=a++,w=g*Math.cos(d),_=g*Math.sin(d),l=w*e,f=_*e,m=C*e,m==null&&(m=0),f==null&&(f=0),l==null&&(l=0),O.push(new h(l,f,m)),d+=E;for(c=0,p=n;c<p;)for(o=c++,a=0,u=t;a<u;)r=a++,y=r+1+o*(t+1),b=r+o*(t+1),x=r+(o+1)*(t+1),v=r+1+(o+1)*(t+1),o!=0&&(i.push(y),i.push(b),i.push(v)),(o!=n-1||s!=1)&&(i.push(b),i.push(x),i.push(v));tn.call(this,O,i)},c["h3d.prim.Sphere"]=Ps,Ps.__name__="h3d.prim.Sphere",Ps.defaultUnitSphere=function(){var t=K.CURRENT,e=t.resCache.h[Ps.__id__];return e??(e=new Ps(1,16,16),e.addNormals(),e.addUVs(),t.resCache.set(Ps,e),e)},Ps.__super__=tn,Ps.prototype=g(tn.prototype,{getCollider:function(){return new Is(this.translatedX,this.translatedY,this.translatedZ,this.ray*this.scaled)},addNormals:function(){this.normals=this.points},addUVs:function(){this.uvs=[];for(var e,n,s,o,t=0,i=this.segsH+1;t<i;)for(n=t++,e=0,s=this.segsW+1;e<s;)o=e++,this.uvs.push(new oe(1-o/this.segsW,n/this.segsH))},__class__:Ps}),oe=function(e,t){this.u=e,this.v=t},c["h3d.prim.UV"]=oe,oe.__name__="h3d.prim.UV",oe.prototype={clone:function(){return new oe(this.u,this.v)},toString:function(){return"{"+x.fmt(this.u)+","+x.fmt(this.v)+"}"},__class__:oe},me=function(e,t,n){this.curScreenRatio=1,this.inheritLod=!1,se.call(this,n),this.set_primitive(e),t==null&&(t=rs.current.createMaterial(),t.set_props(t.getDefaultProps())),this.material=t},c["h3d.scene.Mesh"]=me,me.__name__="h3d.scene.Mesh",me.screenRatio=function(e,t,n){var r,c,l,d,u,h,m,f,p,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,R,P,H,I,B,V,$,W,U,K,q,Y,G,X,Q,Z,ee,J,oe,se,ne,te,g,a=e,s=0,o=0,i=0;return i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),N=s,D=o,z=i,s=a._41,o=a._42,i=a._43,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),N=s,D=o,z=i,a=e,s=0,o=0,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),T=s,A=o,x=i,T=Math.sqrt(a._11*a._11+a._12*a._12+a._13*a._13),A=Math.sqrt(a._21*a._21+a._22*a._22+a._23*a._23),x=Math.sqrt(a._31*a._31+a._32*a._32+a._33*a._33),a._11*(a._22*a._33-a._23*a._32)+a._12*(a._23*a._31-a._21*a._33)+a._13*(a._21*a._32-a._22*a._31)<0&&(T*=-1,A*=-1,x*=-1),w=t.xMax-t.xMin,O=t.yMax-t.yMin,p=t.zMax-t.zMin,I=O<p?p:O,O=T,$=A,p=x,W=$<p?p:$,_=(w<I?I:w)*(O<W?W:O)/2,s=0,o=0,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),U=s,K=o,B=i,n.directions==null&&(n.directions=new L,n.directions._44=0),n.directions._44==0&&n.calcDirections(),U=n.directions._21,K=n.directions._22,B=n.directions._23,s=0,o=0,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),Z=s,Q=o,X=i,n.directions==null&&(n.directions=new L,n.directions._44=0),n.directions._44==0&&n.calcDirections(),Z=n.directions._31,Q=n.directions._32,X=n.directions._33,s=Z-U,o=Q-K,i=X-B,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),l=s,d=o,c=i,c==null&&(c=0),d==null&&(d=0),l==null&&(l=0),S=l,M=d,F=c,v=S*S+M*M+F*F,v<1e-20?v=0:v=1/Math.sqrt(v),s=S*v,o=M*v,i=F*v,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),l=s,d=o,c=i,c==null&&(c=0),d==null&&(d=0),l==null&&(l=0),G=l,Y=d,q=c,s=G*_,o=Y*_,i=q*_,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),l=s,d=o,c=i,c==null&&(c=0),d==null&&(d=0),l==null&&(l=0),R=l,P=d,H=c,s=N+R,o=D+P,i=z+H,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),l=s,d=o,c=i,c==null&&(c=0),d==null&&(d=0),l==null&&(l=0),ee=l,J=d,oe=c,s=G*_,o=Y*_,i=q*_,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),l=s,d=o,c=i,c==null&&(c=0),d==null&&(d=0),l==null&&(l=0),R=l,P=d,H=c,s=N-R,o=D-P,i=z-H,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),l=s,d=o,c=i,c==null&&(c=0),d==null&&(d=0),l==null&&(l=0),se=l,ne=d,te=c,g=!1,g==null&&(g=!0),s=0,o=0,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),f=s,m=o,y=i,s=ee,o=J,i=oe,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),f=s,m=o,y=i,r=n.m,C=f*r._11+m*r._21+y*r._31+r._41,E=f*r._12+m*r._22+y*r._32+r._42,k=f*r._13+m*r._23+y*r._33+r._43,b=1/(f*r._14+m*r._24+y*r._34+r._44),f=C*b,m=E*b,y=k*b,f=(f+1)*.5,m=(-m+1)*.5,g&&(f=Math.round(f),m=Math.round(m)),g=!1,g==null&&(g=!0),s=0,o=0,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),h=s,u=o,j=i,s=se,o=ne,i=te,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),h=s,u=o,j=i,r=n.m,C=h*r._11+u*r._21+j*r._31+r._41,E=h*r._12+u*r._22+j*r._32+r._42,k=h*r._13+u*r._23+j*r._33+r._43,b=1/(h*r._14+u*r._24+j*r._34+r._44),h=C*b,u=E*b,j=k*b,h=(h+1)*.5,u=(-u+1)*.5,g&&(h=Math.round(h),u=Math.round(u)),w=h-f,p=u-m,V=w<p?p:w,V*V},me.__super__=se,me.prototype=g(se.prototype,{getMeshMaterials:function(){return[this.material]},addBoundsRec:function(e,t){if(se.prototype.addBoundsRec.call(this,e,t),this.primitive==null||(this.flags&512)!=0)return;var n,s,i,o=this.primitive.getBounds();t==null?(i=this.absPos,s=new Ce,s.xMin=o.xMin,s.xMax=o.xMax,s.yMin=o.yMin,s.yMax=o.yMax,s.zMin=o.zMin,s.zMax=o.zMax,n=s,n.transform(i),n.xMin<e.xMin&&(e.xMin=n.xMin),n.xMax>e.xMax&&(e.xMax=n.xMax),n.yMin<e.yMin&&(e.yMin=n.yMin),n.yMax>e.yMax&&(e.yMax=n.yMax),n.zMin<e.zMin&&(e.zMin=n.zMin),n.zMax>e.zMax&&(e.zMax=n.zMax)):(me.tmpMat.multiply(this.absPos,t),i=me.tmpMat,s=new Ce,s.xMin=o.xMin,s.xMax=o.xMax,s.yMin=o.yMin,s.yMax=o.yMax,s.zMin=o.zMin,s.zMax=o.zMax,n=s,n.transform(i),n.xMin<e.xMin&&(e.xMin=n.xMin),n.xMax>e.xMax&&(e.xMax=n.xMax),n.yMin<e.yMin&&(e.yMin=n.yMin),n.yMax>e.yMax&&(e.yMax=n.yMax),n.zMin<e.zMin&&(e.zMin=n.zMin),n.zMax>e.zMax&&(e.zMax=n.zMax))},clone:function(e){var t=e??new me(null,this.material);return t.set_primitive(this.primitive),t.material=this.material.clone(),se.prototype.clone.call(this,t),t},getLocalCollider:function(){return this.primitive.getCollider()},draw:function(e){this.primitive.selectMaterial(0,this.primitive.screenRatioToLod(this.curScreenRatio)),this.primitive.render(e.engine)},calcScreenRatio:function(e){if(this.primitive==null||this.primitive.lodCount()==1)return;if(e.forcedScreenRatio>=0){this.curScreenRatio=e.forcedScreenRatio;return}var t=this.primitive.getBounds();if(t==null){this.curScreenRatio=1;return}this.curScreenRatio=me.screenRatio(this.getAbsPos(),t,e.camera),this.inheritLod&&(e.forcedScreenRatio=this.curScreenRatio)},emit:function(e){if(this.calcScreenRatio(e),this.primitive.screenRatioToLod(this.curScreenRatio)>=this.primitive.lodCount())return;for(var t=this.material.passes;t!=null;)t.culled||(e.emitPass(t,this).index=0),t=t.nextPass},getMaterialByName:function(e){return this.material!=null&&this.material.name==e?this.material:se.prototype.getMaterialByName.call(this,e)},getMaterials:function(e,t){return t==null&&(t=!0),e==null&&(e=[]),this.material!=null&&e.indexOf(this.material)<0&&e.push(this.material),se.prototype.getMaterials.call(this,e,t)},onAdd:function(){se.prototype.onAdd.call(this),this.primitive!=null&&this.primitive.incref()},onRemove:function(){this.primitive!=null&&this.primitive.decref(),se.prototype.onRemove.call(this)},set_primitive:function(e){return e!=this.primitive&&(this.flags&32)!=0&&(this.primitive!=null&&this.primitive.decref(),e!=null&&e.incref()),this.primitive=e},__class__:me}),Gn=function(e){this.lineSize=0,this.curR=0,this.curZ=0,this.curY=0,this.curX=0,this.bprim=new nn(y.get_POS3D_NORMAL_UV_RGBA()),this.bprim.isStatic=!1,me.call(this,this.bprim,null,e),this.tmpPoints=[],this.lineShader=new fo,this.lineShader.setPriority(-100);var t,n=this.material;n.set_castShadows(!1),n.set_receiveShadows(!1),this.material.passes.set_enableLights(!1),this.material.passes.addShader(this.lineShader),t=new so,t.setPriority(-100),this.material.passes.addShader(t),this.material.passes.set_culling(xt.None)},c["h3d.scene.Graphics"]=Gn,Gn.__name__="h3d.scene.Graphics",Gn.__super__=me,Gn.prototype=g(me.prototype,{onRemove:function(){me.prototype.onRemove.call(this),this.bprim.clear()},set_is3D:function(e){return this.is3D==e?e:(e?(this.material.set_texture(S.fromColor(-1)),this.material.passes.removeShader(this.lineShader)):(this.material.set_texture(null),this.material.passes.addShader(this.lineShader)),this.bprim.clear(),this.tmpPoints=[],this.is3D=e)},flushLine:function(){var a,r,J,te,u,ee,ne,o,i,c,d,h,m,f,p,g,v,b,j,y,_,x,A,Z,se,w,O,C,E,k,S,M,F,T,z,D,N,L,R,P,H,I,V,$,W,U,K,q,Y,G,X,Q,t=this,s=this.tmpPoints,l=s.length-1,n=s[l],e=s[0],oe=e.x==n.x&&e.y==n.y&&e.z==n.z,B=s.length;for(oe?e!=n&&(--B,--l,n=s[l]):(a=s[l-1],a==null&&(a=e),s.push(new oi(n.x*2-a.x,n.y*2-a.y,n.z*2-a.z,0,0,0,0)),r=s[1],r==null&&(r=e),n=new oi(e.x*2-r.x,e.y*2-r.y,e.z*2-r.z,0,0,0,0)),J=this.bprim.vertexCount(),te=J,u=0,ee=0,ne=B;ee<ne;)f=ee++,p=s[(f+1)%s.length],c=n.y-e.y,h=e.x-n.x,d=1/Math.sqrt(c*c+h*h),j=e.y-p.y,y=p.x-e.x,Z=1/Math.sqrt(j*j+y*y),i=c*d+j*Z,o=h*d+y*Z,A=1/Math.sqrt(i*i+o*o),i*=A,o*=A,se=i*c*d+o*h*d,E=this.lineSize*.5/se,i*=E,o*=E,k=f<B-1||oe,this.bprim.begin(2,k?6:0),x=t.bprim,x.tmpBuf.array[x.bufPos++]=e.x+i,S=t.bprim,S.tmpBuf.array[S.bufPos++]=e.y+o,M=t.bprim,M.tmpBuf.array[M.bufPos++]=e.z,F=t.bprim,F.tmpBuf.array[F.bufPos++]=0,T=t.bprim,T.tmpBuf.array[T.bufPos++]=0,z=t.bprim,z.tmpBuf.array[z.bufPos++]=1,D=t.bprim,D.tmpBuf.array[D.bufPos++]=0,N=t.bprim,N.tmpBuf.array[N.bufPos++]=u,L=t.bprim,L.tmpBuf.array[L.bufPos++]=e.r,R=t.bprim,R.tmpBuf.array[R.bufPos++]=e.g,P=t.bprim,P.tmpBuf.array[P.bufPos++]=e.b,H=t.bprim,H.tmpBuf.array[H.bufPos++]=e.a,I=t.bprim,I.tmpBuf.array[I.bufPos++]=e.x-i,C=t.bprim,C.tmpBuf.array[C.bufPos++]=e.y-o,V=t.bprim,V.tmpBuf.array[V.bufPos++]=e.z,$=t.bprim,$.tmpBuf.array[$.bufPos++]=0,W=t.bprim,W.tmpBuf.array[W.bufPos++]=0,U=t.bprim,U.tmpBuf.array[U.bufPos++]=1,K=t.bprim,K.tmpBuf.array[K.bufPos++]=1,q=t.bprim,q.tmpBuf.array[q.bufPos++]=u,Y=t.bprim,Y.tmpBuf.array[Y.bufPos++]=e.r,G=t.bprim,G.tmpBuf.array[G.bufPos++]=e.g,X=t.bprim,X.tmpBuf.array[X.bufPos++]=e.b,Q=t.bprim,Q.tmpBuf.array[Q.bufPos++]=e.a,u=1-u,k&&(_=f==l?J-te:2,g=this.bprim,g.tmpIdx[g.idxPos++]=g.startIndex,v=this.bprim,v.tmpIdx[v.idxPos++]=1+v.startIndex,b=this.bprim,b.tmpIdx[b.idxPos++]=_+b.startIndex,w=this.bprim,w.tmpIdx[w.idxPos++]=_+w.startIndex,m=this.bprim,m.tmpIdx[m.idxPos++]=1+m.startIndex,O=this.bprim,O.tmpIdx[O.idxPos++]=_+1+O.startIndex),te+=2,n=e,e=p},flush:function(){if(this.tmpPoints.length==0)return;this.is3D&&(this.flushLine(),this.tmpPoints=[])},sync:function(e){me.prototype.sync.call(this,e),this.flush(),this.bprim.flush()},draw:function(e){this.flush(),this.bprim.flush(),me.prototype.draw.call(this,e)},clear:function(){this.flush(),this.bprim.clear()},lineStyle:function(e,t,n){n==null&&(n=1),t==null&&(t=0),e==null&&(e=0),this.flush(),e>0&&this.lineSize!=e&&(this.lineSize=e,this.is3D||(this.lineShader.width__=this.lineSize)),this.setColor(t,n)},setColorF:function(e,t,n,s){s==null&&(s=1),this.curA=s,this.curR=e,this.curG=t,this.curB=n},setColor:function(e,t){t==null&&(t=1),this.curA=t,this.curR=(e>>16&255)/255,this.curG=(e>>8&255)/255,this.curB=(e&255)/255},drawLine:function(e,t){this.moveTo(e.x,e.y,e.z),this.lineTo(t.x,t.y,t.z)},moveTo:function(e,t,n){this.is3D?(this.flush(),this.lineTo(e,t,n)):(this.curX=e,this.curY=t,this.curZ=n)},addVertex:function(e,t,n,s,o,i,a){this.tmpPoints.push(new oi(e,t,n,s,o,i,a))},lineTo:function(e,t,n){var s,i,a,r,c,l,d,o=this;if(this.is3D){i=this.curX,a=this.curY,r=this.curZ,s=this.bprim.bounds,i<s.xMin&&(s.xMin=i),i>s.xMax&&(s.xMax=i),a<s.yMin&&(s.yMin=a),a>s.yMax&&(s.yMax=a),r<s.zMin&&(s.zMin=r),r>s.zMax&&(s.zMax=r),s=this.bprim.bounds,e<s.xMin&&(s.xMin=e),e>s.xMax&&(s.xMax=e),t<s.yMin&&(s.yMin=t),t>s.yMax&&(s.yMax=t),n<s.zMin&&(s.zMin=n),n>s.zMax&&(s.zMax=n),this.tmpPoints.push(new oi(e,t,n,this.curR,this.curG,this.curB,this.curA));return}this.bprim.begin(4,6),c=e-this.curX,l=t-this.curY,d=n-this.curZ,i=this.curX,a=this.curY,r=this.curZ,s=this.bprim.bounds,i<s.xMin&&(s.xMin=i),i>s.xMax&&(s.xMax=i),a<s.yMin&&(s.yMin=a),a>s.yMax&&(s.yMax=a),r<s.zMin&&(s.zMin=r),r>s.zMax&&(s.zMax=r),s=this.bprim.bounds,e<s.xMin&&(s.xMin=e),e>s.xMax&&(s.xMax=e),t<s.yMin&&(s.yMin=t),t>s.yMax&&(s.yMax=t),n<s.zMin&&(s.zMin=n),n>s.zMax&&(s.zMax=n),s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curX,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curY,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curZ,s=o.bprim,s.tmpBuf.array[s.bufPos++]=c,s=o.bprim,s.tmpBuf.array[s.bufPos++]=l,s=o.bprim,s.tmpBuf.array[s.bufPos++]=d,s=o.bprim,s.tmpBuf.array[s.bufPos++]=0,s=o.bprim,s.tmpBuf.array[s.bufPos++]=0,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curR,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curG,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curB,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curA,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curX,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curY,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curZ,s=o.bprim,s.tmpBuf.array[s.bufPos++]=c,s=o.bprim,s.tmpBuf.array[s.bufPos++]=l,s=o.bprim,s.tmpBuf.array[s.bufPos++]=d,s=o.bprim,s.tmpBuf.array[s.bufPos++]=0,s=o.bprim,s.tmpBuf.array[s.bufPos++]=1,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curR,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curG,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curB,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curA,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curX,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curY,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curZ,s=o.bprim,s.tmpBuf.array[s.bufPos++]=c,s=o.bprim,s.tmpBuf.array[s.bufPos++]=l,s=o.bprim,s.tmpBuf.array[s.bufPos++]=d,s=o.bprim,s.tmpBuf.array[s.bufPos++]=1,s=o.bprim,s.tmpBuf.array[s.bufPos++]=0,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curR,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curG,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curB,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curA,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curX,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curY,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curZ,s=o.bprim,s.tmpBuf.array[s.bufPos++]=c,s=o.bprim,s.tmpBuf.array[s.bufPos++]=l,s=o.bprim,s.tmpBuf.array[s.bufPos++]=d,s=o.bprim,s.tmpBuf.array[s.bufPos++]=1,s=o.bprim,s.tmpBuf.array[s.bufPos++]=1,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curR,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curG,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curB,s=o.bprim,s.tmpBuf.array[s.bufPos++]=o.curA,s=this.bprim,s.tmpIdx[s.idxPos++]=s.startIndex,s=this.bprim,s.tmpIdx[s.idxPos++]=1+s.startIndex,s=this.bprim,s.tmpIdx[s.idxPos++]=2+s.startIndex,s=this.bprim,s.tmpIdx[s.idxPos++]=2+s.startIndex,s=this.bprim,s.tmpIdx[s.idxPos++]=3+s.startIndex,s=this.bprim,s.tmpIdx[s.idxPos++]=1+s.startIndex,this.curX=e,this.curY=t,this.curZ=n},__class__:Gn}),Zo=function(e,t,n,s){n==null&&(n=!0),e==null&&(e=-65536),this.prevZMax=-1e9,this.prevYMax=-1e9,this.prevXMax=-1e9,this.prevZMin=1e9,this.prevYMin=1e9,this.prevXMin=1e9,this.thickness=1,Gn.call(this,s),this.color=e,this.bounds=t,n||this.material.passes.depth(!0,Ae.Always)},c["h3d.scene.Box"]=Zo,Zo.__name__="h3d.scene.Box",Zo.__super__=Gn,Zo.prototype=g(Gn.prototype,{clone:function(e){if(e==null){var n,s=this.color,t=this.bounds,o=new Ce;o.xMin=t.xMin,o.xMax=t.xMax,o.yMin=t.yMin,o.yMax=t.yMax,o.zMin=t.zMin,o.zMax=t.zMax,n=new Zo(s,o,this.material.passes.depthWrite,null)}else n=e;return Gn.prototype.clone.call(this,n),t=this.bounds,s=new Ce,s.xMin=t.xMin,s.xMax=t.xMax,s.yMin=t.yMin,s.yMax=t.yMax,s.zMin=t.zMin,s.zMax=t.zMax,n.bounds=s,n.prevXMin=this.prevXMin,n.prevYMin=this.prevYMin,n.prevZMin=this.prevZMin,n.prevXMax=this.prevXMax,n.prevYMax=this.prevYMax,n.prevZMax=this.prevZMax,n},getLocalCollider:function(){return null},sync:function(e){if(this.bounds==null){if(this.prevXMin==-.5&&this.prevYMin==-.5&&this.prevZMin==-.5&&this.prevXMax==.5&&this.prevYMax==.5&&this.prevZMax==.5)return;this.prevXMin=-.5,this.prevYMin=-.5,this.prevZMin=-.5,this.prevXMax=.5,this.prevYMax=.5,this.prevZMax=.5}else{if(this.prevXMin==this.bounds.xMin&&this.prevYMin==this.bounds.yMin&&this.prevZMin==this.bounds.zMin&&this.prevXMax==this.bounds.xMax&&this.prevYMax==this.bounds.yMax&&this.prevZMax==this.bounds.zMax)return;this.prevXMin=this.bounds.xMin,this.prevYMin=this.bounds.yMin,this.prevZMin=this.bounds.zMin,this.prevXMax=this.bounds.xMax,this.prevYMax=this.bounds.yMax,this.prevZMax=this.bounds.zMax}this.clear(),this.lineStyle(this.thickness,this.color),this.moveTo(this.prevXMin,this.prevYMin,this.prevZMin),this.lineTo(this.prevXMax,this.prevYMin,this.prevZMin),this.lineTo(this.prevXMax,this.prevYMax,this.prevZMin),this.lineTo(this.prevXMin,this.prevYMax,this.prevZMin),this.lineTo(this.prevXMin,this.prevYMin,this.prevZMin),this.lineTo(this.prevXMin,this.prevYMin,this.prevZMax),this.lineTo(this.prevXMax,this.prevYMin,this.prevZMax),this.lineTo(this.prevXMax,this.prevYMax,this.prevZMax),this.lineTo(this.prevXMin,this.prevYMax,this.prevZMax),this.lineTo(this.prevXMin,this.prevYMin,this.prevZMax),this.moveTo(this.prevXMax,this.prevYMin,this.prevZMin),this.lineTo(this.prevXMax,this.prevYMin,this.prevZMax),this.moveTo(this.prevXMin,this.prevYMax,this.prevZMin),this.lineTo(this.prevXMin,this.prevYMax,this.prevZMax),this.moveTo(this.prevXMax,this.prevYMax,this.prevZMin),this.lineTo(this.prevXMax,this.prevYMax,this.prevZMax),Gn.prototype.sync.call(this,e)},__class__:Zo}),oi=function(e,t,n,s,o,i,a){this.x=e,this.y=t,this.z=n,this.r=s,this.g=o,this.b=i,this.a=a},c["h3d.scene._Graphics.GPoint"]=oi,oi.__name__="h3d.scene._Graphics.GPoint",oi.prototype={__class__:oi},ai=function(e,t){this.hitPoint=new j(0,0,0,1),this.lastClickFrame=-1,this.mouseDownButton=-1,this.emittedLastFrame=!1,this.isAbsoluteShape=!1,this.allowMultiClick=!1,this.enableRightButton=!1,this.propagateEvents=!1,this.cancelEvents=!1,se.call(this,t),this.shape=e,this.set_cursor(Ht.Button)},c["h3d.scene.Interactive"]=ai,ai.__name__="h3d.scene.Interactive",ai.__interfaces__=[Bi],ai.setupDebugMaterial=function(e){for(var t,o,s=e.getMaterials(),n=0;n<s.length;)t=s[n],++n,o=K.CURRENT,o.driver.hasFeature(je.Wireframe)&&t.passes.set_wireframe(!0),t.set_castShadows(!1),t.set_receiveShadows(!1),t.mshader.color__.w=.7,t.set_blendMode(X.Alpha)},ai.__super__=se,ai.prototype=g(se.prototype,{getPoint:function(e,t){var s,r,c,l,d,u,m,f,p,g,v,b,j,y,O=e.px,E=e.py,w=e.pz,C=e.lx,x=e.ly,_=e.lz,n=this.getInvPos(),a=e.px,i=e.py,o=e.pz;return o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),c=a,l=i,r=o,r==null&&(r=0),l==null&&(l=0),c==null&&(c=0),g=c,d=l,b=r,j=g*n._11+d*n._21+b*n._31+n._41,v=g*n._12+d*n._22+b*n._32+n._42,u=g*n._13+d*n._23+b*n._33+n._43,g=j,d=v,b=u,e.px=g,e.py=d,e.pz=b,a=e.lx,i=e.ly,o=e.lz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),c=a,l=i,r=o,r==null&&(r=0),l==null&&(l=0),c==null&&(c=0),p=c,f=l,m=r,j=p*n._11+f*n._21+m*n._31,v=p*n._12+f*n._22+m*n._32,u=p*n._13+f*n._23+m*n._33,p=j,f=v,m=u,e.lx=p,e.ly=f,e.lz=m,e.normalize(),y=this.shape.rayIntersection(e,t),y<0?(e.px=O,e.py=E,e.pz=w,e.lx=C,e.ly=x,e.lz=_,null):(a=e.px+y*e.lx,i=e.py+y*e.ly,o=e.pz+y*e.lz,o==null&&(o=0),i==null&&(i=0),a==null&&(a=0),s=new h(a,i,o),n=this.getAbsPos(),j=s.x*n._11+s.y*n._21+s.z*n._31+n._41,v=s.x*n._12+s.y*n._22+s.z*n._32+n._42,u=s.x*n._13+s.y*n._23+s.z*n._33+n._43,s.x=j,s.y=v,s.z=u,e.px=O,e.py=E,e.pz=w,e.lx=C,e.ly=x,e.lz=_,s)},get_showDebug:function(){return this.debugObj!=null},set_showDebug:function(e){if(!e){if(this.debugObj!=null){var n,s,o,i,t=this.debugObj;t!=null&&t.parent!=null&&t.parent.removeChild(t)}return this.debugObj=null,!1}return this.debugObj!=null||(this.debugObj=this.shape.makeDebugObj(),this.debugObj!=null&&(ai.setupDebugMaterial(this.debugObj),t=this.debugObj,s=this.isAbsoluteShape,s!=((t.flags&2048)!=0)&&(n=1,o=!0,o?t.flags|=n:t.flags&=~n,i=o,i&&(t.flags&131072)!=0&&(n=262144,t.flags|=n)),n=2048,s?t.flags|=n:t.flags&=~n,this.addChild(this.debugObj)),this.debugObj!=null)},onAdd:function(){this.scene=this.getScene(),this.scene!=null&&this.scene.addEventTarget(this),se.prototype.onAdd.call(this)},onRemove:function(){this.scene!=null&&(this.scene.removeEventTarget(this),this.scene=null),se.prototype.onRemove.call(this)},sync:function(e){se.prototype.sync.call(this,e),this.emittedLastFrame=!1},emit:function(e){se.prototype.emit.call(this,e),this.emittedLastFrame=!0},preventClick:function(){this.mouseDownButton=-1},getInteractiveScene:function(){return this.scene},handleEvent:function(e){switch(this.propagateEvents&&(e.propagate=!0),this.cancelEvents&&(e.cancel=!0),e.kind._hx_index){case 0:(this.enableRightButton||e.button==0)&&(this.mouseDownButton=e.button,this.onPush(e),e.cancel&&(this.mouseDownButton=-1));break;case 1:if(this.enableRightButton||e.button==0){this.onRelease(e);var t=N.frameCount;this.mouseDownButton==e.button&&(this.lastClickFrame!=t||this.allowMultiClick)&&(this.onClick(e),this.lastClickFrame=t)}this.mouseDownButton=-1;break;case 2:this.onMove(e);break;case 3:this.onOver(e);break;case 4:this.onOut(e);break;case 5:this.onWheel(e);break;case 6:this.onFocus(e);break;case 7:this.onFocusLost(e);break;case 8:this.onKeyDown(e);break;case 9:this.onKeyUp(e);break;case 10:(this.enableRightButton||e.button==0)&&(this.onRelease(e),this.mouseDownButton==e.button&&this.onReleaseOutside(e)),this.mouseDownButton=-1;break;case 11:this.onTextInput(e);break;case 12:this.onCheck(e);break}},set_cursor:function(e){return this.cursor=e,this.scene!=null&&this.scene.events!=null&&this.scene.events.updateCursor(this),e},focus:function(){if(this.scene==null||this.scene.events==null)return;this.scene.events.focus(this)},blur:function(){this.hasFocus()&&this.scene.events.blur()},isOver:function(){return this.scene!=null&&this.scene.events!=null&&this.scene.events.overList.indexOf(this)!=-1},hasFocus:function(){return this.scene!=null&&this.scene.events!=null&&this.scene.events.currentFocus==this},onOver:function(){},onOut:function(){},onPush:function(){},onRelease:function(){},onReleaseOutside:function(){},onClick:function(){},onMove:function(){},onWheel:function(){},onFocus:function(){},onFocusLost:function(){},onKeyUp:function(){},onKeyDown:function(){},onCheck:function(){},onTextInput:function(){},__class__:ai}),ri=function(e,t){se.call(this,t),this.shader=e},c["h3d.scene.Light"]=ri,ri.__name__="h3d.scene.Light",ri.__super__=se,ri.prototype=g(se.prototype,{get_color:function(){return new h(0,0,0)},set_color:function(e){return e},emit:function(e){e.emitLight(this)},getShadowDirection:function(){return null},__class__:ri}),pi=function(){this.drawPasses=0},c["h3d.scene.LightSystem"]=pi,pi.__name__="h3d.scene.LightSystem",pi.prototype={initGlobals:function(){},initLights:function(e){if(this.ctx=e,this.shadowLight==null||(this.shadowLight.flags&32)==0)for(var n,t=e.lights;t!=null;){if(n=t.getShadowDirection(),n!=null){this.shadowLight=t;break}t=t.next}},computeLight:function(e,t){return t},dispose:function(){},__class__:pi},Qt=function(e,t,n){me.call(this,e,t==null?null:t[0],n),this.materials=t??[this.material]},c["h3d.scene.MultiMaterial"]=Qt,Qt.__name__="h3d.scene.MultiMaterial",Qt.__super__=me,Qt.prototype=g(me.prototype,{getMeshMaterials:function(){return this.materials.slice()},clone:function(e){var n,s,o,t=e??new Qt(null,this.materials);for(t.materials=[],n=0,s=this.materials;n<s.length;)o=s[n],++n,t.materials.push(o==null?null:o.clone());return me.prototype.clone.call(this,t),t.material=t.materials[0],t},emit:function(e){if(this.calcScreenRatio(e),this.primitive.screenRatioToLod(this.curScreenRatio)>=this.primitive.lodCount())return;for(var t,n,s,o,i=0,a=this.materials.length;i<a;)if(s=i++,o=this.materials[s],o!=null)for(n=s,n==null&&(n=0),t=o.passes;t!=null;)t.culled||(e.emitPass(t,this).index=n),t=t.nextPass},getMaterialByName:function(e){for(var t,n=0,s=this.materials;n<s.length;)if(t=s[n],++n,t!=null&&t.name==e)return t;return me.prototype.getMaterialByName.call(this,e)},getMaterials:function(e,t){t==null&&(t=!0),e==null&&(e=[]);for(var o,i,n=0,s=this.materials;n<s.length;)o=s[n],++n,o!=null&&e.indexOf(o)<0&&e.push(o);if(t)for(n=0,s=this.children;n<s.length;)i=s[n],++n,i.getMaterials(e);return e},draw:function(e){this.materials.length>1&&this.primitive.selectMaterial(e.drawPass.index,this.primitive.screenRatioToLod(this.curScreenRatio)),this.primitive.render(e.engine)},__class__:Qt}),at={},at._new=function(e){return e},at.toInt=function(e){return e},at.has=function(e,t){return(e&t)!=0},at.set=function(e,t,n){return n?e|=t:e&=~t,n},at.toString=function(e){var t="";return(e&1)!=0&&(t+=" | PosChanged"),(e&2)!=0&&(t+=" | Visible"),(e&4)!=0&&(t+=" | Culled"),(e&8)!=0&&(t+=" | FollowPositionOnly"),(e&16)!=0&&(t+=" | LightCameraCenter"),(e&32)!=0&&(t+=" | Allocated"),(e&64)!=0&&(t+=" | AlwaysSyncAnimation"),(e&128)!=0&&(t+=" | InheritCulled"),(e&256)!=0&&(t+=" | ModelRoot"),(e&512)!=0&&(t+=" | IgnoreBounds"),(e&1024)!=0&&(t+=" | IgnoreCollide"),(e&2048)!=0&&(t+=" | IgnoreParentTransform"),(e&4096)!=0&&(t+=" | CullingColliderInherited"),(e&8192)!=0&&(t+=" | FixedPosition"),(e&16384)!=0&&(t+=" | FixedPositionSynced"),(e&32768)!=0&&(t+=" | AlwaysSync"),(e&65536)!=0&&(t+=" | Drawn"),(e&131072)!=0&&(t+=" | InSync"),(e&262144)!=0&&(t+=" | PosChangedInSync"),t.length>0&&(t=u.substr(t,3,null)),t},Bc=function(e,t){this.gid=e,this.value=t},c["h3d.scene._RenderContext.SharedGlobal"]=Bc,Bc.__name__="h3d.scene._RenderContext.SharedGlobal",Bc.prototype={__class__:Bc},Ri=function(e){this.cameraFrustumUploaded=!1,this.cameraFrustumBuffer=null,this.tmpComputeLink=new Ge(null,null),this.forcedScreenRatio=-1,Ie.call(this),this.scene=e,this.camera=new Ci,this.cachedShaderList=[],this.cachedPassObjects=[],this.initGlobals()},c["h3d.scene.RenderContext"]=Ri,Ri.__name__="h3d.scene.RenderContext",Ri.__super__=Ie,Ri.prototype=g(Ie.prototype,{setCamera:function(e){this.camera.load(e),this.camera.reverseDepth=this.useReverseDepth,this.camera.update();var n,s,o,i,t=this.camera.mcam;this.globals.map.h[this.cameraView_id]=t,t=this.camera.zNear,this.globals.map.h[this.cameraNear_id]=t,t=this.camera.zFar,this.globals.map.h[this.cameraFar_id]=t,t=this.camera.mproj,this.globals.map.h[this.cameraProj_id]=t,t=this.camera.pos,this.globals.map.h[this.cameraPos_id]=t,n=this.camera.mproj._11,s=this.camera.mproj._22,o=this.camera.mproj._33,i=this.camera.mproj._44,i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t=new j(n,s,o,i),this.globals.map.h[this.cameraProjDiag_id]=t,this.globals.map.h[this.cameraPreviousViewProj_id]==null&&(t=this.camera.m.clone(),this.globals.map.h[this.cameraPreviousViewProj_id]=t),this.globals.map.h[this.cameraJitterOffsets_id]==null&&(n=0,s=0,o=0,i=0,i==null&&(i=1),o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),t=new j(n,s,o,i),this.globals.map.h[this.cameraJitterOffsets_id]=t),t=this.camera.m,this.globals.map.h[this.cameraViewProj_id]=t,t=this.camera.getInverseViewProj(),this.globals.map.h[this.cameraInverseViewProj_id]=t,t=this.useReverseDepth?-1:1,this.globals.map.h[this.cameraProjDepth_id]=t},setupTarget:function(){var e=this.engine.driver.hasFeature(je.BottomLeftCoords)&&this.engine.getCurrentTarget()!=null?-1:1;this.globals.map.h[this.cameraProjFlip_id]=e},getCurrentPixelSize:function(){var e=this.engine.getCurrentTarget(),t=2/(e==null?this.engine.width:e.width),n=2/(e==null?this.engine.height:e.height);return n==null&&(n=0),t==null&&(t=0),new h(t,n,0)},emit:function(e,t,n){n==null&&(n=0);for(var s=e.passes;s!=null;)s.culled||(this.emitPass(s,t).index=n),s=s.nextPass},start:function(){this.lights=null,this.drawPass=null,this.passes=[],this.lights=null,this.cachedPos=0,this.visibleFlag=!0,this.forcedScreenRatio=-1,this.time+=this.elapsedTime,this.frame++,this.setCurrent(),this.engine=K.CURRENT;var e=this.time;this.globals.map.h[this.globalTime_id]=e,e=this.frame,this.globals.map.h[this.globalFrame_id]=e,e=this.getCurrentPixelSize(),this.globals.map.h[this.pixelSize_id]=e,this.setCamera(this.scene.camera)},nextPass:function(){this.cachedPos=0,this.drawPass=null},getGlobal:function(e){return this.globals.get(e)},setGlobal:function(e,t){this.globals.set(e,t)},emitPass:function(e,t){(e.rendererFlags&1)==0&&this.scene.renderer.setPassFlags(e);var n=this.allocPool;return n==null?(n=new lc,n.nextAlloc=this.allocFirst,this.allocFirst=n):this.allocPool=n.nextAlloc,n.pass=e,n.obj=t,this.passes.length<=e.passId&&(this.passes.length=e.passId),n.next=this.passes[e.passId],this.passes[e.passId]=n,n},allocShaderList:function(e,t){var n=this.cachedShaderList[this.cachedPos++];return n==null&&(n=new Ge(null),this.cachedShaderList[this.cachedPos-1]=n),n.s=e,n.next=t,n},computeList:function(e){if(this.computeLink!=null)throw t.thrown("Use computeDispatch to dispatch computeList");this.computeLink=e},memoryBarrier:function(){this.engine.driver.memoryBarrier()},computeDispatch:function(e,n,s,o,i){if(i==null&&(i=!0),o==null&&(o=1),s==null&&(s=1),n==null&&(n=1),n<=0||s<=0||o<=0)throw t.thrown("Can't use zero or negative work groups count");var a,r,c,d,u,h,l=Ie.get();for(l!=this&&this.start(),this.globals.maxChannels=0,e!=null&&(this.tmpComputeLink.s=e,this.computeLink=this.tmpComputeLink),c=this.computeLink,d=null;c!=d;)u=c.s,c=c.next,h=u,h.updateConstants(this.globals);a=Mn.get().link(this.computeLink,Ft.Compute),this.engine.driver.selectShader(a),r=this.shaderBuffers,r.vertex.grow(a.vertex),a.fragment!=null&&r.fragment.grow(a.fragment),this.fillGlobals(r,a),this.engine.uploadShaderBuffers(r,0),this.fillParams(r,a,this.computeLink,!0),this.engine.uploadInstanceShaderBuffers(r),this.engine.driver.computeDispatch(n,s,o,i),this.engine.dispatches++,this.computeLink==this.tmpComputeLink&&(this.tmpComputeLink.s=null),this.computeLink=null,l!=this&&(this.done(),l!=null&&l.setCurrent())},emitLight:function(e){e.next=this.lights,this.lights=e},getCameraFrustumBuffer:function(){if(this.cameraFrustumBuffer==null&&(this.cameraFrustumBuffer=Ut.get().allocBuffer(6,y.get_VEC4_DATA(),2)),!this.cameraFrustumUploaded){var t=new A(new ArrayBuffer(96)),n=this.camera.frustum,e=n.pleft;t.setFloat(0,e.nx),t.setFloat(4,e.ny),t.setFloat(8,e.nz),t.setFloat(12,e.d),e=n.pright,t.setFloat(16,e.nx),t.setFloat(20,e.ny),t.setFloat(24,e.nz),t.setFloat(28,e.d),e=n.ptop,t.setFloat(32,e.nx),t.setFloat(36,e.ny),t.setFloat(40,e.nz),t.setFloat(44,e.d),e=n.pbottom,t.setFloat(48,e.nx),t.setFloat(52,e.ny),t.setFloat(56,e.nz),t.setFloat(60,e.d),e=n.pfar,t.setFloat(64,e.nx),t.setFloat(68,e.ny),t.setFloat(72,e.nz),t.setFloat(76,e.d),e=n.pnear,t.setFloat(80,e.nx),t.setFloat(84,e.ny),t.setFloat(88,e.nz),t.setFloat(92,e.d),this.cameraFrustumBuffer.uploadBytes(t,0,6),this.cameraFrustumUploaded=!0}return this.cameraFrustumBuffer},getDepthClearValue:function(){return this.useReverseDepth?0:1},uploadParams:function(){this.fillParams(this.shaderBuffers,this.drawPass.shader,this.drawPass.shaders),this.engine.uploadInstanceShaderBuffers(this.shaderBuffers)},done:function(){this.drawPass=null;for(var t,n,s,e=this.allocFirst;e!=null&&e!=this.allocPool;)e.obj=null,e.pass=null,e.shader=null,e.shaders=null,e.next=null,e.index=0,e.texture=0,e=e.nextAlloc;for(this.allocPool!=null&&(this.allocFirst=this.allocFirst.nextAlloc),this.allocPool=this.allocFirst,t=0,n=this.cachedShaderList;t<n.length;)s=n[t],++t,s.s=null,s.next=null;this.passes=[],this.lights=null,this.cameraFrustumUploaded=!1,this.globals.map.h[this.cameraPreviousViewProj_id].load(this.globals.map.h[this.cameraViewProj_id]),this.computeVelocity=!1,this.clearCurrent()},dispose:function(){Ie.prototype.dispose.call(this),this.cameraFrustumBuffer!=null&&Ut.get().disposeBuffer(this.cameraFrustumBuffer)},get_cameraView:function(){return this.globals.map.h[this.cameraView_id]},set_cameraView:function(e){return this.globals.map.h[this.cameraView_id]=e,e},get_cameraNear:function(){return this.globals.map.h[this.cameraNear_id]},set_cameraNear:function(e){return this.globals.map.h[this.cameraNear_id]=e,e},get_cameraFar:function(){return this.globals.map.h[this.cameraFar_id]},set_cameraFar:function(e){return this.globals.map.h[this.cameraFar_id]=e,e},get_cameraProj:function(){return this.globals.map.h[this.cameraProj_id]},set_cameraProj:function(e){return this.globals.map.h[this.cameraProj_id]=e,e},get_cameraPos:function(){return this.globals.map.h[this.cameraPos_id]},set_cameraPos:function(e){return this.globals.map.h[this.cameraPos_id]=e,e},get_cameraProjDiag:function(){return this.globals.map.h[this.cameraProjDiag_id]},set_cameraProjDiag:function(e){return this.globals.map.h[this.cameraProjDiag_id]=e,e},get_cameraProjFlip:function(){return this.globals.map.h[this.cameraProjFlip_id]},set_cameraProjFlip:function(e){return this.globals.map.h[this.cameraProjFlip_id]=e,e},get_cameraProjDepth:function(){return this.globals.map.h[this.cameraProjDepth_id]},set_cameraProjDepth:function(e){return this.globals.map.h[this.cameraProjDepth_id]=e,e},get_cameraViewProj:function(){return this.globals.map.h[this.cameraViewProj_id]},set_cameraViewProj:function(e){return this.globals.map.h[this.cameraViewProj_id]=e,e},get_cameraInverseViewProj:function(){return this.globals.map.h[this.cameraInverseViewProj_id]},set_cameraInverseViewProj:function(e){return this.globals.map.h[this.cameraInverseViewProj_id]=e,e},get_cameraPreviousViewProj:function(){return this.globals.map.h[this.cameraPreviousViewProj_id]},set_cameraPreviousViewProj:function(e){return this.globals.map.h[this.cameraPreviousViewProj_id]=e,e},get_cameraJitterOffsets:function(){return this.globals.map.h[this.cameraJitterOffsets_id]},set_cameraJitterOffsets:function(e){return this.globals.map.h[this.cameraJitterOffsets_id]=e,e},get_globalTime:function(){return this.globals.map.h[this.globalTime_id]},set_globalTime:function(e){return this.globals.map.h[this.globalTime_id]=e,e},get_pixelSize:function(){return this.globals.map.h[this.pixelSize_id]},set_pixelSize:function(e){return this.globals.map.h[this.pixelSize_id]=e,e},get_globalModelView:function(){return this.globals.map.h[this.globalModelView_id]},set_globalModelView:function(e){return this.globals.map.h[this.globalModelView_id]=e,e},get_globalModelViewInverse:function(){return this.globals.map.h[this.globalModelViewInverse_id]},set_globalModelViewInverse:function(e){return this.globals.map.h[this.globalModelViewInverse_id]=e,e},get_globalPreviousModelView:function(){return this.globals.map.h[this.globalPreviousModelView_id]},set_globalPreviousModelView:function(e){return this.globals.map.h[this.globalPreviousModelView_id]=e,e},get_globalFrame:function(){return this.globals.map.h[this.globalFrame_id]},set_globalFrame:function(e){return this.globals.map.h[this.globalFrame_id]=e,e},initGlobals:function(){this.cameraView_id=ie.allocID("camera.view"),this.cameraNear_id=ie.allocID("camera.zNear"),this.cameraFar_id=ie.allocID("camera.zFar"),this.cameraProj_id=ie.allocID("camera.proj"),this.cameraPos_id=ie.allocID("camera.position"),this.cameraProjDiag_id=ie.allocID("camera.projDiag"),this.cameraProjFlip_id=ie.allocID("camera.projFlip"),this.cameraProjDepth_id=ie.allocID("camera.projDepth"),this.cameraViewProj_id=ie.allocID("camera.viewProj"),this.cameraInverseViewProj_id=ie.allocID("camera.inverseViewProj"),this.cameraPreviousViewProj_id=ie.allocID("camera.previousViewProj"),this.cameraJitterOffsets_id=ie.allocID("camera.jitterOffsets"),this.globalTime_id=ie.allocID("global.time"),this.pixelSize_id=ie.allocID("global.pixelSize"),this.globalModelView_id=ie.allocID("global.modelView"),this.globalModelViewInverse_id=ie.allocID("global.modelViewInverse"),this.globalPreviousModelView_id=ie.allocID("global.previousModelView"),this.globalFrame_id=ie.allocID("global.frame")},__class__:Ri}),Nr=function(){this.passes=new ya},c["h3d.scene.PassObjects"]=Nr,Nr.__name__="h3d.scene.PassObjects",Nr.prototype={__class__:Nr},Di=_["h3d.scene.RenderMode"]={__ename__:!0,__constructs__:null,Default:{_hx_name:"Default",_hx_index:0,__enum__:"h3d.scene.RenderMode",toString:s},LightProbe:{_hx_name:"LightProbe",_hx_index:1,__enum__:"h3d.scene.RenderMode",toString:s}},Di.__constructs__=[Di.Default,Di.LightProbe],Di.__empty_constructs__=[Di.Default,Di.LightProbe],Ns=function(){this.shadows=!0,this.renderMode=Di.Default,this.effects=[],this.debugging=!1,this.hasSetTarget=!1,this.emptyPasses=new ya,this.allPasses=[],this.passObjects=new fe,this.set_props(this.getDefaultProps());var e,t,n=this,s=!0;this.frontToBack=function(e){n.depthSort(s,e)},e=this,t=!1,this.backToFront=function(n){e.depthSort(t,n)}},c["h3d.scene.Renderer"]=Ns,Ns.__name__="h3d.scene.Renderer",Ns.__super__=Qo,Ns.prototype=g(Qo.prototype,{getEffect:function(e){for(var n,s,t=0,o=this.effects;t<o.length;)if(n=o[t],++t,s=H.__downcastCheck(n,e)?n:null,s!=null)return s;return null},dispose:function(){for(var n,s,e=0,t=this.allPasses;e<t.length;)n=t[e],++e,n.dispose();for(e=0,t=this.effects;e<t.length;)s=t[e],++e,s.dispose();this.ctx.lightSystem!=null&&this.ctx.lightSystem.dispose(),this.passObjects=new fe},mark:function(){},addShader:function(){},getPass:function(e){for(var n,t=0,s=this.allPasses;t<s.length;)if(n=s[t],++t,H.__instanceof(n,e))return n;return null},getPassByName:function(e){for(var n,t=0,s=this.allPasses;t<s.length;)if(n=s[t],++t,n.name==e)return n;return null},hasFeature:function(e){return K.CURRENT.driver.hasFeature(e)},getLightSystem:function(){return this.ctx.scene.lightSystem},getDepthClearValue:function(){return this.ctx.getDepthClearValue()},depthSort:function(e,t){for(var n,s,o,i,a,r,c,l,d,h,m,f,g,v,b,u=this.ctx.camera.m,p=t.current;p!=null;)l=p,p=p.next,s=l,v=s.obj.absPos._41*u._13+s.obj.absPos._42*u._23+s.obj.absPos._43*u._33+u._43,f=s.obj.absPos._41*u._14+s.obj.absPos._42*u._24+s.obj.absPos._43*u._34+u._44,s.depth=f>0?v/f:-v/f;if(e&&!this.ctx.camera.reverseDepth||!e&&this.ctx.camera.reverseDepth){if(a=t.current,a==null)l=null;else{for(d=1,r=0,i=0;!0;){for(s=a,a=null,c=null,h=0;s!=null;){for(++h,n=s,r=0,m=0,g=d;m<g;)if(b=m++,++r,n=n.next,n==null)break;for(i=d;r>0||i>0&&n!=null;)r==0?(o=n,n=n.next,--i):i==0||n==null||(s.pass.layer!=n.pass.layer?s.pass.layer-n.pass.layer:s.depth==n.depth?0:s.depth>n.depth?1:-1)<=0?(o=s,s=s.next,--r):(o=n,n=n.next,--i),c!=null?c.next=o:a=o,c=o;s=n}if(c.next=null,h<=1)break;d*=2}l=a}t.current=l}else{if(a=t.current,a==null)l=null;else{for(d=1,r=0,i=0;!0;){for(s=a,a=null,c=null,h=0;s!=null;){for(++h,n=s,r=0,m=0,g=d;m<g;)if(b=m++,++r,n=n.next,n==null)break;for(i=d;r>0||i>0&&n!=null;)r==0?(o=n,n=n.next,--i):i==0||n==null||(s.pass.layer!=n.pass.layer?s.pass.layer-n.pass.layer:s.depth==n.depth?0:s.depth<n.depth?1:-1)<=0?(o=s,s=s.next,--r):(o=n,n=n.next,--i),c!=null?c.next=o:a=o,c=o;s=n}if(c.next=null,h<=1)break;d*=2}l=a}t.current=l}},clear:function(e,t,n){this.ctx.engine.clear(e,t,n)},allocTarget:function(e,t,n,s){return n==null&&(n=1),t==null&&(t=!0),this.ctx.textures.allocTarget(e,Math.round(this.ctx.engine.width*n),Math.round(this.ctx.engine.height*n),t,s)},copy:function(e,t,n){Gt.run(e,t,n)},setTarget:function(e,t){t==null&&(t=ht.ReadWrite),this.hasSetTarget&&this.ctx.engine.popTarget(),this.ctx.engine.pushTarget(e,null,null,t),this.hasSetTarget=!0},setTargets:function(e,t){t==null&&(t=ht.ReadWrite),this.hasSetTarget&&this.ctx.engine.popTarget(),this.ctx.engine.pushTargets(e,t),this.hasSetTarget=!0},setDepth:function(e){this.hasSetTarget&&this.ctx.engine.popTarget(),this.ctx.engine.pushDepth(e),this.hasSetTarget=!0},resetTarget:function(){this.hasSetTarget&&(this.ctx.engine.popTarget(),this.hasSetTarget=!1)},has:function(e){return this.passObjects.h[e]!=null},setPassFlags:function(e){e.rendererFlags|=1},get:function(e){var t=this.passObjects.h[e];return t==null?this.emptyPasses:(t.rendered=!0,t.passes)},draw:function(e){this.defaultPass.draw(this.get(e))},render:function(){throw t.thrown("Not implemented")},computeStatic:function(){throw t.thrown("Not implemented")},start:function(){},startEffects:function(){for(var t,e=0,n=this.effects;e<n.length;)t=n[e],++e,t.enabled&&t.start(this)},process:function(e){this.hasSetTarget=!1;for(var n,t=0,s=this.allPasses;t<s.length;)n=s[t],++t,n.setContext(this.ctx);for(t=0;t<e.length;)n=e[t],++t,this.passObjects.h[n.name]=n;for(this.ctx.textures.begin(),this.ctx.computingStatic?this.computeStatic():this.render(),this.resetTarget(),t=0;t<e.length;)n=e[t],++t,this.passObjects.h[n.name]=null},computeDispatch:function(e,t,n,s){s==null&&(s=1),n==null&&(n=1),t==null&&(t=1),this.ctx.computeDispatch(e,t,n,s)},__class__:Ns}),Ls=function(e,t){t==null&&(t=!0),e==null&&(e=!0),this.prevEngine=null,this.interactiveOffset=0,this.ratioY=1,this.ratioX=1,this.offsetY=0,this.offsetX=0,se.call(this,null),this.window=pt.getInstance(),this.eventListeners=[],this.hitInteractives=[],this.interactives=[],this.camera=new Ci;var n=K.CURRENT;n!=null&&(this.camera.screenRatio=n.width/n.height),this.ctx=new Ri(this),e&&this.set_renderer(rs.current.createRenderer()),t&&(this.lightSystem=rs.current.createLightSystem())},c["h3d.scene.Scene"]=Ls,Ls.__name__="h3d.scene.Scene",Ls.__interfaces__=[zi,Bo],Ls.__super__=se,Ls.prototype=g(se.prototype,{setEvents:function(e){this.events=e},addEventListener:function(e){this.eventListeners.push(e)},removeEventListener:function(e){for(var n,t=0,s=this.eventListeners;t<s.length;)if(n=s[t],++t,n==e)return u.remove(this.eventListeners,n),!0;return!1},dispatchListeners:function(e){for(var s,t=0,n=this.eventListeners;t<n.length;)if(s=n[t],++t,s(e),!e.propagate)break},set_renderer:function(e){return this.renderer=e,e!=null&&(e.ctx=this.ctx),e},sortHitPointByCameraDistance:function(e,t){var n=e.hitPoint.w,s=t.hitPoint.w;return n>s?-1:1},dispatchEvent:function(e,t){var n=t;n.handleEvent(e)},isInteractiveVisible:function(e){for(var t=e;t!=this;){if(t==null||(t.flags&2)==0)return!1;t=t.parent}return!0},handleEvent:function(e){if(this.interactives.length==0)return null;if(this.hitInteractives.length==0){var l,d,u,ge,ve,be,Oe,we,Fe,n,s,i,f,p,g,C,E,k,A,M,I,B,V,ee,he,ue,v,j,y,S,F,T,z,D,N,L,R,P,H,$,U,K,q,Y,Q,J,oe,Z,ae,re,ce,o,je,fe,ie,X,se,ne,m,W,me,te,de,le,_,w,O,x,Ce,Ee,ke,r,Ae,Se,Me,G,c=e.relX-this.offsetX,a=e.relY-this.offsetY,ze=this.ratioX*this.window.get_width(),Te=this.ratioY*this.window.get_height(),xe=(c/ze-.5)*2,_e=-(a/Te-.5)*2,ye=this.camera.unproject(xe,_e,0),pe=this.camera.unproject(xe,_e,1),c=ye.x,a=ye.y,h=ye.z;for(h==null&&(h=0),a==null&&(a=0),c==null&&(c=0),l=c,d=a,u=h,u==null&&(u=0),d==null&&(d=0),l==null&&(l=0),ge=l,ve=d,be=u,c=pe.x,a=pe.y,h=pe.z,h==null&&(h=0),a==null&&(a=0),c==null&&(c=0),l=c,d=a,u=h,u==null&&(u=0),d==null&&(d=0),l==null&&(l=0),Oe=l,we=d,Fe=u,E=new nt,E.px=ge,E.py=ve,E.pz=be,E.lx=Oe-ge,E.ly=we-ve,E.lz=Fe-be,E.normalize(),n=E,this.interactiveOffset!=0&&(n.px+=n.lx*this.interactiveOffset,n.py+=n.ly*this.interactiveOffset,n.pz+=n.lz*this.interactiveOffset),U=n.px,V=n.py,K=n.pz,$=n.lx,Y=n.ly,q=n.lz,J=-2147483648,M=0,B=this.interactives;M<B.length;){if(s=B[M],++M,s.priority<J)continue;for(I=s;I!=null&&(I.flags&2)!=0;)I=I.parent;if(I!=null)continue;if(s.isAbsoluteShape||(i=s.getInvPos(),c=n.px,a=n.py,h=n.pz,h==null&&(h=0),a==null&&(a=0),c==null&&(c=0),l=c,d=a,u=h,u==null&&(u=0),d==null&&(d=0),l==null&&(l=0),f=l,g=d,p=u,ee=f*i._11+g*i._21+p*i._31+i._41,he=f*i._12+g*i._22+p*i._32+i._42,ue=f*i._13+g*i._23+p*i._33+i._43,f=ee,g=he,p=ue,n.px=f,n.py=g,n.pz=p,F=n.lx,z=n.ly,N=n.lz,N==null&&(N=0),z==null&&(z=0),F==null&&(F=0),H=F,P=z,S=N,S==null&&(S=0),P==null&&(P=0),H==null&&(H=0),j=H,y=P,v=S,oe=j*i._11+y*i._21+v*i._31,Q=j*i._12+y*i._22+v*i._32,Z=j*i._13+y*i._23+v*i._33,j=oe,y=Q,v=Z,n.lx=j,n.ly=y,n.lz=v,n.normalize()),n.lx!=n.lx){n.px=U,n.py=V,n.pz=K,n.lx=$,n.ly=Y,n.lz=q;continue}if(C=s.shape.rayIntersection(n,s.bestMatch),C<0){n.px=U,n.py=V,n.pz=K,n.lx=$,n.ly=Y,n.lz=q;continue}if(L=n.px+C*n.lx,T=n.py+C*n.ly,A=n.pz+C*n.lz,A==null&&(A=0),T==null&&(T=0),L==null&&(L=0),R=L,k=T,D=A,D==null&&(D=0),k==null&&(k=0),R==null&&(R=0),ae=R,re=k,ce=D,n.px=U,n.py=V,n.pz=K,n.lx=$,n.ly=Y,n.lz=q,s.hitPoint.x=ae,s.hitPoint.y=re,s.hitPoint.z=ce,s.priority>J){for(;this.hitInteractives.length>0;)this.hitInteractives.pop();J=s.priority}this.hitInteractives.push(s)}if(this.hitInteractives.length==0)return null;if(this.hitInteractives.length>1){for(M=0,B=this.hitInteractives;M<B.length;)s=B[M],++M,o=s.invPos,je=0,(s.preciseShape!=null||!s.bestMatch)&&(s.isAbsoluteShape||(c=n.px,a=n.py,h=n.pz,h==null&&(h=0),a==null&&(a=0),c==null&&(c=0),l=c,d=a,u=h,u==null&&(u=0),d==null&&(d=0),l==null&&(l=0),f=l,g=d,p=u,ee=f*o._11+g*o._21+p*o._31+o._41,he=f*o._12+g*o._22+p*o._32+o._42,ue=f*o._13+g*o._23+p*o._33+o._43,f=ee,g=he,p=ue,n.px=f,n.py=g,n.pz=p,F=n.lx,z=n.ly,N=n.lz,N==null&&(N=0),z==null&&(z=0),F==null&&(F=0),H=F,P=z,S=N,S==null&&(S=0),P==null&&(P=0),H==null&&(H=0),j=H,y=P,v=S,oe=j*o._11+y*o._21+v*o._31,Q=j*o._12+y*o._22+v*o._32,Z=j*o._13+y*o._23+v*o._33,j=oe,y=Q,v=Z,n.lx=j,n.ly=y,n.lz=v,n.normalize()),fe=s.preciseShape,C=(fe??s.shape).rayIntersection(n,!0),C>0?(L=n.px+C*n.lx,T=n.py+C*n.ly,A=n.pz+C*n.lz,A==null&&(A=0),T==null&&(T=0),L==null&&(L=0),R=L,k=T,D=A,D==null&&(D=0),k==null&&(k=0),R==null&&(R=0),ae=R,re=k,ce=D,s.hitPoint.x=ae,s.hitPoint.y=re,s.hitPoint.z=ce):je=1,n.px=U,n.py=V,n.pz=K,n.lx=$,n.ly=Y,n.lz=q),W=s.hitPoint,me=W.x,te=W.y,de=W.z,le=W.w,le==null&&(le=1),de==null&&(de=0),te==null&&(te=0),me==null&&(me=0),ie=me,X=te,se=de,ne=le,ne==null&&(ne=1),se==null&&(se=0),X==null&&(X=0),ie==null&&(ie=0),w=ie,O=X,_=se,x=ne,x=1,s.isAbsoluteShape||(m=s.absPos,Ce=w*m._11+O*m._21+_*m._31+x*m._41,Ee=w*m._12+O*m._22+_*m._32+x*m._42,ke=w*m._13+O*m._23+_*m._33+x*m._43,w=Ce,O=Ee,_=ke),r=this.camera.m,Ae=w*r._11+O*r._21+_*r._31+x*r._41,Se=w*r._12+O*r._22+_*r._32+x*r._42,Me=w*r._13+O*r._23+_*r._33+x*r._43,G=1/(w*r._14+O*r._24+_*r._34+x*r._44),w=Ae*G,O=Se*G,_=Me*G,x=1,s.hitPoint.w=_+je;this.hitInteractives.sort(b(this,this.sortHitPointByCameraDistance))}this.hitInteractives.unshift(null)}for(;this.hitInteractives.length>0;){if(s=this.hitInteractives.pop(),s==null)return null;if(e.relX=s.hitPoint.x,e.relY=s.hitPoint.y,e.relZ=s.hitPoint.z,s.handleEvent(e),e.cancel){e.cancel=!1,e.propagate=!1;continue}if(!e.propagate)for(;this.hitInteractives.length>0;)this.hitInteractives.pop();return s}return null},clone:function(e){var t=e??new Ls;return t.camera=this.camera.clone(),se.prototype.clone.call(this,t),t},dispose:function(){(this.flags&32)!=0&&this.onRemove(),this.ctx.dispose(),this.renderer!=null&&(this.renderer.dispose(),this.set_renderer(new Ns))},addEventTarget:function(e){if(this.interactives.indexOf(e)>=0)throw t.thrown("assert");this.interactives.push(e)},removeEventTarget:function(e){u.remove(this.interactives,e)&&(this.events!=null&&this.events.onRemove(e),u.remove(this.hitInteractives,e))},setElapsedTime:function(e){this.ctx.elapsedTime=e},syncOnly:function(e){var t,n=K.CURRENT;this.setElapsedTime(e),t=n.getCurrentTarget(),t==null?this.camera.screenRatio=n.width/n.height:this.camera.screenRatio=t.width/t.height,this.camera.update(),this.ctx.start(),this.syncRec(this.ctx),this.ctx.done()},computeStatic:function(){var e=this.ctx.elapsedTime;this.ctx.elapsedTime=0,this.ctx.computingStatic=!0,this.render(K.CURRENT),this.ctx.computingStatic=!1,this.ctx.elapsedTime=e},onContextLost:function(){this.ctx.wasContextLost=!0},render:function(e){(this.flags&32)==0&&this.onAdd();var t,n,s,o,i,a,c,l,d,u,r=e.getCurrentTarget();for(r==null?this.camera.screenRatio=e.width/e.height:this.camera.screenRatio=r.width/r.height,this.camera.update(),this.camera.rightHanded&&e.driver.setRenderFlag(fa.CameraHandness,1),this.ctx.start(),this.renderer.start(),this.renderer.startEffects(),this.mark("sync"),this.syncRec(this.ctx),this.mark("emit"),this.emitRec(this.ctx),c=[],o=-1,s=0,i=this.ctx.passes.length;s<i;){if(d=s++,a=this.ctx.passes[d],a==null)continue;n=this.ctx.cachedPassObjects[++o],n==null&&(n=new Nr,this.ctx.cachedPassObjects[o]=n),n.name=a.pass.name,t=n.passes,t.current=a,t.discarded=t.lastDisc=null,c.push(n)}for(this.lightSystem!=null&&(this.ctx.lightSystem=this.lightSystem,this.lightSystem.initLights(this.ctx)),this.renderer.process(c),this.camera.rightHanded&&e.driver.setRenderFlag(fa.CameraHandness,0),this.ctx.done(),this.ctx.wasContextLost=!1,s=0,i=o;s<i;)u=s++,l=this.ctx.cachedPassObjects[u],l.name=null,t=l.passes,t.current=null,t.discarded=t.lastDisc=null},mark:function(e){this.renderer.mark(e)},setOutputTarget:function(e,n){if(n!=null){if(this.prevDB!=null)throw t.thrown("missing setOutputTarget()");e.pushTarget(n),e.width=n.width,e.height=n.height,this.prevDB=this.ctx.textures.defaultDepthBuffer,this.prevEngine=e,this.ctx.textures.defaultDepthBuffer=n.depthBuffer}else this.prevEngine.popTarget(),this.prevEngine.width=this.prevDB.width,this.prevEngine.height=this.prevDB.height,this.ctx.textures.defaultDepthBuffer=this.prevDB,this.prevDB=null,this.prevEngine=null},getRenderCamera:function(){return this.ctx.camera},__class__:Ls}),yi=function(e,t){se.call(this,null),this.name=t.name,this.skin=e,this.lastFrame=-2,this.parent=e,this.index=t.index},c["h3d.scene.Joint"]=yi,yi.__name__="h3d.scene.Joint",yi.__super__=se,yi.prototype=g(se.prototype,{getObjectByName:function(e){var n,o,i,a=this.skin.getSkinData(),s=a.namedJoints.h[e];if(s==null)return null;if(o=a.allJoints[this.index],o.index!=this.index)throw t.thrown("assert");for(n=s.parent;n!=null;){if(n==o)return i=new yi(this.skin,s),i.parent=this,i;n=n.parent}return null},syncPos:function(){for(var e=this.skin;e!=null;){if((e.flags&1)!=0){this.update();break}e=e.parent}this.lastFrame!=this.skin.lastFrame&&(this.lastFrame=this.skin.lastFrame,this.absPos.load(this.skin.jointsData[this.index].currentAbsPos))},update:function(){this.skin.getAbsPos(),this.skin.syncJoints(),this.lastFrame=-1},__class__:yi}),us=function(){this.originMat=Be.I(),this.targetMat=Be.I(),this.currentAbsPos=Be.I()},c["h3d.scene.JointData"]=us,us.__name__="h3d.scene.JointData",us.prototype={sync:function(e,t){if(t.follow!=null)return;var s,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,D,i=this.currentAbsPos,o=this.currentRelPos,z=t.bindIndex;o==null?o=t.defMat:t.retargetAnim&&e.enableRetargeting&&(Ne.TMP_MAT.load(o),o=Ne.TMP_MAT,o._41=t.defMat._41,o._42=t.defMat._42,o._43=t.defMat._43),t.parent==null?(s=i,r=e.absPos,A=o._11,k=o._12,b=o._13,v=o._21,C=o._22,x=o._23,O=o._31,w=o._32,_=o._33,y=o._41,E=o._42,j=o._43,l=r._11,g=r._12,p=r._13,f=r._21,m=r._22,h=r._23,d=r._31,c=r._32,u=r._33,S=r._41,M=r._42,F=r._43,s._11=A*l+k*f+b*d,s._12=A*g+k*m+b*c,s._13=A*p+k*h+b*u,s._14=0,s._21=v*l+C*f+x*d,s._22=v*g+C*m+x*c,s._23=v*p+C*h+x*u,s._24=0,s._31=O*l+w*f+_*d,s._32=O*g+w*m+_*c,s._33=O*p+w*h+_*u,s._34=0,s._41=y*l+E*f+j*d+S,s._42=y*g+E*m+j*c+M,s._43=y*p+E*h+j*u+F,s._44=1):(s=i,r=e.jointsData[t.parent.index].currentAbsPos,A=o._11,k=o._12,b=o._13,v=o._21,C=o._22,x=o._23,O=o._31,w=o._32,_=o._33,y=o._41,E=o._42,j=o._43,l=r._11,g=r._12,p=r._13,f=r._21,m=r._22,h=r._23,d=r._31,c=r._32,u=r._33,S=r._41,M=r._42,F=r._43,s._11=A*l+k*f+b*d,s._12=A*g+k*m+b*c,s._13=A*p+k*h+b*u,s._14=0,s._21=v*l+C*f+x*d,s._22=v*g+C*m+x*c,s._23=v*p+C*h+x*u,s._24=0,s._31=O*l+w*f+_*d,s._32=O*g+w*m+_*c,s._33=O*p+w*h+_*u,s._34=0,s._41=y*l+E*f+j*d+S,s._42=y*g+E*m+j*c+M,s._43=y*p+E*h+j*u+F,s._44=1),this.additivePose!=null&&(s=i,a=this.additivePose,A=a._11,k=a._12,b=a._13,v=a._21,C=a._22,x=a._23,O=a._31,w=a._32,_=a._33,y=a._41,E=a._42,j=a._43,l=i._11,g=i._12,p=i._13,f=i._21,m=i._22,h=i._23,d=i._31,c=i._32,u=i._33,S=i._41,M=i._42,F=i._43,s._11=A*l+k*f+b*d,s._12=A*g+k*m+b*c,s._13=A*p+k*h+b*u,s._14=0,s._21=v*l+C*f+x*d,s._22=v*g+C*m+x*c,s._23=v*p+C*h+x*u,s._24=0,s._31=O*l+w*f+_*d,s._32=O*g+w*m+_*c,s._33=O*p+w*h+_*u,s._34=0,s._41=y*l+E*f+j*d+S,s._42=y*g+E*m+j*c+M,s._43=y*p+E*h+j*u+F,s._44=1),z>=0&&(s=e.currentPalette[z],a=t.transPos,A=a._11,k=a._12,b=a._13,v=a._21,C=a._22,x=a._23,O=a._31,w=a._32,_=a._33,y=a._41,E=a._42,j=a._43,l=i._11,g=i._12,p=i._13,f=i._21,m=i._22,h=i._23,d=i._31,c=i._32,u=i._33,S=i._41,M=i._42,F=i._43,s._11=A*l+k*f+b*d,s._12=A*g+k*m+b*c,s._13=A*p+k*h+b*u,s._14=0,s._21=v*l+C*f+x*d,s._22=v*g+C*m+x*c,s._23=v*p+C*h+x*u,s._24=0,s._31=O*l+w*f+_*d,s._32=O*g+w*m+_*c,s._33=O*p+w*h+_*u,s._34=0,s._41=y*l+E*f+j*d+S,s._42=y*g+E*m+j*c+M,s._43=y*p+E*h+j*u+F,s._44=1),T=e.jointsData[t.index],D=T instanceof us?T:null,D.originMat.load(this.targetMat)},__class__:us},J=function(){this.f=-1,us.call(this);var e=0,t=0,n=0;n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.speed=new h(e,t,n)},c["h3d.scene.DynamicJointData"]=J,J.__name__="h3d.scene.DynamicJointData",J.__super__=us,J.prototype=g(us.prototype,{load:function(e){e.currentRelPos!=null&&(this.currentRelPos==null&&(this.currentRelPos=new L),this.currentRelPos.load(e.currentRelPos)),e.currentAbsPos!=null&&(this.currentAbsPos==null&&(this.currentAbsPos=new L),this.currentAbsPos.load(e.currentAbsPos)),e.additivePose!=null&&(this.additivePose==null&&(this.additivePose=new L),this.additivePose.load(e.additivePose)),e.absPos!=null&&(this.absPos==null&&(this.absPos=new L),this.absPos.load(e.absPos));var t=this.speed,n=e.speed;t.x=n.x,t.y=n.y,t.z=n.z},sync:function(e,t,n){us.prototype.sync.call(this,e,t,n),this.f!=N.frameCount?(this.f=N.frameCount,this.initialState==null&&(this.initialState=new J),this.initialState.load(this)):this.load(this.initialState);var s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,S,M,F,T,z,A=e.jointsData[t.index],k=A instanceof J?A:null,A=e.jointsData[t.parent.index],D=A instanceof us?A:null;if(n&&(k.originMat.load(k.targetMat),this.computeDyn(e,t),this.computeRotationDyn(e,t.parent)),k.originMat==null||k.targetMat==null)return;S=e.accumulator/Ne.FIXED_DT,z=S<0?0:S>1?1:S,this.lerpMatrixTerms(k.originMat,k.targetMat,z,Ne.TMP_MAT),t.bindIndex>=0&&(s=e.currentPalette[t.bindIndex],o=t.transPos,i=Ne.TMP_MAT,p=o._11,E=o._12,C=o._13,g=o._21,O=o._22,x=o._23,v=o._31,b=o._32,j=o._33,y=o._41,_=o._42,w=o._43,a=i._11,f=i._12,m=i._13,h=i._21,u=i._22,d=i._23,l=i._31,c=i._32,r=i._33,M=i._41,F=i._42,T=i._43,s._11=p*a+E*h+C*l,s._12=p*f+E*u+C*c,s._13=p*m+E*d+C*r,s._14=0,s._21=g*a+O*h+x*l,s._22=g*f+O*u+x*c,s._23=g*m+O*d+x*r,s._24=0,s._31=v*a+b*h+j*l,s._32=v*f+b*u+j*c,s._33=v*m+b*d+j*r,s._34=0,s._41=y*a+_*h+w*l+M,s._42=y*f+_*u+w*c+F,s._43=y*m+_*d+w*r+T,s._44=1),t.parent.bindIndex>=0&&(this.lerpMatrixTerms(D.originMat,D.targetMat,z,Ne.TMP_MAT),s=e.currentPalette[t.parent.bindIndex],o=t.parent.transPos,i=D.currentAbsPos,p=o._11,E=o._12,C=o._13,g=o._21,O=o._22,x=o._23,v=o._31,b=o._32,j=o._33,y=o._41,_=o._42,w=o._43,a=i._11,f=i._12,m=i._13,h=i._21,u=i._22,d=i._23,l=i._31,c=i._32,r=i._33,M=i._41,F=i._42,T=i._43,s._11=p*a+E*h+C*l,s._12=p*f+E*u+C*c,s._13=p*m+E*d+C*r,s._14=0,s._21=g*a+O*h+x*l,s._22=g*f+O*u+x*c,s._23=g*m+O*d+x*r,s._24=0,s._31=v*a+b*h+j*l,s._32=v*f+b*u+j*c,s._33=v*m+b*d+j*r,s._34=0,s._41=y*a+_*h+w*l+M,s._42=y*f+_*u+w*c+F,s._43=y*m+_*d+w*r+T,s._44=1),s=k.speed,Math.sqrt(s.x*s.x+s.y*s.y+s.z*s.z)!=0&&(e.forceJointsUpdateOnFrame=N.frameCount+1)},computeDyn:function(e,t){var a,r,c,l,d,u,h,m,f,v,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,R,H,I,B,b=t,V=e.jointsData[b.index],g=V instanceof J?V:null,P=g.absPos==null?g.currentAbsPos:g.absPos,$=b.defMat,i=J.newWorldPos,p=P,s=0,o=0,n=0;n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,s=p._41,o=p._42,n=p._43,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,i.x=u,i.y=h,i.z=m,i=J.expectedPos,p=P,s=0,o=0,n=0,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,s=p._41,o=p._42,n=p._43,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,i.x=u,i.y=h,i.z=m,D=b.globalForce,i=this.speed,a=this.speed,f=1-b.resistance,s=D.x*f,o=D.y*f,n=D.z*f,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),u=l,h=c,m=r,s=a.x+u,o=a.y+h,n=a.z+m,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),u=l,h=c,m=r,i.x=u,i.y=h,i.z=m,a=g.speed,f=1-b.damping,a.x*=f,a.y*=f,a.z*=f,i=g.speed,i.x*i.x+i.y*i.y+i.z*i.z>Un.SLEEP_THRESHOLD&&(i=J.newWorldPos,a=J.newWorldPos,C=g.speed,f=Ne.FIXED_DT,s=C.x*f,o=C.y*f,n=C.z*f,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),u=l,h=c,m=r,s=a.x+u,o=a.y+h,n=a.z+m,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),u=l,h=c,m=r,i.x=u,i.y=h,i.z=m),i=g.speed,i.x*i.x+i.y*i.y+i.z*i.z>Un.MAX_THRESHOLD&&(i=g.speed,s=0,o=0,n=0,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),i.x=s,i.y=o,i.z=n),Ne.TMP_MAT.multiply($,e.jointsData[b.parent.index].currentAbsPos),i=J.expectedPos,p=Ne.TMP_MAT,s=0,o=0,n=0,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,s=p._41,o=p._42,n=p._43,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,i.x=u,i.y=h,i.z=m,i=J.newWorldPos,O=J.newWorldPos,x=J.expectedPos,j=b.stiffness,v=O.x,i.x=v+j*(x.x-v),v=O.y,i.y=v+j*(x.y-v),v=O.z,i.z=v+j*(x.z-v),a=J.newWorldPos,i=e.jointsData[b.parent.index].currentAbsPos,s=0,o=0,n=0,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,s=i._41,o=i._42,n=i._43,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,s=a.x-u,o=a.y-h,n=a.z-m,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),y=l,_=c,w=r,j=y*y+_*_+w*w,j<1e-20?j=0:j=1/Math.sqrt(j),s=y*j,o=_*j,n=w*j,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),B=l,I=c,H=r,i=$,s=0,o=0,n=0,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),y=s,_=o,w=n,s=i._41,o=i._42,n=i._43,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),y=s,_=o,w=n,T=Math.sqrt(y*y+_*_+w*w),i=e.jointsData[b.parent.index].currentAbsPos,s=0,o=0,n=0,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),z=s,N=o,R=n,z=Math.sqrt(i._11*i._11+i._12*i._12+i._13*i._13),N=Math.sqrt(i._21*i._21+i._22*i._22+i._23*i._23),R=Math.sqrt(i._31*i._31+i._32*i._32+i._33*i._33),i._11*(i._22*i._33-i._23*i._32)+i._12*(i._23*i._31-i._21*i._33)+i._13*(i._21*i._32-i._22*i._31)<0&&(z*=-1,N*=-1,R*=-1),i=J.expectedPos,p=e.jointsData[b.parent.index].currentAbsPos,s=0,o=0,n=0,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),y=s,_=o,w=n,s=p._41,o=p._42,n=p._43,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),y=s,_=o,w=n,s=B*T,o=I*T,n=H*T,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),F=l,M=c,S=r,f=z,s=F*f,o=M*f,n=S*f,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),u=l,h=c,m=r,s=y+u,o=_+h,n=w+m,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),u=l,h=c,m=r,i.x=u,i.y=h,i.z=m,i=J.newWorldPos,O=J.expectedPos,x=J.newWorldPos,j=b.slackness,v=O.x,i.x=v+j*(x.x-v),v=O.y,i.y=v+j*(x.y-v),v=O.z,i.z=v+j*(x.z-v),e.jointsData[b.parent.index].currentAbsPos.getInverse(Ne.TMP_MAT),i=J.tmpVec,f=J.newWorldPos,i.x=f.x,i.y=f.y,i.z=f.z,a=J.tmpVec,d=Ne.TMP_MAT,A=a.x*d._11+a.y*d._21+a.z*d._31+d._41,k=a.x*d._12+a.y*d._22+a.z*d._32+d._42,E=a.x*d._13+a.y*d._23+a.z*d._33+d._43,a.x=A,a.y=k,a.z=E,i=J.tmpVec2,p=g.currentAbsPos,s=0,o=0,n=0,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,s=p._41,o=p._42,n=p._43,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,i.x=u,i.y=h,i.z=m,a=J.tmpVec2,d=Ne.TMP_MAT,A=a.x*d._11+a.y*d._21+a.z*d._31+d._41,k=a.x*d._12+a.y*d._22+a.z*d._32+d._42,E=a.x*d._13+a.y*d._23+a.z*d._33+d._43,a.x=A,a.y=k,a.z=E,b.lockAxis.x>0&&(J.tmpVec.x=J.tmpVec2.x),b.lockAxis.y>0&&(J.tmpVec.y=J.tmpVec2.y),b.lockAxis.z>0&&(J.tmpVec.z=J.tmpVec2.z),a=J.tmpVec,d=e.jointsData[b.parent.index].currentAbsPos,A=a.x*d._11+a.y*d._21+a.z*d._31+d._41,k=a.x*d._12+a.y*d._22+a.z*d._32+d._42,E=a.x*d._13+a.y*d._23+a.z*d._33+d._43,a.x=A,a.y=k,a.z=E,i=J.newWorldPos,f=J.tmpVec,i.x=f.x,i.y=f.y,i.z=f.z,i=g.speed,a=g.speed,C=J.newWorldPos,p=P,s=0,o=0,n=0,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,s=p._41,o=p._42,n=p._43,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),u=s,h=o,m=n,s=C.x-u,o=C.y-h,n=C.z-m,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),F=l,M=c,S=r,f=1/Ne.FIXED_DT,s=F*f,o=M*f,n=S*f,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),u=l,h=c,m=r,s=a.x+u,o=a.y+h,n=a.z+m,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),F=l,M=c,S=r,s=F*.5,o=M*.5,n=S*.5,n==null&&(n=0),o==null&&(o=0),s==null&&(s=0),l=s,c=o,r=n,r==null&&(r=0),c==null&&(c=0),l==null&&(l=0),u=l,h=c,m=r,i.x=u,i.y=h,i.z=m,i=g.currentAbsPos,f=J.newWorldPos,i._41=f.x,i._42=f.y,i._43=f.z,g.absPos==null&&(g.absPos=new L),g.absPos.load(g.currentAbsPos),g.relPos==null&&(g.relPos=new L),e.jointsData[b.parent.index].currentAbsPos.getInverse(Ne.TMP_MAT),g.relPos.multiply(g.absPos,Ne.TMP_MAT),g.targetMat.load(g.currentAbsPos)},computeRotationDyn:function(e,t){if(t.follow!=null)return;var n,s,o,i,a,r,c,l,d,u,h,m,g,v,b,j,y,p=e.jointsData[t.index],f=e.jointsData[t.index],_=f instanceof J?f:null,w=t instanceof Un?t:null;if(t.subs.length==1){if(f=t.subs[0],g=f instanceof Un?f:null,g==null)return;f=e.jointsData[g.index],y=f instanceof J?f:null,u=J.tmpVec,h=g.defMat,n=0,o=0,s=0,s==null&&(s=0),o==null&&(o=0),n==null&&(n=0),c=n,r=o,a=s,n=h._41,o=h._42,s=h._43,s==null&&(s=0),o==null&&(o=0),n==null&&(n=0),c=n,r=o,a=s,i=c*c+r*r+a*a,i<1e-20?i=0:i=1/Math.sqrt(i),n=c*i,o=r*i,s=a*i,s==null&&(s=0),o==null&&(o=0),n==null&&(n=0),l=n,m=o,d=s,d==null&&(d=0),m==null&&(m=0),l==null&&(l=0),v=l,b=m,j=d,u.x=v,u.y=b,u.z=j,u=J.tmpVec2,h=y.relPos,n=0,o=0,s=0,s==null&&(s=0),o==null&&(o=0),n==null&&(n=0),c=n,r=o,a=s,n=h._41,o=h._42,s=h._43,s==null&&(s=0),o==null&&(o=0),n==null&&(n=0),c=n,r=o,a=s,i=c*c+r*r+a*a,i<1e-20?i=0:i=1/Math.sqrt(i),n=c*i,o=r*i,s=a*i,s==null&&(s=0),o==null&&(o=0),n==null&&(n=0),l=n,m=o,d=s,d==null&&(d=0),m==null&&(m=0),l==null&&(l=0),v=l,b=m,j=d,u.x=v,u.y=b,u.z=j,J.tmpQ.initMoveTo(J.tmpVec,J.tmpVec2),J.tmpQ.toMatrix(Ne.TMP_MAT),p.currentAbsPos.multiply(Ne.TMP_MAT,p.currentAbsPos)}p.targetMat.load(p.currentAbsPos)},lerpMatrixTerms:function(e,t,n,s){var o=e._11;return s._11=o+n*(t._11-o),o=e._12,s._12=o+n*(t._12-o),o=e._13,s._13=o+n*(t._13-o),o=e._14,s._14=o+n*(t._14-o),o=e._21,s._21=o+n*(t._21-o),o=e._22,s._22=o+n*(t._22-o),o=e._23,s._23=o+n*(t._23-o),o=e._24,s._24=o+n*(t._24-o),o=e._31,s._31=o+n*(t._31-o),o=e._32,s._32=o+n*(t._32-o),o=e._33,s._33=o+n*(t._33-o),o=e._34,s._34=o+n*(t._34-o),o=e._41,s._41=o+n*(t._41-o),o=e._42,s._42=o+n*(t._42-o),o=e._43,s._43=o+n*(t._43-o),o=e._44,s._44=o+n*(t._44-o),s},__class__:J}),Ne=function(e,t,n){this.prevEnableRetargeting=!0,this.enableRetargeting=!0,this.forceJointsUpdateOnFrame=-1,this.prevJointsFrame=-1,this.accumulator=Ne.FIXED_DT,Qt.call(this,null,t,n),e!=null&&this.setSkinData(e)},c["h3d.scene.Skin"]=Ne,Ne.__name__="h3d.scene.Skin",Ne.__super__=Qt,Ne.prototype=g(Qt.prototype,{clone:function(e){var n,s,o,t=e??new Ne(null,this.materials.slice());for(Qt.prototype.clone.call(this,t),t.setSkinData(this.skinData),t.jointsData=[],n=0,s=this.jointsData;n<s.length;)o=s[n],++n,t.jointsData.push(q.copy(o));return t},addBoundsRec:function(e,t){var n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,I,B,V,$,W,U,K,q,Y,G,X,Q=this.primitive;if(this.set_primitive(null),Qt.prototype.addBoundsRec.call(this,e,t),this.set_primitive(Q),(this.flags&512)!=0)return;for(this.syncJoints(),this.skinData.vertexWeights==null&&H.__cast(this.primitive,Mo).loadSkin(this.skinData),n=this.getAbsPos(),m=0,f=0,h=0,h==null&&(h=0),f==null&&(f=0),m==null&&(m=0),A=m,w=f,C=h,A=Math.sqrt(n._11*n._11+n._12*n._12+n._13*n._13),w=Math.sqrt(n._21*n._21+n._22*n._22+n._23*n._23),C=Math.sqrt(n._31*n._31+n._32*n._32+n._33*n._33),n._11*(n._22*n._33-n._23*n._32)+n._12*(n._23*n._31-n._21*n._33)+n._13*(n._21*n._32-n._22*n._31)<0&&(A*=-1,w*=-1,C*=-1),L=Math.max(Math.max(A,w),C),M=0,R=this.skinData.allJoints;M<R.length;){if(p=R[M],++M,p.offsetRay<0)continue;s=this.currentPalette[p.bindIndex],n=p.offsets,m=n.xMin,f=n.yMin,h=n.zMin,h==null&&(h=0),f==null&&(f=0),m==null&&(m=0),x=m,E=f,k=h,k==null&&(k=0),E==null&&(E=0),x==null&&(x=0),u=x,l=E,d=k,s!=null&&(I=u*s._11+l*s._21+d*s._31+s._41,Y=u*s._12+l*s._22+d*s._32+s._42,q=u*s._13+l*s._23+d*s._33+s._43,u=I,l=Y,d=q,t!=null&&(X=u*t._11+l*t._21+d*t._31+t._41,P=u*t._12+l*t._22+d*t._32+t._42,G=u*t._13+l*t._23+d*t._33+t._43,u=X,l=P,d=G),g=u,y=l,_=d,i=p.offsetRay*L,g-i<e.xMin&&(e.xMin=g-i),g+i>e.xMax&&(e.xMax=g+i),y-i<e.yMin&&(e.yMin=y-i),y+i>e.yMax&&(e.yMax=y+i),_-i<e.zMin&&(e.zMin=_-i),_+i>e.zMax&&(e.zMax=_+i),T=p.offsets,O=T.xMax,z=T.yMax,D=T.zMax,D==null&&(D=0),z==null&&(z=0),O==null&&(O=0),N=O,F=z,S=D,S==null&&(S=0),F==null&&(F=0),N==null&&(N=0),a=N,c=F,r=S,B=a*s._11+c*s._21+r*s._31+s._41,V=a*s._12+c*s._22+r*s._32+s._42,$=a*s._13+c*s._23+r*s._33+s._43,a=B,c=V,r=$,t!=null&&(W=a*t._11+c*t._21+r*t._31+t._41,U=a*t._12+c*t._22+r*t._32+t._42,K=a*t._13+c*t._23+r*t._33+t._43,a=W,c=U,r=K),j=a,b=c,v=r,o=p.offsetRay*L,j-o<e.xMin&&(e.xMin=j-o),j+o>e.xMax&&(e.xMax=j+o),b-o<e.yMin&&(e.yMin=b-o),b+o>e.yMax&&(e.yMax=b+o),v-o<e.zMin&&(e.zMin=v-o),v+o>e.zMax&&(e.zMax=v+o))}},getCurrentSkeletonBounds:function(){this.syncJoints();for(var t,n,s,o,a,e=new Ce,i=0,r=this.skinData.allJoints;i<r.length;){if(a=r[i],++i,a.bindIndex<0)continue;o=this.jointsData[a.index].currentAbsPos,t=o._41,n=o._42,s=o._43,t<e.xMin&&(e.xMin=t),t>e.xMax&&(e.xMax=t),n<e.yMin&&(e.yMin=n),n>e.yMax&&(e.yMax=n),s<e.zMin&&(e.zMin=s),s>e.zMax&&(e.zMax=s)}return e},getObjectByName:function(e){if(this.skinData!=null&&this.skinData.name==e)return this;var t,n=Qt.prototype.getObjectByName.call(this,e);return n??(this.skinData!=null&&(t=this.skinData.namedJoints.h[e],t!=null)?new yi(this,t):null)},getLocalCollider:function(){throw t.thrown("Not implemented")},getGlobalCollider:function(){var e=H.__cast(this.primitive.getCollider(),fi);return H.__cast(this.primitive,Mo).loadSkin(this.skinData),new nr(this,H.__cast(e.b,Do))},calcAbsPos:function(){Qt.prototype.calcAbsPos.call(this),this.jointsUpdated=!0},getSkinData:function(){return this.skinData},getJointRelPosition:function(e,t){t==null&&(t=!1);var s,n=this.skinData.namedJoints.h[e];return n==null?null:t?this.jointsData[n.index].additivePose:(s=this.jointsData[n.index].currentRelPos,s??n.defMat)},setJointRelPosition:function(e,t,n){n==null&&(n=!1);var s=this.skinData.namedJoints.h[e];if(s==null)return;n?this.jointsData[s.index].additivePose=t:this.jointsData[s.index].currentRelPos=t,this.jointsUpdated=!0},setSkinData:function(e,t){if(t==null&&(t=!0),this.skinData=e,this.jointsUpdated=!0,this.set_primitive(e.primitive),t){for(var e,o,i,a,r,c,l,d,u,m,f,h=!1,n=0,s=this.materials;n<s.length;)if(o=s[n],++n,o!=null&&o.get_normalMap()!=null){h=!0;break}if(this.skinShader=h?new Bs:new co,i=this.skinShader,i.constModified=!0,i.fourBonesByVertex__=this.skinData.bonesPerVertex==4,a=0,this.skinData.splitJoints!=null)for(n=0,s=this.skinData.splitJoints;n<s.length;)e=s[n],++n,e.joints.length>a&&(a=e.joints.length);else a=this.skinData.boundJoints.length;for(this.skinShader.MaxBones__<a&&(i=this.skinShader,i.constModified=!0,i.MaxBones__=a),n=0,s=this.materials;n<s.length;)o=s[n],++n,o!=null&&(e=o.passes.getShader(Bs),e!=null&&o.passes.removeShader(e),o.get_normalMap()!=null?o.passes.addShaderAtIndex(this.skinShader,o.passes.getShaderIndex(o.normalShader)+1):o.passes.addShader(this.skinShader),this.skinData.splitJoints!=null&&o.passes.set_dynamicParameters(!0))}for(this.jointsData=[],this.currentPalette=[],this.prevPalette=null,this.prevSplitPalette=null,this.paletteChanged=!0,this.makeJointsData(),n=0,s=this.skinData.boundJoints.length;n<s;)f=n++,this.currentPalette.push(Be.I());if(this.skinData.splitJoints!=null)for(this.splitPalette=[],n=0,s=this.skinData.splitJoints;n<s.length;){for(d=s[n],++n,u=this.splitPalette,c=[],r=0,l=d.joints;r<l.length;)m=l[r],++r,c.push(this.currentPalette[m.bindIndex]);u.push(c)}else this.splitPalette=null},makeJointsData:function(){for(var t,e=0,n=this.skinData.allJoints;e<n.length;)t=n[e],++e,this.jointsData[t.index]=t.makeRuntimeData()},sync:function(e){if(!e.visibleFlag&&(this.flags&64)==0)return;this.syncJoints()},syncJoints:function(){if(!this.jointsUpdated&&this.forceJointsUpdateOnFrame>=N.frameCount)return;if(this.computeVelocity()){this.syncPrevJoints();var t,n,s,o,i,e=this.skinShader;e.constModified=!0,e.calcPrevPos__=!0}else this.prevSplitPalette=null,this.prevPalette=null,e=this.skinShader,e.constModified=!0,e.calcPrevPos__=!1;for(e=this.skinShader,i=this.computeVelocity(),e.constModified=!0,e.calcPrevPos__=i,n=!1,this.accumulator+=N.dt,this.accumulator>=Ne.FIXED_DT&&(n=!0,this.accumulator-=Ne.FIXED_DT),t=0,s=this.skinData.allJoints;t<s.length;)o=s[t],++t,this.jointsData[o.index].sync(this,o,n);this.skinShader.bonesMatrixes__=this.currentPalette,this.jointsUpdated=!1,this.prevEnableRetargeting=this.enableRetargeting},syncPrevJoints:function(){if(this.prevJointsFrame==N.frameCount)return;if(this.prevJointsFrame=N.frameCount,this.prevPalette==null){this.prevPalette=[];for(var t,s,o,i,a,r,c,l,d,u,h,m,f,e=0,n=this.currentPalette.length;e<n;)f=e++,this.prevPalette.push(Be.I());if(this.splitPalette!=null)for(this.prevSplitPalette=[],e=0,n=this.skinData.splitJoints;e<n.length;){for(l=n[e],++e,c=this.prevSplitPalette,a=[],s=0,o=l.joints;s<o.length;)r=o[s],++s,a.push(this.prevPalette[r.bindIndex]);c.push(a)}}for(t=0,i=this.currentPalette;t<i.length;)d=i[t],u=t++,h=u,m=d,this.prevPalette[h].load(m);this.skinShader.prevBonesMatrixes__=this.prevPalette},emit:function(e){if(this.calcScreenRatio(e),this.syncJoints(),this.splitPalette==null)Qt.prototype.emit.call(this,e);else for(var t,s,o,i,a,r,l,d,u,n=0,c=this.splitPalette.length;n<c;)if(u=n++,t=this.materials[this.skinData.splitJoints[u].material],t!=null)for(l=u,l==null&&(l=0),s=t.passes;s!=null;)s.culled||(e.emitPass(s,this).index=l),s=s.nextPass;if(this.showJoints){for(this.jointsGraphics==null&&(this.jointsGraphics=new Gn(this),this.jointsGraphics.material.passes.depth(!1,Ae.Always),this.jointsGraphics.material.passes.setPassName("alpha")),o=this;o.parent!=null;)o=o.parent;for(this.jointsGraphics.set_follow(o),i=this.jointsGraphics,i.clear(),n=0,c=this.skinData.allJoints;n<c.length;)a=c[n],++n,t=this.jointsData[a.index].currentAbsPos,d=a.parent==null?this.absPos:this.jointsData[a.parent.index].currentAbsPos,i.lineStyle(1,a.parent==null?-16776961:-256),i.moveTo(d._41,d._42,d._43),i.lineTo(t._41,t._42,t._43)}else this.jointsGraphics!=null&&(r=this.jointsGraphics,r!=null&&r.parent!=null&&r.parent.removeChild(r),this.jointsGraphics=null)},draw:function(e){if(this.splitPalette==null)Qt.prototype.draw.call(this,e);else{var t=e.drawPass.index;this.skinShader.bonesMatrixes__=this.splitPalette[t],this.prevSplitPalette!=null&&(this.skinShader.prevBonesMatrixes__=this.prevSplitPalette[t]),this.primitive.selectMaterial(t,this.primitive.screenRatioToLod(this.curScreenRatio)),e.uploadParams(),this.primitive.render(e.engine)}},__class__:Ne}),fs=function(e,t){this.priority=0,this.cullingDistance=-1,ri.call(this,e,t)},c["h3d.scene.fwd.Light"]=fs,fs.__name__="h3d.scene.fwd.Light",fs.__super__=ri,fs.prototype=g(ri.prototype,{get_enableSpecular:function(){return!1},set_enableSpecular:function(e){if(e)throw t.thrown("Not implemented for this light");return!1},__class__:fs}),Ha=function(e,t){this.dshader=new wo,fs.call(this,this.dshader,t),this.priority=100,e!=null&&this.setDirection(e)},c["h3d.scene.fwd.DirLight"]=Ha,Ha.__name__="h3d.scene.fwd.DirLight",Ha.__super__=fs,Ha.prototype=g(fs.prototype,{get_color:function(){return this.dshader.color__},set_color:function(e){return this.dshader.color__=e},get_enableSpecular:function(){return this.dshader.enableSpecular__},set_enableSpecular:function(e){var t=this.dshader;return t.constModified=!0,t.enableSpecular__=e},getShadowDirection:function(){var t,i,e=this.absPos,n=e._11,s=e._12,o=e._13;return o==null&&(o=0),s==null&&(s=0),n==null&&(n=0),i=new h(n,s,o),e=i,t=e.x*e.x+e.y*e.y+e.z*e.z,t<1e-20?t=0:t=1/Math.sqrt(t),e.x*=t,e.y*=t,e.z*=t,i},emit:function(e){var t,s,o,i,a,r,c,n=this.dshader.direction__,l=this.absPos,d=l._11,u=l._12,h=l._13;h==null&&(h=0),u==null&&(u=0),d==null&&(d=0),a=d,r=u,c=h,c==null&&(c=0),r==null&&(r=0),a==null&&(a=0),s=a,o=r,i=c,t=s*s+o*o+i*i,t<1e-20?t=0:t=1/Math.sqrt(t),s*=t,o*=t,i*=t,n.x=s,n.y=o,n.z=i,n=this.dshader.direction__,t=n.x*n.x+n.y*n.y+n.z*n.z,t<1e-20?t=0:t=1/Math.sqrt(t),n.x*=t,n.y*=t,n.z*=t,fs.prototype.emit.call(this,e)},__class__:Ha}),Mi=function(){this.perPixelLighting=!0,this.maxLightsPerObject=6,pi.call(this);var e=.5,t=.5,n=.5;n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.ambientLight=new h(e,t,n),this.ambientShader=new ys,this.set_additiveLighting(!0)},c["h3d.scene.fwd.LightSystem"]=Mi,Mi.__name__="h3d.scene.fwd.LightSystem",Mi.__super__=pi,Mi.prototype=g(pi.prototype,{get_additiveLighting:function(){var e=this.ambientShader;return(e instanceof ys?e:null).additive__},set_additiveLighting:function(e){var t=this.ambientShader,n=t instanceof ys?t:null;return n.constModified=!0,n.additive__=e},initLights:function(e){if(this.lightCount=0,this.ctx=e,this.cullLights(),pi.prototype.initLights.call(this,e),this.lightCount<=this.maxLightsPerObject){var t,n,s,o,i,r,c,l,d,u,h,f,a=e.lights,m=b(this,this.sortLight);if(a==null)d=null;else{for(c=1,o=0,i=0;!0;){for(n=a,a=null,r=null,l=0;n!=null;){for(++l,t=n,o=0,u=0,h=c;u<h;)if(f=u++,++o,t=t.next,t==null)break;for(i=c;o>0||i>0&&t!=null;)o==0?(s=t,t=t.next,--i):i==0||t==null||m(n,t)<=0?(s=n,n=n.next,--o):(s=t,t=t.next,--i),r!=null?r.next=s:a=s,r=s;n=t}if(r.next=null,l<=1)break;c*=2}d=a}e.lights=d}},initGlobals:function(e){e.set("global.ambientLight",this.ambientLight),e.set("global.perPixelLighting",this.perPixelLighting)},cullLights:function(){for(var t,e=this.ctx.lights,s=null,n=new Is;e!=null;){if(t=e instanceof fs?e:null,t!=null&&(n.x=t.absPos._41,n.y=t.absPos._42,n.z=t.absPos._43,n.r=t.cullingDistance),t==null||t.cullingDistance>0&&!this.ctx.computingStatic&&!this.ctx.camera.frustum.hasSphere(n)){s==null?this.ctx.lights=e.next:s.next=e.next,e=e.next;continue}this.lightCount++,t.objectDistance=0,s=e,e=e.next}},sortLight:function(e,t){var n=e.priority-t.priority;return n!=0?-n:e.objectDistance<t.objectDistance?-1:1},computeLight:function(e,t){var n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,j,y,_,w,x,C,O=this;if(this.lightCount>this.maxLightsPerObject){for(a=this.ctx.lights;a!=null;)n=a instanceof fs?a:null,(e.flags&16)!=0?(y=n.absPos._41-this.ctx.camera.target.x,j=n.absPos._42-this.ctx.camera.target.y,d=n.absPos._43-this.ctx.camera.target.z,d==null&&(d=0),n.objectDistance=y*y+j*j+d*d):(f=n.absPos._41-e.absPos._41,g=n.absPos._42-e.absPos._42,h=n.absPos._43-e.absPos._43,h==null&&(h=0),n.objectDistance=f*f+g*g+h*h),a=a.next;if(i=this.ctx.lights,x=b(this,this.sortLight),i==null)v=null;else{for(m=1,l=0,c=0;!0;){for(o=i,i=null,u=null,p=0;o!=null;){for(++p,s=o,l=0,_=0,C=m;_<C;)if(w=_++,++l,s=s.next,s==null)break;for(c=m;l>0||c>0&&s!=null;)l==0?(r=s,s=s.next,--c):c==0||s==null||x(o,s)<=0?(r=o,o=o.next,--l):(r=s,s=s.next,--c),u!=null?u.next=r:i=r,u=r;o=s}if(u.next=null,p<=1)break;m*=2}v=i}this.ctx.lights=v}for(t=O.ctx.allocShaderList(this.ambientShader,t),n=this.ctx.lights,w=0;n!=null;){if(w++==this.maxLightsPerObject)break;t=O.ctx.allocShaderList(n.shader,t),n=n.next}return t},__class__:Mi}),Pa=function(){this.enableSky=!1,zt.call(this,"depth",[vt.PackFloat(vt.Value("output.depth"))]),this.depthMapId=ie.allocID("depthMap")},c["h3d.scene.fwd.DepthPass"]=Pa,Pa.__name__="h3d.scene.fwd.DepthPass",Pa.__super__=zt,Pa.prototype=g(zt.prototype,{draw:function(e,t){var n=this.ctx.textures.allocTarget("depthMap",this.ctx.engine.width,this.ctx.engine.height,!0);this.ctx.engine.pushTarget(n),this.ctx.engine.clear(this.enableSky?0:16711680,1),zt.prototype.draw.call(this,e,t),this.ctx.engine.popTarget(),this.ctx.globals.map.h[this.depthMapId]={texture:n}},__class__:Pa}),Ra=function(){zt.call(this,"normal",[vt.PackNormal(vt.Value("output.normal"))]),this.normalMapId=ie.allocID("normalMap")},c["h3d.scene.fwd.NormalPass"]=Ra,Ra.__name__="h3d.scene.fwd.NormalPass",Ra.__super__=zt,Ra.prototype=g(zt.prototype,{draw:function(e,t){var n=this.ctx.textures.allocTarget("normalMap",this.ctx.engine.width,this.ctx.engine.height);this.ctx.engine.pushTarget(n),this.ctx.engine.clear(8421504,1),zt.prototype.draw.call(this,e,t),this.ctx.engine.popTarget(),this.ctx.globals.map.h[this.normalMapId]=n},__class__:Ra}),La=function(){this.shadow=new Sa(1024),this.normal=new Ra,this.depth=new Pa,Ns.call(this),this.defaultPass=new zt("default"),this.allPasses=[this.defaultPass,this.depth,this.normal,this.shadow]},c["h3d.scene.fwd.Renderer"]=La,La.__name__="h3d.scene.fwd.Renderer",La.__super__=Ns,La.prototype=g(Ns.prototype,{get_def:function(){return this.defaultPass},renderPass:function(e,t,n){e.draw(t,n)},getPassByName:function(e){return e=="alpha"||e=="additive"?this.defaultPass:Ns.prototype.getPassByName.call(this,e)},render:function(){this.has("shadow")&&this.renderPass(this.shadow,this.get("shadow")),this.has("depth")&&this.renderPass(this.depth,this.get("depth")),this.has("normal")&&this.renderPass(this.normal,this.get("normal")),this.renderPass(this.defaultPass,this.get("default")),this.renderPass(this.defaultPass,this.get("alpha"),this.backToFront),this.renderPass(this.defaultPass,this.get("additive"))},__class__:La}),ys=function(){P.call(this)},c["h3d.shader.AmbientLight"]=ys,ys.__name__="h3d.shader.AmbientLight",ys.__super__=P,ys.prototype=g(P.prototype,{get_additive:function(){return this.additive__},set_additive:function(e){return this.constModified=!0,this.additive__=e},updateConstants:function(e){this.constBits=0,this.additive__&&(this.constBits|=2),this.updateConstantsFinal(e)},getParamValue:function(e){return e==0?this.additive__:null},getParamFloatValue:function(){return 0},setParamIndexValue:function(e,t){e==0&&(this.additive__=t)},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(ys.prototype);return e.shader=this.shader,e.additive__=this.additive__,e},__class__:ys}),Qs=function(){this.viewportB__=new h(0,0,0),this.viewportA__=new h(0,0,0),this.halfPixelInverse__=new h(0,0,0),this.uvPos__=new j(0,0,0,1),this.filterMatrixB__=new h(0,0,0),this.filterMatrixA__=new h(0,0,0),this.absoluteMatrixB__=new h(0,0,0),this.absoluteMatrixA__=new h(0,0,0),this.color__=new j(0,0,0,1),this.zValue__=0,P.call(this)},c["h3d.shader.Base2d"]=Qs,Qs.__name__="h3d.shader.Base2d",Qs.__super__=P,Qs.prototype=g(P.prototype,{get_zValue:function(){return this.zValue__},set_zValue:function(e){return this.zValue__=e},get_texture:function(){return this.texture__},set_texture:function(e){return this.texture__=e},get_isRelative:function(){return this.isRelative__},set_isRelative:function(e){return this.constModified=!0,this.isRelative__=e},get_color:function(){return this.color__},set_color:function(e){return this.color__=e},get_absoluteMatrixA:function(){return this.absoluteMatrixA__},set_absoluteMatrixA:function(e){return this.absoluteMatrixA__=e},get_absoluteMatrixB:function(){return this.absoluteMatrixB__},set_absoluteMatrixB:function(e){return this.absoluteMatrixB__=e},get_filterMatrixA:function(){return this.filterMatrixA__},set_filterMatrixA:function(e){return this.filterMatrixA__=e},get_filterMatrixB:function(){return this.filterMatrixB__},set_filterMatrixB:function(e){return this.filterMatrixB__=e},get_hasUVPos:function(){return this.hasUVPos__},set_hasUVPos:function(e){return this.constModified=!0,this.hasUVPos__=e},get_uvPos:function(){return this.uvPos__},set_uvPos:function(e){return this.uvPos__=e},get_killAlpha:function(){return this.killAlpha__},set_killAlpha:function(e){return this.constModified=!0,this.killAlpha__=e},get_pixelAlign:function(){return this.pixelAlign__},set_pixelAlign:function(e){return this.constModified=!0,this.pixelAlign__=e},get_halfPixelInverse:function(){return this.halfPixelInverse__},set_halfPixelInverse:function(e){return this.halfPixelInverse__=e},get_viewportA:function(){return this.viewportA__},set_viewportA:function(e){return this.viewportA__=e},get_viewportB:function(){return this.viewportB__},set_viewportB:function(e){return this.viewportB__=e},updateConstants:function(e){this.constBits=0,this.isRelative__&&(this.constBits|=1),this.hasUVPos__&&(this.constBits|=2),this.killAlpha__&&(this.constBits|=4),this.pixelAlign__&&(this.constBits|=8),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.zValue__;case 1:return this.texture__;case 2:return this.isRelative__;case 3:return this.color__;case 4:return this.absoluteMatrixA__;case 5:return this.absoluteMatrixB__;case 6:return this.filterMatrixA__;case 7:return this.filterMatrixB__;case 8:return this.hasUVPos__;case 9:return this.uvPos__;case 10:return this.killAlpha__;case 11:return this.pixelAlign__;case 12:return this.halfPixelInverse__;case 13:return this.viewportA__;case 14:return this.viewportB__;default:}return null},getParamFloatValue:function(e){return e==0?this.zValue__:0},setParamIndexValue:function(e,t){switch(e){case 0:this.zValue__=t;break;case 1:this.texture__=t;break;case 2:this.isRelative__=t;break;case 3:this.color__=t;break;case 4:this.absoluteMatrixA__=t;break;case 5:this.absoluteMatrixB__=t;break;case 6:this.filterMatrixA__=t;break;case 7:this.filterMatrixB__=t;break;case 8:this.hasUVPos__=t;break;case 9:this.uvPos__=t;break;case 10:this.killAlpha__=t;break;case 11:this.pixelAlign__=t;break;case 12:this.halfPixelInverse__=t;break;case 13:this.viewportA__=t;break;case 14:this.viewportB__=t;break;default:}},setParamIndexFloatValue:function(e,t){e==0&&(this.zValue__=t)},clone:function(){var e=Object.create(Qs.prototype);return e.shader=this.shader,e.zValue__=this.zValue__,e.texture__=this.texture__,e.isRelative__=this.isRelative__,e.color__=this.color__,e.absoluteMatrixA__=this.absoluteMatrixA__,e.absoluteMatrixB__=this.absoluteMatrixB__,e.filterMatrixA__=this.filterMatrixA__,e.filterMatrixB__=this.filterMatrixB__,e.hasUVPos__=this.hasUVPos__,e.uvPos__=this.uvPos__,e.killAlpha__=this.killAlpha__,e.pixelAlign__=this.pixelAlign__,e.halfPixelInverse__=this.halfPixelInverse__,e.viewportA__=this.viewportA__,e.viewportB__=this.viewportB__,e},__class__:Qs}),xo=function(){this.specularColor__=new h(0,0,0),this.specularAmount__=0,this.specularPower__=0,this.color__=new j(0,0,0,1),P.call(this);var e=this.color__,t=1,n=1,s=1;s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=s,e.w=1,e=this.specularColor__,t=1,n=1,s=1,s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=s,this.specularPower__=50,this.specularAmount__=1},c["h3d.shader.BaseMesh"]=xo,xo.__name__="h3d.shader.BaseMesh",xo.__super__=P,xo.prototype=g(P.prototype,{get_color:function(){return this.color__},set_color:function(e){return this.color__=e},get_specularPower:function(){return this.specularPower__},set_specularPower:function(e){return this.specularPower__=e},get_specularAmount:function(){return this.specularAmount__},set_specularAmount:function(e){return this.specularAmount__=e},get_specularColor:function(){return this.specularColor__},set_specularColor:function(e){return this.specularColor__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.color__;case 1:return this.specularPower__;case 2:return this.specularAmount__;case 3:return this.specularColor__;default:}return null},getParamFloatValue:function(e){switch(e){case 1:return this.specularPower__;case 2:return this.specularAmount__;default:}return 0},setParamIndexValue:function(e,t){switch(e){case 0:this.color__=t;break;case 1:this.specularPower__=t;break;case 2:this.specularAmount__=t;break;case 3:this.specularColor__=t;break;default:}},setParamIndexFloatValue:function(e,t){switch(e){case 1:this.specularPower__=t;break;case 2:this.specularAmount__=t;break;default:}},clone:function(){var e=Object.create(xo.prototype);return e.shader=this.shader,e.color__=this.color__,e.specularPower__=this.specularPower__,e.specularAmount__=this.specularAmount__,e.specularColor__=this.specularColor__,e},__class__:xo}),Ts=function(){this.vcount__=0,this.shapeCount__=0,P.call(this)},c["h3d.shader.Blendshape"]=Ts,Ts.__name__="h3d.shader.Blendshape",Ts.__super__=P,Ts.prototype=g(P.prototype,{get_shapeCount:function(){return this.shapeCount__},set_shapeCount:function(e){return this.shapeCount__=e},get_vcount:function(){return this.vcount__},set_vcount:function(e){return this.vcount__=e},get_offsets:function(){return this.offsets__},set_offsets:function(e){return this.offsets__=e},get_weights:function(){return this.weights__},set_weights:function(e){return this.weights__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.shapeCount__;case 1:return this.vcount__;case 2:return this.offsets__;case 3:return this.weights__;default:}return null},getParamFloatValue:function(e){switch(e){case 0:return this.shapeCount__;case 1:return this.vcount__;default:}return 0},setParamIndexValue:function(e,t){switch(e){case 0:this.shapeCount__=t;break;case 1:this.vcount__=t;break;case 2:this.offsets__=t;break;case 3:this.weights__=t;break;default:}},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(Ts.prototype);return e.shader=this.shader,e.shapeCount__=this.shapeCount__,e.vcount__=this.vcount__,e.offsets__=this.offsets__,e.weights__=this.weights__,e},__class__:Ts}),Oo=function(){this.cubeDir__=new L,this.depthThresholdMaxDist__=0,this.depthThreshold__=1,this.fixedColor__=new j(0,0,0,1),this.pixel__=new h(0,0,0),this.offsets__=[],this.values__=[],this.Quality__=0,this.inverseProj__=new L,Fe.call(this)},c["h3d.shader.Blur"]=Oo,Oo.__name__="h3d.shader.Blur",Oo.__super__=Fe,Oo.prototype=g(Fe.prototype,{get_inverseProj:function(){return this.inverseProj__},set_inverseProj:function(e){return this.inverseProj__=e},get_texture:function(){return this.texture__},set_texture:function(e){return this.texture__=e},get_depthTexture:function(){return this.depthTexture__},set_depthTexture:function(e){return this.depthTexture__=e},get_Quality:function(){return this.Quality__},set_Quality:function(e){return this.constModified=!0,this.Quality__=e},get_isDepth:function(){return this.isDepth__},set_isDepth:function(e){return this.constModified=!0,this.isDepth__=e},get_values:function(){return this.values__},set_values:function(e){return this.values__=e},get_offsets:function(){return this.offsets__},set_offsets:function(e){return this.offsets__=e},get_pixel:function(){return this.pixel__},set_pixel:function(e){return this.pixel__=e},get_hasFixedColor:function(){return this.hasFixedColor__},set_hasFixedColor:function(e){return this.constModified=!0,this.hasFixedColor__=e},get_smoothFixedColor:function(){return this.smoothFixedColor__},set_smoothFixedColor:function(e){return this.constModified=!0,this.smoothFixedColor__=e},get_fixedColor:function(){return this.fixedColor__},set_fixedColor:function(e){return this.fixedColor__=e},get_isDepthDependant:function(){return this.isDepthDependant__},set_isDepthDependant:function(e){return this.constModified=!0,this.isDepthDependant__=e},get_depthThreshold:function(){return this.depthThreshold__},set_depthThreshold:function(e){return this.depthThreshold__=e},get_depthThresholdMaxDist:function(){return this.depthThresholdMaxDist__},set_depthThresholdMaxDist:function(e){return this.depthThresholdMaxDist__=e},get_isCube:function(){return this.isCube__},set_isCube:function(e){return this.constModified=!0,this.isCube__=e},get_cubeTexture:function(){return this.cubeTexture__},set_cubeTexture:function(e){return this.cubeTexture__=e},get_cubeDir:function(){return this.cubeDir__},set_cubeDir:function(e){return this.cubeDir__=e},updateConstants:function(e){this.constBits=0;var n=this.Quality__;if(n>>>8!=0)throw t.thrown("Quality is out of range "+n+">"+255+", consider using @const(MAX_VALUE)");this.constBits|=n,this.isDepth__&&(this.constBits|=256),this.hasFixedColor__&&(this.constBits|=512),this.smoothFixedColor__&&(this.constBits|=1024),this.isDepthDependant__&&(this.constBits|=2048),this.isCube__&&(this.constBits|=4096),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.flipY__;case 1:return this.inverseProj__;case 2:return this.texture__;case 3:return this.depthTexture__;case 4:return this.Quality__;case 5:return this.isDepth__;case 6:return this.values__;case 7:return this.offsets__;case 8:return this.pixel__;case 9:return this.hasFixedColor__;case 10:return this.smoothFixedColor__;case 11:return this.fixedColor__;case 12:return this.isDepthDependant__;case 13:return this.depthThreshold__;case 14:return this.depthThresholdMaxDist__;case 15:return this.isCube__;case 16:return this.cubeTexture__;case 17:return this.cubeDir__;default:}return null},getParamFloatValue:function(e){switch(e){case 0:return this.flipY__;case 4:return this.Quality__;case 13:return this.depthThreshold__;case 14:return this.depthThresholdMaxDist__;default:}return 0},clone:function(){var e=Object.create(Oo.prototype);return e.shader=this.shader,e.flipY__=this.flipY__,e.inverseProj__=this.inverseProj__,e.texture__=this.texture__,e.depthTexture__=this.depthTexture__,e.Quality__=this.Quality__,e.isDepth__=this.isDepth__,e.values__=this.values__,e.offsets__=this.offsets__,e.pixel__=this.pixel__,e.hasFixedColor__=this.hasFixedColor__,e.smoothFixedColor__=this.smoothFixedColor__,e.fixedColor__=this.fixedColor__,e.isDepthDependant__=this.isDepthDependant__,e.depthThreshold__=this.depthThreshold__,e.depthThresholdMaxDist__=this.depthThresholdMaxDist__,e.isCube__=this.isCube__,e.cubeTexture__=this.cubeTexture__,e.cubeDir__=this.cubeDir__,e},__class__:Oo}),Da=function(){this.globals=new Float32Array(0),this.params=new Float32Array(0),this.tex=new Array(0)},c["h3d.shader.ShaderBuffers"]=Da,Da.__name__="h3d.shader.ShaderBuffers",Da.prototype={grow:function(e){var n=e.globalsSize<<2,s=e.paramsSize<<2,o=e.texturesCount,t=e.bufferCount;this.globals.length<n&&(this.globals=new Float32Array(n)),this.params.length<s&&(this.params=new Float32Array(s)),this.tex.length<o&&(this.tex=new Array(o)),t>0&&(this.buffers==null||this.buffers.length<t)&&(this.buffers=new Array(t))},__class__:Da},uc=function(){this.vertex=new Da,this.fragment=new Da},c["h3d.shader.Buffers"]=uc,uc.__name__="h3d.shader.Buffers",uc.prototype={grow:function(e){this.vertex.grow(e.vertex),e.fragment!=null&&this.fragment.grow(e.fragment)},__class__:uc},ks=function(e){e==null&&(e=0),this.color__=new h(0,0,0),P.call(this);var t=this.color__;t.x=(e>>16&255)/255,t.y=(e>>8&255)/255,t.z=(e&255)/255},c["h3d.shader.ColorAdd"]=ks,ks.__name__="h3d.shader.ColorAdd",ks.__super__=P,ks.prototype=g(P.prototype,{get_color:function(){return this.color__},set_color:function(e){return this.color__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){return e==0?this.color__:null},getParamFloatValue:function(){return 0},setParamIndexValue:function(e,t){e==0&&(this.color__=t)},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(ks.prototype);return e.shader=this.shader,e.color__=this.color__,e},__class__:ks}),Hs=function(e){e==null&&(e=0),this.colorKey__=new j(0,0,0,1),P.call(this);var t=this.colorKey__;t.x=(e>>16&255)/255,t.y=(e>>8&255)/255,t.z=(e&255)/255,t.w=(e>>>24)/255},c["h3d.shader.ColorKey"]=Hs,Hs.__name__="h3d.shader.ColorKey",Hs.__super__=P,Hs.prototype=g(P.prototype,{get_colorKey:function(){return this.colorKey__},set_colorKey:function(e){return this.colorKey__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){return e==0?this.colorKey__:null},getParamFloatValue:function(){return 0},setParamIndexValue:function(e,t){e==0&&(this.colorKey__=t)},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(Hs.prototype);return e.shader=this.shader,e.colorKey__=this.colorKey__,e},__class__:Hs}),Es=function(e){this.enabled__=!0,this.matrix__=new L,P.call(this),e!=null?this.matrix__.loadValues(e):this.matrix__.identity()},c["h3d.shader.ColorMatrix"]=Es,Es.__name__="h3d.shader.ColorMatrix",Es.__super__=P,Es.prototype=g(P.prototype,{get_matrix:function(){return this.matrix__},set_matrix:function(e){return this.matrix__=e},get_enabled:function(){return this.enabled__},set_enabled:function(e){return this.constModified=!0,this.enabled__=e},updateConstants:function(e){this.constBits=0,this.enabled__&&(this.constBits|=1),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.matrix__;case 1:return this.enabled__;default:}return null},getParamFloatValue:function(){return 0},setParamIndexValue:function(e,t){switch(e){case 0:this.matrix__=t;break;case 1:this.enabled__=t;break;default:}},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(Es.prototype);return e.shader=this.shader,e.matrix__=this.matrix__,e.enabled__=this.enabled__,e},__class__:Es}),wo=function(){this.direction__=new h(0,0,0),this.color__=new h(0,0,0),P.call(this);var e=this.color__,t=1,n=1,s=1;s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e.x=t,e.y=n,e.z=s},c["h3d.shader.DirLight"]=wo,wo.__name__="h3d.shader.DirLight",wo.__super__=P,wo.prototype=g(P.prototype,{get_color:function(){return this.color__},set_color:function(e){return this.color__=e},get_direction:function(){return this.direction__},set_direction:function(e){return this.direction__=e},get_enableSpecular:function(){return this.enableSpecular__},set_enableSpecular:function(e){return this.constModified=!0,this.enableSpecular__=e},updateConstants:function(e){this.constBits=0,this.enableSpecular__&&(this.constBits|=1),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.color__;case 1:return this.direction__;case 2:return this.enableSpecular__;default:}return null},getParamFloatValue:function(){return 0},setParamIndexValue:function(e,t){switch(e){case 0:this.color__=t;break;case 1:this.direction__=t;break;case 2:this.enableSpecular__=t;break;default:}},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(wo.prototype);return e.shader=this.shader,e.color__=this.color__,e.direction__=this.direction__,e.enableSpecular__=this.enableSpecular__,e},__class__:wo}),_o=function(){this.poissonDisk__=[],this.shadowBias__=0,this.shadowProj__=new L,this.shadowMapChannel__=Re.Unknown,this.shadowRes__=new h(0,0,0),this.pcfScale__=0,this.PCF_SAMPLES__=0,this.shadowPower__=0,P.call(this),this.set_pcfQuality(1)},c["h3d.shader.DirShadow"]=_o,_o.__name__="h3d.shader.DirShadow",_o.__super__=P,_o.prototype=g(P.prototype,{set_pcfQuality:function(e){switch(e){case 2:var s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,B,V,$,W,U,K,q,Y,G,X,Q,Z,J,ee,te,ne,se,oe,ie,ae,re,ce,le,de,ue,he,me,n=-.326,t=-.406;t==null&&(t=0),n==null&&(n=0),s=new j(n,t,0,1),n=-.84,t=-.074,t==null&&(t=0),n==null&&(n=0),o=new j(n,t,0,1),n=-.696,t=.457,t==null&&(t=0),n==null&&(n=0),i=new j(n,t,0,1),n=-.203,t=.621,t==null&&(t=0),n==null&&(n=0),r=new j(n,t,0,1),n=.962,t=-.195,t==null&&(t=0),n==null&&(n=0),c=new j(n,t,0,1),n=.473,t=-.48,t==null&&(t=0),n==null&&(n=0),l=new j(n,t,0,1),n=.519,t=.767,t==null&&(t=0),n==null&&(n=0),d=new j(n,t,0,1),n=.185,t=-.893,t==null&&(t=0),n==null&&(n=0),u=new j(n,t,0,1),n=.507,t=.064,t==null&&(t=0),n==null&&(n=0),h=new j(n,t,0,1),n=.896,t=.412,t==null&&(t=0),n==null&&(n=0),m=new j(n,t,0,1),n=-.322,t=-.933,t==null&&(t=0),n==null&&(n=0),f=new j(n,t,0,1),n=-.792,t=-.598,t==null&&(t=0),n==null&&(n=0),a=[s,o,i,r,c,l,d,u,h,m,f,new j(n,t,0,1)];break;case 3:n=-.613392,t=.617481,t==null&&(t=0),n==null&&(n=0),s=new j(n,t,0,1),n=.170019,t=-.040254,t==null&&(t=0),n==null&&(n=0),o=new j(n,t,0,1),n=-.299417,t=.791925,t==null&&(t=0),n==null&&(n=0),i=new j(n,t,0,1),n=.64568,t=.49321,t==null&&(t=0),n==null&&(n=0),r=new j(n,t,0,1),n=-.651784,t=.717887,t==null&&(t=0),n==null&&(n=0),c=new j(n,t,0,1),n=.421003,t=.02707,t==null&&(t=0),n==null&&(n=0),l=new j(n,t,0,1),n=-.817194,t=-.271096,t==null&&(t=0),n==null&&(n=0),d=new j(n,t,0,1),n=-.705374,t=-.668203,t==null&&(t=0),n==null&&(n=0),u=new j(n,t,0,1),n=.97705,t=-.108615,t==null&&(t=0),n==null&&(n=0),h=new j(n,t,0,1),n=.063326,t=.142369,t==null&&(t=0),n==null&&(n=0),m=new j(n,t,0,1),n=.203528,t=.214331,t==null&&(t=0),n==null&&(n=0),f=new j(n,t,0,1),n=-.667531,t=.32609,t==null&&(t=0),n==null&&(n=0),p=new j(n,t,0,1),n=-.098422,t=-.295755,t==null&&(t=0),n==null&&(n=0),g=new j(n,t,0,1),n=-.885922,t=.215369,t==null&&(t=0),n==null&&(n=0),v=new j(n,t,0,1),n=.566637,t=.605213,t==null&&(t=0),n==null&&(n=0),b=new j(n,t,0,1),n=.039766,t=-.3961,t==null&&(t=0),n==null&&(n=0),y=new j(n,t,0,1),n=.751946,t=.453352,t==null&&(t=0),n==null&&(n=0),_=new j(n,t,0,1),n=.078707,t=-.715323,t==null&&(t=0),n==null&&(n=0),w=new j(n,t,0,1),n=-.075838,t=-.529344,t==null&&(t=0),n==null&&(n=0),O=new j(n,t,0,1),n=.724479,t=-.580798,t==null&&(t=0),n==null&&(n=0),x=new j(n,t,0,1),n=.222999,t=-.215125,t==null&&(t=0),n==null&&(n=0),C=new j(n,t,0,1),n=-.467574,t=-.405438,t==null&&(t=0),n==null&&(n=0),E=new j(n,t,0,1),n=-.248268,t=-.814753,t==null&&(t=0),n==null&&(n=0),k=new j(n,t,0,1),n=.354411,t=-.88757,t==null&&(t=0),n==null&&(n=0),A=new j(n,t,0,1),n=.175817,t=.382366,t==null&&(t=0),n==null&&(n=0),S=new j(n,t,0,1),n=.487472,t=-.063082,t==null&&(t=0),n==null&&(n=0),M=new j(n,t,0,1),n=-.084078,t=.898312,t==null&&(t=0),n==null&&(n=0),F=new j(n,t,0,1),n=.488876,t=-.783441,t==null&&(t=0),n==null&&(n=0),T=new j(n,t,0,1),n=.470016,t=.217933,t==null&&(t=0),n==null&&(n=0),z=new j(n,t,0,1),n=-.69689,t=-.549791,t==null&&(t=0),n==null&&(n=0),D=new j(n,t,0,1),n=-.149693,t=.605762,t==null&&(t=0),n==null&&(n=0),N=new j(n,t,0,1),n=.034211,t=.97998,t==null&&(t=0),n==null&&(n=0),L=new j(n,t,0,1),n=.503098,t=-.308878,t==null&&(t=0),n==null&&(n=0),R=new j(n,t,0,1),n=-.016205,t=-.872921,t==null&&(t=0),n==null&&(n=0),P=new j(n,t,0,1),n=.385784,t=-.393902,t==null&&(t=0),n==null&&(n=0),H=new j(n,t,0,1),n=-.146886,t=-.859249,t==null&&(t=0),n==null&&(n=0),I=new j(n,t,0,1),n=.643361,t=.164098,t==null&&(t=0),n==null&&(n=0),B=new j(n,t,0,1),n=.634388,t=-.049471,t==null&&(t=0),n==null&&(n=0),V=new j(n,t,0,1),n=-.688894,t=.007843,t==null&&(t=0),n==null&&(n=0),$=new j(n,t,0,1),n=.464034,t=-.188818,t==null&&(t=0),n==null&&(n=0),W=new j(n,t,0,1),n=-.44084,t=.137486,t==null&&(t=0),n==null&&(n=0),U=new j(n,t,0,1),n=.364483,t=.511704,t==null&&(t=0),n==null&&(n=0),K=new j(n,t,0,1),n=.034028,t=.325968,t==null&&(t=0),n==null&&(n=0),q=new j(n,t,0,1),n=.099094,t=-.308023,t==null&&(t=0),n==null&&(n=0),Y=new j(n,t,0,1),n=.69396,t=-.366253,t==null&&(t=0),n==null&&(n=0),G=new j(n,t,0,1),n=.678884,t=-.204688,t==null&&(t=0),n==null&&(n=0),X=new j(n,t,0,1),n=.001801,t=.780328,t==null&&(t=0),n==null&&(n=0),Q=new j(n,t,0,1),n=.145177,t=-.898984,t==null&&(t=0),n==null&&(n=0),Z=new j(n,t,0,1),n=.062655,t=-.611866,t==null&&(t=0),n==null&&(n=0),J=new j(n,t,0,1),n=.315226,t=-.604297,t==null&&(t=0),n==null&&(n=0),ee=new j(n,t,0,1),n=-.780145,t=.486251,t==null&&(t=0),n==null&&(n=0),te=new j(n,t,0,1),n=-.371868,t=.882138,t==null&&(t=0),n==null&&(n=0),ne=new j(n,t,0,1),n=.200476,t=.49443,t==null&&(t=0),n==null&&(n=0),se=new j(n,t,0,1),n=-.494552,t=-.711051,t==null&&(t=0),n==null&&(n=0),oe=new j(n,t,0,1),n=.612476,t=.705252,t==null&&(t=0),n==null&&(n=0),ie=new j(n,t,0,1),n=-.578845,t=-.768792,t==null&&(t=0),n==null&&(n=0),ae=new j(n,t,0,1),n=-.772454,t=-.090976,t==null&&(t=0),n==null&&(n=0),re=new j(n,t,0,1),n=.50444,t=.372295,t==null&&(t=0),n==null&&(n=0),ce=new j(n,t,0,1),n=.155736,t=.065157,t==null&&(t=0),n==null&&(n=0),le=new j(n,t,0,1),n=.391522,t=.849605,t==null&&(t=0),n==null&&(n=0),de=new j(n,t,0,1),n=-.620106,t=-.328104,t==null&&(t=0),n==null&&(n=0),ue=new j(n,t,0,1),n=.789239,t=-.419965,t==null&&(t=0),n==null&&(n=0),he=new j(n,t,0,1),n=-.545396,t=.538133,t==null&&(t=0),n==null&&(n=0),me=new j(n,t,0,1),n=-.178564,t=-.596057,t==null&&(t=0),n==null&&(n=0),a=[s,o,i,r,c,l,d,u,h,m,f,p,g,v,b,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,B,V,$,W,U,K,q,Y,G,X,Q,Z,J,ee,te,ne,se,oe,ie,ae,re,ce,le,de,ue,he,me,new j(n,t,0,1)];break;default:n=-.942,t=-.399,t==null&&(t=0),n==null&&(n=0),s=new j(n,t,0,1),n=.945,t=-.768,t==null&&(t=0),n==null&&(n=0),o=new j(n,t,0,1),n=-.094,t=-.929,t==null&&(t=0),n==null&&(n=0),i=new j(n,t,0,1),n=.344,t=.293,t==null&&(t=0),n==null&&(n=0),a=[s,o,i,new j(n,t,0,1)]}return this.poissonDisk__=a,this.constModified=!0,this.PCF_SAMPLES__=this.poissonDisk__.length,e},get_enable:function(){return this.enable__},set_enable:function(e){return this.constModified=!0,this.enable__=e},get_USE_ESM:function(){return this.USE_ESM__},set_USE_ESM:function(e){return this.constModified=!0,this.USE_ESM__=e},get_shadowPower:function(){return this.shadowPower__},set_shadowPower:function(e){return this.shadowPower__=e},get_USE_PCF:function(){return this.USE_PCF__},set_USE_PCF:function(e){return this.constModified=!0,this.USE_PCF__=e},get_PCF_SAMPLES:function(){return this.PCF_SAMPLES__},set_PCF_SAMPLES:function(e){return this.constModified=!0,this.PCF_SAMPLES__=e},get_pcfScale:function(){return this.pcfScale__},set_pcfScale:function(e){return this.pcfScale__=e},get_shadowRes:function(){return this.shadowRes__},set_shadowRes:function(e){return this.shadowRes__=e},get_shadowMap:function(){return this.shadowMap__},set_shadowMap:function(e){return this.constModified=!0,this.shadowMap__=e},get_shadowMapChannel:function(){return this.shadowMapChannel__},set_shadowMapChannel:function(e){return this.constModified=!0,this.shadowMapChannel__=e},get_shadowProj:function(){return this.shadowProj__},set_shadowProj:function(e){return this.shadowProj__=e},get_shadowBias:function(){return this.shadowBias__},set_shadowBias:function(e){return this.shadowBias__=e},get_poissonDisk:function(){return this.poissonDisk__},set_poissonDisk:function(e){return this.poissonDisk__=e},updateConstants:function(e){this.constBits=0,this.enable__&&(this.constBits|=1),this.USE_ESM__&&(this.constBits|=2),this.USE_PCF__&&(this.constBits|=4);var n=this.PCF_SAMPLES__;if(n>>>8!=0)throw t.thrown("PCF_SAMPLES is out of range "+n+">"+255+", consider using @const(MAX_VALUE)");if(this.constBits|=n<<3,this.shadowMap__==null)this.shadowMapChannel__=Re.Unknown;else if(this.shadowMapChannel__==Re.Unknown)if(this.shadowMap__.format==S.nativeFormat)this.shadowMapChannel__=Re.PackedFloat;else throw t.thrown("shadowMapChannel is not set");this.constBits|=(e.allocChannelID(this.shadowMap__)<<3|this.shadowMapChannel__._hx_index)<<11,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.enable__;case 1:return this.USE_ESM__;case 2:return this.shadowPower__;case 3:return this.USE_PCF__;case 4:return this.PCF_SAMPLES__;case 5:return this.pcfScale__;case 6:return this.shadowRes__;case 7:return this.shadowMap__;case 8:return this.shadowProj__;case 9:return this.shadowBias__;case 10:return this.poissonDisk__;default:}return null},getParamFloatValue:function(e){switch(e){case 2:return this.shadowPower__;case 4:return this.PCF_SAMPLES__;case 5:return this.pcfScale__;case 9:return this.shadowBias__;default:}return 0},setParamIndexValue:function(e,t){switch(e){case 0:this.enable__=t;break;case 1:this.USE_ESM__=t;break;case 2:this.shadowPower__=t;break;case 3:this.USE_PCF__=t;break;case 4:this.PCF_SAMPLES__=t;break;case 5:this.pcfScale__=t;break;case 6:this.shadowRes__=t;break;case 7:this.shadowMap__=t;break;case 8:this.shadowProj__=t;break;case 9:this.shadowBias__=t;break;case 10:this.poissonDisk__=t;break;default:}},setParamIndexFloatValue:function(e,t){switch(e){case 2:this.shadowPower__=t;break;case 5:this.pcfScale__=t;break;case 9:this.shadowBias__=t;break;default:}},clone:function(){var e=Object.create(_o.prototype);return e.shader=this.shader,e.enable__=this.enable__,e.USE_ESM__=this.USE_ESM__,e.shadowPower__=this.shadowPower__,e.USE_PCF__=this.USE_PCF__,e.PCF_SAMPLES__=this.PCF_SAMPLES__,e.pcfScale__=this.pcfScale__,e.shadowRes__=this.shadowRes__,e.shadowMap__=this.shadowMap__,e.shadowProj__=this.shadowProj__,e.shadowBias__=this.shadowBias__,e.poissonDisk__=this.poissonDisk__,e},__class__:_o}),jo=function(){this.color__=new j(0,0,0,1),this.mode__=0,Fe.call(this)},c["h3d.shader.GenTexture"]=jo,jo.__name__="h3d.shader.GenTexture",jo.__super__=Fe,jo.prototype=g(Fe.prototype,{get_mode:function(){return this.mode__},set_mode:function(e){return this.constModified=!0,this.mode__=e},get_color:function(){return this.color__},set_color:function(e){return this.color__=e},updateConstants:function(e){this.constBits=0;var n=this.mode__;if(n>>>8!=0)throw t.thrown("mode is out of range "+n+">"+255+", consider using @const(MAX_VALUE)");this.constBits|=n,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.flipY__;case 1:return this.mode__;case 2:return this.color__;default:}return null},getParamFloatValue:function(e){switch(e){case 0:return this.flipY__;case 1:return this.mode__;default:}return 0},clone:function(){var e=Object.create(jo.prototype);return e.shader=this.shader,e.flipY__=this.flipY__,e.mode__=this.mode__,e.color__=this.color__,e},__class__:jo}),fo=function(e,t){t==null&&(t=1),e==null&&(e=1.5),this.width__=0,this.lengthScale__=0,P.call(this),this.width__=e,this.lengthScale__=t},c["h3d.shader.LineShader"]=fo,fo.__name__="h3d.shader.LineShader",fo.__super__=P,fo.prototype=g(P.prototype,{get_lengthScale:function(){return this.lengthScale__},set_lengthScale:function(e){return this.lengthScale__=e},get_width:function(){return this.width__},set_width:function(e){return this.width__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.lengthScale__;case 1:return this.width__;default:}return null},getParamFloatValue:function(e){switch(e){case 0:return this.lengthScale__;case 1:return this.width__;default:}return 0},setParamIndexValue:function(e,t){switch(e){case 0:this.lengthScale__=t;break;case 1:this.width__=t;break;default:}},setParamIndexFloatValue:function(e,t){switch(e){case 0:this.lengthScale__=t;break;case 1:this.width__=t;break;default:}},clone:function(){var e=Object.create(fo.prototype);return e.shader=this.shader,e.lengthScale__=this.lengthScale__,e.width__=this.width__,e},__class__:fo}),mo=function(){Fe.call(this)},c["h3d.shader.MinMaxShader"]=mo,mo.__name__="h3d.shader.MinMaxShader",mo.__super__=Fe,mo.prototype=g(Fe.prototype,{get_texA:function(){return this.texA__},set_texA:function(e){return this.texA__=e},get_texB:function(){return this.texB__},set_texB:function(e){return this.texB__=e},get_isMax:function(){return this.isMax__},set_isMax:function(e){return this.constModified=!0,this.isMax__=e},updateConstants:function(e){this.constBits=0,this.isMax__&&(this.constBits|=1),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.flipY__;case 1:return this.texA__;case 2:return this.texB__;case 3:return this.isMax__;default:}return null},getParamFloatValue:function(e){return e==0?this.flipY__:0},clone:function(){var e=Object.create(mo.prototype);return e.shader=this.shader,e.flipY__=this.flipY__,e.texA__=this.texA__,e.texB__=this.texB__,e.isMax__=this.isMax__,e},__class__:mo}),bi=function(){this.mat__=new L,Fe.call(this)},c["h3d.shader.CubeMinMaxShader"]=bi,bi.__name__="h3d.shader.CubeMinMaxShader",bi.__super__=Fe,bi.prototype=g(Fe.prototype,{get_texA:function(){return this.texA__},set_texA:function(e){return this.texA__=e},get_texB:function(){return this.texB__},set_texB:function(e){return this.texB__=e},get_isMax:function(){return this.isMax__},set_isMax:function(e){return this.constModified=!0,this.isMax__=e},get_mat:function(){return this.mat__},set_mat:function(e){return this.mat__=e},updateConstants:function(e){this.constBits=0,this.isMax__&&(this.constBits|=1),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.flipY__;case 1:return this.texA__;case 2:return this.texB__;case 3:return this.isMax__;case 4:return this.mat__;default:}return null},getParamFloatValue:function(e){return e==0?this.flipY__:0},clone:function(){var e=Object.create(bi.prototype);return e.shader=this.shader,e.flipY__=this.flipY__,e.texA__=this.texA__,e.texB__=this.texB__,e.isMax__=this.isMax__,e.mat__=this.mat__,e},__class__:bi}),uo=function(e){P.call(this),this.texture__=e},c["h3d.shader.NormalMap"]=uo,uo.__name__="h3d.shader.NormalMap",uo.__super__=P,uo.prototype=g(P.prototype,{get_texture:function(){return this.texture__},set_texture:function(e){return this.texture__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){return e==0?this.texture__:null},getParamFloatValue:function(){return 0},setParamIndexValue:function(e,t){e==0&&(this.texture__=t)},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(uo.prototype);return e.shader=this.shader,e.texture__=this.texture__,e},__class__:uo}),vi=function(){P.call(this)},c["h3d.shader.Shadow"]=vi,vi.__name__="h3d.shader.Shadow",vi.__super__=P,vi.prototype=g(P.prototype,{updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(){return null},getParamFloatValue:function(){return 0},setParamIndexValue:function(){},setParamIndexFloatValue:function(){},__class__:vi}),Ii=function(){P.call(this)},c["h3d.shader.Utils"]=Ii,Ii.__name__="h3d.shader.Utils",Ii.__super__=P,Ii.prototype=g(P.prototype,{updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(){return null},getParamFloatValue:function(){return 0},setParamIndexValue:function(){},setParamIndexFloatValue:function(){},__class__:Ii}),An=function(){this.prevBonesMatrixes__=[],this.bonesMatrixes__=[],this.calcPrevPos__=!1,this.fourBonesByVertex__=!1,this.MaxBones__=0,P.call(this),this.constModified=!0,this.MaxBones__=34},c["h3d.shader.SkinBase"]=An,An.__name__="h3d.shader.SkinBase",An.__super__=P,An.prototype=g(P.prototype,{get_MaxBones:function(){return this.MaxBones__},set_MaxBones:function(e){return this.constModified=!0,this.MaxBones__=e},get_fourBonesByVertex:function(){return this.fourBonesByVertex__},set_fourBonesByVertex:function(e){return this.constModified=!0,this.fourBonesByVertex__=e},get_calcPrevPos:function(){return this.calcPrevPos__},set_calcPrevPos:function(e){return this.constModified=!0,this.calcPrevPos__=e},get_bonesMatrixes:function(){return this.bonesMatrixes__},set_bonesMatrixes:function(e){return this.bonesMatrixes__=e},get_prevBonesMatrixes:function(){return this.prevBonesMatrixes__},set_prevBonesMatrixes:function(e){return this.prevBonesMatrixes__=e},updateConstants:function(e){this.constBits=0;var n=this.MaxBones__;if(n>>>8!=0)throw t.thrown("MaxBones is out of range "+n+">"+255+", consider using @const(MAX_VALUE)");this.constBits|=n,this.fourBonesByVertex__&&(this.constBits|=256),this.calcPrevPos__&&(this.constBits|=512),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.MaxBones__;case 1:return this.fourBonesByVertex__;case 2:return this.calcPrevPos__;case 3:return this.bonesMatrixes__;case 4:return this.prevBonesMatrixes__;default:}return null},getParamFloatValue:function(e){return e==0?this.MaxBones__:0},setParamIndexValue:function(e,t){switch(e){case 0:this.MaxBones__=t;break;case 1:this.fourBonesByVertex__=t;break;case 2:this.calcPrevPos__=t;break;case 3:this.bonesMatrixes__=t;break;case 4:this.prevBonesMatrixes__=t;break;default:}},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(An.prototype);return e.shader=this.shader,e.MaxBones__=this.MaxBones__,e.fourBonesByVertex__=this.fourBonesByVertex__,e.calcPrevPos__=this.calcPrevPos__,e.bonesMatrixes__=this.bonesMatrixes__,e.prevBonesMatrixes__=this.prevBonesMatrixes__,e},__class__:An}),co=function(){An.call(this)},c["h3d.shader.Skin"]=co,co.__name__="h3d.shader.Skin",co.__super__=An,co.prototype=g(An.prototype,{updateConstants:function(e){this.constBits=0;var n=this.MaxBones__;if(n>>>8!=0)throw t.thrown("MaxBones is out of range "+n+">"+255+", consider using @const(MAX_VALUE)");this.constBits|=n,this.fourBonesByVertex__&&(this.constBits|=256),this.calcPrevPos__&&(this.constBits|=512),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.MaxBones__;case 1:return this.fourBonesByVertex__;case 2:return this.calcPrevPos__;case 3:return this.bonesMatrixes__;case 4:return this.prevBonesMatrixes__;default:}return null},getParamFloatValue:function(e){return e==0?this.MaxBones__:0},clone:function(){var e=Object.create(co.prototype);return e.shader=this.shader,e.MaxBones__=this.MaxBones__,e.fourBonesByVertex__=this.fourBonesByVertex__,e.calcPrevPos__=this.calcPrevPos__,e.bonesMatrixes__=this.bonesMatrixes__,e.prevBonesMatrixes__=this.prevBonesMatrixes__,e},__class__:co}),Bs=function(){An.call(this)},c["h3d.shader.SkinTangent"]=Bs,Bs.__name__="h3d.shader.SkinTangent",Bs.__super__=An,Bs.prototype=g(An.prototype,{updateConstants:function(e){this.constBits=0;var n=this.MaxBones__;if(n>>>8!=0)throw t.thrown("MaxBones is out of range "+n+">"+255+", consider using @const(MAX_VALUE)");this.constBits|=n,this.fourBonesByVertex__&&(this.constBits|=256),this.calcPrevPos__&&(this.constBits|=512),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.MaxBones__;case 1:return this.fourBonesByVertex__;case 2:return this.calcPrevPos__;case 3:return this.bonesMatrixes__;case 4:return this.prevBonesMatrixes__;default:}return null},getParamFloatValue:function(e){return e==0?this.MaxBones__:0},clone:function(){var e=Object.create(Bs.prototype);return e.shader=this.shader,e.MaxBones__=this.MaxBones__,e.fourBonesByVertex__=this.fourBonesByVertex__,e.calcPrevPos__=this.calcPrevPos__,e.bonesMatrixes__=this.bonesMatrixes__,e.prevBonesMatrixes__=this.prevBonesMatrixes__,e},__class__:Bs}),ao=function(e){P.call(this),this.texture__=e},c["h3d.shader.SpecularTexture"]=ao,ao.__name__="h3d.shader.SpecularTexture",ao.__super__=P,ao.prototype=g(P.prototype,{get_texture:function(){return this.texture__},set_texture:function(e){return this.texture__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){return e==0?this.texture__:null},getParamFloatValue:function(){return 0},setParamIndexValue:function(e,t){e==0&&(this.texture__=t)},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(ao.prototype);return e.shader=this.shader,e.texture__=this.texture__,e},__class__:ao}),oo=function(e){this.killAlphaThreshold__=0,P.call(this),this.texture__=e,this.killAlphaThreshold__=Cn.defaultKillAlphaThreshold},c["h3d.shader.Texture"]=oo,oo.__name__="h3d.shader.Texture",oo.__super__=P,oo.prototype=g(P.prototype,{get_additive:function(){return this.additive__},set_additive:function(e){return this.constModified=!0,this.additive__=e},get_killAlpha:function(){return this.killAlpha__},set_killAlpha:function(e){return this.constModified=!0,this.killAlpha__=e},get_specularAlpha:function(){return this.specularAlpha__},set_specularAlpha:function(e){return this.constModified=!0,this.specularAlpha__=e},get_killAlphaThreshold:function(){return this.killAlphaThreshold__},set_killAlphaThreshold:function(e){return this.killAlphaThreshold__=e},get_texture:function(){return this.texture__},set_texture:function(e){return this.texture__=e},updateConstants:function(e){this.constBits=0,this.additive__&&(this.constBits|=1),this.killAlpha__&&(this.constBits|=2),this.specularAlpha__&&(this.constBits|=4),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.additive__;case 1:return this.killAlpha__;case 2:return this.specularAlpha__;case 3:return this.killAlphaThreshold__;case 4:return this.texture__;default:}return null},getParamFloatValue:function(e){return e==3?this.killAlphaThreshold__:0},setParamIndexValue:function(e,t){switch(e){case 0:this.additive__=t;break;case 1:this.killAlpha__=t;break;case 2:this.specularAlpha__=t;break;case 3:this.killAlphaThreshold__=t;break;case 4:this.texture__=t;break;default:}},setParamIndexFloatValue:function(e,t){e==3&&(this.killAlphaThreshold__=t)},clone:function(){var e=Object.create(oo.prototype);return e.shader=this.shader,e.additive__=this.additive__,e.killAlpha__=this.killAlpha__,e.specularAlpha__=this.specularAlpha__,e.killAlphaThreshold__=this.killAlphaThreshold__,e.texture__=this.texture__,e},__class__:oo}),Jn=function(e,t,n,s){s==null&&(s=1),n==null&&(n=1),t==null&&(t=0),e==null&&(e=0),this.uvScale__=new h(0,0,0),this.uvDelta__=new h(0,0,0),P.call(this);var o=this.uvDelta__,i=e,a=t;a==null&&(a=0),i==null&&(i=0),o.x=i,o.y=a,o.z=0,o=this.uvScale__,i=n,a=s,a==null&&(a=0),i==null&&(i=0),o.x=i,o.y=a,o.z=0},c["h3d.shader.UVDelta"]=Jn,Jn.__name__="h3d.shader.UVDelta",Jn.__super__=P,Jn.prototype=g(P.prototype,{get_uvDelta:function(){return this.uvDelta__},set_uvDelta:function(e){return this.uvDelta__=e},get_uvScale:function(){return this.uvScale__},set_uvScale:function(e){return this.uvScale__=e},updateConstants:function(e){this.constBits=0,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.uvDelta__;case 1:return this.uvScale__;default:}return null},getParamFloatValue:function(){return 0},setParamIndexValue:function(e,t){switch(e){case 0:this.uvDelta__=t;break;case 1:this.uvScale__=t;break;default:}},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(Jn.prototype);return e.shader=this.shader,e.uvDelta__=this.uvDelta__,e.uvScale__=this.uvScale__,e},__class__:Jn}),so=function(){P.call(this)},c["h3d.shader.VertexColorAlpha"]=so,so.__name__="h3d.shader.VertexColorAlpha",so.__super__=P,so.prototype=g(P.prototype,{get_additive:function(){return this.additive__},set_additive:function(e){return this.constModified=!0,this.additive__=e},updateConstants:function(e){this.constBits=0,this.additive__&&(this.constBits|=1),this.updateConstantsFinal(e)},getParamValue:function(e){return e==0?this.additive__:null},getParamFloatValue:function(){return 0},setParamIndexValue:function(e,t){e==0&&(this.additive__=t)},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(so.prototype);return e.shader=this.shader,e.additive__=this.additive__,e},__class__:so}),no=function(e,t){this.isCentered__=!0,this.tangent__=new h(0,0,0),this.normal__=new h(0,0,0),this.scale__=new h(0,0,0),P.call(this);var n=this.normal__,s=0,o=0,i=1;i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,n=this.tangent__,s=1,o=0,i=0,i==null&&(i=0),o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=i,n=this.scale__,s=1/e,o=1/t,o==null&&(o=0),s==null&&(s=0),n.x=s,n.y=o,n.z=0},c["h3d.shader.VolumeDecal"]=no,no.__name__="h3d.shader.VolumeDecal",no.__super__=P,no.prototype=g(P.prototype,{get_scale:function(){return this.scale__},set_scale:function(e){return this.scale__=e},get_normal:function(){return this.normal__},set_normal:function(e){return this.normal__=e},get_tangent:function(){return this.tangent__},set_tangent:function(e){return this.tangent__=e},get_isCentered:function(){return this.isCentered__},set_isCentered:function(e){return this.constModified=!0,this.isCentered__=e},updateConstants:function(e){this.constBits=0,this.isCentered__&&(this.constBits|=64),this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.scale__;case 1:return this.normal__;case 2:return this.tangent__;case 3:return this.isCentered__;default:}return null},getParamFloatValue:function(){return 0},setParamIndexValue:function(e,t){switch(e){case 0:this.scale__=t;break;case 1:this.normal__=t;break;case 2:this.tangent__=t;break;case 3:this.isCentered__=t;break;default:}},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(no.prototype);return e.shader=this.shader,e.scale__=this.scale__,e.normal__=this.normal__,e.tangent__=this.tangent__,e.isCentered__=this.isCentered__,e},__class__:no}),_n=_["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:s},Module:(a=function(e){return{_hx_index:1,m:e,__enum__:"haxe.StackItem",toString:s}},a._hx_name="Module",a.__params__=["m"],a),FilePos:(a=function(e,t,n,o){return{_hx_index:2,s:e,file:t,line:n,column:o,__enum__:"haxe.StackItem",toString:s}},a._hx_name="FilePos",a.__params__=["s","file","line","column"],a),Method:(a=function(e,t){return{_hx_index:3,classname:e,method:t,__enum__:"haxe.StackItem",toString:s}},a._hx_name="Method",a.__params__=["classname","method"],a),LocalFunction:(a=function(e){return{_hx_index:4,v:e,__enum__:"haxe.StackItem",toString:s}},a._hx_name="LocalFunction",a.__params__=["v"],a)},_n.__constructs__=[_n.CFunction,_n.Module,_n.FilePos,_n.Method,_n.LocalFunction],_n.__empty_constructs__=[_n.CFunction],rl={},rl.callStack=function(){return It.toHaxe(It.callStack())},Bn=function(){},c["haxe.EntryPoint"]=Bn,Bn.__name__="haxe.EntryPoint",Bn.processEvents=function(){for(;!0;){var t,e=Bn.pending.shift();if(e==null)break;e()}return t=Bt.tick(),!Bt.hasEvents()&&Bn.threadCount==0?-1:t},Bn.run=function(){var t,n,e=Bn.processEvents();typeof window!="undefined"?(t=window,n=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame,n!=null?n(Bn.run):e>=0&&setTimeout(Bn.run,e*1e3)):e>=0&&setTimeout(Bn.run,e*1e3)},ol={},ol.from=function(e){var t=1<<e._hx_index;return t==null&&(t=0),t},t=function(e,t,n){Error.call(this,e),this.message=e,this.__previousException=t,this.__nativeException=n??this},c["haxe.Exception"]=t,t.__name__="haxe.Exception",t.caught=function(e){return e instanceof t?e:e instanceof Error?new t(e.message,null,e):new Qi(e,null,e)},t.thrown=function(e){if(e instanceof t)return e.get_native();if(e instanceof Error)return e;var n=new Qi(e);return n},t.__super__=Error,t.prototype=g(Error.prototype,{unwrap:function(){return this.__nativeException},toString:function(){return this.get_message()},get_message:function(){return this.message},get_native:function(){return this.__nativeException},__class__:t}),be=function(){},c["haxe.Log"]=be,be.__name__="haxe.Log",be.formatOutput=function(e,t){var e,n,i,a,s=o.string(e);if(t==null)return s;if(a=t.fileName+":"+t.lineNumber,t.customParams!=null)for(n=0,i=t.customParams;n<i.length;)e=i[n],++n,s+=", "+o.string(e);return a+": "+s},be.trace=function(e,t){var n=be.formatOutput(e,t);typeof console!="undefined"&&console.log!=null&&console.log(n)},yc=function(e,t){this.isBlocking=!0,this.f=e,this.priority=t,this.nextRun=-(1/0)},c["haxe.MainEvent"]=yc,yc.__name__="haxe.MainEvent",yc.prototype={stop:function(){if(this.f==null)return;this.f=null,this.nextRun=-(1/0),this.prev==null?Bt.pending=this.next:this.prev.next=this.next,this.next!=null&&(this.next.prev=this.prev)},__class__:yc},Bt=function(){},c["haxe.MainLoop"]=Bt,Bt.__name__="haxe.MainLoop",Bt.hasEvents=function(){for(var e=Bt.pending;e!=null;){if(e.isBlocking)return!0;e=e.next}return!1},Bt.add=function(e,n){if(n==null&&(n=0),e==null)throw t.thrown("Event function is null");var s=new yc(e,n),o=Bt.pending;return o!=null&&(o.prev=s),s.next=o,Bt.pending=s,s},Bt.sortEvents=function(){var e,t,n,o,i,a,r,c,l,d,u,s=Bt.pending;if(s==null)return;for(r=1,o=0,i=0;!0;){for(t=s,s=null,a=null,c=0;t!=null;){for(++c,e=t,o=0,l=0,d=r;l<d;)if(u=l++,++o,e=e.next,e==null)break;for(i=r;o>0||i>0&&e!=null;)o==0?(n=e,e=e.next,--i):i==0||e==null||t.priority>e.priority||t.priority==e.priority&&t.nextRun<=e.nextRun?(n=t,t=t.next,--o):(n=e,e=e.next,--i),a!=null?a.next=n:s=n,n.prev=a,a=n;t=e}if(a.next=null,c<=1)break;r*=2}s.prev=null,Bt.pending=s},Bt.tick=function(){Bt.sortEvents();for(var n,s,e=Bt.pending,o=u.now()/1e3,t=1e9;e!=null;)s=e.next,n=e.nextRun-o,n<=0?(t=0,e.f!=null&&e.f()):t>n&&(t=n),e=s;return t},It=function(){},c["haxe.NativeStackTrace"]=It,It.__name__="haxe.NativeStackTrace",It.callStack=function(){var e=new Error(""),t=It.tryHaxeStack(e);if(typeof t=="undefined"){try{throw e}catch{}t=e.stack}return It.normalize(t,2)},It.toHaxe=function(e,t){if(t==null&&(t=0),e==null)return[];if(typeof e=="string"){var n,s,a,r,c,l,d,u,h,m,f,i=e.split(`
`);for(i[0]=="Error"&&i.shift(),a=[],c=0,u=i.length;c<u;){if(l=c++,t>l)continue;d=i[l],n=d.match(/^    at ([$A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/),n!=null?(s=n[1].split("."),s[0]=="$hxClasses"&&s.shift(),r=s.pop(),h=n[2],m=o.parseInt(n[3]),f=o.parseInt(n[4]),a.push(_n.FilePos(r=="Anonymous function"?_n.LocalFunction():r=="Global code"?null:_n.Method(s.join("."),r),h,m,f))):a.push(_n.Module(M.trim(d)))}return a}return t>0&&Array.isArray(e)?e.slice(t):e},It.tryHaxeStack=function(e){if(e==null)return[];var t,n=Error.prepareStackTrace;return Error.prepareStackTrace=It.prepareHxStackTrace,t=e.stack,Error.prepareStackTrace=n,t},It.prepareHxStackTrace=function(e,t){for(var n,s,o,i,a,c,d,u,l=[],r=0;r<t.length;)n=t[r],++r,It.wrapCallSite!=null&&(n=It.wrapCallSite(n)),i=null,s=n.getFunctionName(),s!=null&&(a=s.lastIndexOf("."),a>=0?(d=s.substring(0,a),u=s.substring(a+1),i=_n.Method(d,u)):i=_n.Method(null,s)),o=n.getFileName(),c=o==null?-1:o.indexOf("file:"),It.wrapCallSite!=null&&c>0&&(o=o.substring(c+6)),l.push(_n.FilePos(i,o,n.getLineNumber(),n.getColumnNumber()));return l},It.normalize=function(e,t){if(t==null&&(t=0),Array.isArray(e)&&t>0)return e.slice(t);if(typeof e=="string"){switch(e.substring(0,6)){case`Error
`:case"Error:":++t;break;default:}return It.skipLines(e,t)}return e},It.skipLines=function(e,t,n){return n==null&&(n=0),t>0?(n=e.indexOf(`
`,n),n<0?"":It.skipLines(e,--t,n+1)):e.substring(n)},Xi=function(){},c["haxe.Resource"]=Xi,Xi.__name__="haxe.Resource",Xi.getBytes=function(e){for(var t,n=0,s=Xi.content;n<s.length;)if(t=s[n],++n,t.name==e)return t.str!=null?A.ofString(t.str):Nn.decode(t.data);return null},Us=function(e){var t=this;this.id=setInterval(function(){t.run()},e)},c["haxe.Timer"]=Us,Us.__name__="haxe.Timer",Us.delay=function(e,t){var n=new Us(t);return n.run=function(){n.stop(),e()},n},Us.prototype={stop:function(){if(this.id==null)return;clearInterval(this.id),this.id=null},run:function(){},__class__:Us},_a=function(){},c["haxe._Unserializer.DefaultResolver"]=_a,_a.__name__="haxe._Unserializer.DefaultResolver",_a.prototype={resolveClass:function(e){return c[e]},resolveEnum:function(e){return _[e]},__class__:_a},qt=function(e){this.buf=e,this.length=this.buf.length,this.pos=0,this.scache=[],this.cache=[];var t=qt.DEFAULT_RESOLVER;t==null&&(t=new _a,qt.DEFAULT_RESOLVER=t),this.resolver=t},c["haxe.Unserializer"]=qt,qt.__name__="haxe.Unserializer",qt.initCodes=function(){for(var e,t=[],n=0,s=qt.BASE64.length;n<s;)e=n++,t[qt.BASE64.charCodeAt(e)]=e;return t},qt.run=function(e){return new qt(e).unserialize()},qt.prototype={readDigits:function(){for(var e,t=0,n=!1,s=this.pos;!0;){if(e=this.buf.charCodeAt(this.pos),e!=e)break;if(e==45){if(this.pos!=s)break;n=!0,this.pos++;continue}if(e<48||e>57)break;t=t*10+(e-48),this.pos++}return n&&(t*=-1),t},readFloat:function(){for(var e,t=this.pos;!0;){if(e=this.buf.charCodeAt(this.pos),e!=e)break;if(e>=43&&e<58||e==101||e==69)this.pos++;else break}return parseFloat(u.substr(this.buf,t,this.pos-t))},unserializeObject:function(e){for(;!0;){if(this.pos>=this.length)throw t.thrown("Invalid object");if(this.buf.charCodeAt(this.pos)==103)break;var s,n=this.unserialize();if(typeof n!="string")throw t.thrown("Invalid object key");s=this.unserialize(),e[n]=s}this.pos++},unserializeEnum:function(e,n){if(this.buf.charCodeAt(this.pos++)!=58)throw t.thrown("Invalid enum format");var s,o=this.readDigits();if(o==0)return Y.createEnum(e,n);for(s=[];o-- >0;)s.push(this.unserialize());return Y.createEnum(e,n,s)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var n,s,o,i,a,r,c,l,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,S,M,F,T,z,D,e=this.unserialize(),d=this.resolver.resolveClass(e);if(d==null)throw t.thrown("Class not found "+e);return d;case 66:if(e=this.unserialize(),h=this.resolver.resolveEnum(e),h==null)throw t.thrown("Enum not found "+e);return h;case 67:if(e=this.unserialize(),d=this.resolver.resolveClass(e),d==null)throw t.thrown("Class not found "+e);if(o=Object.create(d.prototype),this.cache.push(o),o.hxUnserialize(this),this.buf.charCodeAt(this.pos++)!=103)throw t.thrown("Invalid custom data");return o;case 77:for(i=new Rt,this.cache.push(i),s=this.buf;this.buf.charCodeAt(this.pos)!=104;)l=this.unserialize(),i.set(l,this.unserialize());return this.pos++,i;case 82:if(r=this.readDigits(),r<0||r>=this.scache.length)throw t.thrown("Invalid string reference");return this.scache[r];case 97:for(s=this.buf,j=[],this.cache.push(j);!0;){if(f=this.buf.charCodeAt(this.pos),f==104){this.pos++;break}f==117?(this.pos++,r=this.readDigits(),j[j.length+r-1]=null):j.push(this.unserialize())}return j;case 98:for(i=new fe,this.cache.push(i),s=this.buf;this.buf.charCodeAt(this.pos)!=104;)l=this.unserialize(),_=this.unserialize(),i.h[l]=_;return this.pos++,i;case 99:if(e=this.unserialize(),d=this.resolver.resolveClass(e),d==null)throw t.thrown("Class not found "+e);return o=Object.create(d.prototype),this.cache.push(o),this.unserializeObject(o),o;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:if(e=this.unserialize(),p=this.resolver.resolveEnum(e),p==null)throw t.thrown("Enum not found "+e);for(this.pos++,E=this.readDigits(),x=p.__constructs__,M=new Array(x.length),k=0,F=x.length;k<F;)n=k++,M[n]=x[n]._hx_name;if(S=M[E],S==null)throw t.thrown("Unknown enum index "+e+"@"+E);return h=this.unserializeEnum(p,S),this.cache.push(h),h;case 107:return NaN;case 108:for(w=new jn,this.cache.push(w),s=this.buf;this.buf.charCodeAt(this.pos)!=104;)w.add(this.unserialize());return this.pos++,w;case 109:return-(1/0);case 110:return null;case 111:return o={},this.cache.push(o),this.unserializeObject(o),o;case 112:return 1/0;case 113:for(i=new le,this.cache.push(i),s=this.buf,f=this.buf.charCodeAt(this.pos++);f==58;)n=this.readDigits(),_=this.unserialize(),i.h[n]=_,f=this.buf.charCodeAt(this.pos++);if(f!=104)throw t.thrown("Invalid IntMap format");return i;case 114:if(r=this.readDigits(),r<0||r>=this.cache.length)throw t.thrown("Invalid reference");return this.cache[r];case 115:if(c=this.readDigits(),s=this.buf,this.buf.charCodeAt(this.pos++)!=58||this.length-this.pos<c)throw t.thrown("Invalid bytes length");for(a=qt.CODES,a==null&&(a=qt.initCodes(),qt.CODES=a),n=this.pos,g=c&3,D=(c>>2)*3+(g>=2?g-1:0),T=n+(c-g),m=new A(new ArrayBuffer(D)),b=0;n<T;)C=a[s.charCodeAt(n++)],v=a[s.charCodeAt(n++)],m.b[b++]=C<<2|v>>4,y=a[s.charCodeAt(n++)],m.b[b++]=v<<4|y>>2,z=a[s.charCodeAt(n++)],m.b[b++]=y<<6|z;return g>=2&&(C=a[s.charCodeAt(n++)],v=a[s.charCodeAt(n++)],m.b[b++]=C<<2|v>>4,g==3&&(y=a[s.charCodeAt(n++)],m.b[b++]=v<<4|y>>2)),this.pos+=c,this.cache.push(m),m;case 116:return!0;case 118:return this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&this.buf.charCodeAt(this.pos+4)==45?(O=u.strDate(u.substr(this.buf,this.pos,19)),this.pos+=19):O=new Date(this.readFloat()),this.cache.push(O),O;case 119:if(e=this.unserialize(),p=this.resolver.resolveEnum(e),p==null)throw t.thrown("Enum not found "+e);return h=this.unserializeEnum(p,this.unserialize()),this.cache.push(h),h;case 120:throw t.thrown(this.unserialize());case 121:if(c=this.readDigits(),this.buf.charCodeAt(this.pos++)!=58||this.length-this.pos<c)throw t.thrown("Invalid string length");return l=u.substr(this.buf,this.pos,c),this.pos+=c,l=decodeURIComponent(l.split("+").join(" ")),this.scache.push(l),l;case 122:return 0;default:}throw this.pos--,t.thrown("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:qt},Qi=function(e,n,s){t.call(this,String(e),n,s),this.value=e},c["haxe.ValueException"]=Qi,Qi.__name__="haxe.ValueException",Qi.__super__=t,Qi.prototype=g(t.prototype,{unwrap:function(){return this.value},__class__:Qi}),si=function(){this.a1=1,this.a2=0},c["haxe.crypto.Adler32"]=si,si.__name__="haxe.crypto.Adler32",si.read=function(e){var t=new si,n=e.readByte(),s=e.readByte(),o=e.readByte(),i=e.readByte();return t.a1=o<<8|i,t.a2=n<<8|s,t},si.prototype={update:function(e,t,n){for(var a,r,s=this.a1,o=this.a2,i=t,c=t+n;i<c;)a=i++,r=e.b[a],s=(s+r)%65521,o=(o+s)%65521;this.a1=s,this.a2=o},equals:function(e){return e.a1==this.a1&&e.a2==this.a2},__class__:si},A=function(e){this.length=e.byteLength,this.b=new Uint8Array(e),this.b.bufferValue=e,e.hxBytes=this,e.bytes=this.b},c["haxe.io.Bytes"]=A,A.__name__="haxe.io.Bytes",A.ofString=function(e,t){if(t==ti.RawNative){for(var n,s,o,i=new Uint8Array(e.length<<1),a=0,r=e.length;a<r;)o=a++,n=e.charCodeAt(o),i[o<<1]=n&255,i[o<<1|1]=n>>8;return new A(i.buffer)}for(s=[],o=0;o<e.length;)n=e.charCodeAt(o++),55296<=n&&n<=56319&&(n=n-55232<<10|e.charCodeAt(o++)&1023),n<=127?s.push(n):n<=2047?(s.push(192|n>>6),s.push(128|n&63)):n<=65535?(s.push(224|n>>12),s.push(128|n>>6&63),s.push(128|n&63)):(s.push(240|n>>18),s.push(128|n>>12&63),s.push(128|n>>6&63),s.push(128|n&63));return new A(new Uint8Array(s).buffer)},A.ofData=function(e){var t=e.hxBytes;return t??new A(e)},A.prototype={blit:function(e,n,s,o){if(e<0||s<0||o<0||e+o>this.length||s+o>n.length)throw t.thrown(Et.OutsideBounds);s==0&&o==n.b.byteLength?this.b.set(n.b,e):this.b.set(n.b.subarray(s,s+o),e)},fill:function(e,t,n){for(var i,s=0,o=t;s<o;)i=s++,this.b[e++]=n},sub:function(e,n){if(e<0||n<0||e+n>this.length)throw t.thrown(Et.OutsideBounds);return new A(this.b.buffer.slice(e+this.b.byteOffset,e+this.b.byteOffset+n))},getFloat:function(e){return this.data==null&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(e,!0)},setFloat:function(e,t){this.data==null&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(e,t,!0)},getUInt16:function(e){return this.data==null&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(e,!0)},setUInt16:function(e,t){this.data==null&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setUint16(e,t,!0)},getInt32:function(e){return this.data==null&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(e,!0)},setInt32:function(e,t){this.data==null&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(e,t,!0)},getString:function(e,n,s){if(e<0||n<0||e+n>this.length)throw t.thrown(Et.OutsideBounds);s==null&&(s=ti.UTF8);var i,l,d,u,h,m,f,p,r="",a=this.b,o=e,c=e+n;switch(s._hx_index){case 0:for(p=e>0;o<c;)if(i=a[o++],i<128){if(i==0)break;r+=String.fromCodePoint(i)}else i<224?(l=(i&63)<<6|a[o++]&127,r+=String.fromCodePoint(l)):i<240?(d=a[o++],u=(i&31)<<12|(d&127)<<6|a[o++]&127,r+=String.fromCodePoint(u)):(h=a[o++],m=a[o++],f=(i&15)<<18|(h&127)<<12|(m&127)<<6|a[o++]&127,r+=String.fromCodePoint(f));break;case 1:for(;o<c;)i=a[o++]|a[o++]<<8,r+=String.fromCodePoint(i);break}return r},toString:function(){return this.getString(0,this.length)},__class__:A},ti=_["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:s},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:s}},ti.__constructs__=[ti.UTF8,ti.RawNative],ti.__empty_constructs__=[ti.UTF8,ti.RawNative],Nn=function(){},c["haxe.crypto.Base64"]=Nn,Nn.__name__="haxe.crypto.Base64",Nn.encode=function(e,t){t==null&&(t=!0);var n=new ba(Nn.BYTES).encodeBytes(e).toString();if(t)switch(e.length%3){case 1:n+="==";break;case 2:n+="=";break;default:}return n},Nn.decode=function(e,t){if(t==null&&(t=!0),t)for(;u.cca(e,e.length-1)==61;)e=u.substr(e,0,-1);return new ba(Nn.BYTES).decodeBytes(A.ofString(e))},ba=function(e){for(var s=e.length,n=1;s>1<<n;)++n;if(n>8||s!=1<<n)throw t.thrown("BaseCode : base length must be a power of two.");this.base=e,this.nbits=n},c["haxe.crypto.BaseCode"]=ba,ba.__name__="haxe.crypto.BaseCode",ba.prototype={encodeBytes:function(e){for(var t=this.nbits,a=this.base,r=e.length*8/t|0,o=new A(new ArrayBuffer(r+(e.length*8%t==0?0:1))),s=0,n=0,c=(1<<t)-1,l=0,i=0;i<r;){for(;n<t;)n+=8,s<<=8,s|=e.b[l++];n-=t,o.b[i++]=a.b[s>>n&c]}return n>0&&(o.b[i++]=a.b[s<<t-n&c]),o},initTable:function(){for(var t,s,n=[],e=0;e<256;)t=e++,n[t]=-1;for(e=0,s=this.base.length;e<s;)t=e++,n[this.base.b[t]]=t;this.tbl=n},decodeBytes:function(e){var n,s,i,a,r,c,l,d,o=this.nbits,u=this.base;for(this.tbl==null&&this.initTable(),l=this.tbl,i=e.length*o>>3,a=new A(new ArrayBuffer(i)),s=0,n=0,d=0,r=0;r<i;){for(;n<8;){if(n+=o,s<<=o,c=l[e.b[d++]],c==-1)throw t.thrown("BaseCode : invalid encoded char");s|=c}n-=8,a.b[r++]=s>>n&255}return a},__class__:ba},pn=function(){},c["haxe.crypto.Md5"]=pn,pn.__name__="haxe.crypto.Md5",pn.encode=function(e){var t=new pn,n=t.doEncode(pn.str2blks(e));return t.hex(n)},pn.str2blks=function(e){for(var t,s,o,a,i=A.ofString(e),r=(i.length+8>>6)+1,n=[],l=r*16,c=0,d=l;c<d;)t=c++,n[t]=0;for(t=0,a=i.length,s=a*8;t<a;)n[t>>2]|=i.b[t]<<(s+t)%4*8,++t;return n[t>>2]|=128<<(s+t)%4*8,o=r*16-2,n[o]=s&255,n[o]|=(s>>>8&255)<<8,n[o]|=(s>>>16&255)<<16,n[o]|=(s>>>24&255)<<24,n},pn.prototype={bitOR:function(e,t){var n=e&1|t&1,s=e>>>1|t>>>1;return s<<1|n},bitXOR:function(e,t){var n=e&1^t&1,s=e>>>1^t>>>1;return s<<1|n},bitAND:function(e,t){var n=e&1&(t&1),s=e>>>1&t>>>1;return s<<1|n},addme:function(e,t){var n=(e&65535)+(t&65535),s=(e>>16)+(t>>16)+(n>>16);return s<<16|n&65535},hex:function(e){for(var t,s="",n="0123456789abcdef",o=0;o<e.length;)t=e[o],++o,s+=n.charAt(t>>4&15)+n.charAt(t&15),s+=n.charAt(t>>12&15)+n.charAt(t>>8&15),s+=n.charAt(t>>20&15)+n.charAt(t>>16&15),s+=n.charAt(t>>28&15)+n.charAt(t>>24&15);return s},rol:function(e,t){return e<<t|e>>>32-t},cmn:function(e,t,n,s,o,i){return this.addme(this.rol(this.addme(this.addme(t,e),this.addme(s,i)),o),n)},ff:function(e,t,n,s,o,i,a){return this.cmn(this.bitOR(this.bitAND(t,n),this.bitAND(~t,s)),e,t,o,i,a)},gg:function(e,t,n,s,o,i,a){return this.cmn(this.bitOR(this.bitAND(t,s),this.bitAND(n,~s)),e,t,o,i,a)},hh:function(e,t,n,s,o,i,a){return this.cmn(this.bitXOR(this.bitXOR(t,n),s),e,t,o,i,a)},ii:function(e,t,n,s,o,i,a){return this.cmn(this.bitXOR(n,this.bitOR(t,~s)),e,t,o,i,a)},doEncode:function(e){for(var a,r,c,l,d,t=1732584193,n=-271733879,s=-1732584194,o=271733878,i=0;i<e.length;)a=t,r=n,c=s,l=o,d=0,t=this.ff(t,n,s,o,e[i],7,-680876936),o=this.ff(o,t,n,s,e[i+1],12,-389564586),s=this.ff(s,o,t,n,e[i+2],17,606105819),n=this.ff(n,s,o,t,e[i+3],22,-1044525330),t=this.ff(t,n,s,o,e[i+4],7,-176418897),o=this.ff(o,t,n,s,e[i+5],12,1200080426),s=this.ff(s,o,t,n,e[i+6],17,-1473231341),n=this.ff(n,s,o,t,e[i+7],22,-45705983),t=this.ff(t,n,s,o,e[i+8],7,1770035416),o=this.ff(o,t,n,s,e[i+9],12,-1958414417),s=this.ff(s,o,t,n,e[i+10],17,-42063),n=this.ff(n,s,o,t,e[i+11],22,-1990404162),t=this.ff(t,n,s,o,e[i+12],7,1804603682),o=this.ff(o,t,n,s,e[i+13],12,-40341101),s=this.ff(s,o,t,n,e[i+14],17,-1502002290),n=this.ff(n,s,o,t,e[i+15],22,1236535329),t=this.gg(t,n,s,o,e[i+1],5,-165796510),o=this.gg(o,t,n,s,e[i+6],9,-1069501632),s=this.gg(s,o,t,n,e[i+11],14,643717713),n=this.gg(n,s,o,t,e[i],20,-373897302),t=this.gg(t,n,s,o,e[i+5],5,-701558691),o=this.gg(o,t,n,s,e[i+10],9,38016083),s=this.gg(s,o,t,n,e[i+15],14,-660478335),n=this.gg(n,s,o,t,e[i+4],20,-405537848),t=this.gg(t,n,s,o,e[i+9],5,568446438),o=this.gg(o,t,n,s,e[i+14],9,-1019803690),s=this.gg(s,o,t,n,e[i+3],14,-187363961),n=this.gg(n,s,o,t,e[i+8],20,1163531501),t=this.gg(t,n,s,o,e[i+13],5,-1444681467),o=this.gg(o,t,n,s,e[i+2],9,-51403784),s=this.gg(s,o,t,n,e[i+7],14,1735328473),n=this.gg(n,s,o,t,e[i+12],20,-1926607734),t=this.hh(t,n,s,o,e[i+5],4,-378558),o=this.hh(o,t,n,s,e[i+8],11,-2022574463),s=this.hh(s,o,t,n,e[i+11],16,1839030562),n=this.hh(n,s,o,t,e[i+14],23,-35309556),t=this.hh(t,n,s,o,e[i+1],4,-1530992060),o=this.hh(o,t,n,s,e[i+4],11,1272893353),s=this.hh(s,o,t,n,e[i+7],16,-155497632),n=this.hh(n,s,o,t,e[i+10],23,-1094730640),t=this.hh(t,n,s,o,e[i+13],4,681279174),o=this.hh(o,t,n,s,e[i],11,-358537222),s=this.hh(s,o,t,n,e[i+3],16,-722521979),n=this.hh(n,s,o,t,e[i+6],23,76029189),t=this.hh(t,n,s,o,e[i+9],4,-640364487),o=this.hh(o,t,n,s,e[i+12],11,-421815835),s=this.hh(s,o,t,n,e[i+15],16,530742520),n=this.hh(n,s,o,t,e[i+2],23,-995338651),t=this.ii(t,n,s,o,e[i],6,-198630844),o=this.ii(o,t,n,s,e[i+7],10,1126891415),s=this.ii(s,o,t,n,e[i+14],15,-1416354905),n=this.ii(n,s,o,t,e[i+5],21,-57434055),t=this.ii(t,n,s,o,e[i+12],6,1700485571),o=this.ii(o,t,n,s,e[i+3],10,-1894986606),s=this.ii(s,o,t,n,e[i+10],15,-1051523),n=this.ii(n,s,o,t,e[i+1],21,-2054922799),t=this.ii(t,n,s,o,e[i+8],6,1873313359),o=this.ii(o,t,n,s,e[i+15],10,-30611744),s=this.ii(s,o,t,n,e[i+6],15,-1560198380),n=this.ii(n,s,o,t,e[i+13],21,1309151649),t=this.ii(t,n,s,o,e[i+4],6,-145523070),o=this.ii(o,t,n,s,e[i+11],10,-1120210379),s=this.ii(s,o,t,n,e[i+2],15,718787259),n=this.ii(n,s,o,t,e[i+9],21,-343485551),t=this.addme(t,a),n=this.addme(n,r),s=this.addme(s,c),o=this.addme(o,l),i+=16;return[t,n,s,o]},__class__:pn},et=function(){},c["haxe.ds.ArraySort"]=et,et.__name__="haxe.ds.ArraySort",et.sort=function(e,t){et.rec(e,t,0,e.length)},et.rec=function(e,t,n,s){var o,a,r,c,i=n+s>>1;if(s-n<12){if(s<=n)return;for(a=n+1,r=s;a<r;)for(c=a++,o=c;o>n;){if(t(e[o],e[o-1])<0)et.swap(e,o-1,o);else break;--o}return}et.rec(e,t,n,i),et.rec(e,t,i,s),et.doMerge(e,t,n,i,s,i-n,s-i)},et.doMerge=function(e,t,n,s,o,i,a){if(i==0||a==0)return;if(i+a==2){t(e[s],e[n])<0&&et.swap(e,s,n);return}i>a?(d=i>>1,r=n+d,c=et.lower(e,t,s,o,r),l=c-s):(l=a>>1,c=s+l,r=et.upper(e,t,n,s,c),d=r-n),et.rotate(e,t,r,s,c);var r,c,l,d,u=r+l;et.doMerge(e,t,n,r,u,d,l),et.doMerge(e,t,u,c,o,i-d,a-l)},et.rotate=function(e,t,n,s,o){if(n==s||s==o)return;for(var i,r,c,l,a=et.gcd(o-n,s-n);a--!=0;){for(l=e[n+a],r=s-n,c=n+a,i=n+a+r;i!=n+a;)e[c]=e[i],c=i,o-i>r?i+=r:i=n+(r-(o-i));e[c]=l}},et.gcd=function(e,t){for(;t!=0;){var n=e%t;e=t,t=n}return e},et.upper=function(e,t,n,s,o){for(var a,r,i=s-n;i>0;)a=i>>1,r=n+a,t(e[o],e[r])<0?i=a:(n=r+1,i=i-a-1);return n},et.lower=function(e,t,n,s,o){for(var a,r,i=s-n;i>0;)a=i>>1,r=n+a,t(e[r],e[o])<0?(n=r+1,i=i-a-1):i=a;return n},et.swap=function(e,t,n){var s=e[t];e[t]=e[n],e[n]=s},Jo=function(){},c["haxe.ds.BalancedTree"]=Jo,Jo.__name__="haxe.ds.BalancedTree",Jo.__interfaces__=[Xo],Jo.prototype={set:function(e,t){this.root=this.setLoop(e,t,this.root)},get:function(e){for(var n,t=this.root;t!=null;){if(n=this.compare(e,t.key),n==0)return t.value;n<0?t=t.left:t=t.right}return null},setLoop:function(e,t,n){if(n==null)return new $t(null,e,t,null);var o,i,s=this.compare(e,n.key);return s==0?new $t(n.left,e,t,n.right,n==null?0:n._height):s<0?(o=this.setLoop(e,t,n.left),this.balance(o,n.key,n.value,n.right)):(i=this.setLoop(e,t,n.right),this.balance(n.left,n.key,n.value,i))},balance:function(e,t,n,s){var o,i,a=e==null?0:e._height,r=s==null?0:s._height;return a>r+2?(o=e.left,i=e.right,(o==null?0:o._height)>=(i==null?0:i._height)?new $t(e.left,e.key,e.value,new $t(e.right,t,n,s)):new $t(new $t(e.left,e.key,e.value,e.right.left),e.right.key,e.right.value,new $t(e.right.right,t,n,s))):r>a+2?(o=s.right,i=s.left,(o==null?0:o._height)>(i==null?0:i._height)?new $t(new $t(e,t,n,s.left),s.key,s.value,s.right):new $t(new $t(e,t,n,s.left.left),s.left.key,s.left.value,new $t(s.left.right,s.key,s.value,s.right))):new $t(e,t,n,s,(a>r?a:r)+1)},compare:function(e,t){return q.compare(e,t)},__class__:Jo},$t=function(e,t,n,s,o){if(o==null&&(o=-1),this.left=e,this.key=t,this.value=n,this.right=s,o==-1){var a,i=this.left,r=this.right;(i==null?0:i._height)>(r==null?0:r._height)?(i=this.left,a=i==null?0:i._height):(i=this.right,a=i==null?0:i._height),this._height=a+1}else this._height=o},c["haxe.ds.TreeNode"]=$t,$t.__name__="haxe.ds.TreeNode",$t.prototype={__class__:$t},vo=function(){Jo.call(this)},c["haxe.ds.EnumValueMap"]=vo,vo.__name__="haxe.ds.EnumValueMap",vo.__interfaces__=[Xo],vo.__super__=Jo,vo.prototype=g(Jo.prototype,{compare:function(e,t){var n,s,o=e._hx_index-t._hx_index;return o!=0?o:(n=Y.enumParameters(e),s=Y.enumParameters(t),n.length==0&&s.length==0?0:this.compareArgs(n,s))},compareArgs:function(e,t){var n,s,o,a,i=e.length-t.length;if(i!=0)return i;for(n=0,a=e.length;n<a;)if(s=n++,o=this.compareArg(e[s],t[s]),o!=0)return o;return 0},compareArg:function(e,t){return q.isEnumValue(e)&&q.isEnumValue(t)?this.compare(e,t):e instanceof Array&&t instanceof Array?this.compareArgs(e,t):q.compare(e,t)},__class__:vo}),jn=function(){this.length=0},c["haxe.ds.List"]=jn,jn.__name__="haxe.ds.List",jn.prototype={add:function(e){var t=new va(e,null);this.h==null?this.h=t:this.q.next=t,this.q=t,this.length++},push:function(e){var t=new va(e,this.h);this.h=t,this.q==null&&(this.q=t),this.length++},remove:function(e){for(var n=null,t=this.h;t!=null;){if(t.item==e)return n==null?this.h=t.next:n.next=t.next,this.q==t&&(this.q=n),this.length--,!0;n=t,t=t.next}return!1},__class__:jn},va=function(e,t){this.item=e,this.next=t},c["haxe.ds._List.ListNode"]=va,va.__name__="haxe.ds._List.ListNode",va.prototype={__class__:va},Rt=function(){this.h={__keys__:{}}},c["haxe.ds.ObjectMap"]=Rt,Rt.__name__="haxe.ds.ObjectMap",Rt.__interfaces__=[Xo],Rt.prototype={set:function(t,n){var s=t.__id__;s==null&&(s=t.__id__=e.$haxeUID++),this.h[s]=n,this.h.__keys__[s]=t},remove:function(e){var t=e.__id__;return this.h.__keys__[t]!=null&&(delete this.h[t],delete this.h.__keys__[t],!0)},keys:function(){var t,e=[];for(t in this.h.__keys__)this.h.hasOwnProperty(t)&&e.push(this.h.__keys__[t]);return new Ws(e)},__class__:Rt},sa=function(e){this.h=e,this.keys=Object.keys(e),this.length=this.keys.length,this.current=0},c["haxe.ds._StringMap.StringMapKeyIterator"]=sa,sa.__name__="haxe.ds._StringMap.StringMapKeyIterator",sa.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.keys[this.current++]},__class__:sa},ac=function(e){this.h=e,this.keys=Object.keys(e),this.length=this.keys.length,this.current=0},c["haxe.ds._StringMap.StringMapValueIterator"]=ac,ac.__name__="haxe.ds._StringMap.StringMapValueIterator",ac.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.h[this.keys[this.current++]]},__class__:ac},il={},il.blit=function(e,t,n,s,o){if(e==n){if(t<s)for(var l,i=t+o,r=s+o,a=0,c=o;a<c;)l=a++,--i,--r,e[r]=e[i];else if(t>s)for(i=t,r=s,a=0,c=o;a<c;)l=a++,e[r]=e[i],++i,++r}else for(a=0,c=o;a<c;)i=a++,n[s+i]=e[t+i]},$o=function(e,n,s){t.call(this,e,n),s==null?this.posInfos={fileName:"(unknown)",lineNumber:0,className:"(unknown)",methodName:"(unknown)"}:this.posInfos=s},c["haxe.exceptions.PosException"]=$o,$o.__name__="haxe.exceptions.PosException",$o.__super__=t,$o.prototype=g(t.prototype,{toString:function(){return""+t.prototype.toString.call(this)+" in "+this.posInfos.className+"."+this.posInfos.methodName+" at "+this.posInfos.fileName+":"+this.posInfos.lineNumber},__class__:$o}),Vo=function(e,t,n){e==null&&(e="Not implemented"),$o.call(this,e,t,n)},c["haxe.exceptions.NotImplementedException"]=Vo,Vo.__name__="haxe.exceptions.NotImplementedException",Vo.__super__=$o,Vo.prototype=g($o.prototype,{__class__:Vo}),Kn=function(){this.pos=0,this.size=0},c["haxe.io.BytesBuffer"]=Kn,Kn.__name__="haxe.io.BytesBuffer",Kn.prototype={addByte:function(e){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,e)},add:function(e){if(this.pos+e.length>this.size&&this.grow(e.length),this.size==0)return;var t=new Uint8Array(e.b.buffer,e.b.byteOffset,e.length);this.u8.set(t,this.pos),this.pos+=e.length},addInt32:function(e){this.pos+4>this.size&&this.grow(4),this.view.setInt32(this.pos,e,!0),this.pos+=4},addFloat:function(e){this.pos+4>this.size&&this.grow(4),this.view.setFloat32(this.pos,e,!0),this.pos+=4},addDouble:function(e){this.pos+8>this.size&&this.grow(8),this.view.setFloat64(this.pos,e,!0),this.pos+=8},addBytes:function(e,n,s){if(n<0||s<0||n+s>e.length)throw t.thrown(Et.OutsideBounds);if(this.pos+s>this.size&&this.grow(s),this.size==0)return;var o=new Uint8Array(e.b.buffer,e.b.byteOffset+n,s);this.u8.set(o,this.pos),this.pos+=s},grow:function(e){for(var n,s,o=this.pos+e,t=this.size==0?16:this.size;t<o;)t=t*3>>1;n=new ArrayBuffer(t),s=new Uint8Array(n),this.size>0&&s.set(this.u8),this.size=t,this.buffer=n,this.u8=s,this.view=new DataView(this.buffer)},getBytes:function(){if(this.size==0)return new A(new ArrayBuffer(0));var e=new A(this.buffer);return e.length=this.pos,e},__class__:Kn},Io=function(){},c["haxe.io.Input"]=Io,Io.__name__="haxe.io.Input",Io.prototype={readByte:function(){throw new Vo(null,null,{fileName:"haxe/io/Input.hx",lineNumber:53,className:"haxe.io.Input",methodName:"readByte"})},readBytes:function(e,n,s){var o=s,i=e.b;if(n<0||s<0||n+s>e.length)throw t.thrown(Et.OutsideBounds);try{for(;o>0;)i[n]=this.readByte(),++n,--o}catch(e){if(!(t.caught(e).unwrap()instanceof fn))throw e}return s-o},set_bigEndian:function(e){return this.bigEndian=e,e},readFullBytes:function(e,n,s){for(;s>0;){var o=this.readBytes(e,n,s);if(o==0)throw t.thrown(Et.Blocked);n+=o,s-=o}},read:function(e){for(var n,s=new A(new ArrayBuffer(e)),o=0;e>0;){if(n=this.readBytes(s,o,e),n==0)throw t.thrown(Et.Blocked);o+=n,e-=n}return s},readUntil:function(e){for(var t,n=new Kn;!0;){if(t=this.readByte(),t==e)break;n.addByte(t)}return n.getBytes().toString()},readLine:function(){var e,s,o,i,n=new Kn;try{for(;!0;){if(s=this.readByte(),s==10)break;n.addByte(s)}e=n.getBytes().toString(),u.cca(e,e.length-1)==13&&(e=u.substr(e,0,-1))}catch(s){if(o=t.caught(s).unwrap(),o instanceof fn){if(i=o,e=n.getBytes().toString(),e.length==0)throw t.thrown(i)}else throw s}return e},readFloat:function(){return yt.i32ToFloat(this.readInt32())},readDouble:function(){var e=this.readInt32(),t=this.readInt32();return this.bigEndian?yt.i64ToDouble(t,e):yt.i64ToDouble(e,t)},readInt16:function(){var t=this.readByte(),n=this.readByte(),e=this.bigEndian?n|t<<8:t|n<<8;return(e&32768)!=0?e-65536:e},readUInt16:function(){var e=this.readByte(),t=this.readByte();return this.bigEndian?t|e<<8:e|t<<8},readUInt24:function(){var e=this.readByte(),t=this.readByte(),n=this.readByte();return this.bigEndian?n|t<<8|e<<16:e|t<<8|n<<16},readInt32:function(){var e=this.readByte(),t=this.readByte(),n=this.readByte(),s=this.readByte();return this.bigEndian?s|n<<8|t<<16|e<<24:e|t<<8|n<<16|s<<24},readString:function(e,t){var n=new A(new ArrayBuffer(e));return this.readFullBytes(n,0,e),n.getString(0,e,t)},__class__:Io},Nt=function(e,n,s){if(n==null&&(n=0),s==null&&(s=e.length-n),n<0||s<0||n+s>e.length)throw t.thrown(Et.OutsideBounds);this.b=e.b,this.pos=n,this.len=s,this.totlen=s},c["haxe.io.BytesInput"]=Nt,Nt.__name__="haxe.io.BytesInput",Nt.__super__=Io,Nt.prototype=g(Io.prototype,{set_position:function(e){return e<0?e=0:e>this.totlen&&(e=this.totlen),this.len=this.totlen-e,this.pos=e},readByte:function(){if(this.len==0)throw t.thrown(new fn);return this.len--,this.b[this.pos++]},readBytes:function(e,n,s){if(n<0||s<0||n+s>e.length)throw t.thrown(Et.OutsideBounds);if(this.len==0&&s>0)throw t.thrown(new fn);this.len<s&&(s=this.len);for(var o,a=this.b,r=e.b,i=0,c=s;i<c;)o=i++,r[n+o]=a[this.pos+o];return this.pos+=s,this.len-=s,s},__class__:Nt}),Na=function(){},c["haxe.io.Output"]=Na,Na.__name__="haxe.io.Output",Na.prototype={writeByte:function(){throw new Vo(null,null,{fileName:"haxe/io/Output.hx",lineNumber:47,className:"haxe.io.Output",methodName:"writeByte"})},writeBytes:function(e,n,s){if(n<0||s<0||n+s>e.length)throw t.thrown(Et.OutsideBounds);for(var i=e.b,o=s;o>0;)this.writeByte(i[n]),++n,--o;return s},flush:function(){},close:function(){},set_bigEndian:function(e){return this.bigEndian=e,e},write:function(e){for(var n,s=e.length,o=0;s>0;){if(n=this.writeBytes(e,o,s),n==0)throw t.thrown(Et.Blocked);o+=n,s-=n}},writeFullBytes:function(e,t,n){for(;n>0;){var s=this.writeBytes(e,t,n);t+=s,n-=s}},writeInt32:function(e){this.bigEndian?(this.writeByte(e>>>24),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(e&255)):(this.writeByte(e&255),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>>24))},writeString:function(e,t){var n=A.ofString(e,t);this.writeFullBytes(n,0,n.length)},__class__:Na},zn=function(){this.b=new Kn},c["haxe.io.BytesOutput"]=zn,zn.__name__="haxe.io.BytesOutput",zn.__super__=Na,zn.prototype=g(Na.prototype,{writeByte:function(e){this.b.addByte(e)},writeBytes:function(e,t,n){return this.b.addBytes(e,t,n),n},getBytes:function(){return this.b.getBytes()},__class__:zn}),fn=function(){},c["haxe.io.Eof"]=fn,fn.__name__="haxe.io.Eof",fn.prototype={toString:function(){return"Eof"},__class__:fn},Et=_["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:s},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:s},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:s},Custom:(a=function(e){return{_hx_index:3,e,__enum__:"haxe.io.Error",toString:s}},a._hx_name="Custom",a.__params__=["e"],a)},Et.__constructs__=[Et.Blocked,Et.Overflow,Et.OutsideBounds,Et.Custom],Et.__empty_constructs__=[Et.Blocked,Et.Overflow,Et.OutsideBounds],yt=function(){},c["haxe.io.FPHelper"]=yt,yt.__name__="haxe.io.FPHelper",yt.i32ToFloat=function(e){return yt.helper.setInt32(0,e,!0),yt.helper.getFloat32(0,!0)},yt.floatToI32=function(e){return yt.helper.setFloat32(0,e,!0),yt.helper.getInt32(0,!0)},yt.i64ToDouble=function(e,t){return yt.helper.setInt32(0,e,!0),yt.helper.setInt32(4,t,!0),yt.helper.getFloat64(0,!0)},ge=function(e){switch(e){case".":case"..":this.dir=e,this.file="";return}var s,t=e.lastIndexOf("/"),n=e.lastIndexOf("\\");t<n?(this.dir=u.substr(e,0,n),e=u.substr(e,n+1,null),this.backslash=!0):n<t?(this.dir=u.substr(e,0,t),e=u.substr(e,t+1,null)):this.dir=null,s=e.lastIndexOf("."),s!=-1?(this.ext=u.substr(e,s+1,null),this.file=u.substr(e,0,s)):(this.ext=null,this.file=e)},c["haxe.io.Path"]=ge,ge.__name__="haxe.io.Path",ge.directory=function(e){var t=new ge(e);return t.dir==null?"":t.dir},ge.extension=function(e){var t=new ge(e);return t.ext==null?"":t.ext},ge.withExtension=function(e,t){var n=new ge(e);return n.ext=t,n.toString()},ge.join=function(e){for(var e,s,o,a,t=[],n=0,i=e;n<i.length;)o=i[n],++n,o!=null&&o!=""&&t.push(o);if(e=t,e.length==0)return"";for(s=e[0],t=1,n=e.length;t<n;)a=t++,s=ge.addTrailingSlash(s),s+=e[a];return ge.normalize(s)},ge.normalize=function(e){var t,n,s,o,i,a,c,l,d,h,m,f,p,g,v,b,j,r="/";if(e=e.split("\\").join(r),e==r)return r;for(t=[],l=0,h=e.split(r);l<h.length;)o=h[l],++l,o==".."&&t.length>0&&t[t.length-1]!=".."?t.pop():o==""?(t.length>0||u.cca(e,0)==47)&&t.push(o):o!="."&&t.push(o);for(v=t.join(r),n="",a=!1,s=!1,c=0,m=v;c<m.length;)switch(f=m,p=c++,i=f.charCodeAt(p),i>=55296&&i<=56319&&(i=i-55232<<10|f.charCodeAt(p+1)&1023),g=i,g>=65536&&++c,d=g,d){case 47:a?(b=d,a=!1,s&&(n+="/",s=!1),n+=String.fromCodePoint(b)):s=!0;break;case 58:n+=":",a=!0;break;default:j=d,a=!1,s&&(n+="/",s=!1),n+=String.fromCodePoint(j)}return n},ge.addTrailingSlash=function(e){if(e.length==0)return"/";var t=e.lastIndexOf("/"),n=e.lastIndexOf("\\");return t<n?n!=e.length-1?e+"\\":e:t!=e.length-1?e+"/":e},ge.isAbsolute=function(e){return!!M.startsWith(e,"/")||e.charAt(1)==":"||!!M.startsWith(e,"\\\\")},ge.prototype={toString:function(){return(this.dir==null?"":this.dir+(this.backslash?"\\":"/"))+this.file+(this.ext==null?"":"."+this.ext)},__class__:ge},Ws=function(e){this.current=0,this.array=e},c["haxe.iterators.ArrayIterator"]=Ws,Ws.__name__="haxe.iterators.ArrayIterator",Ws.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Ws},T=_["haxe.macro.Binop"]={__ename__:!0,__constructs__:null,OpAdd:{_hx_name:"OpAdd",_hx_index:0,__enum__:"haxe.macro.Binop",toString:s},OpMult:{_hx_name:"OpMult",_hx_index:1,__enum__:"haxe.macro.Binop",toString:s},OpDiv:{_hx_name:"OpDiv",_hx_index:2,__enum__:"haxe.macro.Binop",toString:s},OpSub:{_hx_name:"OpSub",_hx_index:3,__enum__:"haxe.macro.Binop",toString:s},OpAssign:{_hx_name:"OpAssign",_hx_index:4,__enum__:"haxe.macro.Binop",toString:s},OpEq:{_hx_name:"OpEq",_hx_index:5,__enum__:"haxe.macro.Binop",toString:s},OpNotEq:{_hx_name:"OpNotEq",_hx_index:6,__enum__:"haxe.macro.Binop",toString:s},OpGt:{_hx_name:"OpGt",_hx_index:7,__enum__:"haxe.macro.Binop",toString:s},OpGte:{_hx_name:"OpGte",_hx_index:8,__enum__:"haxe.macro.Binop",toString:s},OpLt:{_hx_name:"OpLt",_hx_index:9,__enum__:"haxe.macro.Binop",toString:s},OpLte:{_hx_name:"OpLte",_hx_index:10,__enum__:"haxe.macro.Binop",toString:s},OpAnd:{_hx_name:"OpAnd",_hx_index:11,__enum__:"haxe.macro.Binop",toString:s},OpOr:{_hx_name:"OpOr",_hx_index:12,__enum__:"haxe.macro.Binop",toString:s},OpXor:{_hx_name:"OpXor",_hx_index:13,__enum__:"haxe.macro.Binop",toString:s},OpBoolAnd:{_hx_name:"OpBoolAnd",_hx_index:14,__enum__:"haxe.macro.Binop",toString:s},OpBoolOr:{_hx_name:"OpBoolOr",_hx_index:15,__enum__:"haxe.macro.Binop",toString:s},OpShl:{_hx_name:"OpShl",_hx_index:16,__enum__:"haxe.macro.Binop",toString:s},OpShr:{_hx_name:"OpShr",_hx_index:17,__enum__:"haxe.macro.Binop",toString:s},OpUShr:{_hx_name:"OpUShr",_hx_index:18,__enum__:"haxe.macro.Binop",toString:s},OpMod:{_hx_name:"OpMod",_hx_index:19,__enum__:"haxe.macro.Binop",toString:s},OpAssignOp:(a=function(e){return{_hx_index:20,op:e,__enum__:"haxe.macro.Binop",toString:s}},a._hx_name="OpAssignOp",a.__params__=["op"],a),OpInterval:{_hx_name:"OpInterval",_hx_index:21,__enum__:"haxe.macro.Binop",toString:s},OpArrow:{_hx_name:"OpArrow",_hx_index:22,__enum__:"haxe.macro.Binop",toString:s},OpIn:{_hx_name:"OpIn",_hx_index:23,__enum__:"haxe.macro.Binop",toString:s},OpNullCoal:{_hx_name:"OpNullCoal",_hx_index:24,__enum__:"haxe.macro.Binop",toString:s}},T.__constructs__=[T.OpAdd,T.OpMult,T.OpDiv,T.OpSub,T.OpAssign,T.OpEq,T.OpNotEq,T.OpGt,T.OpGte,T.OpLt,T.OpLte,T.OpAnd,T.OpOr,T.OpXor,T.OpBoolAnd,T.OpBoolOr,T.OpShl,T.OpShr,T.OpUShr,T.OpMod,T.OpAssignOp,T.OpInterval,T.OpArrow,T.OpIn,T.OpNullCoal],T.__empty_constructs__=[T.OpAdd,T.OpMult,T.OpDiv,T.OpSub,T.OpAssign,T.OpEq,T.OpNotEq,T.OpGt,T.OpGte,T.OpLt,T.OpLte,T.OpAnd,T.OpOr,T.OpXor,T.OpBoolAnd,T.OpBoolOr,T.OpShl,T.OpShr,T.OpUShr,T.OpMod,T.OpInterval,T.OpArrow,T.OpIn,T.OpNullCoal],ln=_["haxe.macro.Unop"]={__ename__:!0,__constructs__:null,OpIncrement:{_hx_name:"OpIncrement",_hx_index:0,__enum__:"haxe.macro.Unop",toString:s},OpDecrement:{_hx_name:"OpDecrement",_hx_index:1,__enum__:"haxe.macro.Unop",toString:s},OpNot:{_hx_name:"OpNot",_hx_index:2,__enum__:"haxe.macro.Unop",toString:s},OpNeg:{_hx_name:"OpNeg",_hx_index:3,__enum__:"haxe.macro.Unop",toString:s},OpNegBits:{_hx_name:"OpNegBits",_hx_index:4,__enum__:"haxe.macro.Unop",toString:s},OpSpread:{_hx_name:"OpSpread",_hx_index:5,__enum__:"haxe.macro.Unop",toString:s}},ln.__constructs__=[ln.OpIncrement,ln.OpDecrement,ln.OpNot,ln.OpNeg,ln.OpNegBits,ln.OpSpread],ln.__empty_constructs__=[ln.OpIncrement,ln.OpDecrement,ln.OpNot,ln.OpNeg,ln.OpNegBits,ln.OpSpread],pa=function(e,n,s){t.call(this,e,s),this.pos=n},c["haxe.macro.Error"]=pa,pa.__name__="haxe.macro.Error",pa.__super__=t,pa.prototype=g(t.prototype,{__class__:pa}),Ho={},Ho.resolve=function(e,n){var o,s=e.elementsNamed(n).next();if(s==null){if(e.nodeType==k.Document)o="Document";else{if(e.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element but found "+(e.nodeType==null?"null":_e.toString(e.nodeType)));o=e.nodeName}throw t.thrown(o+" is missing element "+n)}if(s.nodeType!=k.Document&&s.nodeType!=k.Element)throw t.thrown("Invalid nodeType "+(s.nodeType==null?"null":_e.toString(s.nodeType)));return s},$e={},$e.resolve=function(e,n){if(e.nodeType==k.Document)throw t.thrown("Cannot access document attribute "+n);var s=e.get(n);if(s==null)throw e.nodeType!=k.Element?t.thrown("Bad node type, expected Element but found "+(e.nodeType==null?"null":_e.toString(e.nodeType))):t.thrown(e.nodeName+" is missing attribute "+n);return s},al={},al.resolve=function(e,t){return e.elementsNamed(t).hasNext()},ct=function(e,t,n){this.xml=t,this.message=e,this.position=n,this.lineNumber=1,this.positionAtLine=0;for(var s,i,o=0,a=n;o<a;)i=o++,s=t.charCodeAt(i),s==10?(this.lineNumber++,this.positionAtLine=0):s!=13&&this.positionAtLine++},c["haxe.xml.XmlParserException"]=ct,ct.__name__="haxe.xml.XmlParserException",ct.prototype={toString:function(){var e=H.getClass(this);return e.__name__+": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine},__class__:ct},zs=function(){},c["haxe.xml.Parser"]=zs,zs.__name__="haxe.xml.Parser",zs.parse=function(e,t){t==null&&(t=!1);var n=k.createDocument();return zs.doParse(e,t,0,n),n},zs.doParse=function(e,n,s,i){s==null&&(s=0);for(var a,d,f,j,y,_,w,x,C,E,A,S,M,F,T,z,p=null,c=1,h=1,g=null,r=0,m=0,b=0,l=new Yt,v=1,O=-1;s<e.length;){switch(a=e.charCodeAt(s),c){case 0:switch(a){case 9:case 10:case 13:case 32:break;default:c=h;continue}break;case 1:if(a==60)c=0,h=2;else{r=s,c=13;continue}break;case 2:switch(a){case 33:if(e.charCodeAt(s+1)==91){if(s+=2,u.substr(e,s,6).toUpperCase()!="CDATA[")throw t.thrown(new ct("Expected <![CDATA[",e,s));s+=5,c=17,r=s+1}else if(e.charCodeAt(s+1)==68||e.charCodeAt(s+1)==100){if(u.substr(e,s+2,6).toUpperCase()!="OCTYPE")throw t.thrown(new ct("Expected <!DOCTYPE",e,s));s+=8,c=16,r=s+1}else if(e.charCodeAt(s+1)!=45||e.charCodeAt(s+2)!=45)throw t.thrown(new ct("Expected <!--",e,s));else s+=2,c=15,r=s+1;break;case 47:if(i==null)throw t.thrown(new ct("Expected node name",e,s));r=s+1,c=0,h=10;break;case 63:c=14,r=s;break;default:c=3,r=s;continue}break;case 3:if(!(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a==58||a==46||a==95||a==45)){if(s==r)throw t.thrown(new ct("Expected node name",e,s));p=k.createElement(u.substr(e,r,s-r)),i.addChild(p),++m,c=0,h=4;continue}break;case 4:switch(a){case 47:c=11;break;case 62:c=9;break;default:c=5,r=s;continue}break;case 5:if(!(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a==58||a==46||a==95||a==45)){if(r==s)throw t.thrown(new ct("Expected attribute name",e,s));if(A=u.substr(e,r,s-r),g=A,p.exists(g))throw t.thrown(new ct("Duplicate attribute ["+g+"]",e,s));c=0,h=6;continue}break;case 6:if(a==61)c=0,h=7;else throw t.thrown(new ct("Expected =",e,s));break;case 7:switch(a){case 34:case 39:l=new Yt,c=8,r=s+1,O=a;break;default:throw t.thrown(new ct('Expected "',e,s))}break;case 8:switch(a){case 38:f=s-r,l.b+=f==null?u.substr(e,r,null):u.substr(e,r,f),c=18,v=8,r=s+1;break;case 60:case 62:if(n)throw t.thrown(new ct("Invalid unescaped "+String.fromCodePoint(a)+" in attribute value",e,s));a==O&&(y=s-r,l.b+=y==null?u.substr(e,r,null):u.substr(e,r,y),z=l.b,l=new Yt,p.set(g,z),c=0,h=4);break;default:a==O&&(w=s-r,l.b+=w==null?u.substr(e,r,null):u.substr(e,r,w),F=l.b,l=new Yt,p.set(g,F),c=0,h=4)}break;case 9:s=zs.doParse(e,n,s,p),r=s,c=1;break;case 10:if(!(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a==58||a==46||a==95||a==45)){if(r==s)throw t.thrown(new ct("Expected node name",e,s));if(x=u.substr(e,r,s-r),i==null||i.nodeType!=0)throw t.thrown(new ct("Unexpected </"+x+">, tag is not open",e,s));if(i.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element but found "+(i.nodeType==null?"null":_e.toString(i.nodeType)));if(x!=i.nodeName)throw i.nodeType!=k.Element?t.thrown("Bad node type, expected Element but found "+(i.nodeType==null?"null":_e.toString(i.nodeType))):t.thrown(new ct("Expected </"+i.nodeName+">",e,s));c=0,h=12;continue}break;case 11:if(a==62)c=1;else throw t.thrown(new ct("Expected >",e,s));break;case 12:if(a==62)return m==0&&i.addChild(k.createPCData("")),s;throw t.thrown(new ct("Expected >",e,s));break;case 13:a==60?(j=s-r,l.b+=j==null?u.substr(e,r,null):u.substr(e,r,j),E=k.createPCData(l.b),l=new Yt,i.addChild(E),++m,c=0,h=2):a==38&&(C=s-r,l.b+=C==null?u.substr(e,r,null):u.substr(e,r,C),c=18,v=13,r=s+1);break;case 14:a==63&&e.charCodeAt(s+1)==62&&(++s,S=u.substr(e,r+1,s-r-2),i.addChild(k.createProcessingInstruction(S)),++m,c=1);break;case 15:a==45&&e.charCodeAt(s+1)==45&&e.charCodeAt(s+2)==62&&(i.addChild(k.createComment(u.substr(e,r,s-r))),++m,s+=2,c=1);break;case 16:a==91?++b:a==93?--b:a==62&&b==0&&(i.addChild(k.createDocType(u.substr(e,r,s-r))),++m,c=1);break;case 17:a==93&&e.charCodeAt(s+1)==93&&e.charCodeAt(s+2)==62&&(M=k.createCData(u.substr(e,r,s-r)),i.addChild(M),++m,s+=2,c=1);break;case 18:if(a==59){if(d=u.substr(e,r,s-r),d.charCodeAt(0)==35)T=d.charCodeAt(1)==120?o.parseInt("0"+u.substr(d,1,d.length-1)):o.parseInt(u.substr(d,1,d.length-1)),l.b+=String.fromCodePoint(T);else if(Object.prototype.hasOwnProperty.call(zs.escapes.h,d))l.b+=o.string(zs.escapes.h[d]);else{if(n)throw t.thrown(new ct("Undefined entity: "+d,e,s));l.b+=o.string("&"+d+";")}r=s+1,c=v}else if(!(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a==58||a==46||a==95||a==45)&&a!=35){if(n)throw t.thrown(new ct("Invalid character in entity: "+String.fromCodePoint(a),e,s));l.b+=String.fromCodePoint(38),_=s-r,l.b+=_==null?u.substr(e,r,null):u.substr(e,r,_),--s,r=s+1,c=v}break}++s}if(c==1&&(r=s,c=13),c==13){if(i.nodeType==0)throw i.nodeType!=k.Element?t.thrown("Bad node type, expected Element but found "+(i.nodeType==null?"null":_e.toString(i.nodeType))):t.thrown(new ct("Unclosed node <"+i.nodeName+">",e,s));return(s!=r||m==0)&&(f=s-r,l.b+=f==null?u.substr(e,r,null):u.substr(e,r,f),i.addChild(k.createPCData(l.b)),++m),s}if(!n&&c==18&&v==13)return l.b+=String.fromCodePoint(38),f=s-r,l.b+=f==null?u.substr(e,r,null):u.substr(e,r,f),i.addChild(k.createPCData(l.b)),++m,s;throw t.thrown(new ct("Unexpected end",e,s))},da=function(e){this.output=new Yt,this.pretty=e},c["haxe.xml.Printer"]=da,da.__name__="haxe.xml.Printer",da.print=function(e,t){t==null&&(t=!1);var n=new da(t);return n.writeNode(e,""),n.output.b},da.prototype={writeNode:function(e,n){switch(e.nodeType){case 0:if(this.output.b+=o.string(n+"<"),e.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element but found "+(e.nodeType==null?"null":_e.toString(e.nodeType)));this.output.b+=o.string(e.nodeName);for(var s,i,a,r,c,l,d,h,u=e.attributes();u.hasNext();)l=u.next(),this.output.b+=o.string(" "+l+'="'),s=M.htmlEscape(e.get(l),!0),this.output.b+=o.string(s),this.output.b+='"';if(this.hasChildren(e)){if(this.output.b+=">",this.pretty&&(this.output.b+=`
`),e.nodeType!=k.Document&&e.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element or Document but found "+(e.nodeType==null?"null":_e.toString(e.nodeType)));for(i=0,a=e.children;i<a.length;)c=a[i++],this.writeNode(c,this.pretty?n+"	":n);if(this.output.b+=o.string(n+"</"),e.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element but found "+(e.nodeType==null?"null":_e.toString(e.nodeType)));this.output.b+=o.string(e.nodeName),this.output.b+=">",this.pretty&&(this.output.b+=`
`)}else this.output.b+="/>",this.pretty&&(this.output.b+=`
`);break;case 1:if(e.nodeType==k.Document||e.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(e.nodeType==null?"null":_e.toString(e.nodeType)));d=e.nodeValue,d.length!=0&&(s=n+M.htmlEscape(d),this.output.b+=o.string(s),this.pretty&&(this.output.b+=`
`));break;case 2:if(this.output.b+=o.string(n+"<![CDATA["),e.nodeType==k.Document||e.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(e.nodeType==null?"null":_e.toString(e.nodeType)));this.output.b+=o.string(e.nodeValue),this.output.b+="]]>",this.pretty&&(this.output.b+=`
`);break;case 3:if(e.nodeType==k.Document||e.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(e.nodeType==null?"null":_e.toString(e.nodeType)));r=e.nodeValue,h=new RegExp(`[
\r	]+`,"g".split("u").join("")),r=r.replace(h,""),r="<!--"+r+"-->",this.output.b+=n==null?"null":""+n,s=M.trim(r),this.output.b+=o.string(s),this.pretty&&(this.output.b+=`
`);break;case 4:if(e.nodeType==k.Document||e.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(e.nodeType==null?"null":_e.toString(e.nodeType)));this.output.b+=o.string("<!DOCTYPE "+e.nodeValue+">"),this.pretty&&(this.output.b+=`
`);break;case 5:if(e.nodeType==k.Document||e.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(e.nodeType==null?"null":_e.toString(e.nodeType)));this.output.b+=o.string("<?"+e.nodeValue+"?>"),this.pretty&&(this.output.b+=`
`);break;case 6:if(e.nodeType!=k.Document&&e.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element or Document but found "+(e.nodeType==null?"null":_e.toString(e.nodeType)));for(i=0,a=e.children;i<a.length;)c=a[i++],this.writeNode(c,n);break}},hasChildren:function(e){if(e.nodeType!=k.Document&&e.nodeType!=k.Element)throw t.thrown("Bad node type, expected Element or Document but found "+(e.nodeType==null?"null":_e.toString(e.nodeType)));for(var n,s=0,o=e.children;s<o.length;)switch(n=o[s++],n.nodeType){case 0:case 1:return!0;case 2:case 3:if(n.nodeType==k.Document||n.nodeType==k.Element)throw t.thrown("Bad node type, unexpected "+(n.nodeType==null?"null":_e.toString(n.nodeType)));if(M.ltrim(n.nodeValue).length!=0)return!0;break;default:}return!1},__class__:da},Cr=function(){},c["haxe.zip.Compress"]=Cr,Cr.__name__="haxe.zip.Compress",Cr.run=function(){throw new Vo("Not implemented for this platform",null,{fileName:"haxe/zip/Compress.hx",lineNumber:39,className:"haxe.zip.Compress",methodName:"run"})},Fn=_["haxe.zip.Huffman"]={__ename__:!0,__constructs__:null,Found:(a=function(e){return{_hx_index:0,i:e,__enum__:"haxe.zip.Huffman",toString:s}},a._hx_name="Found",a.__params__=["i"],a),NeedBit:(a=function(e,t){return{_hx_index:1,left:e,right:t,__enum__:"haxe.zip.Huffman",toString:s}},a._hx_name="NeedBit",a.__params__=["left","right"],a),NeedBits:(a=function(e,t){return{_hx_index:2,n:e,table:t,__enum__:"haxe.zip.Huffman",toString:s}},a._hx_name="NeedBits",a.__params__=["n","table"],a)},Fn.__constructs__=[Fn.Found,Fn.NeedBit,Fn.NeedBits],Fn.__empty_constructs__=[],Mr=function(){},c["haxe.zip.HuffTools"]=Mr,Mr.__name__="haxe.zip.HuffTools",Mr.prototype={treeDepth:function(e){switch(e._hx_index){case 0:var n,s,i,a,o=e.i;return 0;case 1:return i=e.left,a=e.right,n=this.treeDepth(i),s=this.treeDepth(a),1+(n<s?n:s);case 2:throw o=e.n,o=e.table,t.thrown("assert")}},treeCompress:function(e){var s,o,i,a,r,c,l,n=this.treeDepth(e);if(n==0)return e;if(n==1){if(e._hx_index==1)return i=e.left,a=e.right,Fn.NeedBit(this.treeCompress(i),this.treeCompress(a));throw t.thrown("assert")}for(r=1<<n,s=[],o=0,c=r;o<c;)l=o++,s.push(Fn.Found(-1));return this.treeWalk(s,0,0,n,e),Fn.NeedBits(n,s)},treeWalk:function(e,t,n,s,o){if(o._hx_index==1){var i=o.left,a=o.right;s>0?(this.treeWalk(e,t,n+1,s-1,i),this.treeWalk(e,t|1<<n,n+1,s-1,a)):e[t]=this.treeCompress(o)}else e[t]=this.treeCompress(o)},treeMake:function(e,n,s,o){if(o>n)throw t.thrown("Invalid huffman");var i=s<<5|o;return e.h.hasOwnProperty(i)?Fn.Found(e.h[i]):(s<<=1,++o,Fn.NeedBit(this.treeMake(e,n,s,o),this.treeMake(e,n,s|1,o)))},make:function(e,n,s,o){if(s==1)return Fn.NeedBit(Fn.Found(0),Fn.Found(0));var i,a,r,c,d,u,m,f,h=[],l=[];if(o>32)throw t.thrown("Invalid huffman");for(i=0,r=o;i<r;)a=i++,h.push(0),l.push(0);for(i=0,r=s;i<r;){if(a=i++,m=e[a+n],m>=o)throw t.thrown("Invalid huffman");h[m]++}for(d=0,i=1,r=o-1;i<r;)a=i++,d=d+h[a]<<1,l[a]=d;for(u=new le,i=0,r=s;i<r;)a=i++,c=e[a+n],c!=0&&(f=l[c-1],l[c-1]=f+1,u.h[f<<5|c]=a);return this.treeCompress(Fn.NeedBit(this.treeMake(u,o,0,1),this.treeMake(u,o,1,1)))},__class__:Mr},ec=function(e){this.buffer=new A(new ArrayBuffer(65536)),this.pos=0,e&&(this.crc=new si)},c["haxe.zip._InflateImpl.Window"]=ec,ec.__name__="haxe.zip._InflateImpl.Window",ec.prototype={slide:function(){this.crc!=null&&this.crc.update(this.buffer,0,32768);var e=new A(new ArrayBuffer(65536));this.pos-=32768,e.blit(0,this.buffer,32768,this.pos),this.buffer=e},addBytes:function(e,t,n){this.pos+n>65536&&this.slide(),this.buffer.blit(this.pos,e,t,n),this.pos+=n},addByte:function(e){this.pos==65536&&this.slide(),this.buffer.b[this.pos]=e,this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){return this.crc!=null&&this.crc.update(this.buffer,0,this.pos),this.crc},__class__:ec},xe=_["haxe.zip._InflateImpl.State"]={__ename__:!0,__constructs__:null,Head:{_hx_name:"Head",_hx_index:0,__enum__:"haxe.zip._InflateImpl.State",toString:s},Block:{_hx_name:"Block",_hx_index:1,__enum__:"haxe.zip._InflateImpl.State",toString:s},CData:{_hx_name:"CData",_hx_index:2,__enum__:"haxe.zip._InflateImpl.State",toString:s},Flat:{_hx_name:"Flat",_hx_index:3,__enum__:"haxe.zip._InflateImpl.State",toString:s},Crc:{_hx_name:"Crc",_hx_index:4,__enum__:"haxe.zip._InflateImpl.State",toString:s},Dist:{_hx_name:"Dist",_hx_index:5,__enum__:"haxe.zip._InflateImpl.State",toString:s},DistOne:{_hx_name:"DistOne",_hx_index:6,__enum__:"haxe.zip._InflateImpl.State",toString:s},Done:{_hx_name:"Done",_hx_index:7,__enum__:"haxe.zip._InflateImpl.State",toString:s}},xe.__constructs__=[xe.Head,xe.Block,xe.CData,xe.Flat,xe.Crc,xe.Dist,xe.DistOne,xe.Done],xe.__empty_constructs__=[xe.Head,xe.Block,xe.CData,xe.Flat,xe.Crc,xe.Dist,xe.DistOne,xe.Done],ut=function(e,t,n){n==null&&(n=!0),t==null&&(t=!0),this.isFinal=!1,this.htools=new Mr,this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.len=0,this.dist=0,this.state=t?xe.Head:xe.Block,this.input=e,this.bits=0,this.nbits=0,this.needed=0,this.output=null,this.outpos=0,this.lengths=[],this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.lengths.push(-1),this.window=new ec(n)},c["haxe.zip.InflateImpl"]=ut,ut.__name__="haxe.zip.InflateImpl",ut.run=function(e,t){t==null&&(t=65536);for(var n,s=new A(new ArrayBuffer(t)),o=new Kn,i=new ut(e);!0;)if(n=i.readBytes(s,0,t),o.addBytes(s,0,n),n<t)break;return o.getBytes()},ut.prototype={buildFixedHuffman:function(){if(ut.FIXED_HUFFMAN!=null)return ut.FIXED_HUFFMAN;for(var e,t=[],n=0;n<288;)e=n++,t.push(e<=143?8:e<=255?9:e<=279?7:8);return ut.FIXED_HUFFMAN=this.htools.make(t,0,288,10),ut.FIXED_HUFFMAN},readBytes:function(e,t,n){if(this.needed=n,this.outpos=t,this.output=e,n>0)for(;this.inflateLoop(););return n-this.needed},getBits:function(e){for(;this.nbits<e;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var t=this.bits&(1<<e)-1;return this.nbits-=e,this.bits>>=e,t},getBit:function(){this.nbits==0&&(this.nbits=8,this.bits=this.input.readByte());var e=(this.bits&1)==1;return this.nbits--,this.bits>>=1,e},getRevBits:function(e){return e==0?0:this.getBit()?1<<e-1|this.getRevBits(e-1):this.getRevBits(e-1)},resetBits:function(){this.bits=0,this.nbits=0},addBytes:function(e,t,n){this.window.addBytes(e,t,n),this.output.blit(this.outpos,e,t,n),this.needed-=n,this.outpos+=n},addByte:function(e){this.window.addByte(e),this.output.b[this.outpos]=e,this.needed--,this.outpos++},addDistOne:function(e){for(var o,n=this.window.getLastChar(),t=0,s=e;t<s;)o=t++,this.addByte(n)},addDist:function(e,t){this.addBytes(this.window.buffer,this.window.pos-e,t)},applyHuffman:function(e){switch(e._hx_index){case 0:var n,s,o,t=e.i;return t;case 1:return n=e.left,s=e.right,this.applyHuffman(this.getBit()?s:n);case 2:return t=e.n,o=e.table,this.applyHuffman(o[this.getBits(t)])}},inflateLengths:function(e,n){for(var o,i,s=0,a=0;s<n;)switch(o=this.applyHuffman(this.huffman),o){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:a=o,e[s]=o,++s;break;case 16:if(i=s+3+this.getBits(2),i>n)throw t.thrown("Invalid data");for(;s<i;)e[s]=a,++s;break;case 17:if(s+=3+this.getBits(3),s>n)throw t.thrown("Invalid data");break;case 18:if(s+=11+this.getBits(7),s>n)throw t.thrown("Invalid data");break;default:throw t.thrown("Invalid data")}},inflateLoop:function(){switch(this.state._hx_index){case 0:var e,n,s,o,i,a,r,c,l,u,h,m,f,p,g,b,j,y,_,d=this.input.readByte(),v=d&15,w=d>>4;if(v!=8)throw t.thrown("Invalid data");if(u=this.input.readByte(),_=(u&32)!=0,((d<<8)+u)%31!=0)throw t.thrown("Invalid data");if(_)throw t.thrown("Unsupported dictionary");return this.state=xe.Block,!0;case 1:switch(this.isFinal=this.getBit(),this.getBits(2)){case 0:if(this.len=this.input.readUInt16(),j=this.input.readUInt16(),j!=65535-this.len)throw t.thrown("Invalid data");return this.state=xe.Flat,g=this.inflateLoop(),this.resetBits(),g;case 1:return this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.state=xe.CData,!0;case 2:for(c=this.getBits(5)+257,l=this.getBits(5)+1,m=this.getBits(4)+4,n=0,i=m;n<i;)r=n++,this.lengths[ut.CODE_LENGTHS_POS[r]]=this.getBits(3);for(n=m,i=19;n<i;)r=n++,this.lengths[ut.CODE_LENGTHS_POS[r]]=0;for(this.huffman=this.htools.make(this.lengths,0,19,8),a=[],n=0,i=c+l;n<i;)r=n++,a.push(0);return this.inflateLengths(a,c+l),this.huffdist=this.htools.make(a,c,l,16),this.huffman=this.htools.make(a,0,c,16),this.state=xe.CData,!0;default:throw t.thrown("Invalid data")}break;case 2:if(s=this.applyHuffman(this.huffman),s<256)return this.addByte(s),this.needed>0;if(s==256)return this.state=this.isFinal?xe.Crc:xe.Block,!0;if(s-=257,o=ut.LEN_EXTRA_BITS_TBL[s],o==-1)throw t.thrown("Invalid data");if(this.len=ut.LEN_BASE_VAL_TBL[s]+this.getBits(o),p=this.huffdist==null?this.getRevBits(5):this.applyHuffman(this.huffdist),o=ut.DIST_EXTRA_BITS_TBL[p],o==-1)throw t.thrown("Invalid data");if(this.dist=ut.DIST_BASE_VAL_TBL[p]+this.getBits(o),this.dist>this.window.available())throw t.thrown("Invalid data");return this.state=this.dist==1?xe.DistOne:xe.Dist,!0;break;case 3:return e=this.len<this.needed?this.len:this.needed,b=this.input.read(e),this.len-=e,this.addBytes(b,0,e),this.len==0&&(this.state=this.isFinal?xe.Crc:xe.Block),this.needed>0;case 4:if(f=this.window.checksum(),f==null)return this.state=xe.Done,!0;if(y=si.read(this.input),!f.equals(y))throw t.thrown("Invalid CRC");return this.state=xe.Done,!0;case 5:for(;this.len>0&&this.needed>0;)h=this.len<this.dist?this.len:this.dist,e=this.needed<h?this.needed:h,this.addDist(this.dist,e),this.len-=e;return this.len==0&&(this.state=xe.CData),this.needed>0;case 6:return e=this.len<this.needed?this.len:this.needed,this.addDistOne(e),this.len-=e,this.len==0&&(this.state=xe.CData),this.needed>0;case 7:return!1}},__class__:ut},dc=function(){},c["haxe.zip.Uncompress"]=dc,dc.__name__="haxe.zip.Uncompress",dc.run=function(e,t){return ut.run(new Nt(e),t)},ns=function(e,t){if(e!=-101||t!=-102){var n=window.document.createElement("canvas");n.width=e,n.height=t,this.ctx=n.getContext("2d",null)}},c["hxd.BitmapData"]=ns,ns.__name__="hxd.BitmapData",ns.notImplemented=function(){throw t.thrown("Not implemented")},ns.fromNative=function(e){var t=new ns(-101,-102);return t.ctx=e,t},ns.prototype={clear:function(e){this.fill(0,0,this.ctx.canvas.width,this.ctx.canvas.height,e)},fill:function(e,t,n,s,o){this.ctx.fillStyle="rgba("+(o>>16&255)+", "+(o>>8&255)+", "+(o&255)+", "+(o>>>24)/255+")",this.ctx.fillRect(e,t,n,s)},draw:function(e,t,n,s,o,i,a,r){this.drawScaled(e,t,i,a,n,s,o,i,a,r)},drawScaled:function(e,n,s,o,i,a,r,c,l,d,u){throw u==null&&(u=!0),d==null&&(d=X.Alpha),t.thrown("Not implemented")},line:function(e,t,n,s,o){var i,a,r,c,l,d,m,f,p,g,v,b,j,y,_,w,O,x,C,E,u=n-e,h=s-t;if(u==0)for(s<t&&(C=t,t=s,s=C),t<0&&(t=0),s>this.ctx.canvas.height-1&&(s=this.ctx.canvas.height-1),w=t,E=s+1;w<E;)a=w++,this.setPixel(e,a,o);else if(h==0)for(n<e&&(C=e,e=n,n=C),e<0&&(e=0),n>this.ctx.canvas.width-1&&(n=this.ctx.canvas.width-1),w=e,E=n+1;w<E;)r=w++,this.setPixel(r,t,o);else{if(e<n){if(e>=this.ctx.canvas.width||n<0)return;x=1,p=0,v=this.ctx.canvas.width-1}else{if(n>=this.ctx.canvas.width||e<0)return;x=-1,n=-n,e=-e,p=1-this.ctx.canvas.width,v=0}if(t<s){if(t>=this.ctx.canvas.height||s<0)return;O=1,g=0,b=this.ctx.canvas.height-1}else{if(s>=this.ctx.canvas.height||t<0)return;O=-1,s=-s,t=-t,g=1-this.ctx.canvas.height,b=0}if(u=n-e,h=s-t,l=u<<1,c=h<<1,r=e,a=t,u>=h){if(d=c-u,_=!1,t<g){if(i=l,i=i*(g-t)-u,j=i/c,r+=j|0,r>v)return;r>=p&&(i-=j*c,d-=(i|0)+u,a=g,i>0&&(++r,d+=c),_=!0)}if(!_&&e<p){if(i=c,i*=p-e,y=i/l,a+=y|0,i%=l,a>b||a==b&&i>u)return;r=p,d+=i|0,i>=u&&(++a,d-=l)}for(f=n,s>b&&(i=l,i=i*(b-s)+u,j=i/c,f+=j|0,i-j*c==0&&--f),f>v?f=v+1:++f,x==-1&&(r=-r,f=-f),O==-1&&(a=-a),l-=c;r!=f;)this.setPixel(r,a,o),d>=0?(a+=O,d-=l):d+=c,r+=x}else{if(d=l-h,_=!1,e<p){if(i=c,i=i*(p-e)-h,y=i/l,a+=y|0,a>b)return;a>=g&&(i-=y*l,d-=(i|0)+h,r=p,i>0&&(++a,d+=l),_=!0)}if(!_&&t<g){if(i=l,i*=g-t,j=i/c,r+=j|0,i%=c,r>v||r==v&&i>h)return;a=g,d+=i|0,i>=h&&(++r,d-=c)}for(m=s,n>v&&(i=c,i=i*(v-n)+h,y=i/l,m+=y|0,i-y*l==0&&--m),m>b?m=b+1:++m,x==-1&&(r=-r),O==-1&&(a=-a,m=-m),c-=l;a!=m;)this.setPixel(r,a,o),d>=0?(r+=x,d-=c):d+=l,a+=O}}},dispose:function(){this.ctx=null,this.pixel=null},clone:function(){return this.sub(0,0,this.ctx.canvas.width,this.ctx.canvas.height)},sub:function(e,t,n,s){var i,o=window.document.createElement("canvas");return o.width=n,o.height=s,i=o.getContext("2d",null),i.drawImage(this.ctx.canvas,e,t,n,s,0,0,n,s),ns.fromNative(i)},lock:function(){this.lockImage==null&&(this.lockImage=this.ctx.getImageData(0,0,this.ctx.canvas.width,this.ctx.canvas.height))},unlock:function(){this.lockImage!=null&&(this.ctx.putImageData(this.lockImage,0,0),this.lockImage=null)},getPixel:function(e,t){var s,n=this.lockImage;return n!=null?s=e+t*n.width<<2:(s=0,n=this.ctx.getImageData(e,t,1,1)),n.data[s]<<16|n.data[s|1]<<8|n.data[s|2]|n.data[s|3]<<24},setPixel:function(e,t,n){var o,s=this.lockImage;if(s!=null){o=e+t*s.width<<2,s.data[o]=n>>16&255,s.data[o|1]=n>>8&255,s.data[o|2]=n&255,s.data[o|3]=n>>>24&255;return}s=this.pixel,s==null&&(s=this.ctx.createImageData(1,1),this.pixel=s),s.data[0]=n>>16&255,s.data[1]=n>>8&255,s.data[2]=n&255,s.data[3]=n>>>24&255,this.ctx.putImageData(s,e,t)},get_width:function(){return this.ctx.canvas.width},get_height:function(){return this.ctx.canvas.height},getPixels:function(){var e=this.ctx.canvas.width,t=this.ctx.canvas.height,n=this.ctx.getImageData(0,0,e,t).data,s=n.buffer;return new G(e,t,A.ofData(s),f.RGBA)},setPixels:function(e){if(e.width!=this.ctx.canvas.width||e.height!=this.ctx.canvas.height)throw t.thrown("Invalid pixels size");var n,s,i,o=this.ctx.createImageData(e.width,e.height);for(e.convert(f.RGBA),n=0,i=e.width*e.height*4;n<i;)s=n++,o.data[s]=e.bytes.b[s];this.ctx.putImageData(o,0,0)},toNative:function(){return this.ctx},toPNG:function(){var e=this.getPixels(),t=e.toPNG();return e.dispose(),t},__class__:ns},Mt={},Mt._new=function(e){return e},Mt.getSize=function(e){return Mt.SIZES[e]},Mt.toInt=function(e){return e},Mt.fromInt=function(e){return e},Mt.toString=function(e){switch(e){case 0:return"F32";case 1:return"F16";case 2:return"U8";case 3:return"S8"}},Pt={},Pt._new=function(e){return e},Pt.getSize=function(e){return e==H.__cast(9,St)?1:e},Pt.toInt=function(e){return e},Pt.toString=function(e){switch(e){case 1:return"DFloat";case 2:return"DVec2";case 3:return"DVec3";case 4:return"DVec4";case 9:return"DBytes4";case 16:return"DMat4"}},Pt.fromInt=function(e){return e},Pt.fromHXSL=function(e){switch(e._hx_index){case 3:return 1;case 5:var n=e.t;switch(e.size){case 2:if(n._hx_index==1)return 2;throw t.thrown("Unsupported buffer type "+o.string(e));break;case 3:if(n._hx_index==1)return 3;throw t.thrown("Unsupported buffer type "+o.string(e));break;case 4:if(n._hx_index==1)return 4;throw t.thrown("Unsupported buffer type "+o.string(e));break;default:throw t.thrown("Unsupported buffer type "+o.string(e))}break;case 7:return 16;case 9:if(e.size==4)return 9;throw t.thrown("Unsupported buffer type "+o.string(e));break;default:throw t.thrown("Unsupported buffer type "+o.string(e))}},ce=function(e,t,n){n==null&&(n=0),this.name=e,this.type=t,this.precision=n},c["hxd.BufferInput"]=ce,ce.__name__="hxd.BufferInput",ce.prototype={getBytesSize:function(){var e=this.type;return(e==H.__cast(9,St)?1:e)*Mt.SIZES[this.precision]},equals:function(e){return this.type==e.type&&this.name==e.name&&this.precision==e.precision},__class__:ce},ja={},ja._new=function(e,t,n){return e<<3|n|t<<16},ja.get_bufferIndex=function(e){return e>>3&255},ja.get_precision=function(e){return e&7},ja.get_offset=function(e){return e>>16},y=function(e){this.uid=y._UID++,this.stride=this.strideBytes=0,this.inputs=e.slice(),this.hasLowPrecision=!1;for(var t,s,o,n=0;n<e.length;)t=e[n],++n,s=t.type,this.stride+=s==H.__cast(9,St)?1:s,o=t.type,this.strideBytes+=(o==H.__cast(9,St)?1:o)*Mt.SIZES[t.precision],(this.strideBytes&3)!=0&&(this.strideBytes+=4-(this.strideBytes&3)),t.precision!=0&&(this.hasLowPrecision=!0)},c["hxd.BufferFormat"]=y,y.__name__="hxd.BufferFormat",y.get_COMPRESSED_CONFIG=function(){return y.COMPRESSED_CONFIG==null&&(y.COMPRESSED_CONFIG=y.make([new ce("data",4,1),new ce("color",4,1),new ce("position",2,1),new ce("normal",3,3),new ce("uv",2,1),new ce("position",3,1)]),y.COMPRESSED_CONFIG.compressed=y.COMPRESSED_CONFIG),y.COMPRESSED_CONFIG},y.get_H2D=function(){return y.get_XY_UV_RGBA()},y.get_XY_UV_RGBA=function(){return y.XY_UV_RGBA==null&&(y.XY_UV_RGBA=y.make([new ce("position",2,0),new ce("uv",2,0),new ce("color",4,0)])),y.XY_UV_RGBA},y.get_XY_UV=function(){return y.XY_UV==null&&(y.XY_UV=y.make([new ce("position",2,0),new ce("uv",2,0)])),y.XY_UV},y.get_POS3D=function(){return y.POS3D==null&&(y.POS3D=y.make([new ce("position",3,0)])),y.POS3D},y.get_POS3D_NORMAL=function(){return y.POS3D_NORMAL==null&&(y.POS3D_NORMAL=y.make([new ce("position",3,0),new ce("normal",3,0)])),y.POS3D_NORMAL},y.get_POS3D_NORMAL_UV=function(){return y.POS3D_NORMAL_UV==null&&(y.POS3D_NORMAL_UV=y.make([new ce("position",3,0),new ce("normal",3,0),new ce("uv",2,0)])),y.POS3D_NORMAL_UV},y.get_POS3D_NORMAL_UV_RGBA=function(){return y.POS3D_NORMAL_UV_RGBA==null&&(y.POS3D_NORMAL_UV_RGBA=y.get_POS3D_NORMAL_UV().append("color",4)),y.POS3D_NORMAL_UV_RGBA},y.get_POS3D_UV=function(){return y.POS3D_UV==null&&(y.POS3D_UV=y.make([new ce("position",3,0),new ce("uv",2,0)])),y.POS3D_UV},y.get_VEC4_DATA=function(){return y.VEC4_DATA==null&&(y.VEC4_DATA=y.make([new ce("data",4,0)])),y.VEC4_DATA},y.get_MAT4_DATA=function(){return y.MAT4_DATA==null&&(y.MAT4_DATA=y.make([new ce("data",16,0)])),y.MAT4_DATA},y.get_INDEX16=function(){return y.INDEX16==null&&(y.INDEX16=y.make([new ce("index",1,1)]),y.INDEX16.strideBytes=2),y.INDEX16},y.get_INDEX32=function(){return y.INDEX32==null&&(y.INDEX32=y.make([new ce("index",1,0)])),y.INDEX32},y.fromID=function(e){for(var t,n,s,o=y.ALL_FORMATS.h,r=o,i=Object.keys(o),c=i.length,a=0;a<c;)for(n=r[i[a++]],t=0;t<n.length;)if(s=n[t],++t,s.uid==e)return s;return null},y.make=function(e){for(var n,s,o,i,a,r,c,l,u,d=[],t=0;t<e.length;)s=e[t],++t,d.push(s.name);for(a=d.join("|"),n=y.ALL_FORMATS.h[a],n==null&&(n=[],y.ALL_FORMATS.h[a]=n),t=0;t<n.length;){for(o=n[t],++t,r=!0,c=0,u=e.length;c<u;)if(l=c++,i=e[l],s=o.inputs[l],!(i.type==s.type&&i.name==s.name&&i.precision==s.precision)){r=!1;break}if(r)return o}return o=new y(e),n.push(o),o},y.float32to16=function(e,t){t==null&&(t=!1);var s=yt.floatToI32(e),o=(s&-2147483648)>>>16,n=(s&2139095040)>>>23,i=s&8388607;return n>112?o|n-112<<10&31744|i>>13:n<113&&n>101&&!t?o|(8384512+i>>125-n)+1>>1:n>143?o|32767:0},y.float16to32=function(e){var n,s=(e&32768)<<16,t=(e&1023)<<13,o=(e&31744)>>10;return o!=0?yt.i32ToFloat(s|o+112<<23|t):t==0?0:(n=yt.floatToI32(t)>>23,yt.i32ToFloat(s|n-37<<23|t<<150-n&8380416))},y.float32toS8=function(e){var t=Math.floor(e*128);return t>=127?127:t<=-127?128:t>=0?t:127+t|128},y.floatS8to32=function(e){return(e&128)!=0?-1*(127-(e&127))/128:(e&127)/128},y.float32toU8=function(e){return e<0?0:e>=1?255:Math.floor(e*256)},y.floatU8to32=function(e){return(e&255)/255},y.prototype={getInput:function(e){for(var n,t=0,s=this.inputs;t<s.length;)if(n=s[t],++t,n.name==e)return n;return null},getCompressed:function(){if(this.compressed!=null)return this.compressed;var e,t,n,s,o,i,a,r,d,u,h,m,f,p,g,v,b,j,_,w,O,x,C,E,c=[],l=[];for(c.length=this.inputs.length,l.length=this.inputs.length,e=0,m=0,j=this.inputs;m<j.length;){for(E=j[m],_=m++,a=_,i=E,p=!1,h=0,g=y.get_COMPRESSED_CONFIG().inputs;h<g.length;)if(C=g[h],O=h++,w=O,s=C,i.type==s.type&&q.compare(i.name,s.name)==0){r=s.type,e+=(r==H.__cast(9,St)?1:r)*Mt.SIZES[s.precision],(e&3)!=0&&(e+=4-(e&3)),c[a]=new ce(s.name,s.type,s.precision),l[a]={compressedIndex:w,index:a},p=!0;break}p||(d=i.type,e+=(d==H.__cast(9,St)?1:d)*Mt.SIZES[i.precision],(e&3)!=0&&(e+=4-(e&3)),c[a]=new ce(i.name,i.type,i.precision),l[a]={compressedIndex:-1,index:a})}if(o=e,(o&7)!=0&&(o+=8-(o&7)),o!=e)for(l.sort(function(e,t){return t.compressedIndex-e.compressedIndex}),f=0;f<l.length;){for(b=l[f],++f,t=c[b.index],r=t.type,u=(r==H.__cast(9,St)?1:r)*Mt.SIZES[t.precision],(u&3)!=0&&(u+=4-(u&3)),x=e-u,v=e,n=e;n<o&&t.precision>0;)v=n,t.precision=t.precision-1,d=t.type,n=x+(d==H.__cast(9,St)?1:d)*Mt.SIZES[t.precision],(n&3)!=0&&(n+=4-(n&3));if(n>o&&(t.precision=t.precision+1,n=v),c[b.index]=t,e=n,e==o)break}return this.compressed=y.make(c),this.compressed.compressed=this.compressed,this.compressed},calculateInputOffset:function(e){for(var s,i,n=0,o=0,a=this.inputs;o<a.length;){if(s=a[o],++o,s.name==e)return n;i=s.type,n+=(i==H.__cast(9,St)?1:i)*Mt.SIZES[s.precision],(n&3)!=0&&(n+=4-(n&3))}throw t.thrown("Input not found : "+e)},hasInput:function(e,t){for(var s,n=0,o=this.inputs;n<o.length;)if(s=o[n],++n,s.name==e)return t==null||t==s.type;return!1},append:function(e,t){var n=this.inputs.slice();return n.push(new ce(e,t,0)),y.make(n)},pop:function(){var e=this.inputs.slice();return e.pop(),y.make(e)},isSubSet:function(e){if(e==this)return!0;if(this.inputs.length>=e.inputs.length)return!1;for(var t,n,s,o=0,i=this.inputs.length;o<i;)if(t=o++,n=this.inputs[t],s=e.inputs[t],n.name!=s.name||n.type!=s.type)return!1;return!0},resolveMapping:function(e){var s,o,i,a,r,c,l,n=this.mappings==null?null:this.mappings[e.uid];if(n!=null)return n;for(n=[],o=0,r=e.inputs;o<r.length;){for(i=r[o],++o,c=!1,a=0,l=this.inputs;a<l.length;)if(s=l[a],++a,s.name==i.name&&s.type==i.type){n.push(ja._new(0,this.calculateInputOffset(s.name),s.precision)),c=!0;break}if(!c)throw t.thrown("Missing buffer input '"+i.name+"'")}return this.mappings==null&&(this.mappings=[]),this.mappings[e.uid]=n,n},getInputs:function(){return new Ws(this.inputs)},toString:function(){for(var e,n=[],t=0,s=this.inputs;t<s.length;)e=s[t],++t,n.push(e.name+":"+Pt.toString(e.type)+(e.precision==0?"":"."+Mt.toString(e.precision).toLowerCase()));return n.toString()},__class__:y},Ln=function(e){this.mappings=[],this.uid=Ln._UID++,this.formats=e},c["hxd.MultiFormat"]=Ln,Ln.__name__="hxd.MultiFormat",Ln.make=function(e){if(e.length>Ln.MAX_FORMATS){for(var n,i,a,s=[],r=0;r<e.length;)i=e[r],++r,s.push(i.toString());throw t.thrown("Too many formats (addBuffer leak?) "+o.string(s))}for(n={found:null,nexts:Ln.CACHE},s=0;s<e.length;)i=e[s],++s,a=n.nexts.h[i.uid],a==null&&(a={found:null,nexts:new le},n.nexts.h[i.uid]=a),n=a;return n.found==null&&(n.found=new Ln(e)),n.found},Ln.prototype={resolveMapping:function(e){var t=this.mappings[e.uid];return t==null&&(t=this.makeMapping(e)),t},makeMapping:function(e){for(var n,s,o,i,a,c,l,u,h,m,p,r=[],f=0,d=e.inputs;f<d.length;){for(n=d[f++],a=!1,o=null,i=0,c=this.formats;i<c.length;)if(u=c[i],h=i++,m=h,l=u,s=l.getInput(n.name),s!=null){if(o=s,s.type!=n.type)continue;p=l.calculateInputOffset(s.name),r.push(ja._new(m,p,s.precision)),a=!0;break}if(!a)throw o!=null?t.thrown("Shader buffer "+n.name+" was requested with "+(n.type==null?"null":Pt.toString(n.type))+" but found with "+(o.type==null?"null":Pt.toString(o.type))):t.thrown("Missing shader buffer "+n.name)}return this.mappings[e.uid]=r,r},__class__:Ln},gt=function(){var t,n,s,e=this;for(this.map=new le,t=0;t<94;)n=t++,e.map.h[65281+n]=33+n;for(t=192,s=199;t<s;)n=t++,e.map.h[n]=65;for(t=224,s=231;t<s;)n=t++,e.map.h[n]=97;for(t=200,s=204;t<s;)n=t++,e.map.h[n]=69;for(t=232,s=236;t<s;)n=t++,e.map.h[n]=101;for(t=204,s=208;t<s;)n=t++,e.map.h[n]=73;for(t=236,s=240;t<s;)n=t++,e.map.h[n]=105;for(t=210,s=215;t<s;)n=t++,e.map.h[n]=79;for(t=242,s=247;t<s;)n=t++,e.map.h[n]=111;for(t=217,s=221;t<s;)n=t++,e.map.h[n]=85;for(t=249,s=253;t<s;)n=t++,e.map.h[n]=117;e.map.h[199]=67,e.map.h[231]=67,e.map.h[208]=68,e.map.h[222]=100,e.map.h[209]=78,e.map.h[241]=110,e.map.h[221]=89,e.map.h[253]=121,e.map.h[255]=121,e.map.h[8364]=69,e.map.h[12288]=32,e.map.h[160]=32,e.map.h[171]=34,e.map.h[187]=34,e.map.h[8220]=34,e.map.h[8221]=34,e.map.h[8222]=34,e.map.h[8216]=39,e.map.h[8217]=39,e.map.h[180]=39,e.map.h[8216]=39,e.map.h[8249]=60,e.map.h[8250]=62,e.map.h[8211]=45},c["hxd.Charset"]=gt,gt.__name__="hxd.Charset",gt.getDefault=function(){return gt.inst==null&&(gt.inst=new gt),gt.inst},gt.prototype={resolveChar:function(e,t){for(var s,n=e;n!=null;){if(s=t.h[n],s!=null)return s;n=this.map.h[n]}return null},isCJK:function(e){return e>=11904&&e<=42191||e>=63744&&e<=64255||e>=131072&&e<=262141},isSpace:function(e){return e==32||e==12288},isBreakChar:function(e){return!!this.isSpace(e)||this.isCJK(e)},isComplementChar:function(e){return gt.complementChars.h.hasOwnProperty(e)},__class__:gt},Ht=_["hxd.Cursor"]={__ename__:!0,__constructs__:null,Default:{_hx_name:"Default",_hx_index:0,__enum__:"hxd.Cursor",toString:s},Button:{_hx_name:"Button",_hx_index:1,__enum__:"hxd.Cursor",toString:s},Move:{_hx_name:"Move",_hx_index:2,__enum__:"hxd.Cursor",toString:s},TextInput:{_hx_name:"TextInput",_hx_index:3,__enum__:"hxd.Cursor",toString:s},Hide:{_hx_name:"Hide",_hx_index:4,__enum__:"hxd.Cursor",toString:s},Custom:(a=function(e){return{_hx_index:5,custom:e,__enum__:"hxd.Cursor",toString:s}},a._hx_name="Custom",a.__params__=["custom"],a),Callback:(a=function(e){return{_hx_index:6,f:e,__enum__:"hxd.Cursor",toString:s}},a._hx_name="Callback",a.__params__=["f"],a)},Ht.__constructs__=[Ht.Default,Ht.Button,Ht.Move,Ht.TextInput,Ht.Hide,Ht.Custom,Ht.Callback],Ht.__empty_constructs__=[Ht.Default,Ht.Button,Ht.Move,Ht.TextInput,Ht.Hide],Aa=function(e,t,n,s){this.frames=e,this.speed=t,this.offsetX=n,this.offsetY=s,this.frameDelay=1/t,this.frameTime=0,this.frameIndex=0},c["hxd.CustomCursor"]=Aa,Aa.__name__="hxd.CustomCursor",Aa.getNativeCursor=function(e){var t=new Aa([],0,0,0);return t.alloc=[e],Ht.Custom(t)},Aa.prototype={reset:function(){this.frameTime=0,this.frameIndex=0},update:function(e){for(var n=this.frameTime+e,s=this.frameDelay,t=this.frameIndex;n>=s;)n-=s,++t;return this.frameTime=n,t>=this.frames.length&&(t%=this.frames.length),t!=this.frameIndex?(this.frameIndex=t,t):-1},dispose:function(){for(var t,e=0,n=this.frames;e<n.length;)t=n[e],++e,t.ctx=null,t.pixel=null;this.frames=[],this.alloc!=null&&(this.alloc=null)},__class__:Aa},qi=function(e){this.file=e},c["hxd.DroppedFile"]=qi,qi.__name__="hxd.DroppedFile",qi.prototype={__class__:qi},_c=function(e,t,n){this.files=e,this.dropX=t,this.dropY=n},c["hxd.DropFileEvent"]=_c,_c.__name__="hxd.DropFileEvent",_c.prototype={get_file:function(){return this.files[0]},__class__:_c},W=_["hxd.EventKind"]={__ename__:!0,__constructs__:null,EPush:{_hx_name:"EPush",_hx_index:0,__enum__:"hxd.EventKind",toString:s},ERelease:{_hx_name:"ERelease",_hx_index:1,__enum__:"hxd.EventKind",toString:s},EMove:{_hx_name:"EMove",_hx_index:2,__enum__:"hxd.EventKind",toString:s},EOver:{_hx_name:"EOver",_hx_index:3,__enum__:"hxd.EventKind",toString:s},EOut:{_hx_name:"EOut",_hx_index:4,__enum__:"hxd.EventKind",toString:s},EWheel:{_hx_name:"EWheel",_hx_index:5,__enum__:"hxd.EventKind",toString:s},EFocus:{_hx_name:"EFocus",_hx_index:6,__enum__:"hxd.EventKind",toString:s},EFocusLost:{_hx_name:"EFocusLost",_hx_index:7,__enum__:"hxd.EventKind",toString:s},EKeyDown:{_hx_name:"EKeyDown",_hx_index:8,__enum__:"hxd.EventKind",toString:s},EKeyUp:{_hx_name:"EKeyUp",_hx_index:9,__enum__:"hxd.EventKind",toString:s},EReleaseOutside:{_hx_name:"EReleaseOutside",_hx_index:10,__enum__:"hxd.EventKind",toString:s},ETextInput:{_hx_name:"ETextInput",_hx_index:11,__enum__:"hxd.EventKind",toString:s},ECheck:{_hx_name:"ECheck",_hx_index:12,__enum__:"hxd.EventKind",toString:s}},W.__constructs__=[W.EPush,W.ERelease,W.EMove,W.EOver,W.EOut,W.EWheel,W.EFocus,W.EFocusLost,W.EKeyDown,W.EKeyUp,W.EReleaseOutside,W.ETextInput,W.ECheck],W.__empty_constructs__=[W.EPush,W.ERelease,W.EMove,W.EOver,W.EOut,W.EWheel,W.EFocus,W.EFocusLost,W.EKeyDown,W.EKeyUp,W.EReleaseOutside,W.ETextInput,W.ECheck],it=function(e,t,n){n==null&&(n=0),t==null&&(t=0),this.button=0,this.kind=e,this.relX=t,this.relY=n},c["hxd.Event"]=it,it.__name__="hxd.Event",it.prototype={toString:function(){var e,t=o.string(this.kind)+"["+(this.relX|0)+","+(this.relY|0)+"]";switch(this.kind._hx_index){case 5:e=",wheelDelta="+this.wheelDelta;break;case 8:case 9:e=",keyCode="+this.keyCode;break;case 0:case 1:case 10:e=",button="+this.button;break;case 11:e=",charCode="+this.charCode;break;case 2:case 3:case 4:case 6:case 7:case 12:e="";break}return t+e},__class__:it},Tt={},Tt._new=function(e){return{pos:e,array:new Float32Array(new ArrayBuffer(e<<2))}},Tt.get_length=function(e){return e.pos},Tt.set_length=function(e,t){if(e.pos!=t){var n=new Float32Array(t);n.set(e.array),e.array=n}return e.pos=t,t},Tt.push=function(e,t){if(e.pos==e.array.length){var s,n=e.array.length<<1;n<128&&(n=128),s=new Float32Array(n),s.set(e.array),e.array=s}e.array[e.pos++]=t},Tt.get=function(e,t){return e.array[t]},Tt.set=function(e,t,n){return e.array[t]=n},Tt.toF32Array=function(e){return e.array},Tt.toArray=function(e){for(var s,t=[],n=0,o=e.pos;n<o;)s=n++,t.push(e.array[s]);return t},vc=function(e){this.b=e,this.len=this.b.pos,this.pos=0},c["hxd._FloatBuffer.InnerIterator"]=vc,vc.__name__="hxd._FloatBuffer.InnerIterator",vc.prototype={hasNext:function(){return this.pos<this.len},next:function(){return this.b.array[this.pos++]},__class__:vc},lo={},lo._new=function(e){return e==null&&(e=0),Tt._new(e)},lo.push=function(e,t){if(e.pos==e.array.length){var s,n=e.array.length<<1;n<128&&(n=128),s=new Float32Array(n),s.set(e.array),e.array=s}e.array[e.pos++]=t},lo.grow=function(e,t){for(var n,s,a,o=e.pos,i=t;o<i;)a=o++,e.pos==e.array.length&&(n=e.array.length<<1,n<128&&(n=128),s=new Float32Array(n),s.set(e.array),e.array=s),e.array[e.pos++]=0},lo.resize=function(e,t){if(e.pos!=t){var n=new Float32Array(t);n.set(e.array),e.array=n}e.pos=t},lo.arrayRead=function(e,t){return e.array[t]},lo.arrayWrite=function(e,t,n){return e.array[t]=n},lo.getNative=function(e){return e},lo.iterator=function(e){return new vc(e)},lo.get_length=function(e){return e.pos},fc=function(e){this.b=e,this.len=this.b.length,this.pos=0},c["hxd._IndexBuffer.InnerIterator"]=fc,fc.__name__="hxd._IndexBuffer.InnerIterator",fc.prototype={hasNext:function(){return this.pos<this.len},next:function(){return this.b[this.pos++]},__class__:fc},gi={},gi._new=function(e){return e==null&&(e=0),new Array(e)},gi.push=function(e,t){e.push(t)},gi.grow=function(e,t){for(;e.length<t;)e.push(0)},gi.arrayRead=function(e,t){return e[t]},gi.arrayWrite=function(e,t,n){return e[t]=n},gi.getNative=function(e){return e},gi.iterator=function(e){return new fc(e)},gi.get_length=function(e){return e.length},p=function(){},c["hxd.Key"]=p,p.__name__="hxd.Key",p.isDown=function(e){return p.keyPressed[e]>0},p.getFrame=function(){return N.frameCount+2},p.isPressed=function(e){return p.keyPressed[e]==N.frameCount+2-1},p.isReleased=function(e){return p.keyPressed[e]==-(N.frameCount+2)+1},p.initialize=function(){p.initDone&&p.dispose(),p.initDone=!0,p.keyPressed=[],pt.getInstance().addEventTarget(p.onEvent)},p.dispose=function(){p.initDone&&(pt.getInstance().removeEventTarget(p.onEvent),p.initDone=!1,p.keyPressed=[])},p.onEvent=function(e){switch(e.kind._hx_index){case 0:e.button<5&&(p.keyPressed[e.button]=N.frameCount+2);break;case 1:e.button<5&&(p.keyPressed[e.button]=-(N.frameCount+2));break;case 5:p.keyPressed[e.wheelDelta>0?6:5]=N.frameCount+2;break;case 8:if(!p.ALLOW_KEY_REPEAT&&p.keyPressed[e.keyCode]>0)return;p.keyPressed[e.keyCode]=N.frameCount+2;break;case 9:p.keyPressed[e.keyCode]=-(N.frameCount+2);break;case 10:p.keyPressed=[];break;default:}},p.getKeyName=function(e){var t=e;switch(t){case 0:return"MouseLeft";case 1:return"MouseRight";case 2:return"MouseMiddle";case 3:return"Mouse3";case 4:return"Mouse4";case 8:return"Backspace";case 9:return"Tab";case 13:return"Enter";case 16:return"Shift";case 17:return"Ctrl";case 18:return"Alt";case 19:return"PauseBreak";case 20:return"CapsLock";case 27:return"Escape";case 32:return"Space";case 33:return"PageUp";case 34:return"PageDown";case 35:return"End";case 36:return"Home";case 37:return"Left";case 38:return"Up";case 39:return"Right";case 40:return"Down";case 45:return"Insert";case 46:return"Delete";case 91:return"LeftWindowKey";case 92:return"RightWindowKey";case 93:return"ContextMenu";case 106:return"NumPad*";case 107:return"NumPad+";case 108:return"NumPadEnter";case 109:return"NumPad-";case 110:return"NumPad.";case 111:return"NumPad/";case 144:return"NumLock";case 145:return"ScrollLock";case 186:return"Semicolon";case 187:return"Equals";case 188:return"Comma";case 189:return"Minus";case 190:return"Period";case 191:return"Slash";case 192:return"Tilde";case 219:return"BracketLeft";case 220:return"Backslash";case 221:return"BracketRight";case 222:return"Quote";case 226:return"IntlBackslash";case 272:return"LShift";case 273:return"LCtrl";case 274:return"LAlt";case 528:return"RShift";case 529:return"RCtrl";case 530:return"RAlt";default:return t>=48&&t<=57?""+(t-48):t>=96&&t<=105?"NumPad"+(t-96):t>=65&&t<=90?String.fromCodePoint(65+t-65):t>=112&&t<=135?"F"+(t-112+1):null}},x=function(){},c["hxd.Math"]=x,x.__name__="hxd.Math",x.get_POSITIVE_INFINITY=function(){return 1/0},x.get_NEGATIVE_INFINITY=function(){return-(1/0)},x.get_NaN=function(){return NaN},x.isNaN=function(e){return isNaN(e)},x.isFinite=function(e){return isFinite(e)},x.fmt=function(e){if(e<0?(n=-1,e=-e):n=1,isNaN(e)||!isFinite(e))return e;var n,s,t=4-Math.log(e)/Math.log(10)|0;if(t<1)t=1;else if(t>=10)return 0;return s=10**t,Math.floor(e*s+.49999)*n/s},x.exp=function(e){return Math.exp(e)},x.log=function(e){return Math.log(e)},x.log2=function(e){return Math.log(e)/Math.log(2)},x.log10=function(e){return Math.log(e)/Math.log(10)},x.logBase=function(e,t){return Math.log(e)/Math.log(t)},x.floor=function(e){return Math.floor(e)},x.ffloor=function(e){return Math.floor(e)},x.ceil=function(e){return Math.ceil(e)},x.round=function(e){return Math.round(e)},x.fround=function(e){return Math.round(e)},x.clamp=function(e,t,n){return n==null&&(n=1),t==null&&(t=0),e<t?t:e>n?n:e},x.pow=function(e,t){return e**t},x.cos=function(e){return Math.cos(e)},x.sin=function(e){return Math.sin(e)},x.tan=function(e){return Math.tan(e)},x.acos=function(e){return Math.acos(e)},x.asin=function(e){return Math.asin(e)},x.atan=function(e){return Math.atan(e)},x.sqrt=function(e){return Math.sqrt(e)},x.invSqrt=function(e){return 1/Math.sqrt(e)},x.atan2=function(e,t){return Math.atan2(e,t)},x.abs=function(e){return e<0?-e:e},x.max=function(e,t){return e<t?t:e},x.min=function(e,t){return e>t?t:e},x.iabs=function(e){return e<0?-e:e},x.imax=function(e,t){return e<t?t:e},x.imin=function(e,t){return e>t?t:e},x.iclamp=function(e,t,n){return e<t?t:e>n?n:e},x.lerp=function(e,t,n){return e+n*(t-e)},x.inverseLerp=function(e,t,n){return(n-e)/(t-e)},x.ease=function(e,t,n,s){var o=n**(1+s);return e+o/(o+(1-n)**(s+1))*(t-e)},x.easeFactor=function(e,t){var n=e**(1+t);return n/(n+(1-e)**(t+1))},x.lerpTime=function(e,t,n,s){return e+(1-(1-n)**(s*N.wantedFPS))*(t-e)},x.bitCount=function(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24},x.isPOT=function(e){return(e&e-1)==0},x.nextPOT=function(e){return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},x.distanceSq=function(e,t,n){return n==null&&(n=0),e*e+t*t+n*n},x.distance=function(e,t,n){n==null&&(n=0);var s=n;return s==null&&(s=0),Math.sqrt(e*e+t*t+s*s)},x.colorLerp=function(e,t,n){var s=e>>>24,o=e>>16&255,i=e>>8&255,a=e&255,r=t>>>24,c=t>>16&255,l=t>>8&255,d=t&255,u=s*(1-n)+r*n|0,h=o*(1-n)+c*n|0,m=i*(1-n)+l*n|0,f=a*(1-n)+d*n|0;return u<<24|h<<16|m<<8|f},x.angle=function(e){return e%=6.2831853071795862,e>3.14159265358979323?e-=6.2831853071795862:e<=-3.1415926535897931&&(e+=6.2831853071795862),e},x.angleLerp=function(e,t,n){var s=t-e;return s%=6.2831853071795862,s>3.14159265358979323?s-=6.2831853071795862:s<=-3.1415926535897931&&(s+=6.2831853071795862),e+s*n},x.angleMove=function(e,t,n){var o,s=t-e;return s%=6.2831853071795862,s>3.14159265358979323?s-=6.2831853071795862:s<=-3.1415926535897931&&(s+=6.2831853071795862),o=s,o>-n&&o<n?t:e+(o<0?-n:n)},x.valueMove=function(e,t,n){return e<t?(e+=n,e>t&&(e=t)):e>t&&(e-=n,e<t&&(e=t)),e},x.shuffle=function(e){for(var n,s,a,c,t=e.length,i=0,r=t;i<r;)c=i++,n=o.random(t),s=o.random(t),a=e[n],e[n]=e[s],e[s]=a},x.random=function(e){return e==null&&(e=1),Math.random()*e},x.srand=function(e){return e==null&&(e=1),(Math.random()-.5)*(e*2)},x.b2f=function(e){return(e&255)*.0039215686274509803921568627451},x.f2b=function(e){return(e<0?0:e>1?1:e)*255|0},x.umod=function(e,t){var n=e%t;return n>=0?n:n+t},x.ufmod=function(e,t){var n=e%t;return n>=0?n:n+t},x.degToRad=function(e){return e*3.14159265358979323/180},x.radToDeg=function(e){return e*180/3.14159265358979323},bn=_["hxd.Flags"]={__ename__:!0,__constructs__:null,ReadOnly:{_hx_name:"ReadOnly",_hx_index:0,__enum__:"hxd.Flags",toString:s},AlphaPremultiplied:{_hx_name:"AlphaPremultiplied",_hx_index:1,__enum__:"hxd.Flags",toString:s}},bn.__constructs__=[bn.ReadOnly,bn.AlphaPremultiplied],bn.__empty_constructs__=[bn.ReadOnly,bn.AlphaPremultiplied],qc={},qc.getPixel=function(e,t,n){var s=e.bytes.getInt32((t+n*e.width<<2)+e.offset);return s>>>24|s>>8&65280|s<<8&16711680|s<<24},qc.setPixel=function(e,t,n,s){e.bytes.setInt32((t+n*e.width<<2)+e.offset,s>>>24|s>>8&65280|s<<8&16711680|s<<24)},qc.fromPixels=function(e){return e.convert(f.ARGB),e},Jc={},Jc.getPixelF=function(e,t,n,s){s==null&&(s=new j(0,0,0,1));var o=(t+n*e.width<<2)+e.offset;return s.x=e.bytes.getFloat(o),s},Jc.setPixelF=function(e,t,n,s){var o=(t+n*e.width<<2)+e.offset;e.bytes.setFloat(o,s.x)},Jc.fromPixels=function(e){return e.convert(f.R32F),e},nl={},nl.getPixelF=function(e,t,n,s){s==null&&(s=new j(0,0,0,1));var o=(t+n*e.width<<4)+e.offset;return s.x=e.bytes.getFloat(o),s.y=e.bytes.getFloat(o+4),s.z=e.bytes.getFloat(o+8),s.w=e.bytes.getFloat(o+12),s},nl.setPixelF=function(e,t,n,s){var o=(t+n*e.width<<4)+e.offset;e.bytes.setFloat(o,s.x),e.bytes.setFloat(o+4,s.y),e.bytes.setFloat(o+8,s.z),e.bytes.setFloat(o+12,s.w)},nl.fromPixels=function(e){return e.convert(f.RGBA32F),e},za={},za.toInt=function(e){return e},za.fromInt=function(e){return e},G=function(e,t,n,s,o){o==null&&(o=0),this.width=e,this.height=t,this.bytes=n,this.set_innerFormat(s),this.offset=o;var i=0;i==null&&(i=0),this.flags=i},c["hxd.Pixels"]=G,G.__name__="hxd.Pixels",G.switchEndian=function(e){return e>>>24|e>>8&65280|e<<8&16711680|e<<24},G.switchBR=function(e){return e&-16711936|e<<16&16711680|e>>16&255},G.calcDataSize=function(e,t,n){if(n._hx_index==22){var s=n.v;return(t+3>>2<<2)*G.calcStride(e,n)}return t*G.calcStride(e,n)},G.calcStride=function(e,t){switch(t._hx_index){case 3:case 21:n=8;break;case 4:n=16;break;case 5:n=1;break;case 6:case 18:n=2;break;case 7:n=4;break;case 8:n=2;break;case 9:case 19:n=4;break;case 10:n=8;break;case 11:n=3;break;case 12:case 20:n=6;break;case 13:n=12;break;case 0:case 1:case 2:case 14:case 15:n=4;break;case 16:n=4;break;case 17:n=4;break;case 22:var n,o=t.v,s=e+3>>2;return o==1||o==4?s<<1:s<<2;case 23:n=2;break;case 24:n=3;break;case 25:case 26:n=4;break}return e*n},G.isFloatFormat=function(e){switch(e._hx_index){case 3:case 6:case 9:case 12:return!0;case 4:case 7:case 10:case 13:return!0;case 22:return e.v==6;break;default:return!1}},G.getChannelOffset=function(e,n){switch(e._hx_index){case 0:return[1,2,3,0][n];case 1:return[2,1,0,3][n];case 4:return n*4;case 8:case 9:case 10:case 19:var o,s=G.calcStride(1,e);return[0,s,-1,-1][n];case 2:case 14:case 15:return n;case 16:case 17:throw t.thrown("Bit packed format");case 5:case 6:case 7:case 18:return n==0?0:-1;break;case 11:case 12:case 13:case 20:return s=G.calcStride(1,e),[0,s,s<<1,-1][n];case 3:case 21:return n*2;case 22:throw o=e.v,t.thrown("Not supported");case 23:case 24:case 25:case 26:throw t.thrown("Not supported")}},G.alloc=function(e,t,n){return new G(e,t,new A(new ArrayBuffer(G.calcDataSize(e,t,n))),n)},G.toDDSLayers=function(e,n){if(n==null&&(n=!1),e.length==0)throw t.thrown("Must contain at least one image");for(var s,i,r,l,d,h,m,f,p,g,v,b,j,_,w,O,x,C,E,S,M,F,T,k=e[0],c=k.innerFormat,a=[],y=0,u=0;u<e.length;){if(l=e[u],++u,!Y.enumEq(l.innerFormat,c))throw t.thrown("All images must be of the same pixel format");for(y+=l.dataSize,x=!1,m=0;m<a.length;)if(j=a[m],++m,j[0].width==l.width&&j[0].height==l.height){j.push(l),x=!0;break}x||a.push([l])}for(a.sort(function(e,t){return t[0].width*t[0].height-e[0].width*e[0].height}),d=a[0].length,C=a[0][0].width,O=a[0][0].height,u=1,m=a.length;u<m;){if(f=u++,p=a[f],p.length!=d)throw t.thrown("Invalid number of mipmaps at level "+f+": "+p.length+" should be "+d);if(g=C>>f,g==0&&(g=1),v=O>>f,v==0&&(v=1),w=p[0].width,_=p[0].height,w!=g||_!=v)throw t.thrown("Invalid mip level size "+f+": "+w+"x"+_+" should be "+g+"x"+v)}if(y+=128,b=d>1&&!n,b&&(y+=20),i=new A(new ArrayBuffer(y)),s=0,i.setInt32(s,542327876),s+=4,i.setInt32(s,124),s+=4,i.setInt32(s,135183),s+=4,i.setInt32(s,O),s+=4,i.setInt32(s,C),s+=4,i.setInt32(s,k.stride),s+=4,i.setInt32(s,1),s+=4,i.setInt32(s,a.length),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,32),s+=4,b)i.setInt32(s,4),s+=4,i.setInt32(s,808540228),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4;else switch(c._hx_index){case 0:case 1:case 2:i.setInt32(s,65),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,32),s+=4,h=G.getChannelOffset(c,0),i.setInt32(s,255<<h*8),s+=4,h=G.getChannelOffset(c,1),i.setInt32(s,255<<h*8),s+=4,h=G.getChannelOffset(c,2),i.setInt32(s,255<<h*8),s+=4,h=G.getChannelOffset(c,3),i.setInt32(s,255<<h*8),s+=4;break;default:switch(i.setInt32(s,4),s+=4,c._hx_index){case 3:r=113;break;case 4:r=116;break;case 6:r=111;break;case 7:r=114;break;case 9:r=112;break;case 10:r=115;break;default:throw t.thrown("Unsupported format "+o.string(c))}i.setInt32(s,r),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4}if(i.setInt32(s,b?4096:(e.length==1?0:8)|4096|(a.length==1?0:4194304)),s+=4,S=1536|(d>1?2048:0)|(d>2?4096:0)|(d>3?8192:0)|(d>4?16384:0)|(d>5?32768:0),i.setInt32(s,n?S:0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,0),s+=4,b){switch(c._hx_index){case 2:i.setInt32(s,28),s+=4;break;case 22:switch(M=c.v,M){case 1:r=71;break;case 2:r=74;break;case 3:r=77;break;case 7:r=98;break;default:throw t.thrown("Unnsupported format "+o.string(c))}i.setInt32(s,r),s+=4;break;default:throw t.thrown("Unsupported DXT10 format "+o.string(c))}i.setInt32(s,3),s+=4,i.setInt32(s,0),s+=4,i.setInt32(s,d),s+=4,i.setInt32(s,0),s+=4}for(u=0,m=d;u<m;)for(f=u++,E=0,F=a.length;E<F;)T=E++,l=a[T][f],i.blit(s,l.bytes,l.offset,l.dataSize),s+=l.dataSize;return i},G.prototype={get_format:function(){return this.innerFormat},set_innerFormat:function(e){return this.innerFormat=e,this.stride=G.calcStride(this.width,e),this.dataSize=G.calcDataSize(this.width,this.height,e),this.bytesPerPixel=G.calcStride(1,e),e},invalidFormat:function(){throw t.thrown("Unsupported format for this operation : "+o.string(this.innerFormat))},sub:function(e,n,s,o){if(e<0||n<0||e+s>this.width||n+o>this.height)throw t.thrown("Pixels.sub() outside bounds");for(var l,d,i=new A(new ArrayBuffer(o*this.stride)),a=G.calcStride(s,this.innerFormat),r=0,c=0,u=o;c<u;)l=c++,d=(e+(n+l)*this.width)*this.bytesPerPixel+this.offset,i.blit(r,this.bytes,d,a),r+=a;return new G(s,o,i,this.innerFormat)},blit:function(e,n,s,o,i,a,r){if(e<0||n<0||e+a>this.width||n+r>this.height)throw t.thrown("Pixels.blit() outside bounds");if(o<0||o<0||o+a>s.width||i+r>s.height)throw t.thrown("Pixels.blit() outside src bounds");(this.flags&1<<bn.ReadOnly._hx_index)!=0&&this.copyInner(),s.convert(this.innerFormat);var l,d,u,h,m,f,c=this.bytesPerPixel;if(c==0)throw t.thrown("assert");for(u=G.calcStride(a,this.innerFormat),l=0,h=r;l<h;)d=l++,m=(o+(d+i)*s.width)*c+s.offset,f=(e+(d+n)*this.width)*c+this.offset,this.bytes.blit(f,s.bytes,m,u)},clear:function(e,t){t==null&&(t=0);var s,o,i,a,n=t;if((this.flags&1<<bn.ReadOnly._hx_index)!=0&&this.copyInner(),(e&255)==(e>>8&255)&&(e&65535)==e>>>16&&n==0){this.bytes.fill(this.offset,this.width*this.height*this.bytesPerPixel,e&255);return}switch(this.innerFormat._hx_index){case 0:e=e>>>24|e>>8&65280|e<<8&16711680|e<<24,n=n>>>24|n>>8&65280|n<<8&16711680|n<<24;break;case 1:break;case 2:e=e&-16711936|e<<16&16711680|e>>16&255,n=n&-16711936|n<<16&16711680|n>>16&255;break;default:this.invalidFormat()}if(s=this.offset,n==0)for(o=0,i=this.width*this.height;o<i;)a=o++,this.bytes.setInt32(s,e),s+=4;else for(o=0,i=this.width*this.height;o<i;)a=o++,this.bytes.setInt32(s,e|this.bytes.getInt32(s)&n),s+=4},toVector:function(){var t,n,s,o,i,l,d,a=new Array(this.width*this.height),r=0,e=this.offset,c=0;switch(this.innerFormat._hx_index){case 0:for(t=0,o=this.height;t<o;){for(l=t++,n=0,i=this.width;n<i;)d=n++,s=this.bytes.getInt32(e),a[r++]=s>>>24|s>>8&65280|s<<8&16711680|s<<24,e+=4;e+=c}break;case 1:for(t=0,o=this.height;t<o;){for(l=t++,n=0,i=this.width;n<i;)d=n++,a[r++]=this.bytes.getInt32(e),e+=4;e+=c}break;case 2:for(t=0,o=this.height;t<o;){for(l=t++,n=0,i=this.width;n<i;)d=n++,s=this.bytes.getInt32(e),a[r++]=s&-16711936|s<<16&16711680|s>>16&255,e+=4;e+=c}break;default:this.invalidFormat()}return a},makeSquare:function(e){for(var n,o,a,r,l,d,u,h,m,f,i=this.width,c=this.height,t=i==0?0:1,s=c==0?0:1;t<i;)t<<=1;for(;s<c;)s<<=1;if(i==t&&c==s)return this;for(o=this.bytesPerPixel,a=new A(new ArrayBuffer(t*s*o)),n=0,d=this.offset,r=0,l=c;r<l;)for(f=r++,a.blit(n,this.bytes,d,i*o),n+=i*o,d+=i*o,u=0,h=(t-i)*o>>2;u<h;)m=u++,a.setInt32(n,0),n+=4;for(r=0,l=(s-c)*t*o>>2;r<l;)m=r++,a.setInt32(n,0),n+=4;return e?new G(t,s,a,this.innerFormat):(this.bytes=a,this.width=t,this.height=s,this)},copyInner:function(){var e=this.bytes;this.bytes=new A(new ArrayBuffer(this.dataSize)),this.bytes.blit(0,e,this.offset,this.dataSize),this.offset=0,this.flags&=-1-(1<<bn.ReadOnly._hx_index)},willChange:function(){(this.flags&1<<bn.ReadOnly._hx_index)!=0&&this.copyInner()},flipY:function(){(this.flags&1<<bn.ReadOnly._hx_index)!=0&&this.copyInner(),this.stride%4!=0&&this.invalidFormat();for(var e,t,n,s,i,a,r,l,o=0,c=this.height>>1;o<c;)for(n=o++,e=n*this.stride+this.offset,t=(this.height-1-n)*this.stride+this.offset,s=0,i=this.stride>>2;s<i;)l=s++,a=this.bytes.getInt32(e),r=this.bytes.getInt32(t),this.bytes.setInt32(e,r),this.bytes.setInt32(t,a),e+=4,t+=4},convert:function(e){if(this.innerFormat==e||Y.enumEq(this.innerFormat,e))return;(this.flags&1<<bn.ReadOnly._hx_index)!=0&&this.copyInner();var n,i,a,r,c,l,d,u,h,m,f,p,g,v,j,s=this.bytes.b,b=this.innerFormat;switch(b._hx_index){case 0:switch(e._hx_index){case 1:for(i=0,r=this.width*this.height;i<r;)a=i++,n=(a<<2)+this.offset,d=s[n],h=s[n+1],m=s[n+2],u=s[n+3],s[n++]=u,s[n++]=m,s[n++]=h,s[n]=d;break;case 2:for(i=0,r=this.width*this.height;i<r;)a=i++,n=(a<<2)+this.offset,d=s[n],c=s[n+1],s[n]=c,f=s[n+2],s[n+1]=f,p=s[n+3],s[n+2]=p,s[n+3]=d;break;default:throw t.thrown("Cannot convert from "+o.string(this.innerFormat)+" to "+o.string(e))}break;case 1:switch(e._hx_index){case 0:for(i=0,r=this.width*this.height;i<r;)a=i++,n=(a<<2)+this.offset,d=s[n],h=s[n+1],m=s[n+2],u=s[n+3],s[n++]=u,s[n++]=m,s[n++]=h,s[n]=d;break;case 2:for(i=0,r=this.width*this.height;i<r;)a=i++,n=(a<<2)+this.offset,u=s[n],h=s[n+2],s[n]=h,s[n+2]=u;break;default:throw t.thrown("Cannot convert from "+o.string(this.innerFormat)+" to "+o.string(e))}break;case 2:switch(e._hx_index){case 0:for(i=0,r=this.width*this.height;i<r;)a=i++,n=(a<<2)+this.offset,d=s[n+3],c=s[n+2],s[n+3]=c,f=s[n+1],s[n+2]=f,p=s[n],s[n+1]=p,s[n]=d;break;case 1:for(i=0,r=this.width*this.height;i<r;)a=i++,n=(a<<2)+this.offset,u=s[n],h=s[n+2],s[n]=h,s[n+2]=u;break;case 5:for(l=new A(new ArrayBuffer(this.width*this.height)),v=l.b,i=0,r=this.width*this.height;i<r;)a=i++,c=s[a<<2],v[a]=c;this.bytes=l;break;default:throw t.thrown("Cannot convert from "+o.string(this.innerFormat)+" to "+o.string(e))}break;case 4:if(e._hx_index==7){for(l=new A(new ArrayBuffer(this.height*this.width*4)),v=l.b,i=0,r=this.width*this.height;i<r;)a=i++,l.setFloat(a<<2,this.bytes.getFloat(a<<4));this.bytes=l}else throw t.thrown("Cannot convert from "+o.string(this.innerFormat)+" to "+o.string(e));break;case 7:switch(e._hx_index){case 1:case 2:for(g=this.bytes,n=0,i=0,r=this.width*this.height;i<r;)a=i++,c=g.getFloat(n)*255|0,c<0?c=0:c>255&&(c=255),s[n++]=c,s[n++]=c,s[n++]=c,s[n++]=255;break;default:throw t.thrown("Cannot convert from "+o.string(this.innerFormat)+" to "+o.string(e))}break;case 18:if(e._hx_index==7){for(l=new A(new ArrayBuffer(this.width*this.height*4)),g=this.bytes,i=0,r=this.width*this.height;i<r;)a=i++,j=g.getUInt16(a<<1),l.setFloat(a<<2,j/65535);this.bytes=l}else throw t.thrown("Cannot convert from "+o.string(this.innerFormat)+" to "+o.string(e));break;case 22:if(e._hx_index==22){if(u=e.v,d=b.v,d!=u)throw t.thrown("Cannot convert from "+o.string(this.innerFormat)+" to "+o.string(e))}else throw t.thrown("Cannot convert from "+o.string(this.innerFormat)+" to "+o.string(e));break;default:throw t.thrown("Cannot convert from "+o.string(this.innerFormat)+" to "+o.string(e))}this.set_innerFormat(e)},getPixel:function(e,t){var n,o,s=(e+t*this.width)*this.bytesPerPixel+this.offset;switch(this.innerFormat._hx_index){case 0:return n=this.bytes.getInt32(s),n>>>24|n>>8&65280|n<<8&16711680|n<<24;case 1:return this.bytes.getInt32(s);case 2:return n=this.bytes.getInt32(s),n&-16711936|n<<16&16711680|n>>16&255;case 5:return this.bytes.b[s];case 8:return o=this.bytes.getUInt16(s),(o&255)<<8|o>>8;default:return this.invalidFormat(),0}},setPixel:function(e,t,n){var s=(e+t*this.width)*this.bytesPerPixel+this.offset;switch((this.flags&1<<bn.ReadOnly._hx_index)!=0&&this.copyInner(),this.innerFormat._hx_index){case 0:this.bytes.setInt32(s,n>>>24|n>>8&65280|n<<8&16711680|n<<24);break;case 1:this.bytes.setInt32(s,n);break;case 2:this.bytes.setInt32(s,n&-16711936|n<<16&16711680|n>>16&255);break;case 5:this.bytes.b[s]=n;break;case 8:this.bytes.setUInt16(s,(n&255)<<8|(n&65280)>>8);break;default:this.invalidFormat()}},getPixelF:function(e,t,n){n==null&&(n=new j(0,0,0,1));var s,o,i,a,r,l,c=(e+t*this.width)*this.bytesPerPixel+this.offset;switch(this.innerFormat._hx_index){case 4:return s=n,o=this.bytes.getFloat(c),i=this.bytes.getFloat(c+4),a=this.bytes.getFloat(c+8),r=this.bytes.getFloat(c+12),r==null&&(r=1),a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),s.x=o,s.y=i,s.z=a,s.w=r,n;case 7:return s=n,o=this.bytes.getFloat(c),i=0,a=0,r=0,r==null&&(r=1),a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),s.x=o,s.y=i,s.z=a,s.w=r,n;case 10:return s=n,o=this.bytes.getFloat(c),i=this.bytes.getFloat(c+4),a=0,r=0,r==null&&(r=1),a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),s.x=o,s.y=i,s.z=a,s.w=r,n;case 18:return s=n,o=this.bytes.getUInt16(c)/65535,i=0,a=0,r=0,r==null&&(r=1),a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),s.x=o,s.y=i,s.z=a,s.w=r,n;default:return s=n,l=this.getPixel(e,t),s.x=(l>>16&255)/255,s.y=(l>>8&255)/255,s.z=(l&255)/255,s.w=(l>>>24)/255,n}},setPixelF:function(e,t,n){(this.flags&1<<bn.ReadOnly._hx_index)!=0&&this.copyInner();var o,i,a,r,c,s=(e+t*this.width)*this.bytesPerPixel+this.offset;switch(this.innerFormat._hx_index){case 4:this.bytes.setFloat(s,n.x),this.bytes.setFloat(s+4,n.y),this.bytes.setFloat(s+8,n.z),this.bytes.setFloat(s+12,n.w);break;case 7:this.bytes.setFloat(s,n.x);break;default:o=n,i=o.w,a=o.x,r=o.y,c=o.z,this.setPixel(e,t,((i<0?0:i>1?1:i)*255+.499|0)<<24|((a<0?0:a>1?1:a)*255+.499|0)<<16|((r<0?0:r>1?1:r)*255+.499|0)<<8|((c<0?0:c>1?1:c)*255+.499|0))}},dispose:function(){this.bytes=null},toString:function(){return"Pixels("+this.width+"x"+this.height+" "+o.string(this.innerFormat)+")"},toPNG:function(e){switch(e==null&&(e=9),this.offset!=0&&(this.bytes=this.bytes.sub(this.offset,G.calcDataSize(this.width,this.height,this.innerFormat)),this.offset=0),this.innerFormat._hx_index){case 0:t=tt.build32ARGB(this.width,this.height,this.bytes,e);break;case 5:t=tt.buildGrey(this.width,this.height,this.bytes,e);break;default:this.convert(f.BGRA),t=tt.build32BGRA(this.width,this.height,this.bytes,e)}var t,n=new zn;return new zc(n).write(t),n.getBytes()},toDDS:function(){return G.toDDSLayers([this])},clone:function(){var e=new G(this.width,this.height,null,this.innerFormat);return e.flags=this.flags,e.flags&=-1-(1<<bn.ReadOnly._hx_index),this.bytes!=null&&(e.bytes=new A(new ArrayBuffer(this.dataSize)),e.bytes.blit(0,this.bytes,this.offset,this.dataSize)),e},__class__:G},Ro=function(){},c["hxd.Res"]=Ro,Ro.__name__="hxd.Res",Ro.load=function(e){return Ro.get_loader().load(e)},Ro.get_loader=function(){var e=Kt.currentInstance;if(e==null)throw t.thrown("Resource loader not initialized: call to hxd.Res.initXXX() required");return e},Ro.set_loader=function(e){return Kt.currentInstance=e},nc=function(e){this.defaultCursor=Ht.Default,this.mouseCheckMove=!0,this.enablePhysicalMouse=!0,this.isOut=!1,this.onOver=new it(W.EOver),this.onOut=new it(W.EOut),this.checkPos=new it(W.ECheck),this.focusLost=new it(W.EFocusLost),this.lastTouch=0,this.mouseY=-1,this.mouseX=-1,this.overIndex=-1,this.scenes=[],this.pendingEvents=[],this.pushList=[],this.overList=[],this.overCandidates=[],e==null&&(e=pt.getInstance()),this.window=e,e.addEventTarget(b(this,this.onEvent))},c["hxd.SceneEvents"]=nc,nc.__name__="hxd.SceneEvents",nc.prototype={setMousePos:function(e,t){this.mouseX=e,this.mouseY=t},onRemove:function(e){if(e==this.currentFocus&&(this.currentFocus=null),this.overIndex>=0){var t=this.overList.indexOf(e);t>=0&&(u.remove(this.overList,e),t<this.overIndex&&this.overIndex--)}else u.remove(this.overList,e),this.selectCursor();u.remove(this.pushList,e)},addScene:function(e,t){e.setEvents(this),t==null?this.scenes.push(e):this.scenes.splice(t,0,e)},removeScene:function(e){u.remove(this.scenes,e)&&e.setEvents(null)},dispose:function(){this.window.removeEventTarget(b(this,this.onEvent))},focus:function(e){if(this.currentFocus==e)return;if(e==null){this.blur();return}if(this.currentFocus!=null&&(this.blur(),this.currentFocus!=null))return;var t=new it(W.EFocus);e.handleEvent(t),t.cancel||(this.currentFocus=e)},blur:function(){if(this.currentFocus==null)return;this.focusLost.cancel=!1,this.currentFocus.handleEvent(this.focusLost),this.focusLost.cancel||(this.currentFocus=null)},checkFocus:function(){if(this.currentFocus==null)return;var e=this.currentFocus.getInteractiveScene();if(e==null){this.currentFocus=null;return}e.isInteractiveVisible(this.currentFocus)||this.blur()},emitEvent:function(e){var t,n,s,o,i,r,c,p,j,h=e.relX,d=e.relY,a=0,b=!1,f=!1,v=!1,g=!1,m=!1,l=!1;switch(this.overIndex=0,e.kind._hx_index){case 0:m=!0,g=!0;break;case 1:g=!0;break;case 5:case 8:case 9:case 11:if(this.currentFocus!=null&&(e.relX=e.relY=0,this.currentFocus.handleEvent(e),e.relX=h,e.relY=d,!e.propagate))return;break;case 2:case 12:f=!0,v=!0;break;default:}for(o=0,r=this.scenes;o<r.length;){for(i=r[o],++o,p=null;!0;){if(t=i.handleEvent(e,p),t==null){e.relX=h,e.relY=d;break}if(f){if(v){if(s=this.overList.indexOf(t),s==-1)this.overCandidates.length==a?this.overCandidates[a]={i:t,s:i,x:e.relX,y:e.relY,z:e.relZ}:(n=this.overCandidates[a],n.i=t,n.s=i,n.x=e.relX,n.y=e.relY,n.z=e.relZ),++a,this.overList.splice(this.overIndex++,0,t),l=!0;else{if(s<this.overIndex){do this.overList[s]=this.overList[s+1],++s;while(s<this.overIndex)this.overList[this.overIndex]=t,l=!0}else if(s>this.overIndex){do this.overList[s]=this.overList[s-1],--s;while(s>this.overIndex)this.overList[this.overIndex]=t,l=!0}this.overIndex++}v=e.propagate}}else g&&(e.kind==W.EPush?this.pushList.push(t):u.remove(this.pushList,t)),m&&t==this.currentFocus&&(m=!1);if(e.relX=h,e.relY=d,!e.propagate){b=!0;break}p=t,e.propagate=!1}if(b)break}if(m&&this.currentFocus!=null&&this.blur(),f){if(this.overIndex<this.overList.length){for(;this.overIndex<this.overList.length;)j=this.overList.pop(),j.handleEvent(this.onOut);l=!0}if(a!=0){t=0,c=this.onOver;do n=this.overCandidates[t++],c.relX=n.x,c.relY=n.y,c.relZ=n.z,n.s.isInteractiveVisible(n.i)?n.i.handleEvent(c):u.remove(this.overList,n.i),n.i=null,n.s=null;while(t<a)}}if(this.overIndex=-1,l&&this.selectCursor(),!b&&e!=this.checkPos&&(e.kind==W.EPush?this.pushList.push(null):e.kind==W.ERelease&&u.remove(this.pushList,null),this.dispatchListeners(e)),e.kind==W.ERelease&&this.pushList.length>0){for(o=0,r=this.pushList;o<r.length;)if(t=r[o],++o,t==null)e.kind=W.EReleaseOutside,this.dispatchListeners(e),e.kind=W.ERelease;else{if(i=t.getInteractiveScene(),i==null)continue;e.kind=W.EReleaseOutside,i.dispatchEvent(e,t),e.kind=W.ERelease,e.relX=h,e.relY=d}this.pushList=[]}},checkEvents:function(){var e,t,n,a,r,s=this.pendingEvents,i=!this.mouseCheckMove,o=this.currentFocus==null;if(s.length>0)for(this.pendingEvents=[],n=0;n<s.length;){switch(e=s[n],++n,a=e.relX,r=e.relY,e.kind._hx_index){case 0:case 1:this.mouseX=e.relX,this.mouseY=e.relY,this.lastTouch=e.touchId;break;case 2:i=!0,this.mouseX=e.relX,this.mouseY=e.relY,this.lastTouch=e.touchId;break;case 3:this.isOut=!1,this.selectCursor();continue;case 4:if(this.isOut=!0,this.overList.length>0){for(t=this.overList.length-1;t>=0;)this.onOut.cancel=!1,this.overList[t].handleEvent(this.onOut),u.remove(this.overList,this.overList[t]),--t;this.selectCursor()}continue;case 5:case 8:case 9:case 11:o||(o=!0,this.checkFocus());break;default:}if(this.currentDrag!=null&&(this.currentDrag.ref==null||this.currentDrag.ref==e.touchId)){if(e.propagate=!0,e.cancel=!1,this.currentDrag.f(e),e.relX=a,e.relY=r,!e.propagate)continue;e.propagate=!1}this.emitEvent(e)}o||this.checkFocus(),!i&&!this.isOut&&this.currentDrag==null&&(this.checkPos.relX=this.mouseX,this.checkPos.relY=this.mouseY,this.checkPos.touchId=this.lastTouch,this.checkPos.cancel=!1,this.checkPos.propagate=!1,this.emitEvent(this.checkPos))},startCapture:function(e,t,n){this.currentDrag!=null&&this.currentDrag.onCancel!=null&&this.currentDrag.onCancel(),this.currentDrag={f:e,ref:n,onCancel:t}},stopCapture:function(){this.currentDrag!=null&&this.currentDrag.onCancel!=null&&this.currentDrag.onCancel(),this.currentDrag=null},startDrag:function(e,t,n){this.startCapture(e,t,n!=null?n.touchId:null)},stopDrag:function(){this.stopCapture()},getFocus:function(){return this.currentFocus},updateCursor:function(e){this.overList.indexOf(e)!=-1&&this.selectCursor()},set_defaultCursor:function(e){return Y.enumEq(e,this.defaultCursor)?e:(this.defaultCursor=e,this.selectCursor(),e)},selectCursor:function(){for(var n,o,e=this.defaultCursor,t=0,s=this.overList;t<s.length;)if(n=s[t],++t,n.cursor!=null){e=n.cursor;break}e._hx_index==6?(o=e.f,o()):V.setCursor(e)},onEvent:function(e){if(!this.enablePhysicalMouse&&e.kind==W.EMove)return;this.pendingEvents.push(e)},dispatchListeners:function(e){var t,n,s,o=e.relX,i=e.relY;for(e.propagate=!0,t=0,n=this.scenes;t<n.length;)if(s=n[t],++t,e.cancel=!1,s.dispatchListeners(e),e.relX=o,e.relY=i,!e.propagate)break},__class__:nc},jt=_["hxd.Platform"]={__ename__:!0,__constructs__:null,IOS:{_hx_name:"IOS",_hx_index:0,__enum__:"hxd.Platform",toString:s},Android:{_hx_name:"Android",_hx_index:1,__enum__:"hxd.Platform",toString:s},WebGL:{_hx_name:"WebGL",_hx_index:2,__enum__:"hxd.Platform",toString:s},PC:{_hx_name:"PC",_hx_index:3,__enum__:"hxd.Platform",toString:s},Console:{_hx_name:"Console",_hx_index:4,__enum__:"hxd.Platform",toString:s},FlashPlayer:{_hx_name:"FlashPlayer",_hx_index:5,__enum__:"hxd.Platform",toString:s}},jt.__constructs__=[jt.IOS,jt.Android,jt.WebGL,jt.PC,jt.Console,jt.FlashPlayer],jt.__empty_constructs__=[jt.IOS,jt.Android,jt.WebGL,jt.PC,jt.Console,jt.FlashPlayer],As=_["hxd.SystemValue"]={__ename__:!0,__constructs__:null,IsTouch:{_hx_name:"IsTouch",_hx_index:0,__enum__:"hxd.SystemValue",toString:s},IsWindowed:{_hx_name:"IsWindowed",_hx_index:1,__enum__:"hxd.SystemValue",toString:s},IsMobile:{_hx_name:"IsMobile",_hx_index:2,__enum__:"hxd.SystemValue",toString:s}},As.__constructs__=[As.IsTouch,As.IsWindowed,As.IsMobile],As.__empty_constructs__=[As.IsTouch,As.IsWindowed,As.IsMobile],Hn=_["hxd.KeyboardLayout"]={__ename__:!0,__constructs__:null,QWERTY:{_hx_name:"QWERTY",_hx_index:0,__enum__:"hxd.KeyboardLayout",toString:s},AZERTY:{_hx_name:"AZERTY",_hx_index:1,__enum__:"hxd.KeyboardLayout",toString:s},QWERTZ:{_hx_name:"QWERTZ",_hx_index:2,__enum__:"hxd.KeyboardLayout",toString:s},QZERTY:{_hx_name:"QZERTY",_hx_index:3,__enum__:"hxd.KeyboardLayout",toString:s},Unknown:{_hx_name:"Unknown",_hx_index:4,__enum__:"hxd.KeyboardLayout",toString:s}},Hn.__constructs__=[Hn.QWERTY,Hn.AZERTY,Hn.QWERTZ,Hn.QZERTY,Hn.Unknown],Hn.__empty_constructs__=[Hn.QWERTY,Hn.AZERTY,Hn.QWERTZ,Hn.QZERTY,Hn.Unknown],N=function(){},c["hxd.Timer"]=N,N.__name__="hxd.Timer",N.update=function(){N.frameCount++;var e,t=u.now()/1e3;N.elapsedTime=t-N.lastTimeStamp,N.lastTimeStamp=t,N.elapsedTime<N.maxDeltaTime?(e=N.elapsedTime,N.currentDT=e+N.smoothFactor*(N.currentDT-e)):N.elapsedTime=1/N.wantedFPS,N.dt=N.currentDT},N.get_tmod=function(){return N.dt*N.wantedFPS},N.set_tmod=function(e){return N.dt=e/N.wantedFPS,e},N.fps=function(){return 1/N.currentDT},N.skip=function(){N.lastTimeStamp=u.now()/1e3},N.reset=function(){N.lastTimeStamp=u.now()/1e3,N.dt=N.currentDT=1/N.wantedFPS},pt=function(e,n){this.canLockMouse=!0,this.discardMouseUp=-1,this.discardMouseCaptureEvent=!0,this.maxPixelRatio=window.devicePixelRatio,this.useScreenPixels=_i.get_supported(),this.curMouseY=0,this.curMouseX=0,this.mouseMode=an.Absolute;var s,o,a,r,c,l,i=this,d=e!=null;if(this.eventTargets=new jn,this.resizeEvents=new jn,this.dropTargets=new jn,!_i.get_supported()){this.canvasPos={width:0,top:0,left:0,height:0};return}if(e==null){if(e=window.document.getElementById("webgl"),e==null)throw t.thrown("Missing canvas #webgl");e.getAttribute("globalEvents")=="1"&&(n=!0)}this.canvas=e,this.propagateKeyEvents=n,s=e.getAttribute("propagateKeyEvents"),s!=null&&(this.propagateKeyEvents=s!="0"&&s!="false"),this.focused=n,this.element=n?window:e,this.canvasPos=e.getBoundingClientRect(),d?e.addEventListener("mousemove",b(this,this.onMouseMove)):window.addEventListener("mousemove",b(this,this.onMouseMove)),this.element.addEventListener("mousedown",b(this,this.onMouseDown)),this.element.addEventListener("mouseup",b(this,this.onMouseUp)),this.element.addEventListener("mouseleave",b(this,this.onMouseLeave)),this.element.addEventListener("wheel",b(this,this.onMouseWheel)),this.element.addEventListener("touchstart",b(this,this.onTouchStart)),this.element.addEventListener("touchmove",b(this,this.onTouchMove)),this.element.addEventListener("touchend",b(this,this.onTouchEnd)),this.element.addEventListener("keydown",b(this,this.onKeyDown)),this.element.addEventListener("keyup",b(this,this.onKeyUp)),this.element.addEventListener("keypress",b(this,this.onKeyPress)),a=this,r=!1,o=function(){a.onFocus(r)},this.element.addEventListener("blur",o),c=this,l=!0,o=function(){c.onFocus(l)},this.element.addEventListener("focus",o),window.ResizeObserver!=null&&(this.observer=new ResizeObserver(function(){i.checkResize()}),this.observer.observe(e)),window.addEventListener("resize",b(this,this.checkResize)),window.document.addEventListener("pointerlockchange",b(this,this.onPointerLockChange)),e.addEventListener("contextmenu",function(e){return e.stopPropagation(),e.button==2&&e.preventDefault(),!1}),n?(e.addEventListener("mousedown",function(e){i.onMouseDown(e),e.stopPropagation(),e.preventDefault()}),this.element.addEventListener("contextmenu",function(e){return e.stopPropagation(),e.preventDefault(),!1})):(e.getAttribute("tabindex")==null&&e.setAttribute("tabindex","1"),e.style.outline="none"),this.curW=this.get_width(),this.curH=this.get_height()},c["hxd.Window"]=pt,pt.__name__="hxd.Window",pt.getInstance=function(){return pt.inst==null&&(pt.inst=new pt),pt.inst},pt.prototype={checkResize:function(){this.canvasPos=this.canvas.getBoundingClientRect();var e=this.get_width(),t=this.get_height();(this.curW!=e||this.curH!=t)&&(this.curW=e,this.curH=t,this.onResize(null))},dispose:function(){pt.inst==this&&(pt.inst=null),window.ResizeObserver!=null&&this.observer!=null&&(this.observer.disconnect(),this.observer=null)},onClose:function(){return!0},onMouseModeChange:function(){return null},event:function(e){for(var n,s,t=this.eventTargets.h;t!=null;)n=t.item,t=t.next,s=n,s(e)},addEventTarget:function(e){this.eventTargets.add(e)},removeEventTarget:function(e){for(var n,s,t=this.eventTargets.h;t!=null;)if(s=t.item,t=t.next,n=s,n==e){this.eventTargets.remove(n);break}},addResizeEvent:function(e){this.resizeEvents.push(e)},removeResizeEvent:function(e){for(var n,s,t=this.resizeEvents.h;t!=null;)if(n=t.item,t=t.next,s=n,s==e){this.resizeEvents.remove(e);break}},onResize:function(){for(var n,s,t=this.resizeEvents.h;t!=null;)n=t.item,t=t.next,s=n,s()},resize:function(){},addDragAndDropTarget:function(e){if(this.dropTargets.length==0){var t=this.canvas;t.addEventListener("dragover",b(this,this.handleDragAndDropEvent)),t.addEventListener("drop",b(this,this.handleDragAndDropEvent))}this.dropTargets.add(e)},removeDragAndDropTarget:function(e){for(var n,s,o,t=this.dropTargets.h;t!=null;)if(s=t.item,t=t.next,o=s,o==e){this.dropTargets.remove(e);break}this.dropTargets.length==0&&(n=this.canvas,n.removeEventListener("dragover",b(this,this.handleDragAndDropEvent)),n.removeEventListener("drop",b(this,this.handleDragAndDropEvent)))},handleDragAndDropEvent:function(e){if(e.preventDefault(),e.type=="dragover"||e.dataTransfer==null||e.dataTransfer.files.length==0)return;for(var t,i,a,r,c,s=[],n=0,o=e.dataTransfer.files;n<o.length;)i=o[n],++n,s.push(new Ia(i));for(a=new _c(s,Math.round((e.clientX-this.canvasPos.left)*this.getPixelRatio()),Math.round((e.clientY-this.canvasPos.top)*this.getPixelRatio())),t=this.dropTargets.h;t!=null;)r=t.item,t=t.next,c=r,c(a)},setFullScreen:function(e){var t=window.document,n=t.documentElement;if(t.fullscreenElement==n==e)return;e?n.requestFullscreen():t.exitFullscreen()},setCursorPos:function(e,n,s){if(s==null&&(s=!1),this.mouseMode==an.Absolute)throw t.thrown("setCursorPos only allowed in relative mouse modes on this platform.");this.curMouseX=e+this.canvasPos.left,this.curMouseY=n+this.canvasPos.top,s&&this.event(new it(W.EMove,e,n))},setCurrent:function(){pt.inst=this},getPixelRatio:function(){if(this.useScreenPixels){var e=window.devicePixelRatio,t=this.maxPixelRatio;return e>t?t:e}else return 1},get_width:function(){return Math.round(this.canvasPos.width*this.getPixelRatio())},get_height:function(){return Math.round(this.canvasPos.height*this.getPixelRatio())},get_mouseX:function(){return Math.round((this.curMouseX-this.canvasPos.left)*this.getPixelRatio())},get_mouseY:function(){return Math.round((this.curMouseY-this.canvasPos.top)*this.getPixelRatio())},get_mouseLock:function(){var t,e=this.mouseMode;return e._hx_index==2&&(t=e.restorePos,!0)},set_mouseLock:function(e){return Y.enumEq(this.set_mouseMode(e?an.AbsoluteUnbound(!0):an.Absolute),an.AbsoluteUnbound(!0))},get_mouseClip:function(){return!1},set_mouseClip:function(e){if(e)throw t.thrown("Can't clip cursor on this platform.");return!1},set_mouseMode:function(e){if(Y.enumEq(e,this.mouseMode))return e;var t,n=this.onMouseModeChange(this.mouseMode,e);return n!=null&&(e=n),t=this.pointerLockTarget=this.canvas!=null?this.canvas:window.document.documentElement,e==an.Absolute?t.ownerDocument.pointerLockElement==t&&t.ownerDocument.exitPointerLock():this.canLockMouse&&t.ownerDocument.pointerLockElement!=t&&t.requestPointerLock(),this.mouseMode=e},get_vsync:function(){return!0},set_vsync:function(e){if(!e)throw t.thrown("Can't disable vsync on this platform");return!0},onPointerLockChange:function(){this.mouseMode!=an.Absolute&&this.pointerLockTarget.ownerDocument.pointerLockElement!=this.pointerLockTarget&&(this.canLockMouse=!1,this.set_mouseMode(an.Absolute),this.canLockMouse=!0)},onMouseDown:function(e){if(this.mouseMode==an.Absolute)(e.clientX!=this.curMouseX||e.clientY!=this.curMouseY)&&this.onMouseMove(e);else{if(this.pointerLockTarget.ownerDocument.pointerLockElement!=this.pointerLockTarget&&(this.pointerLockTarget.requestPointerLock(),this.discardMouseCaptureEvent)){this.discardMouseUp=e.button;return}(e.movementX!=0||e.movementY!=0)&&this.onMouseMove(e)}var t,o,n=new it(W.EPush,this.get_mouseX(),this.get_mouseY()),s=e.button;switch(s){case 1:t=2;break;case 2:t=1;break;default:o=s,t=o}n.button=t,this.event(n)},onMouseUp:function(e){if(this.discardMouseUp==e.button){this.discardMouseUp=-1;return}(this.mouseMode==an.Absolute?e.clientX!=this.curMouseX||e.clientY!=this.curMouseY:e.movementX!=0||e.movementY!=0)&&this.onMouseMove(e);var t,o,n=new it(W.ERelease,this.get_mouseX(),this.get_mouseY()),s=e.button;switch(s){case 1:t=2;break;case 2:t=1;break;default:o=s,t=o}n.button=t,this.event(n)},onMouseLeave:function(e){var t,o,n=new it(W.EReleaseOutside,this.get_mouseX(),this.get_mouseY()),s=e.button;switch(s){case 1:t=2;break;case 2:t=1;break;default:o=s,t=o}n.button=t,this.event(n)},onMouseMove:function(e){var t,s,o,n=this.mouseMode;switch(n._hx_index){case 0:this.curMouseX=e.clientX,this.curMouseY=e.clientY,this.event(new it(W.EMove,this.get_mouseX(),this.get_mouseY()));break;case 1:if(s=n.restorePos,o=n.callback,this.pointerLockTarget.ownerDocument.pointerLockElement!=this.pointerLockTarget)return;t=new it(W.EMove,e.movementX,e.movementY),o(t),!t.cancel&&t.propagate&&(t.cancel=!1,t.propagate=!1,t.relX=this.curMouseX,t.relY=this.curMouseY,this.event(t));break;case 2:if(s=n.restorePos,this.pointerLockTarget.ownerDocument.pointerLockElement!=this.pointerLockTarget)return;this.curMouseX+=e.movementX,this.curMouseY+=e.movementY,this.event(new it(W.EMove,this.get_mouseX(),this.get_mouseY()));break}},onMouseWheel:function(e){e.preventDefault();var t=new it(W.EWheel,this.get_mouseX(),this.get_mouseY());t.wheelDelta=e.deltaY/120,this.event(t)},onTouchStart:function(e){e.preventDefault();for(var t,n,o,i,s=0,a=e.changedTouches;s<a.length;)t=a[s],++s,o=Math.round((t.clientX-this.canvasPos.left)*this.getPixelRatio()),i=Math.round((t.clientY-this.canvasPos.top)*this.getPixelRatio()),n=new it(W.EPush,o,i),n.touchId=t.identifier,this.event(n)},onTouchMove:function(e){e.preventDefault();for(var t,n,o,i,s=0,a=e.changedTouches;s<a.length;)t=a[s],++s,o=Math.round((t.clientX-this.canvasPos.left)*this.getPixelRatio()),i=Math.round((t.clientY-this.canvasPos.top)*this.getPixelRatio()),n=new it(W.EMove,o,i),n.touchId=t.identifier,this.event(n)},onTouchEnd:function(e){e.preventDefault();for(var t,n,o,i,s=0,a=e.changedTouches;s<a.length;)t=a[s],++s,o=Math.round((t.clientX-this.canvasPos.left)*this.getPixelRatio()),i=Math.round((t.clientY-this.canvasPos.top)*this.getPixelRatio()),n=new it(W.ERelease,o,i),n.touchId=t.identifier,this.event(n)},onKeyUp:function(e){var t=new it(W.EKeyUp,this.get_mouseX(),this.get_mouseY());t.keyCode=e.keyCode,this.event(t),this.propagateKeyEvents||(e.preventDefault(),e.stopPropagation())},onKeyDown:function(e){var t=new it(W.EKeyDown,this.get_mouseX(),this.get_mouseY());if(t.keyCode=e.keyCode,this.event(t),!this.propagateKeyEvents){switch(t.keyCode){case 8:case 9:case 16:case 17:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:e.preventDefault();break;default:}e.stopPropagation()}},onKeyPress:function(e){var t=new it(W.ETextInput,this.get_mouseX(),this.get_mouseY());t.charCode=e.charCode,this.event(t),this.propagateKeyEvents||(e.preventDefault(),e.stopPropagation())},onFocus:function(e){this.event(new it(e?W.EFocus:W.EFocusLost)),this.focused=e},get_isFocused:function(){return this.focused},get_displayMode:function(){var e=window.document;return e.fullscreenElement!=null?Wt.Borderless:Wt.Windowed},set_displayMode:function(e){if(!_i.get_supported())return e;var t=window.document,n=t.documentElement,s=e!=Wt.Windowed;return t.fullscreenElement==n==s?Wt.Windowed:(e!=Wt.Windowed?n.requestFullscreen():t.exitFullscreen(),e)},get_title:function(){return window.document.title},set_title:function(e){return window.document.title=e},__class__:pt},_i=function(){},c["js.Browser"]=_i,_i.__name__="js.Browser",_i.get_supported=function(){return typeof window!="undefined"&&typeof window.location!="undefined"&&typeof window.location.protocol=="string"},V=function(){},c["hxd.System"]=V,V.__name__="hxd.System",V.timeoutTick=function(){},V.getCurrentLoop=function(){return V.loopFunc},V.setLoop=function(e){V.loopInit||(V.loopInit=!0,V.browserLoop()),V.loopFunc=e},V.browserLoop=function(){if(_i.get_supported()){var e=window,n=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame;V.fpsLimit>0?window.setTimeout(function(){return n(V.browserLoop)},1e3/V.fpsLimit):n(V.browserLoop)}else throw t.thrown("Cannot use browserLoop without Browser support nor defining nodejs + hxnodejs");V.loopFunc!=null&&V.loopFunc()},V.start=function(e){e()},V.setNativeCursor=function(e){if(V.currentNativeCursor!=null&&Y.enumEq(e,V.currentNativeCursor))return;V.currentNativeCursor=e,V.currentCustomCursor=null;var n,s,o,i,r,a=pt.getInstance().canvas;if(a!=null){switch(e._hx_index){case 0:s="default";break;case 1:s="pointer";break;case 2:s="move";break;case 3:s="text";break;case 4:s="none";break;case 5:if(n=e.custom,n.alloc==null)for(n.alloc=[],o=0,i=n.frames;o<i.length;)r=i[o],++o,n.alloc.push('url("'+r.ctx.canvas.toDataURL("image/png")+'") '+n.offsetX+" "+n.offsetY+", default");n.frames.length>1&&(V.currentCustomCursor=n,n.reset()),s=n.alloc[n.frameIndex];break;case 6:throw o=e.f,t.thrown("assert")}a.style.cursor=s}},V.getDeviceName=function(){return"Unknown"},V.getDefaultFrameRate=function(){return 60},V.getValue=function(e){switch(e._hx_index){case 0:return V.get_platform()==jt.Android||V.get_platform()==jt.IOS;break;case 1:return!0;case 2:return V.get_platform()==jt.Android||V.get_platform()==jt.IOS;break}},V.exit=function(){},V.openURL=function(e){window.open(e,"_blank")},V.updateCursor=function(){if(V.currentCustomCursor!=null){var e,t=V.currentCustomCursor.update(N.elapsedTime);t!=-1&&(e=pt.getInstance().canvas,e!=null&&(e.style.cursor=V.currentCustomCursor.alloc[t]))}},V.getClipboardText=function(){return null},V.setClipboardText=function(){return!1},V.getLocale=function(){return e.navigator.language+"_"+e.navigator.language.toUpperCase()},V.getKeyboardLayout=function(){return Hn.Unknown},V.onKeyboardLayoutChange=function(){},V.get_width=function(){return Math.round(window.document.body.clientWidth*window.devicePixelRatio)},V.get_height=function(){return Math.round(window.document.body.clientHeight*window.devicePixelRatio)},V.get_lang=function(){return e.navigator.language},V.get_platform=function(){var t=e.navigator.userAgent.toLowerCase();return t.indexOf("android")>=0?jt.Android:t.indexOf("ipad")>=0||t.indexOf("iphone")>=0||t.indexOf("ipod")>=0?jt.IOS:jt.PC},V.get_screenDPI=function(){return 72},V.get_allowTimeout=function(){return!1},V.set_allowTimeout=function(){return!1},Wt=_["hxd.DisplayMode"]={__ename__:!0,__constructs__:null,Windowed:{_hx_name:"Windowed",_hx_index:0,__enum__:"hxd.DisplayMode",toString:s},Borderless:{_hx_name:"Borderless",_hx_index:1,__enum__:"hxd.DisplayMode",toString:s},Fullscreen:{_hx_name:"Fullscreen",_hx_index:2,__enum__:"hxd.DisplayMode",toString:s},FullscreenResize:{_hx_name:"FullscreenResize",_hx_index:3,__enum__:"hxd.DisplayMode",toString:s}},Wt.__constructs__=[Wt.Windowed,Wt.Borderless,Wt.Fullscreen,Wt.FullscreenResize],Wt.__empty_constructs__=[Wt.Windowed,Wt.Borderless,Wt.Fullscreen,Wt.FullscreenResize],Ia=function(e){qi.call(this,e.name),this.native=e},c["hxd._Window.NativeDroppedFile"]=Ia,Ia.__name__="hxd._Window.NativeDroppedFile",Ia.__super__=qi,Ia.prototype=g(qi.prototype,{getBytes:function(e){var t=new FileReader;t.onload=function(){e(A.ofData(t.result))},t.onerror=function(){e(null)},t.readAsArrayBuffer(this.native)},__class__:Ia}),Ze=_["hxd.clipper.ClipType"]={__ename__:!0,__constructs__:null,Intersection:{_hx_name:"Intersection",_hx_index:0,__enum__:"hxd.clipper.ClipType",toString:s},Union:{_hx_name:"Union",_hx_index:1,__enum__:"hxd.clipper.ClipType",toString:s},Difference:{_hx_name:"Difference",_hx_index:2,__enum__:"hxd.clipper.ClipType",toString:s},Xor:{_hx_name:"Xor",_hx_index:3,__enum__:"hxd.clipper.ClipType",toString:s}},Ze.__constructs__=[Ze.Intersection,Ze.Union,Ze.Difference,Ze.Xor],Ze.__empty_constructs__=[Ze.Intersection,Ze.Union,Ze.Difference,Ze.Xor],Ct=_["hxd.clipper._Clipper.EdgeSide"]={__ename__:!0,__constructs__:null,Left:{_hx_name:"Left",_hx_index:0,__enum__:"hxd.clipper._Clipper.EdgeSide",toString:s},Right:{_hx_name:"Right",_hx_index:1,__enum__:"hxd.clipper._Clipper.EdgeSide",toString:s}},Ct.__constructs__=[Ct.Left,Ct.Right],Ct.__empty_constructs__=[Ct.Left,Ct.Right],lt=_["hxd.clipper._Clipper.Direction"]={__ename__:!0,__constructs__:null,RightToLeft:{_hx_name:"RightToLeft",_hx_index:0,__enum__:"hxd.clipper._Clipper.Direction",toString:s},LeftToRight:{_hx_name:"LeftToRight",_hx_index:1,__enum__:"hxd.clipper._Clipper.Direction",toString:s}},lt.__constructs__=[lt.RightToLeft,lt.LeftToRight],lt.__empty_constructs__=[lt.RightToLeft,lt.LeftToRight],ls=function(){var e=[];this.polygon=e??[],this.childs=[]},c["hxd.clipper._Clipper.PolyNode"]=ls,ls.__name__="hxd.clipper._Clipper.PolyNode",ls.prototype={isHoleNode:function(){for(var e=!0,t=this.parent;t!=null;)e=!e,t=t.parent;return e},get_childCount:function(){return this.childs.length},get_contour:function(){return this.polygon},addChild:function(e){var t=this.childs.length;this.childs.push(e),e.parent=this,e.index=t},getNext:function(){return this.childs.length>0?this.childs[0]:this.getNextSiblingUp()},getNextSiblingUp:function(){return this.parent==null?null:this.index==this.parent.childs.length-1?this.parent.getNextSiblingUp():this.parent.childs[this.index+1]},isHole:function(){return this.isHoleNode()},__class__:ls},Ar=function(){ls.call(this),this.allPolys=[]},c["hxd.clipper._Clipper.PolyTree"]=Ar,Ar.__name__="hxd.clipper._Clipper.PolyTree",Ar.__super__=ls,Ar.prototype=g(ls.prototype,{toPolygons:function(e){e=[],this.addRec(this,e)},addRec:function(e,t){e.polygon.length>0&&t.push(e.polygon);for(var o,n=0,s=e.childs;n<s.length;)o=s[n],++n,this.addRec(o,t)},clear:function(){this.allPolys=[],this.childs=[]},getFirst:function(){return this.childs.length>0?this.childs[0]:null},get_total:function(){var e=this.allPolys.length;return e>0&&this.childs[0]!=this.allPolys[0]&&--e,e},__class__:Ar}),Uc=function(e){this.val=e},c["hxd.clipper._Clipper.Ref"]=Uc,Uc.__name__="hxd.clipper._Clipper.Ref",Uc.prototype={__class__:Uc},_r=function(){},c["hxd.clipper._Clipper.TEdge"]=_r,_r.__name__="hxd.clipper._Clipper.TEdge",_r.prototype={get_top:function(){return new E(this.topX,this.topY)},get_bot:function(){return new E(this.botX,this.botY)},get_curr:function(){return new E(this.currX,this.currY)},set_top:function(e){return this.topX=e.x,this.topY=e.y,e},set_bot:function(e){return this.botX=e.x,this.botY=e.y,e},set_curr:function(e){return this.currX=e.x,this.currY=e.y,e},__class__:_r},br=function(){},c["hxd.clipper._Clipper.IntersectNode"]=br,br.__name__="hxd.clipper._Clipper.IntersectNode",br.prototype={__class__:br},rr=function(){},c["hxd.clipper._Clipper.LocalMinima"]=rr,rr.__name__="hxd.clipper._Clipper.LocalMinima",rr.prototype={__class__:rr},Ui=function(){},c["hxd.clipper._Clipper.Scanbeam"]=Ui,Ui.__name__="hxd.clipper._Clipper.Scanbeam",Ui.prototype={__class__:Ui},gr=function(){},c["hxd.clipper._Clipper.OutRec"]=gr,gr.__name__="hxd.clipper._Clipper.OutRec",gr.prototype={__class__:gr},ci=function(){},c["hxd.clipper._Clipper.OutPt"]=ci,ci.__name__="hxd.clipper._Clipper.OutPt",ci.prototype={__class__:ci},cr=function(){},c["hxd.clipper._Clipper.Join"]=cr,cr.__name__="hxd.clipper._Clipper.Join",cr.prototype={__class__:cr},yn=function(){this.m_edges=[],this.m_MinimaList=null,this.m_CurrentLM=null},c["hxd.clipper._Clipper.ClipperBase"]=yn,yn.__name__="hxd.clipper._Clipper.ClipperBase",yn.nearZero=function(e){return e>-1e-20&&e<1e-20},yn.getBounds=function(e){for(var n,i,a,r,c,l,d,t=new Zr,s=0,o=e.length;s<o&&e[s].length==0;)++s;for(d=s==o,t.left=t.right=e[s][0].x,t.top=t.bottom=e[s][0].y,i=0,c=o;i<c;)for(s=i++,a=0,r=e[s],l=r.length;a<l;)n=r[a++],n.x<t.left?t.left=n.x:n.x>t.right&&(t.right=n.x),n.y<t.top?t.top=n.y:n.y>t.bottom&&(t.bottom=n.y);return t},yn.prototype={isHorizontal:function(e){return e.deltaY==0},abs:function(e){return e<0?-e:e},PointIsVertex:function(e,t){var s,n=t;do{if(s=n.pt,s.x==e.x&&s.y==e.y)return!0;n=n.next}while(n!=t)return!1},PointOnLineSegment:function(e,t,n){return e.x==t.x&&e.y==t.y||e.x==n.x&&e.y==n.y||e.x>t.x==e.x<n.x&&e.y>t.y==e.y<n.y&&(e.x-t.x)*(n.y-t.y)==(n.x-t.x)*(e.y-t.y)},PointOnPolygon:function(e,t){var n=t;do{if(this.PointOnLineSegment(e,n.pt,n.next.pt))return!0;n=n.next}while(n!=t)return!1},SlopesEqual:function(e,t){return e.deltaY*t.deltaX==e.deltaX*t.deltaY},SlopesEqual3:function(e,t,n){return(e.y-t.y)*(t.x-n.x)-(e.x-t.x)*(t.y-n.y)==0},clear:function(){this.disposeLocalMinimaList(),this.m_edges=[]},disposeLocalMinimaList:function(){for(;this.m_MinimaList!=null;){var e=this.m_MinimaList.next;this.m_MinimaList=null,this.m_MinimaList=e}this.m_CurrentLM=null},addPolygons:function(e,t){for(var i,n=!1,s=0,o=e,a=o.length;s<a;)i=o[s++],this.addPolygon(i,t)&&(n=!0);return n},addPolygon:function(e,n){for(var s,o,i,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,k,A,S,M,F,T,z,D,N,L,R,P,a=e.length-1;a>0&&e[a]==e[0];)--a;for(;a>0&&e[a]==e[a-1];)--a;if(a<2)return!1;for(i=[],F=0,P=a+1;F<P;)l=F++,i.push(new _r);for(S=!0,u=i[1],w=e[1],u.currX=w.x,u.currY=w.y,s=i[0],c=e[0],s.next=i[1],s.prev=i[a],s.currX=c.x,s.currY=c.y,s.outIdx=-1,s=i[a],c=e[a],s.next=i[0],s.prev=i[a-1],s.currX=c.x,s.currY=c.y,s.outIdx=-1,l=a-1;l>0;)s=i[l],c=e[l],s.next=i[l+1],s.prev=i[l-1],s.currX=c.x,s.currY=c.y,s.outIdx=-1,--l;for(r=i[0],g=r,s=r;!0;){if(s.currX==s.next.currX&&s.currY==s.next.currY){if(s==s.next)break;s==r&&(r=s.next),s=this.RemoveEdge(s),g=s;continue}if(s.prev==s.next)break;if(u=s.prev,b=u.currX,j=u.currY,j==null&&(j=0),b==null&&(b=0),R=b,T=j,y=s.currX,_=s.currY,_==null&&(_=0),y==null&&(y=0),C=y,O=_,x=s.next,p=x.currX,m=x.currY,m==null&&(m=0),p==null&&(p=0),L=p,N=m,(T-O)*(C-L)-(R-C)*(O-N)==0?this.preserveCollinear?(M=s.prev,D=new E(M.currX,M.currY),z=new E(s.currX,s.currY),k=s.next,v=!this.Pt2IsBetweenPt1AndPt3(D,z,new E(k.currX,k.currY))):v=!0:v=!1,v){s==r&&(r=s.next),s=this.RemoveEdge(s),s=s.prev,g=s;continue}if(s=s.next,s==g)break}if(s.prev==s.next)return!1;s=r;do s.currY>=s.next.currY?(s.botX=s.currX,s.botY=s.currY,s.topX=s.next.currX,s.topY=s.next.currY):(s.topX=s.currX,s.topY=s.currY,s.botX=s.next.currX,s.botY=s.next.currY),this.SetDx(s),s.polyType=n,s=s.next,s.currY!=r.currY&&(S=!1);while(s!=r)if(S)return!1;for(this.m_edges.push(i),f=null,s.prev.botX==s.prev.topX&&s.prev.botY==s.prev.topY&&(s=s.next),A=null;!0;){if(s=this.FindNextLocMin(s),s==f)break;if(f==null&&(f=s),s==A)throw t.thrown("!");A=s,o=new rr,o.next=null,o.y=s.botY,s.dx<s.prev.dx?(o.leftBound=s.prev,o.rightBound=s,d=!1):(o.leftBound=s,o.rightBound=s.prev,d=!0),o.leftBound.side=Ct.Left,o.rightBound.side=Ct.Right,o.leftBound.next==o.rightBound?o.leftBound.windDelta=-1:o.leftBound.windDelta=1,o.rightBound.windDelta=-o.leftBound.windDelta,s=this.ProcessBound(o.leftBound,d),s.outIdx==-2&&(s=this.ProcessBound(s,d)),h=this.ProcessBound(o.rightBound,!d),h.outIdx==-2&&(h=this.ProcessBound(h,!d)),o.leftBound.outIdx==-2?o.leftBound=null:o.rightBound.outIdx==-2&&(o.rightBound=null),this.InsertLocalMinima(o),d||(s=h)}return!0},InitEdge:function(e,t,n,s){e.next=t,e.prev=n,e.currX=s.x,e.currY=s.y,e.outIdx=-1},InitEdge2:function(e,t){e.currY>=e.next.currY?(e.botX=e.currX,e.botY=e.currY,e.topX=e.next.currX,e.topY=e.next.currY):(e.topX=e.currX,e.topY=e.currY,e.botX=e.next.currX,e.botY=e.next.currY),this.SetDx(e),e.polyType=t},RemoveEdge:function(e){e.prev.next=e.next,e.next.prev=e.prev;var t=e.next;return e.prev=null,t},FindNextLocMin:function(e){for(;!0;){for(var t;e.botX!=e.prev.botX||e.botY!=e.prev.botY||e.currX==e.topX&&e.currY==e.topY;)e=e.next;if(e.dx!=-9007199254740992&&e.prev.dx!=-9007199254740992)break;for(;e.prev.dx==-9007199254740992;)e=e.prev;for(t=e;e.dx==-9007199254740992;)e=e.next;if(e.topY==e.prev.botY)continue;t.prev.botX<e.botX&&(e=t);break}return e},ProcessBound:function(e,t){var s,o,i,n=e;if(n.outIdx==-2){if(e=n,t){for(;e.topY==e.next.botY;)e=e.next;for(;e!=n&&e.dx==-9007199254740992;)e=e.prev}else{for(;e.topY==e.prev.botY;)e=e.prev;for(;e!=n&&e.dx==-9007199254740992;)e=e.next}return e==n?t?n=e.next:n=e.prev:(t?e=n.next:e=n.prev,i=new rr,i.next=null,i.y=e.botY,i.leftBound=null,i.rightBound=e,e.windDelta=0,n=this.ProcessBound(e,t),this.InsertLocalMinima(i)),n}if(e.dx==-9007199254740992&&(t?o=e.prev:o=e.next,o.outIdx!=-2&&(o.dx==-9007199254740992?o.botX!=e.botX&&o.topX!=e.botX&&this.ReverseHorizontal(e):o.botX!=e.botX&&this.ReverseHorizontal(e))),o=e,t){for(;n.topY==n.next.botY&&n.next.outIdx!=-2;)n=n.next;if(n.dx==-9007199254740992&&n.next.outIdx!=-2){for(s=n;s.prev.dx==-9007199254740992;)s=s.prev;s.prev.topX==n.next.topX?t||(n=s.prev):s.prev.topX>n.next.topX&&(n=s.prev)}for(;e!=n;)e.nextInLML=e.next,e.dx==-9007199254740992&&e!=o&&e.botX!=e.prev.topX&&this.ReverseHorizontal(e),e=e.next;e.dx==-9007199254740992&&e!=o&&e.botX!=e.prev.topX&&this.ReverseHorizontal(e),n=n.next}else{for(;n.topY==n.prev.botY&&n.prev.outIdx!=-2;)n=n.prev;if(n.dx==-9007199254740992&&n.prev.outIdx!=-2){for(s=n;s.next.dx==-9007199254740992;)s=s.next;s.next.topX==n.prev.topX?t||(n=s.next):s.next.topX>n.prev.topX&&(n=s.next)}for(;e!=n;)e.nextInLML=e.prev,e.dx==-9007199254740992&&e!=o&&e.botX!=e.next.topX&&this.ReverseHorizontal(e),e=e.prev;e.dx==-9007199254740992&&e!=o&&e.botX!=e.next.topX&&this.ReverseHorizontal(e),n=n.prev}return n},ReverseHorizontal:function(e){var t=e.topX;e.topX=e.botX,e.botX=t},Pt2IsBetweenPt1AndPt3:function(e,t,n){return!(e.x==n.x&&e.y==n.y||e.x==t.x&&e.y==t.y||n.x==t.x&&n.y==t.y)&&(e.x!=n.x?t.x>e.x==t.x<n.x:t.y>e.y==t.y<n.y)},SetDx:function(e){e.deltaX=e.topX-e.botX,e.deltaY=e.topY-e.botY,e.deltaY==0?e.dx=-9007199254740992:e.dx=e.deltaX/e.deltaY},InsertLocalMinima:function(e){if(this.m_MinimaList==null)this.m_MinimaList=e;else if(e.y>=this.m_MinimaList.y)e.next=this.m_MinimaList,this.m_MinimaList=e;else{for(var t=this.m_MinimaList;t.next!=null&&e.y<t.next.y;)t=t.next;e.next=t.next,t.next=e}},PopLocalMinima:function(){if(this.m_CurrentLM==null)return;this.m_CurrentLM=this.m_CurrentLM.next},SwapX:function(e){e.currX=e.topX,e.topX=e.botX,e.botX=e.currX},equals:function(e,t){return e.x==t.x&&e.y==t.y},Reset:function(){this.m_CurrentLM=this.m_MinimaList;for(var e,t=this.m_MinimaList;t!=null;)e=t.leftBound,e!=null&&(e.currX=e.botX,e.currY=e.botY,e.side=Ct.Left,e.outIdx=-1,e=e.nextInLML),e=t.rightBound,e!=null&&(e.currX=e.botX,e.currY=e.botY,e.side=Ct.Right,e.outIdx=-1,e=e.nextInLML),t=t.next},__class__:yn},Co=_["hxd.clipper.NodeType"]={__ename__:!0,__constructs__:null,Any:{_hx_name:"Any",_hx_index:0,__enum__:"hxd.clipper.NodeType",toString:s},Open:{_hx_name:"Open",_hx_index:1,__enum__:"hxd.clipper.NodeType",toString:s},Closed:{_hx_name:"Closed",_hx_index:2,__enum__:"hxd.clipper.NodeType",toString:s}},Co.__constructs__=[Co.Any,Co.Open,Co.Closed],Co.__empty_constructs__=[Co.Any,Co.Open,Co.Closed],Ot=_["hxd.clipper.ResultKind"]={__ename__:!0,__constructs__:null,All:{_hx_name:"All",_hx_index:0,__enum__:"hxd.clipper.ResultKind",toString:s},NoHoles:{_hx_name:"NoHoles",_hx_index:1,__enum__:"hxd.clipper.ResultKind",toString:s},HolesOnly:{_hx_name:"HolesOnly",_hx_index:2,__enum__:"hxd.clipper.ResultKind",toString:s}},Ot.__constructs__=[Ot.All,Ot.NoHoles,Ot.HolesOnly],Ot.__empty_constructs__=[Ot.All,Ot.NoHoles,Ot.HolesOnly],Ve=function(){yn.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=[],this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=[],this.m_Joins=[],this.m_GhostJoins=[],this.reverseSolution=!1,this.strictlySimple=!1,this.preserveCollinear=!1,this.resultKind=Ot.All},c["hxd.clipper.Clipper"]=Ve,Ve.__name__="hxd.clipper.Clipper",Ve.compareY=function(e,t){return t.pt.y-e.pt.y>=0?1:-1},Ve.Orientation=function(e){return Ve.polArea(e)>=0},Ve.polArea=function(e){var t,n,o,i,a,s=e.length;if(s<3)return 0;for(o=0,t=s-1,i=0,a=s;i<a;)n=i++,o+=(e[t].x+e[n].x)*(e[t].y-e[n].y),t=n;return-o*.5},Ve.SimplifyPolygon=function(e,t){t==null&&(t=ee.EvenOdd);var n=new Ve;return n.strictlySimple=!0,n.addPolygon(e,we.Subject),n.execute(Ze.Union,t,t)},Ve.SimplifyPolygons=function(e,t){t==null&&(t=ee.EvenOdd);var n=new Ve;return n.strictlySimple=!0,n.addPolygons(e,we.Subject),n.execute(Ze.Union,t,t)},Ve.MinkowskiSums=function(e,t,n){var o,i,a,r,c,s=new Ve;for(s.resultKind=n??Ot.All,o=0,a=t.length;o<a;)i=o++,r=s.Minkowski(e,t[i],!0),s.addPolygons(r,we.Subject),c=s.TranslatePath(t[i],e[0]),s.addPolygon(c,we.Clip);return s.execute(Ze.Union,ee.NonZero,ee.NonZero)},Ve.MinkowskiDiff=function(e,t,n){var s=new Ve,o=s.Minkowski(e,t,!1);return s.resultKind=n??Ot.All,s.addPolygons(o,we.Subject),s.execute(Ze.Union,ee.NonZero,ee.NonZero)},Ve.__super__=yn,Ve.prototype=g(yn.prototype,{xor:function(e,t){return e?!t:t},DisposeScanbeamList:function(){for(;this.m_Scanbeam!=null;){var e=this.m_Scanbeam.next;this.m_Scanbeam=null,this.m_Scanbeam=e}},Reset:function(){yn.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var e=this.m_MinimaList;e!=null;)this.InsertScanbeam(e.y),e=e.next},InsertScanbeam:function(e){if(this.m_Scanbeam==null)this.m_Scanbeam=new Ui,this.m_Scanbeam.next=null,this.m_Scanbeam.y=e;else if(e>this.m_Scanbeam.y){var t,n=new Ui;n.y=e,n.next=this.m_Scanbeam,this.m_Scanbeam=n}else{for(t=this.m_Scanbeam;t.next!=null&&e<=t.next.y;)t=t.next;if(e==t.y)return;n=new Ui,n.y=e,n.next=t.next,t.next=n}},execute:function(e,t,n){if(t==null&&(t=ee.EvenOdd),n==null&&(n=ee.EvenOdd),this.m_ExecuteLocked)return[];this.m_ExecuteLocked=!0;var o,s=[];return this.m_SubjFillType=t,this.m_ClipFillType=n,this.m_ClipType=e,this.m_UsingPolyTree=!1,o=this.ExecuteInternal(),o&&(s=this.BuildResult()),this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1,s},ExecuteTree:function(e,t,n,s){if(n==null&&(n=ee.EvenOdd),s==null&&(s=ee.EvenOdd),this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=n,this.m_ClipFillType=s,this.m_ClipType=e,this.m_UsingPolyTree=!0;var o=this.ExecuteInternal();return o&&this.BuildResult2(t),this.m_ExecuteLocked=!1,o},FixHoleLinkage:function(e){if(e.firstLeft==null||e.isHole!=e.firstLeft.isHole&&e.firstLeft.pts!=null)return;for(var t=e.firstLeft;t!=null&&(t.isHole==e.isHole||t.pts==null);)t=t.firstLeft;e.firstLeft=t},ExecuteInternal:function(){if(this.Reset(),this.m_CurrentLM==null)return!1;var e,t,n,s,o,i=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(i),this.m_GhostJoins.length>0&&(this.m_GhostJoins=[]),this.ProcessHorizontals(!1),this.m_Scanbeam==null)break;if(s=this.PopScanbeam(),!this.ProcessIntersections(s))return!1;this.ProcessEdgesAtTopOfScanbeam(s),i=s}while(this.m_Scanbeam!=null||this.m_CurrentLM!=null)for(e=0,n=this.m_PolyOuts;e<n.length;){if(t=n[e],++e,t.pts==null)continue;o=this.reverseSolution,(t.isHole?!o:o)==this.Area(t)>0&&this.ReversePolyPtLinks(t.pts)}for(this.JoinCommonEdges(),e=0,n=this.m_PolyOuts;e<n.length;)t=n[e],++e,t.pts!=null&&this.FixupOutPolygon(t);return this.strictlySimple&&this.DoSimplePolygons(),this.m_Joins=[],this.m_GhostJoins=[],!0},PopScanbeam:function(){var e=this.m_Scanbeam.y;return this.m_Scanbeam=this.m_Scanbeam.next,e},DisposeAllPolyPts:function(){for(var t,e=0,n=this.m_PolyOuts.length;e<n;)t=e++,this.DisposeOutRec(t);this.m_PolyOuts=[]},DisposeOutRec:function(e){var t=this.m_PolyOuts[e];t.pts=null,t=null,this.m_PolyOuts[e]=null},AddJoin:function(e,t,n){var s=new cr;s.outPt1=e,s.outPt2=t,s.offPt=n,this.m_Joins.push(s)},AddGhostJoin:function(e,t){var n=new cr;n.outPt1=e,n.offPt=t,this.m_GhostJoins.push(n)},InsertLocalMinimaIntoAEL:function(e){for(;this.m_CurrentLM!=null&&this.m_CurrentLM.y==e;){var s,o,i,a,r,c,l,d,u,h,m,t=this.m_CurrentLM.leftBound,n=this.m_CurrentLM.rightBound;if(this.PopLocalMinima(),s=null,t==null?(this.InsertEdgeIntoAEL(n),this.SetWindingCount(n),this.IsContributing(n)&&(s=this.AddOutPt(n,new E(n.botX,n.botY)))):n==null?(this.InsertEdgeIntoAEL(t),this.SetWindingCount(t),this.IsContributing(t)&&(s=this.AddOutPt(t,new E(t.botX,t.botY))),this.InsertScanbeam(t.topY)):(this.InsertEdgeIntoAEL(t),this.InsertEdgeIntoAEL(n,t),this.SetWindingCount(t),n.windCnt=t.windCnt,n.windCnt2=t.windCnt2,this.IsContributing(t)&&(s=this.AddLocalMinPoly(t,n,new E(t.botX,t.botY))),this.InsertScanbeam(t.topY)),n!=null&&(n.deltaY==0?this.AddEdgeToSEL(n):this.InsertScanbeam(n.topY)),t==null||n==null)continue;if(s!=null&&n.deltaY==0&&this.m_GhostJoins.length>0&&n.windDelta!=0)for(a=0,u=this.m_GhostJoins;a<u.length;)i=u[a],++a,this.HorzSegmentsOverlap(i.outPt1.pt.x,i.offPt.x,n.botX,n.topX)&&this.AddJoin(i.outPt1,s,i.offPt);if(t.outIdx>=0&&t.prevInAEL!=null&&t.prevInAEL.currX==t.botX&&t.prevInAEL.outIdx>=0?(c=t.prevInAEL,r=c.deltaY*t.deltaX==c.deltaX*t.deltaY):r=!1,r&&t.windDelta!=0&&t.prevInAEL.windDelta!=0&&(h=this.AddOutPt(t.prevInAEL,new E(t.botX,t.botY)),this.AddJoin(s,h,new E(t.topX,t.topY))),t.nextInAEL!=n&&(n.outIdx>=0&&n.prevInAEL.outIdx>=0?(d=n.prevInAEL,l=d.deltaY*n.deltaX==d.deltaX*n.deltaY):l=!1,l&&n.windDelta!=0&&n.prevInAEL.windDelta!=0&&(m=this.AddOutPt(n.prevInAEL,new E(n.botX,n.botY)),this.AddJoin(s,m,new E(n.topX,n.topY))),o=t.nextInAEL,o!=null))for(;o!=n;)this.IntersectEdges(n,o,new E(t.currX,t.currY)),o=o.nextInAEL}},InsertEdgeIntoAEL:function(e,t){if(this.m_ActiveEdges==null)e.prevInAEL=null,e.nextInAEL=null,this.m_ActiveEdges=e;else if(t==null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,e))e.prevInAEL=null,e.nextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.prevInAEL=e,this.m_ActiveEdges=e;else{for(t==null&&(t=this.m_ActiveEdges);t.nextInAEL!=null&&!this.E2InsertsBeforeE1(t.nextInAEL,e);)t=t.nextInAEL;e.nextInAEL=t.nextInAEL,t.nextInAEL!=null&&(t.nextInAEL.prevInAEL=e),e.prevInAEL=t,t.nextInAEL=e}},E2InsertsBeforeE1:function(e,t){if(t.currX==e.currX){if(t.topY>e.topY){var n,s,o=t.topY;return o==e.topY?s=e.topX:(n=e.dx*(o-e.botY),s=e.botX+(n<0?n-.5|0:n+.5|0)),t.topX<s}return o=e.topY,o==t.topY?s=t.topX:(n=t.dx*(o-t.botY),s=t.botX+(n<0?n-.5|0:n+.5|0)),e.topX>s}else return t.currX<e.currX},IsEvenOddFillType:function(e){return e.polyType==we.Subject?this.m_SubjFillType==ee.EvenOdd:this.m_ClipFillType==ee.EvenOdd},IsEvenOddAltFillType:function(e){return e.polyType==we.Subject?this.m_ClipFillType==ee.EvenOdd:this.m_SubjFillType==ee.EvenOdd},IsContributing:function(e){switch(e.polyType==we.Subject?(n=this.m_SubjFillType,t=this.m_ClipFillType):(n=this.m_ClipFillType,t=this.m_SubjFillType),n._hx_index){case 0:if(e.windDelta==0&&e.windCnt!=1)return!1;break;case 1:var t,n,s=e.windCnt;if((s<0?-s:s)!=1)return!1;break;case 2:if(e.windCnt!=1)return!1;break;default:if(e.windCnt!=-1)return!1}switch(this.m_ClipType._hx_index){case 0:switch(t._hx_index){case 0:case 1:return e.windCnt2!=0;case 2:return e.windCnt2>0;default:return e.windCnt2<0}break;case 1:switch(t._hx_index){case 0:case 1:return e.windCnt2==0;case 2:return e.windCnt2<=0;default:return e.windCnt2>=0}break;case 2:if(e.polyType==we.Subject)switch(t._hx_index){case 0:case 1:return e.windCnt2==0;case 2:return e.windCnt2<=0;default:return e.windCnt2>=0}else switch(t._hx_index){case 0:case 1:return e.windCnt2!=0;case 2:return e.windCnt2>0;default:return e.windCnt2<0}break;case 3:if(e.windDelta==0)switch(t._hx_index){case 0:case 1:return e.windCnt2==0;case 2:return e.windCnt2<=0;default:return e.windCnt2>=0}else return!0;break}},SetWindingCount:function(e){for(var n,s,t=e.prevInAEL;t!=null&&(t.polyType!=e.polyType||t.windDelta==0);)t=t.prevInAEL;if(t==null)e.windCnt=e.windDelta==0?1:e.windDelta,e.windCnt2=0,t=this.m_ActiveEdges;else if(e.windDelta==0&&this.m_ClipType!=Ze.Union)e.windCnt=1,e.windCnt2=t.windCnt2,t=t.nextInAEL;else if(e.polyType==we.Subject?this.m_SubjFillType==ee.EvenOdd:this.m_ClipFillType==ee.EvenOdd){if(e.windDelta==0){for(s=!0,n=t.prevInAEL;n!=null;)n.polyType==t.polyType&&n.windDelta!=0&&(s=!s),n=n.prevInAEL;e.windCnt=s?0:1}else e.windCnt=e.windDelta;e.windCnt2=t.windCnt2,t=t.nextInAEL}else t.windCnt*t.windDelta<0?t.windCnt>1||t.windCnt<-1?t.windDelta*e.windDelta<0?e.windCnt=t.windCnt:e.windCnt=t.windCnt+e.windDelta:e.windCnt=e.windDelta==0?1:e.windDelta:e.windDelta==0?e.windCnt=t.windCnt<0?t.windCnt-1:t.windCnt+1:t.windDelta*e.windDelta<0?e.windCnt=t.windCnt:e.windCnt=t.windCnt+e.windDelta,e.windCnt2=t.windCnt2,t=t.nextInAEL;if(e.polyType==we.Subject?this.m_ClipFillType==ee.EvenOdd:this.m_SubjFillType==ee.EvenOdd)for(;t!=e;)t.windDelta!=0&&(e.windCnt2=e.windCnt2==0?1:0),t=t.nextInAEL;else for(;t!=e;)e.windCnt2+=t.windDelta,t=t.nextInAEL},AddEdgeToSEL:function(e){this.m_SortedEdges==null?(this.m_SortedEdges=e,e.prevInSEL=null,e.nextInSEL=null):(e.nextInSEL=this.m_SortedEdges,e.prevInSEL=null,this.m_SortedEdges.prevInSEL=e,this.m_SortedEdges=e)},CopyAELToSEL:function(){var e=this.m_ActiveEdges;for(this.m_SortedEdges=e;e!=null;)e.prevInSEL=e.prevInAEL,e.nextInSEL=e.nextInAEL,e=e.nextInAEL},SwapPositionsInAEL:function(e,t){if(e.nextInAEL==e.prevInAEL||t.nextInAEL==t.prevInAEL)return;if(e.nextInAEL==t){var n,s=t.nextInAEL;s!=null&&(s.prevInAEL=e),n=e.prevInAEL,n!=null&&(n.nextInAEL=t),t.prevInAEL=n,t.nextInAEL=e,e.prevInAEL=t,e.nextInAEL=s}else t.nextInAEL==e?(s=e.nextInAEL,s!=null&&(s.prevInAEL=t),n=t.prevInAEL,n!=null&&(n.nextInAEL=e),e.prevInAEL=n,e.nextInAEL=t,t.prevInAEL=e,t.nextInAEL=s):(s=e.nextInAEL,n=e.prevInAEL,e.nextInAEL=t.nextInAEL,e.nextInAEL!=null&&(e.nextInAEL.prevInAEL=e),e.prevInAEL=t.prevInAEL,e.prevInAEL!=null&&(e.prevInAEL.nextInAEL=e),t.nextInAEL=s,t.nextInAEL!=null&&(t.nextInAEL.prevInAEL=t),t.prevInAEL=n,t.prevInAEL!=null&&(t.prevInAEL.nextInAEL=t));e.prevInAEL==null?this.m_ActiveEdges=e:t.prevInAEL==null&&(this.m_ActiveEdges=t)},SwapPositionsInSEL:function(e,t){if(e.nextInSEL==null&&e.prevInSEL==null)return;if(t.nextInSEL==null&&t.prevInSEL==null)return;if(e.nextInSEL==t){var n,s=t.nextInSEL;s!=null&&(s.prevInSEL=e),n=e.prevInSEL,n!=null&&(n.nextInSEL=t),t.prevInSEL=n,t.nextInSEL=e,e.prevInSEL=t,e.nextInSEL=s}else t.nextInSEL==e?(s=e.nextInSEL,s!=null&&(s.prevInSEL=t),n=t.prevInSEL,n!=null&&(n.nextInSEL=e),e.prevInSEL=n,e.nextInSEL=t,t.prevInSEL=e,t.nextInSEL=s):(s=e.nextInSEL,n=e.prevInSEL,e.nextInSEL=t.nextInSEL,e.nextInSEL!=null&&(e.nextInSEL.prevInSEL=e),e.prevInSEL=t.prevInSEL,e.prevInSEL!=null&&(e.prevInSEL.nextInSEL=e),t.nextInSEL=s,t.nextInSEL!=null&&(t.nextInSEL.prevInSEL=t),t.prevInSEL=n,t.prevInSEL!=null&&(t.prevInSEL.nextInSEL=t));e.prevInSEL==null?this.m_SortedEdges=e:t.prevInSEL==null&&(this.m_SortedEdges=t)},AddLocalMaxPoly:function(e,t,n){this.AddOutPt(e,n),t.windDelta==0&&this.AddOutPt(t,n),e.outIdx==t.outIdx?(e.outIdx=-1,t.outIdx=-1):e.outIdx<t.outIdx?this.AppendPolygon(e,t):this.AppendPolygon(t,e)},AddLocalMinPoly:function(e,t,n){if(t.deltaY==0||e.dx>t.dx?(r=this.AddOutPt(e,n),t.outIdx=e.outIdx,e.side=Ct.Left,t.side=Ct.Right,s=e,s.prevInAEL==t?o=t.prevInAEL:o=s.prevInAEL):(r=this.AddOutPt(t,n),e.outIdx=t.outIdx,e.side=Ct.Right,t.side=Ct.Left,s=t,s.prevInAEL==e?o=e.prevInAEL:o=s.prevInAEL),o!=null&&o.outIdx>=0){var s,o,i,r,c,l,d,u,a=n.y;a==o.topY?l=o.topX:(i=o.dx*(a-o.botY),l=o.botX+(i<0?i-.5|0:i+.5|0)),a=n.y,a==s.topY?d=s.topX:(i=s.dx*(a-s.botY),d=s.botX+(i<0?i-.5|0:i+.5|0)),c=l==d}else c=!1;return c&&s.deltaY*o.deltaX==s.deltaX*o.deltaY&&s.windDelta!=0&&o.windDelta!=0&&(u=this.AddOutPt(o,n),this.AddJoin(r,u,new E(s.topX,s.topY))),r},CreateOutRec:function(){var e=new gr;return e.idx=-1,e.isHole=!1,e.firstLeft=null,e.pts=null,e.bottomPt=null,e.polyNode=null,this.m_PolyOuts.push(e),e.idx=this.m_PolyOuts.length-1,e},AddOutPt:function(e,t){var n,s,o,i,a,r=e.side==Ct.Left;return e.outIdx<0?(o=this.CreateOutRec(),n=new ci,o.pts=n,n.idx=o.idx,n.pt=new E(t.x,t.y),n.next=n,n.prev=n,this.SetHoleState(e,o),e.outIdx=o.idx,n):(o=this.m_PolyOuts[e.outIdx],n=o.pts,r?(a=n.pt,i=t.x==a.x&&t.y==a.y):i=!1,i?n:(r?i=!1:(a=n.prev.pt,i=t.x==a.x&&t.y==a.y),i?n.prev:(s=new ci,s.idx=o.idx,s.pt=new E(t.x,t.y),s.next=n,s.prev=n.prev,s.prev.next=s,n.prev=s,r&&(o.pts=s),s)))},HorzSegmentsOverlap:function(e,t,n,s){if(e>t){var o=e;e=t,t=o}return n>s&&(o=n,n=s,s=o),e<s&&n<t},SetHoleState:function(e,t){for(var s=!1,n=e.prevInAEL;n!=null;)n.outIdx>=0&&n.windDelta!=0&&(s=!s,t.firstLeft==null&&(t.firstLeft=this.m_PolyOuts[n.outIdx])),n=n.prevInAEL;s&&(t.isHole=!0)},GetDx:function(e,t){return e.y==t.y?-9007199254740992:(t.x-e.x)/(t.y-e.y)},FirstIsBottomPt:function(e,t){for(var s,o,i,a,r,c,l,n=e.prev;!0;){if(o=n.pt,i=e.pt,!(o.x==i.x&&o.y==i.y&&n!=e))break;n=n.prev}for(s=this.GetDx(e.pt,n.pt),a=s<0?-s:s,n=e.next;!0;){if(o=n.pt,i=e.pt,!(o.x==i.x&&o.y==i.y&&n!=e))break;n=n.next}for(s=this.GetDx(e.pt,n.pt),r=s<0?-s:s,n=t.prev;!0;){if(o=n.pt,i=t.pt,!(o.x==i.x&&o.y==i.y&&n!=t))break;n=n.prev}for(s=this.GetDx(t.pt,n.pt),c=s<0?-s:s,n=t.next;!0;){if(o=n.pt,i=t.pt,!(o.x==i.x&&o.y==i.y&&n!=t))break;n=n.next}return s=this.GetDx(t.pt,n.pt),l=s<0?-s:s,a>=c&&a>=l||r>=c&&r>=l},GetBottomPt:function(e){for(var s,o,i,n=null,t=e.next;t!=e;)t.pt.y>e.pt.y?(e=t,n=null):t.pt.y==e.pt.y&&t.pt.x<=e.pt.x&&(t.pt.x<e.pt.x?(n=null,e=t):t.next!=e&&t.prev!=e&&(n=t)),t=t.next;if(n!=null)for(i=0;n!=t;)for(this.FirstIsBottomPt(t,n)||(e=n),n=n.next;!0;){if(s=n.pt,o=e.pt,s.x==o.x&&s.y==o.y)break;n=n.next}return e},GetLowermostRec:function(e,t){e.bottomPt==null&&(e.bottomPt=this.GetBottomPt(e.pts)),t.bottomPt==null&&(t.bottomPt=this.GetBottomPt(t.pts));var n=e.bottomPt,s=t.bottomPt;return n.pt.y>s.pt.y?e:n.pt.y<s.pt.y?t:n.pt.x<s.pt.x?e:n.pt.x>s.pt.x?t:n.next==n?t:s.next==s?e:this.FirstIsBottomPt(n,s)?e:t},Param1RightOfParam2:function(e,t){do if(e=e.firstLeft,e==t)return!0;while(e!=null)return!1},GetOutRec:function(e){for(var t=this.m_PolyOuts[e];t!=this.m_PolyOuts[t.idx];)t=this.m_PolyOuts[t.idx];return t},AppendPolygon:function(e,t){var o,i,a,r,c,l,d,u,h,n=this.m_PolyOuts[e.outIdx],s=this.m_PolyOuts[t.outIdx];for(this.Param1RightOfParam2(n,s)?l=s:this.Param1RightOfParam2(s,n)?l=n:l=this.GetLowermostRec(n,s),i=n.pts,r=i.prev,o=s.pts,a=o.prev,e.side==Ct.Left?(t.side==Ct.Left?(this.ReversePolyPtLinks(o),o.next=i,i.prev=o,r.next=a,a.prev=r,n.pts=a):(a.next=i,i.prev=a,o.prev=r,r.next=o,n.pts=o),d=Ct.Left):(t.side==Ct.Right?(this.ReversePolyPtLinks(o),r.next=a,a.prev=r,o.next=i,i.prev=o):(r.next=o,o.prev=r,i.prev=a,a.next=i),d=Ct.Right),n.bottomPt=null,l==s&&(s.firstLeft!=n&&(n.firstLeft=s.firstLeft),n.isHole=s.isHole),s.pts=null,s.bottomPt=null,s.firstLeft=n,u=e.outIdx,h=t.outIdx,e.outIdx=-1,t.outIdx=-1,c=this.m_ActiveEdges;c!=null;){if(c.outIdx==h){c.outIdx=u,c.side=d;break}c=c.nextInAEL}s.idx=n.idx},ReversePolyPtLinks:function(e){if(e==null)return;var n,t=e;do n=t.next,t.next=t.prev,t.prev=n,t=n;while(t!=e)},SwapSides:function(e,t){var n=e.side;e.side=t.side,t.side=n},SwapPolyIndexes:function(e,t){var n=e.outIdx;e.outIdx=t.outIdx,t.outIdx=n},IntersectEdges:function(e,t,n){var s,o,i,a,r,c,l,d,u,h,f,m=e.outIdx>=0,p=t.outIdx>=0;switch(e.polyType==t.polyType?(e.polyType==we.Subject?this.m_SubjFillType==ee.EvenOdd:this.m_ClipFillType==ee.EvenOdd)?(f=e.windCnt,e.windCnt=t.windCnt,t.windCnt=f):(e.windCnt+t.windDelta==0?e.windCnt=-e.windCnt:e.windCnt+=t.windDelta,t.windCnt-e.windDelta==0?t.windCnt=-t.windCnt:t.windCnt-=e.windDelta):((t.polyType==we.Subject?this.m_SubjFillType==ee.EvenOdd:this.m_ClipFillType==ee.EvenOdd)?e.windCnt2=e.windCnt2==0?1:0:e.windCnt2+=t.windDelta,(e.polyType==we.Subject?this.m_SubjFillType==ee.EvenOdd:this.m_ClipFillType==ee.EvenOdd)?t.windCnt2=t.windCnt2==0?1:0:t.windCnt2-=e.windDelta),e.polyType==we.Subject?(l=this.m_SubjFillType,u=this.m_ClipFillType):(l=this.m_ClipFillType,u=this.m_SubjFillType),t.polyType==we.Subject?(h=this.m_SubjFillType,d=this.m_ClipFillType):(h=this.m_ClipFillType,d=this.m_SubjFillType),l._hx_index){case 2:o=e.windCnt;break;case 3:o=-e.windCnt;break;default:s=e.windCnt,o=s<0?-s:s}switch(h._hx_index){case 2:i=t.windCnt;break;case 3:i=-t.windCnt;break;default:s=t.windCnt,i=s<0?-s:s}if(m&&p)o!=0&&o!=1||i!=0&&i!=1||e.polyType!=t.polyType&&this.m_ClipType!=Ze.Xor?this.AddLocalMaxPoly(e,t,n):(this.AddOutPt(e,n),this.AddOutPt(t,n),a=e.side,e.side=t.side,t.side=a,this.SwapPolyIndexes(e,t));else if(m)(i==0||i==1)&&(this.AddOutPt(e,n),a=e.side,e.side=t.side,t.side=a,this.SwapPolyIndexes(e,t));else if(p)(o==0||o==1)&&(this.AddOutPt(t,n),a=e.side,e.side=t.side,t.side=a,this.SwapPolyIndexes(e,t));else if((o==0||o==1)&&(i==0||i==1)){switch(u._hx_index){case 2:c=e.windCnt2;break;case 3:c=-e.windCnt2;break;default:s=e.windCnt2,c=s<0?-s:s}switch(d._hx_index){case 2:r=t.windCnt2;break;case 3:r=-t.windCnt2;break;default:s=t.windCnt2,r=s<0?-s:s}if(e.polyType!=t.polyType)this.AddLocalMinPoly(e,t,n);else if(o==1&&i==1)switch(this.m_ClipType._hx_index){case 0:c>0&&r>0&&this.AddLocalMinPoly(e,t,n);break;case 1:c<=0&&r<=0&&this.AddLocalMinPoly(e,t,n);break;case 2:(e.polyType==we.Clip&&c>0&&r>0||e.polyType==we.Subject&&c<=0&&r<=0)&&this.AddLocalMinPoly(e,t,n);break;case 3:this.AddLocalMinPoly(e,t,n);break}else a=e.side,e.side=t.side,t.side=a}},DeleteFromAEL:function(e){var n=e.prevInAEL,t=e.nextInAEL;if(n==null&&t==null&&e!=this.m_ActiveEdges)return;n!=null?n.nextInAEL=t:this.m_ActiveEdges=t,t!=null&&(t.prevInAEL=n),e.nextInAEL=null,e.prevInAEL=null},DeleteFromSEL:function(e){var n=e.prevInSEL,t=e.nextInSEL;if(n==null&&t==null&&e!=this.m_SortedEdges)return;n!=null?n.nextInSEL=t:this.m_SortedEdges=t,t!=null&&(t.prevInSEL=n),e.nextInSEL=null,e.prevInSEL=null},UpdateEdgeIntoAEL:function(e){if(e.nextInLML==null)throw t.thrown("UpdateEdgeIntoAEL: invalid call");var n=e.prevInAEL,s=e.nextInAEL;return e.nextInLML.outIdx=e.outIdx,n!=null?n.nextInAEL=e.nextInLML:this.m_ActiveEdges=e.nextInLML,s!=null&&(s.prevInAEL=e.nextInLML),e.nextInLML.side=e.side,e.nextInLML.windDelta=e.windDelta,e.nextInLML.windCnt=e.windCnt,e.nextInLML.windCnt2=e.windCnt2,e=e.nextInLML,e.currX=e.botX,e.currY=e.botY,e.prevInAEL=n,e.nextInAEL=s,e.deltaY!=0&&this.InsertScanbeam(e.topY),e},GetHorzDirection:function(e){return e.botX<e.topX?{left:e.botX,right:e.topX,dir:lt.LeftToRight}:{left:e.topX,right:e.botX,dir:lt.RightToLeft}},ProcessHorizontals:function(e){for(var t=this.m_SortedEdges;t!=null;)this.DeleteFromSEL(t),this.ProcessHorizontal(t,e),t=this.m_SortedEdges},ProcessHorizontal:function(e,t){for(var n,s,o,i,c,l,u,p,g,v,h=this.GetHorzDirection(e),a=h.dir,f=h.left,m=h.right,r=e,d=null;r.nextInLML!=null&&r.nextInLML.deltaY==0;)r=r.nextInLML;for(r.nextInLML==null&&(d=this.GetMaximaPair(r));!0;){for(p=e==r,n=a==lt.LeftToRight?e.nextInAEL:e.prevInAEL;n!=null;){if(n.currX==e.topX&&e.nextInLML!=null&&n.dx<e.nextInLML.dx)break;if(s=a==lt.LeftToRight?n.nextInAEL:n.prevInAEL,a==lt.LeftToRight&&n.currX<=m||a==lt.RightToLeft&&n.currX>=f){if(n==d&&p){if(e.outIdx>=0){for(c=this.AddOutPt(e,new E(e.topX,e.topY)),o=this.m_SortedEdges;o!=null;)o.outIdx>=0&&this.HorzSegmentsOverlap(e.botX,e.topX,o.botX,o.topX)&&(l=this.AddOutPt(o,new E(o.botX,o.botY)),this.AddJoin(l,c,new E(o.topX,o.topY))),o=o.nextInSEL;this.AddGhostJoin(c,new E(e.botX,e.botY)),this.AddLocalMaxPoly(e,d,new E(e.topX,e.topY))}this.DeleteFromAEL(e),this.DeleteFromAEL(d);return}a==lt.LeftToRight?(g=new E(n.currX,e.currY),this.IntersectEdges(e,n,g)):(v=new E(n.currX,e.currY),this.IntersectEdges(n,e,v)),this.SwapPositionsInAEL(e,n)}else if(a==lt.LeftToRight&&n.currX>=m||a==lt.RightToLeft&&n.currX<=f)break;n=s}if(e.nextInLML!=null&&e.nextInLML.deltaY==0)e=this.UpdateEdgeIntoAEL(e),e.outIdx>=0&&this.AddOutPt(e,new E(e.botX,e.botY)),u=this.GetHorzDirection(e),a=u.dir,f=u.left,m=u.right;else break}if(e.nextInLML!=null)if(e.outIdx>=0){if(c=this.AddOutPt(e,new E(e.topX,e.topY)),t&&this.AddGhostJoin(c,new E(e.botX,e.botY)),e=this.UpdateEdgeIntoAEL(e),e.windDelta==0)return;i=e.prevInAEL,s=e.nextInAEL,i!=null&&i.currX==e.botX&&i.currY==e.botY&&i.windDelta!=0&&i.outIdx>=0&&i.currY>i.topY&&e.deltaY*i.deltaX==e.deltaX*i.deltaY?(l=this.AddOutPt(i,new E(e.botX,e.botY)),this.AddJoin(c,l,new E(e.topX,e.topY))):s!=null&&s.currX==e.botX&&s.currY==e.botY&&s.windDelta!=0&&s.outIdx>=0&&s.currY>s.topY&&e.deltaY*s.deltaX==e.deltaX*s.deltaY&&(l=this.AddOutPt(s,new E(e.botX,e.botY)),this.AddJoin(c,l,new E(e.topX,e.topY)))}else e=this.UpdateEdgeIntoAEL(e);else e.outIdx>=0&&this.AddOutPt(e,new E(e.topX,e.topY)),this.DeleteFromAEL(e)},GetNextInAEL:function(e,t){return t==lt.LeftToRight?e.nextInAEL:e.prevInAEL},IsMinima:function(e){return e!=null&&e.prev.nextInLML!=e&&e.next.nextInLML!=e},IsMaxima:function(e,t){return e!=null&&e.topY==t&&e.nextInLML==null},IsIntermediate:function(e,t){return e.topY==t&&e.nextInLML!=null},GetMaximaPair:function(e){var t=null;return e.next.topX==e.topX&&e.next.topY==e.topY&&e.next.nextInLML==null?t=e.next:e.prev.topX==e.topX&&e.prev.topY==e.topY&&e.prev.nextInLML==null&&(t=e.prev),t!=null&&(t.outIdx==-2||t.nextInAEL==t.prevInAEL&&t.deltaY!=0)?null:t},ProcessIntersections:function(e){if(this.m_ActiveEdges==null)return!0;if(this.BuildIntersectList(e),this.m_IntersectList.length==0)return!0;if(this.m_IntersectList.length==1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1;return this.m_SortedEdges=null,!0},BuildIntersectList:function(e){if(this.m_ActiveEdges==null)return;var n,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,k,t=this.m_ActiveEdges;for(this.m_SortedEdges=t;t!=null;)t.prevInSEL=t.prevInAEL,t.nextInSEL=t.nextInAEL,e==t.topY?k=t.topX:(i=t.dx*(e-t.botY),k=t.botX+(i<0?i-.5|0:i+.5|0)),t.currX=k,t=t.nextInAEL;for(m=!0;m&&this.m_SortedEdges!=null;){for(m=!1,t=this.m_SortedEdges;t.nextInSEL!=null;)n=t.nextInSEL,t.currX>n.currX?(t.dx==n.dx?(s=t.currY,s==t.topY?o=t.topX:(i=t.dx*(s-t.botY),o=t.botX+(i<0?i-.5|0:i+.5|0)),C=new E(o,s)):(t.deltaX==0?(o=t.botX,n.deltaY==0?s=n.botY:(r=n.botY-n.botX/n.dx,j=o/n.dx+r,s=j<0?j-.5|0:j+.5|0)):n.deltaX==0?(o=n.botX,t.deltaY==0?s=t.botY:(l=t.botY-t.botX/t.dx,h=o/t.dx+l,s=h<0?h-.5|0:h+.5|0)):(l=t.botX-t.botY*t.dx,r=n.botX-n.botY*n.dx,a=(r-l)/(t.dx-n.dx),s=a<0?a-.5|0:a+.5|0,f=t.dx,p=n.dx,(f<0?-f:f)<(p<0?-p:p)?(g=t.dx*a+l,o=g<0?g-.5|0:g+.5|0):(d=n.dx*a+r,o=d<0?d-.5|0:d+.5|0)),(s<t.topY||s<n.topY)&&(t.topY>n.topY?s=t.topY:s=n.topY,b=t.dx,u=n.dx,(b<0?-b:b)<(u<0?-u:u)?s==t.topY?o=t.topX:(y=t.dx*(s-t.botY),o=t.botX+(y<0?y-.5|0:y+.5|0)):s==n.topY?o=n.topX:(_=n.dx*(s-n.botY),o=n.botX+(_<0?_-.5|0:_+.5|0))),s>t.currY&&(s=t.currY,w=t.dx,O=n.dx,(w<0?-w:w)>(O<0?-O:O)?s==n.topY?o=n.topX:(x=n.dx*(s-n.botY),o=n.botX+(x<0?x-.5|0:x+.5|0)):s==t.topY?o=t.topX:(v=t.dx*(s-t.botY),o=t.botX+(v<0?v-.5|0:v+.5|0))),C=new E(o,s)),c=new br,c.edge1=t,c.edge2=n,c.pt=C,this.m_IntersectList.push(c),this.SwapPositionsInSEL(t,n),m=!0):t=n;if(t.prevInSEL!=null)t.prevInSEL.nextInSEL=null;else break}this.m_SortedEdges=null},EdgesAdjacent:function(e){return e.edge1.nextInSEL==e.edge2||e.edge1.prevInSEL==e.edge2},IntersectNodeSort:function(e,t){return t.pt.y-e.pt.y|0},FixupIntersectionOrder:function(){this.m_IntersectList.sort(Ve.compareY);var t,n,s,o,i,a,r,c,l,e=this.m_ActiveEdges;for(this.m_SortedEdges=e;e!=null;)e.prevInSEL=e.prevInAEL,e.nextInSEL=e.nextInAEL,e=e.nextInAEL;for(i=this.m_IntersectList.length,a=0,c=i;a<c;){if(t=a++,s=this.m_IntersectList[t],s.edge1.nextInSEL!=s.edge2&&s.edge1.prevInSEL!=s.edge2){for(n=t+1;!0;){if(n<i?(o=this.m_IntersectList[n],r=o.edge1.nextInSEL!=o.edge2&&o.edge1.prevInSEL!=o.edge2):r=!1,!r)break;++n}if(n==i)return!1;l=this.m_IntersectList[t],this.m_IntersectList[t]=this.m_IntersectList[n],this.m_IntersectList[n]=l}this.SwapPositionsInSEL(this.m_IntersectList[t].edge1,this.m_IntersectList[t].edge2)}return!0},ProcessIntersectList:function(){for(var e,n,t=0,s=this.m_IntersectList.length;t<s;)n=t++,e=this.m_IntersectList[n],this.IntersectEdges(e.edge1,e.edge2,e.pt),this.SwapPositionsInAEL(e.edge1,e.edge2);this.m_IntersectList=[]},Round:function(e){return e<0?e-.5|0:e+.5|0},TopX:function(e,t){if(t==e.topY)return e.topX;var n=e.dx*(t-e.botY);return e.botX+(n<0?n-.5|0:n+.5|0)},IntersectPoint:function(e,t){if(e.dx==t.dx){if(s=e.currY,s==e.topY)o=e.topX;else{var s,o,i,a,r,c,l,n=e.dx*(s-e.botY);o=e.botX+(n<0?n-.5|0:n+.5|0)}return new E(o,s)}return e.deltaX==0?(o=e.botX,t.deltaY==0?s=t.botY:(l=t.botY-t.botX/t.dx,n=o/t.dx+l,s=n<0?n-.5|0:n+.5|0)):t.deltaX==0?(o=t.botX,e.deltaY==0?s=e.botY:(c=e.botY-e.botX/e.dx,n=o/e.dx+c,s=n<0?n-.5|0:n+.5|0)):(c=e.botX-e.botY*e.dx,l=t.botX-t.botY*t.dx,r=(l-c)/(e.dx-t.dx),s=r<0?r-.5|0:r+.5|0,i=e.dx,a=t.dx,(i<0?-i:i)<(a<0?-a:a)?(n=e.dx*r+c,o=n<0?n-.5|0:n+.5|0):(n=t.dx*r+l,o=n<0?n-.5|0:n+.5|0)),(s<e.topY||s<t.topY)&&(e.topY>t.topY?s=e.topY:s=t.topY,i=e.dx,a=t.dx,(i<0?-i:i)<(a<0?-a:a)?s==e.topY?o=e.topX:(n=e.dx*(s-e.botY),o=e.botX+(n<0?n-.5|0:n+.5|0)):s==t.topY?o=t.topX:(n=t.dx*(s-t.botY),o=t.botX+(n<0?n-.5|0:n+.5|0))),s>e.currY&&(s=e.currY,i=e.dx,a=t.dx,(i<0?-i:i)>(a<0?-a:a)?s==t.topY?o=t.topX:(n=t.dx*(s-t.botY),o=t.botX+(n<0?n-.5|0:n+.5|0)):s==e.topY?o=e.topX:(n=e.dx*(s-e.botY),o=e.botX+(n<0?n-.5|0:n+.5|0))),new E(o,s)},ProcessEdgesAtTopOfScanbeam:function(e){for(var n,s,o,i,a,r,c,l,d,u,h,t=this.m_ActiveEdges;t!=null;)a=t!=null&&t.topY==e&&t.nextInLML==null,a&&(d=this.GetMaximaPair(t),a=d==null||d.deltaY!=0),a?(n=t.prevInAEL,this.DoMaxima(t),n==null?t=this.m_ActiveEdges:t=n.nextInAEL):(t.topY==e&&t.nextInLML!=null&&t.nextInLML.deltaY==0?(t=this.UpdateEdgeIntoAEL(t),t.outIdx>=0&&this.AddOutPt(t,new E(t.botX,t.botY)),this.AddEdgeToSEL(t)):(e==t.topY?u=t.topX:(r=t.dx*(e-t.botY),u=t.botX+(r<0?r-.5|0:r+.5|0)),t.currX=u,t.currY=e),this.strictlySimple&&(i=t.prevInAEL,t.outIdx>=0&&t.windDelta!=0&&i!=null&&i.outIdx>=0&&i.currX==t.currX&&i.windDelta!=0&&(c=new E(t.currX,t.currY),o=this.AddOutPt(i,c),l=this.AddOutPt(t,c),this.AddJoin(o,l,c))),t=t.nextInAEL);for(this.ProcessHorizontals(!0),t=this.m_ActiveEdges;t!=null;)t.topY==e&&t.nextInLML!=null&&(o=null,t.outIdx>=0&&(o=this.AddOutPt(t,new E(t.topX,t.topY))),t=this.UpdateEdgeIntoAEL(t),n=t.prevInAEL,s=t.nextInAEL,n!=null&&n.currX==t.botX&&n.currY==t.botY&&o!=null&&n.outIdx>=0&&n.currY>n.topY&&t.deltaY*n.deltaX==t.deltaX*n.deltaY&&t.windDelta!=0&&n.windDelta!=0?(l=this.AddOutPt(n,new E(t.botX,t.botY)),this.AddJoin(o,l,new E(t.topX,t.topY))):s!=null&&s.currX==t.botX&&s.currY==t.botY&&o!=null&&s.outIdx>=0&&s.currY>s.topY&&t.deltaY*s.deltaX==t.deltaX*s.deltaY&&t.windDelta!=0&&s.windDelta!=0&&(h=this.AddOutPt(s,new E(t.botX,t.botY)),this.AddJoin(o,h,new E(t.topX,t.topY)))),t=t.nextInAEL},DoMaxima:function(e){var s,n=this.GetMaximaPair(e);if(n==null){e.outIdx>=0&&this.AddOutPt(e,new E(e.topX,e.topY)),this.DeleteFromAEL(e);return}for(s=e.nextInAEL;s!=null&&s!=n;)this.IntersectEdges(e,s,new E(e.topX,e.topY)),this.SwapPositionsInAEL(e,s),s=e.nextInAEL;if(e.outIdx==-1&&n.outIdx==-1)this.DeleteFromAEL(e),this.DeleteFromAEL(n);else if(e.outIdx>=0&&n.outIdx>=0)e.outIdx>=0&&this.AddLocalMaxPoly(e,n,new E(e.topX,e.topY)),this.DeleteFromAEL(e),this.DeleteFromAEL(n);else throw t.thrown("DoMaxima error")},reversePolygons:function(e){for(var s,t=0,n=e,o=n.length;t<o;)s=n[t++],Ee.reverse(s)},PointCount:function(e){if(e==null)return 0;var n=0,t=e;do++n,t=t.next;while(t!=e)return n},BuildResult:function(){for(var e,t,s,o,i,a,l,d,r=[],n=0,c=this.m_PolyOuts;n<c.length;){if(e=c[n],++n,e.pts==null)continue;if(this.resultKind==Ot.NoHoles&&e.isHole)continue;if(this.resultKind==Ot.HolesOnly&&!e.isHole)continue;if(t=e.pts.prev,s=this.PointCount(t),s<2)continue;for(o=null,i=o??[],a=0,l=s;a<l;)d=a++,i.push(t.pt),t=t.prev;r.push(i)}return r},BuildResult2:function(e){e.clear();for(var t,o,i,a,r,c,l,n=0,s=this.m_PolyOuts;n<s.length;){if(t=s[n],++n,a=this.PointCount(t.pts),a<3)continue;for(this.FixHoleLinkage(t),o=new ls,e.allPolys.push(o),t.polyNode=o,i=t.pts.prev,r=0,c=a;r<c;)l=r++,o.polygon.push(i.pt),i=i.prev}for(n=0,s=this.m_PolyOuts;n<s.length;){if(t=s[n],++n,t.polyNode==null)continue;t.firstLeft!=null&&t.firstLeft.polyNode!=null?t.firstLeft.polyNode.addChild(t.polyNode):e.addChild(t.polyNode)}},FixupOutPolygon:function(e){var t,n,o,i,a,r,c,l,d,u,h,s=null;for(e.bottomPt=null,t=e.pts;!0;){if(t.prev==t||t.prev==t.next){e.pts=null;return}if(a=t.pt,r=t.next.pt,a.x==r.x&&a.y==r.y?i=!0:(c=t.pt,l=t.prev.pt,i=c.x==l.x&&c.y==l.y),i?o=!0:(d=t.prev.pt,n=t.pt,u=t.next.pt,o=(d.y-n.y)*(n.x-u.x)-(d.x-n.x)*(n.y-u.y)==0&&(!this.preserveCollinear||!this.Pt2IsBetweenPt1AndPt3(t.prev.pt,t.pt,t.next.pt))),o)s=null,h=t,t.prev.next=t.next,t.next.prev=t.prev,t=t.prev,h=null;else if(t==s)break;else s==null&&(s=t),t=t.next}e.pts=t},DupOutPt:function(e,t){var n=new ci;return n.pt=e.pt,n.idx=e.idx,t?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=e.prev,n.next=e,e.prev.next=n,e.prev=n),n},GetOverlap:function(e,t,n,s){var o,i;return e<t?n<s?(o=e<n?n:e,i=t>s?s:t):(o=e<s?s:e,i=t>n?n:t):n<s?(o=t<n?n:t,i=e>s?s:e):(o=t<s?s:t,i=e>n?n:e),{left:o,right:i,done:o<i}},JoinHorz:function(e,t,n,s,o,i){var a=e.pt.x>t.pt.x?lt.RightToLeft:lt.LeftToRight,r=n.pt.x>s.pt.x?lt.RightToLeft:lt.LeftToRight;if(a==r)return!1;if(a==lt.LeftToRight){for(;e.next.pt.x<=o.x&&e.next.pt.x>=e.pt.x&&e.next.pt.y==o.y;)e=e.next;i&&e.pt.x!=o.x&&(e=e.next),t=this.DupOutPt(e,!i),t.pt!=o&&(e=t,e.pt=o,t=this.DupOutPt(e,!i))}else{for(;e.next.pt.x>=o.x&&e.next.pt.x<=e.pt.x&&e.next.pt.y==o.y;)e=e.next;!i&&e.pt.x!=o.x&&(e=e.next),t=this.DupOutPt(e,i),t.pt!=o&&(e=t,e.pt=o,t=this.DupOutPt(e,i))}if(r==lt.LeftToRight){for(;n.next.pt.x<=o.x&&n.next.pt.x>=n.pt.x&&n.next.pt.y==o.y;)n=n.next;i&&n.pt.x!=o.x&&(n=n.next),s=this.DupOutPt(n,!i),s.pt!=o&&(n=s,n.pt=o,s=this.DupOutPt(n,!i))}else{for(;n.next.pt.x>=o.x&&n.next.pt.x<=n.pt.x&&n.next.pt.y==o.y;)n=n.next;!i&&n.pt.x!=o.x&&(n=n.next),s=this.DupOutPt(n,i),s.pt!=o&&(n=s,n.pt=o,s=this.DupOutPt(n,i))}return a==lt.LeftToRight==i?(e.prev=n,n.next=e,t.next=s,s.prev=t):(e.next=n,n.prev=e,t.prev=s,s.next=t),!0},JoinPoints:function(e,t,n){var s,o,r,c,l,d,u,h,m,f,p,g,v,b,j,y,i=e.outPt1,a=e.outPt2,_=e.outPt1.pt.y==e.offPt.y;if(_?(c=e.offPt,r=e.outPt1.pt,j=c.x==r.x&&c.y==r.y):j=!1,j?(c=e.offPt,r=e.outPt2.pt,l=c.x==r.x&&c.y==r.y):l=!1,l){if(t!=n)return!1;for(s=e.outPt1.next;!0;){if(s!=i?(c=s.pt,r=e.offPt,l=c.x==r.x&&c.y==r.y):l=!1,!l)break;s=s.next}for(b=s.pt.y>e.offPt.y,o=e.outPt2.next;!0;){if(o!=a?(c=o.pt,r=e.offPt,l=c.x==r.x&&c.y==r.y):l=!1,!l)break;o=o.next}return y=o.pt.y>e.offPt.y,b!=y&&(b?(s=this.DupOutPt(i,!1),o=this.DupOutPt(a,!0),i.prev=a,a.next=i,s.next=o,o.prev=s,e.outPt1=i,e.outPt2=s,!0):(s=this.DupOutPt(i,!0),o=this.DupOutPt(a,!1),i.next=a,a.prev=i,s.prev=o,o.next=s,e.outPt1=i,e.outPt2=s,!0))}else if(_){for(s=i;i.prev.pt.y==i.pt.y&&i.prev!=s&&i.prev!=a;)i=i.prev;for(;s.next.pt.y==s.pt.y&&s.next!=i&&s.next!=a;)s=s.next;if(s.next==i||s.next==a)return!1;for(o=a;a.prev.pt.y==a.pt.y&&a.prev!=o&&a.prev!=s;)a=a.prev;for(;o.next.pt.y==o.pt.y&&o.next!=a&&o.next!=i;)o=o.next;return o.next!=a&&o.next!=i&&(p=this.GetOverlap(i.pt.x,s.pt.x,a.pt.x,o.pt.x),!!p.done&&(f=p.left,g=p.right,i.pt.x>=f&&i.pt.x<=g?(m=i.pt,h=i.pt.x>s.pt.x):a.pt.x>=f&&a.pt.x<=g?(m=a.pt,h=a.pt.x>o.pt.x):s.pt.x>=f&&s.pt.x<=g?(m=s.pt,h=s.pt.x>i.pt.x):(m=o.pt,h=o.pt.x>a.pt.x),e.outPt1=i,e.outPt2=a,this.JoinHorz(i,s,a,o,m,h)))}else{for(s=i.next;!0;){if(c=s.pt,r=i.pt,!(c.x==r.x&&c.y==r.y&&s!=i))break;s=s.next}if(s.pt.y<=i.pt.y?(c=i.pt,r=s.pt,d=e.offPt,u=(c.y-r.y)*(r.x-d.x)-(c.x-r.x)*(r.y-d.y)!=0):u=!0,u){for(s=i.prev;!0;){if(c=s.pt,r=i.pt,!(c.x==r.x&&c.y==r.y&&s!=i))break;s=s.prev}if(s.pt.y<=i.pt.y?(c=i.pt,r=s.pt,d=e.offPt,l=(c.y-r.y)*(r.x-d.x)-(c.x-r.x)*(r.y-d.y)!=0):l=!0,l)return!1}for(o=a.next;!0;){if(c=o.pt,r=a.pt,!(c.x==r.x&&c.y==r.y&&o!=a))break;o=o.next}if(o.pt.y<=a.pt.y?(c=a.pt,r=o.pt,d=e.offPt,v=(c.y-r.y)*(r.x-d.x)-(c.x-r.x)*(r.y-d.y)!=0):v=!0,v){for(o=a.prev;!0;){if(c=o.pt,r=a.pt,!(c.x==r.x&&c.y==r.y&&o!=a))break;o=o.prev}if(o.pt.y<=a.pt.y?(c=a.pt,r=o.pt,d=e.offPt,l=(c.y-r.y)*(r.x-d.x)-(c.x-r.x)*(r.y-d.y)!=0):l=!0,l)return!1}return!(s==i||o==a||s==o||t==n&&u==v)&&(u?(s=this.DupOutPt(i,!1),o=this.DupOutPt(a,!0),i.prev=a,a.next=i,s.next=o,o.prev=s,e.outPt1=i,e.outPt2=s,!0):(s=this.DupOutPt(i,!0),o=this.DupOutPt(a,!1),i.next=a,a.prev=i,s.prev=o,o.next=s,e.outPt1=i,e.outPt2=s,!0))}},PointInPolygon:function(e,t){var n,s,a,r,c,l,d,o=0,i=t.length;if(i<3)return 0;for(s=t[0],a=1,d=i+1;a<d;){if(r=a++,n=r==i?t[0]:t[r],n.y==e.y&&(n.x==e.x||s.y==e.y&&n.x>e.x==s.x<e.x))return-1;if(s.y<e.y!=n.y<e.y)if(s.x>=e.x)if(n.x>e.x)o=1-o;else{if(c=(s.x-e.x)*(n.y-e.y)-(n.x-e.x)*(s.y-e.y),c==0)return-1;c>0==n.y>s.y&&(o=1-o)}else if(n.x>e.x){if(l=(s.x-e.x)*(n.y-e.y)-(n.x-e.x)*(s.y-e.y),l==0)return-1;l>0==n.y>s.y&&(o=1-o)}s=n}return o},PointInPolygon2:function(e,t){var o,i,l,d,a=0,u=t,n=e.x,s=e.y,c=t.pt.x,r=t.pt.y;do{if(t=t.next,o=t.pt.x,i=t.pt.y,i==s&&(o==n||r==s&&o>n==c<n))return-1;if(r<s!=i<s)if(c>=n)if(o>n)a=1-a;else{if(l=(c-n)*(i-s)-(o-n)*(r-s),l==0)return-1;l>0==i>r&&(a=1-a)}else if(o>n){if(d=(c-n)*(i-s)-(o-n)*(r-s),d==0)return-1;d>0==i>r&&(a=1-a)}c=o,r=i}while(u!=t)return a},Poly2ContainsPoly1:function(e,t){var s,n=e;do{if(s=this.PointInPolygon2(n.pt,t),s>=0)return s>0;n=n.next}while(n!=e)return!0},FixupFirstLefts1:function(e,t){for(var n,i,s=0,o=this.m_PolyOuts;s<o.length;){if(n=o[s],++s,n.pts==null||n.firstLeft==null)continue;i=this.ParseFirstLeft(n.firstLeft),i==e&&this.Poly2ContainsPoly1(n.pts,t.pts)&&(n.firstLeft=t)}},FixupFirstLefts2:function(e,t){for(var s,n=0,o=this.m_PolyOuts;n<o.length;)s=o[n],++n,s.firstLeft==e&&(s.firstLeft=t)},ParseFirstLeft:function(e){for(;e!=null&&e.pts==null;)e=e.firstLeft;return e},JoinCommonEdges:function(){for(var e,t,n,s,o,i,a,r,c,d,u,l=0,h=this.m_Joins.length;l<h;){if(c=l++,n=this.m_Joins[c],t=this.GetOutRec(n.outPt1.idx),e=this.GetOutRec(n.outPt2.idx),t.pts==null||e.pts==null)continue;if(t==e?s=t:this.Param1RightOfParam2(t,e)?s=e:this.Param1RightOfParam2(e,t)?s=t:s=this.GetLowermostRec(t,e),!this.JoinPoints(n,t,e))continue;if(t==e){if(t.pts=n.outPt1,t.bottomPt=null,e=this.CreateOutRec(),e.pts=n.outPt2,this.UpdateOutPtIdxs(e),this.m_UsingPolyTree)for(i=0,d=this.m_PolyOuts.length-1;i<d;){if(u=i++,o=this.m_PolyOuts[u],o.pts==null||this.ParseFirstLeft(o.firstLeft)!=t||o.isHole==t.isHole)continue;this.Poly2ContainsPoly1(o.pts,n.outPt2)&&(o.firstLeft=e)}this.Poly2ContainsPoly1(e.pts,t.pts)?(e.isHole=!t.isHole,e.firstLeft=t,this.m_UsingPolyTree&&this.FixupFirstLefts2(e,t),a=this.reverseSolution,(e.isHole?!a:a)==this.Area(e)>0&&this.ReversePolyPtLinks(e.pts)):this.Poly2ContainsPoly1(t.pts,e.pts)?(e.isHole=t.isHole,t.isHole=!e.isHole,e.firstLeft=t.firstLeft,t.firstLeft=e,this.m_UsingPolyTree&&this.FixupFirstLefts2(t,e),r=this.reverseSolution,(t.isHole?!r:r)==this.Area(t)>0&&this.ReversePolyPtLinks(t.pts)):(e.isHole=t.isHole,e.firstLeft=t.firstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(t,e))}else e.pts=null,e.bottomPt=null,e.idx=t.idx,t.isHole=s.isHole,s==e&&(t.firstLeft=e.firstLeft),e.firstLeft=t,this.m_UsingPolyTree&&this.FixupFirstLefts2(e,t)}},UpdateOutPtIdxs:function(e){var t=e.pts;do t.idx=e.idx,t=t.prev;while(t!=e.pts)},DoSimplePolygons:function(){for(var e,t,n,s,o,i,a,r,c=0;c<this.m_PolyOuts.length;){if(e=this.m_PolyOuts[c++],t=e.pts,t==null)continue;do{for(s=t.next;s!=e.pts;)o=t.pt,i=s.pt,o.x==i.x&&o.y==i.y&&s.next!=t&&s.prev!=t&&(a=t.prev,r=s.prev,t.prev=r,r.next=t,s.prev=a,a.next=s,e.pts=t,n=this.CreateOutRec(),n.pts=s,this.UpdateOutPtIdxs(n),this.Poly2ContainsPoly1(n.pts,e.pts)?(n.isHole=!e.isHole,n.firstLeft=e):this.Poly2ContainsPoly1(e.pts,n.pts)?(n.isHole=e.isHole,e.isHole=!n.isHole,n.firstLeft=e.firstLeft,e.firstLeft=n):(n.isHole=e.isHole,n.firstLeft=e.firstLeft),s=t),s=s.next;t=t.next}while(t!=e.pts)}},Area:function(e){var n,t=e.pts;if(t==null)return 0;n=0;do n+=(t.pt.x+t.prev.pt.x)*(t.prev.pt.y-t.pt.y),t=t.next;while(t!=e.pts)return n/2},DistanceFromLineSqrd:function(e,t,n){var s=t.y-n.y,o=n.x-t.x,i=s*t.x+o*t.y,i=s*e.x+o*e.y-i;return i*i/(s*s+o*o)},SlopesNearCollinear:function(e,t,n,s){var o=e.x-t.x,i=e.y-t.y;return(o<0?-o:o)>(i<0?-i:i)?e.x>t.x==e.x<n.x?this.DistanceFromLineSqrd(e,t,n)<s:t.x>e.x==t.x<n.x?this.DistanceFromLineSqrd(t,e,n)<s:this.DistanceFromLineSqrd(n,e,t)<s:e.y>t.y==e.y<n.y?this.DistanceFromLineSqrd(e,t,n)<s:t.y>e.y==t.y<n.y?this.DistanceFromLineSqrd(t,e,n)<s:this.DistanceFromLineSqrd(n,e,t)<s},PointsAreClose:function(e,t,n){var s=e.x-t.x,o=e.y-t.y;return s*s+o*o<=n},ExcludeOp:function(e){var t=e.prev;return t.next=e.next,e.next.prev=t,t.idx=0,t},CleanPolygon:function(e,t){t==null&&(t=1.415);var n,s,o,a,r,c,l,d,i=e.length;if(i==0)return a=null,a??[];for(s=[],r=0,c=i;r<c;)o=r++,s[o]=new ci,s[o].pt=e[o],s[o].next=s[(o+1)%i],s[o].next.prev=s[o],s[o].idx=0;for(l=t*t,n=s[0];n.idx==0&&n.next!=n.prev;)this.PointsAreClose(n.pt,n.prev.pt,l)?(n=this.ExcludeOp(n),--i):this.PointsAreClose(n.prev.pt,n.next.pt,l)?(this.ExcludeOp(n.next),n=this.ExcludeOp(n),i-=2):this.SlopesNearCollinear(n.prev.pt,n.pt,n.next.pt,l)?(n=this.ExcludeOp(n),--i):(n.idx=1,n=n.next);for(i<3&&(i=0),a=null,d=a??[],r=0,c=i;r<c;)o=r++,d.push(n.pt),n=n.next;return s=null,d},CleanPolygons:function(e,t){t==null&&(t=1.415);for(var i,n=null,s=n??[],o=0,a=e.length;o<a;)i=o++,s.push(this.CleanPolygon(e[i],t));return s},Minkowski:function(e,t,n){for(var s,o,a,r,h,m,f,p,v,b,j,y,c=e.length,i=t.length,u=null,d=u??[],l=0,g=i;l<g;){for(s=l++,a=null,m=a??[],b=0,v=e,j=v.length;b<j;)r=v[b++],n?m.push(new E(t[s].x+r.x,t[s].y+r.y)):m.push(new E(t[s].x-r.x,t[s].y-r.y));d.push(m)}for(u=null,p=u??[],l=0,g=i;l<g;)for(s=l++,f=0,y=c;f<y;)h=f++,a=null,o=a??[],o.push(d[s%i][h%c]),o.push(d[(s+1)%i][h%c]),o.push(d[(s+1)%i][(h+1)%c]),o.push(d[s%i][(h+1)%c]),Ve.polArea(o)>=0||Ee.reverse(o),p.push(o);return p},MinkowskiSum:function(e,t,n){var o=this.Minkowski(e,t,!0),s=new Ve;return s.resultKind=n??Ot.All,s.addPolygons(o,we.Subject),s.execute(Ze.Union,ee.NonZero,ee.NonZero)},TranslatePath:function(e,t){for(var n,s=null,o=s??[],i=0,a=e.length;i<a;)n=i++,o.push(new E(e[n].x+t.x,e[n].y+t.y));return o},PolyTreeToPaths:function(e){var t=null,n=t??[];return this.AddPolyNodeToPaths(e,Co.Any,n),n},AddPolyNodeToPaths:function(e,t,n){var s,o,i,a=!0;if(t._hx_index==1)return;for(e.polygon.length>0&&a&&n.push(e.polygon),s=0,o=e.childs;s<o.length;)i=o[s],++s,this.AddPolyNodeToPaths(i,t,n)},__class__:Ve}),ar=function(e,t){t==null&&(t=.25),e==null&&(e=2),this.two_pi=6.2831853071795862,this.def_arc_tolerance=.25,this.MiterLimit=e,this.ArcTolerance=t,this.m_lowest=new E(-1,0),this.m_normals=[],this.m_polyNodes=new ls,this.resultKind=Ot.All},c["hxd.clipper.ClipperOffset"]=ar,ar.__name__="hxd.clipper.ClipperOffset",ar.prototype={clear:function(){this.m_polyNodes=new ls,this.m_lowest=new E(-1,0)},addPolygon:function(e,t,n){var s,o,i,r,c,l,d,a=e.length-1;if(a<0)return;if(s=new ls,s.jointype=t,s.endtype=n,n==ye.ClosedLine||n==ye.ClosedPol)for(;a>0&&e[0]==e[a];)--a;for(s.polygon.push(e[0]),r=0,o=0,l=1,d=a+1;l<d;)i=l++,s.polygon[r]!=e[i]&&(++r,s.polygon.push(e[i]),(e[i].y>s.polygon[o].y||e[i].y==s.polygon[o].y&&e[i].x<s.polygon[o].x)&&(o=r));if(n==ye.ClosedPol&&r<2)return;if(this.m_polyNodes.addChild(s),n!=ye.ClosedPol)return;this.m_lowest.x<0?this.m_lowest=new E(this.m_polyNodes.childs.length-1,o):(c=this.m_polyNodes.childs[this.m_lowest.x].polygon[this.m_lowest.y],(s.polygon[o].y>c.y||s.polygon[o].y==c.y&&s.polygon[o].x<c.x)&&(this.m_lowest=new E(this.m_polyNodes.childs.length-1,o)))},addPolygons:function(e,t,n){for(var i,s=0,o=e,a=o.length;s<a;)i=o[s++],this.addPolygon(i,t,n)},fixOrientations:function(){if(this.m_lowest.x>=0&&!(Ve.polArea(this.m_polyNodes.childs[this.m_lowest.x].polygon)>=0))for(var e,t=0,n=this.m_polyNodes.childs;t<n.length;)e=n[t],++t,(e.endtype==ye.ClosedPol||e.endtype==ye.ClosedLine&&Ve.polArea(e.polygon)>=0)&&Ee.reverse(e.polygon);else for(t=0,n=this.m_polyNodes.childs;t<n.length;)e=n[t],++t,e.endtype==ye.ClosedLine&&!(Ve.polArea(e.polygon)>=0)&&Ee.reverse(e.polygon)},getUnitNormal:function(e,t){var s,i,a,r,n=t.x-e.x,o=t.y-e.y;return n==0&&o==0?new U(0,0):(s=0,s==null&&(s=0),r=1/Math.sqrt(n*n+o*o+s*s),n*=r,i=o*=r,a=-n,a==null&&(a=0),i==null&&(i=0),new U(i,a))},doOffset:function(e){var t,n,s,c,d,u,p,b,j,y,C,A,S,Y,de,w,O,H,W,K,ee,pe,i,a,se,ae,h,ce,Z,re,ge,m,g,x,q,X,J,ie,he,me,o,f,R,G,ue,v,_,k,M,F,T,z,D,N,L,P,B,fe,I,V,$,Q,ne,le,r,l,te,ve,oe=null;if(this.m_destPolys=oe??[],this.m_delta=e,e>-1e-20&&e<1e-20){for(d=0,u=this.m_polyNodes.childs;d<u.length;)n=u[d],++d,n.endtype==ye.ClosedPol&&this.m_destPolys.push(n.polygon);return}for(this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5,this.ArcTolerance<=0?c=this.def_arc_tolerance:this.ArcTolerance>(e<0?-e:e)*this.def_arc_tolerance?c=(e<0?-e:e)*this.def_arc_tolerance:c=this.ArcTolerance,p=3.14159265358979323/Math.acos(1-c/(e<0?-e:e))|0,this.m_sin=Math.sin(this.two_pi/p),this.m_cos=Math.cos(this.two_pi/p),this.m_StepsPerRad=p/this.two_pi,e<0&&(this.m_sin=-this.m_sin),d=0,u=this.m_polyNodes.childs;d<u.length;){if(n=u[d],++d,this.m_srcPoly=n.polygon,s=this.m_srcPoly.length,s==0||e<=0&&(s<3||n.endtype!=ye.ClosedPol))continue;if(W=null,this.m_destPoly=W??[],s==1){if(n.jointype==dn.Round)for(j=1,b=0,K=1,ee=p+1;K<ee;)pe=K++,this.m_destPoly.push(new E(Math.round(this.m_srcPoly[0].x+j*e),Math.round(this.m_srcPoly[0].y+b*e))),J=j,j=j*this.m_cos-this.m_sin*b,b=J*this.m_sin+b*this.m_cos;else i=-1,a=-1,this.m_destPoly.push(new E(Math.round(this.m_srcPoly[0].x+i*e),Math.round(this.m_srcPoly[0].y+a*e))),i<0?i=1:a<0?a=1:i=-1,this.m_destPoly.push(new E(Math.round(this.m_srcPoly[0].x+i*e),Math.round(this.m_srcPoly[0].y+a*e))),i<0?i=1:a<0?a=1:i=-1,this.m_destPoly.push(new E(Math.round(this.m_srcPoly[0].x+i*e),Math.round(this.m_srcPoly[0].y+a*e))),i<0?i=1:a<0?a=1:i=-1,this.m_destPoly.push(new E(Math.round(this.m_srcPoly[0].x+i*e),Math.round(this.m_srcPoly[0].y+a*e))),i<0?i=1:a<0?a=1:i=-1;this.m_destPolys.push(this.m_destPoly);continue}for(this.m_normals=[],X=0,ie=s-1;X<ie;)P=X++,this.m_normals.push(this.getUnitNormal(this.m_srcPoly[P],this.m_srcPoly[P+1]));if(n.endtype==ye.ClosedLine||n.endtype==ye.ClosedPol?this.m_normals.push(this.getUnitNormal(this.m_srcPoly[s-1],this.m_srcPoly[0])):this.m_normals.push(this.m_normals[s-2]),n.endtype==ye.ClosedPol){for(Q=s-1,H=0,se=s;H<se;)ae=H++,Q=this.offsetPoint(ae,Q,n.jointype);this.m_destPolys.push(this.m_destPoly)}else if(n.endtype==ye.ClosedLine){for(h=s-1,q=0,he=s;q<he;)me=q++,h=this.offsetPoint(me,h,n.jointype);for(this.m_destPolys.push(this.m_destPoly),$=null,this.m_destPoly=$??[],V=this.m_normals[s-1],f=s-1;f>0;)T=-this.m_normals[f-1].x,c=-this.m_normals[f-1].y,c==null&&(c=0),T==null&&(T=0),this.m_normals[f]=new U(T,c),--f;for(z=-V.x,D=-V.y,D==null&&(D=0),z==null&&(z=0),this.m_normals[0]=new U(z,D),h=0,N=s-1;N>0;)h=this.offsetPoint(N,h,n.jointype),--N;this.m_destPolys.push(this.m_destPoly)}else{for(o=0,B=1,ne=s-1;B<ne;)le=B++,o=this.offsetPoint(le,o,n.jointype);if(n.endtype==ye.OpenButt)r=s-1,l=new E(Math.round(this.m_srcPoly[r].x+this.m_normals[r].x*e),Math.round(this.m_srcPoly[r].y+this.m_normals[r].y*e)),this.m_destPoly.push(l),l=new E(Math.round(this.m_srcPoly[r].x-this.m_normals[r].x*e),Math.round(this.m_srcPoly[r].y-this.m_normals[r].y*e)),this.m_destPoly.push(l);else if(t=s-1,o=s-2,this.m_sinA=0,S=-this.m_normals[t].x,A=-this.m_normals[t].y,A==null&&(A=0),S==null&&(S=0),this.m_normals[t]=new U(S,A),n.endtype==ye.OpenSquare)y=Math.tan(Math.atan2(this.m_sinA,this.m_normals[o].x*this.m_normals[t].x+this.m_normals[o].y*this.m_normals[t].y)*.25),this.m_destPoly.push(new E(Math.round(this.m_srcPoly[t].x+this.m_delta*(this.m_normals[o].x-this.m_normals[o].y*y)),Math.round(this.m_srcPoly[t].y+this.m_delta*(this.m_normals[o].y+this.m_normals[o].x*y)))),this.m_destPoly.push(new E(Math.round(this.m_srcPoly[t].x+this.m_delta*(this.m_normals[t].x+this.m_normals[t].y*y)),Math.round(this.m_srcPoly[t].y+this.m_delta*(this.m_normals[t].y-this.m_normals[t].x*y))));else{for(C=Math.atan2(this.m_sinA,this.m_normals[o].x*this.m_normals[t].x+this.m_normals[o].y*this.m_normals[t].y),Y=Math.round(this.m_StepsPerRad*(C<0?-C:C)),de=Y<1?1:Y,O=this.m_normals[o].x,w=this.m_normals[o].y,Z=0,re=de;Z<re;)ge=Z++,this.m_destPoly.push(new E(Math.round(this.m_srcPoly[t].x+O*this.m_delta),Math.round(this.m_srcPoly[t].y+w*this.m_delta))),ce=O,O=O*this.m_cos-this.m_sin*w,w=ce*this.m_sin+w*this.m_cos;this.m_destPoly.push(new E(Math.round(this.m_srcPoly[t].x+this.m_normals[t].x*this.m_delta),Math.round(this.m_srcPoly[t].y+this.m_normals[t].y*this.m_delta)))}for(m=s-1;m>0;)k=-this.m_normals[m-1].x,x=-this.m_normals[m-1].y,x==null&&(x=0),k==null&&(k=0),this.m_normals[m]=new U(k,x),--m;for(M=-this.m_normals[1].x,F=-this.m_normals[1].y,F==null&&(F=0),M==null&&(M=0),this.m_normals[0]=new U(M,F),o=s-1,L=o-1;L>0;)o=this.offsetPoint(L,o,n.jointype),--L;if(n.endtype==ye.OpenButt)l=new E(Math.round(this.m_srcPoly[0].x-this.m_normals[0].x*e),Math.round(this.m_srcPoly[0].y-this.m_normals[0].y*e)),this.m_destPoly.push(l),l=new E(Math.round(this.m_srcPoly[0].x+this.m_normals[0].x*e),Math.round(this.m_srcPoly[0].y+this.m_normals[0].y*e)),this.m_destPoly.push(l);else if(o=1,this.m_sinA=0,n.endtype==ye.OpenSquare)g=Math.tan(Math.atan2(this.m_sinA,this.m_normals[1].x*this.m_normals[0].x+this.m_normals[1].y*this.m_normals[0].y)*.25),this.m_destPoly.push(new E(Math.round(this.m_srcPoly[0].x+this.m_delta*(this.m_normals[1].x-this.m_normals[1].y*g)),Math.round(this.m_srcPoly[0].y+this.m_delta*(this.m_normals[1].y+this.m_normals[1].x*g)))),this.m_destPoly.push(new E(Math.round(this.m_srcPoly[0].x+this.m_delta*(this.m_normals[0].x+this.m_normals[0].y*g)),Math.round(this.m_srcPoly[0].y+this.m_delta*(this.m_normals[0].y-this.m_normals[0].x*g))));else{for(R=Math.atan2(this.m_sinA,this.m_normals[1].x*this.m_normals[0].x+this.m_normals[1].y*this.m_normals[0].y),G=Math.round(this.m_StepsPerRad*(R<0?-R:R)),ue=G<1?1:G,v=this.m_normals[1].x,_=this.m_normals[1].y,I=0,te=ue;I<te;)ve=I++,this.m_destPoly.push(new E(Math.round(this.m_srcPoly[0].x+v*this.m_delta),Math.round(this.m_srcPoly[0].y+_*this.m_delta))),fe=v,v=v*this.m_cos-this.m_sin*_,_=fe*this.m_sin+_*this.m_cos;this.m_destPoly.push(new E(Math.round(this.m_srcPoly[0].x+this.m_normals[0].x*this.m_delta),Math.round(this.m_srcPoly[0].y+this.m_normals[0].y*this.m_delta)))}this.m_destPolys.push(this.m_destPoly)}}},execute:function(e){this.fixOrientations(),this.doOffset(e);var t,s,o,i,n=new Ve;return n.resultKind=this.resultKind,n.addPolygons(this.m_destPolys,we.Subject),e>0?n.execute(Ze.Union,ee.Positive,ee.Positive):(t=yn.getBounds(this.m_destPolys),i=null,s=i??[],s.push(new E(t.left-10,t.bottom+10)),s.push(new E(t.right+10,t.bottom+10)),s.push(new E(t.right+10,t.top-10)),s.push(new E(t.left-10,t.top-10)),n.addPolygon(s,we.Subject),n.reverseSolution=!0,o=n.execute(Ze.Union,ee.Negative,ee.Negative),o.length>0&&o.shift(),o)},offsetPoint:function(e,t,n){this.m_sinA=this.m_normals[t].x*this.m_normals[e].y-this.m_normals[e].x*this.m_normals[t].y;var s,o,i,a,r,c,l,d,u,m,f,p,g,v,b,j,h=this.m_sinA*this.m_delta;if((h<0?-h:h)<1){if(g=this.m_normals[t].x*this.m_normals[e].x+this.m_normals[e].y*this.m_normals[t].y,g>0)return this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+this.m_normals[t].x*this.m_delta),Math.round(this.m_srcPoly[e].y+this.m_normals[t].y*this.m_delta))),t}else this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1);if(this.m_sinA*this.m_delta<0)r=new E(Math.round(this.m_srcPoly[e].x+this.m_normals[t].x*this.m_delta),Math.round(this.m_srcPoly[e].y+this.m_normals[t].y*this.m_delta)),c=new E(Math.round(this.m_srcPoly[e].x+this.m_normals[e].x*this.m_delta),Math.round(this.m_srcPoly[e].y+this.m_normals[e].y*this.m_delta)),this.m_destPoly.push(r),s=r.x-c.x,u=r.y-c.y,s*s+u*u>1&&(this.m_destPoly.push(this.m_srcPoly[e]),this.m_destPoly.push(c));else switch(n._hx_index){case 0:s=Math.tan(Math.atan2(this.m_sinA,this.m_normals[t].x*this.m_normals[e].x+this.m_normals[t].y*this.m_normals[e].y)*.25),this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+this.m_delta*(this.m_normals[t].x-this.m_normals[t].y*s)),Math.round(this.m_srcPoly[e].y+this.m_delta*(this.m_normals[t].y+this.m_normals[t].x*s)))),this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+this.m_delta*(this.m_normals[e].x+this.m_normals[e].y*s)),Math.round(this.m_srcPoly[e].y+this.m_delta*(this.m_normals[e].y-this.m_normals[e].x*s))));break;case 1:for(a=Math.atan2(this.m_sinA,this.m_normals[t].x*this.m_normals[e].x+this.m_normals[t].y*this.m_normals[e].y),d=Math.round(this.m_StepsPerRad*(a<0?-a:a)),p=d<1?1:d,i=this.m_normals[t].x,o=this.m_normals[t].y,l=0,b=p;l<b;)j=l++,this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+i*this.m_delta),Math.round(this.m_srcPoly[e].y+o*this.m_delta))),v=i,i=i*this.m_cos-this.m_sin*o,o=v*this.m_sin+o*this.m_cos;this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+this.m_normals[e].x*this.m_delta),Math.round(this.m_srcPoly[e].y+this.m_normals[e].y*this.m_delta)));break;case 2:m=1+(this.m_normals[e].x*this.m_normals[t].x+this.m_normals[e].y*this.m_normals[t].y),m>=this.m_miterLim?(f=this.m_delta/m,this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+(this.m_normals[t].x+this.m_normals[e].x)*f),Math.round(this.m_srcPoly[e].y+(this.m_normals[t].y+this.m_normals[e].y)*f)))):(s=Math.tan(Math.atan2(this.m_sinA,this.m_normals[t].x*this.m_normals[e].x+this.m_normals[t].y*this.m_normals[e].y)*.25),this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+this.m_delta*(this.m_normals[t].x-this.m_normals[t].y*s)),Math.round(this.m_srcPoly[e].y+this.m_delta*(this.m_normals[t].y+this.m_normals[t].x*s)))),this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+this.m_delta*(this.m_normals[e].x+this.m_normals[e].y*s)),Math.round(this.m_srcPoly[e].y+this.m_delta*(this.m_normals[e].y-this.m_normals[e].x*s)))));break}return e},doSquare:function(e,t){var n=Math.tan(Math.atan2(this.m_sinA,this.m_normals[t].x*this.m_normals[e].x+this.m_normals[t].y*this.m_normals[e].y)*.25);this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+this.m_delta*(this.m_normals[t].x-this.m_normals[t].y*n)),Math.round(this.m_srcPoly[e].y+this.m_delta*(this.m_normals[t].y+this.m_normals[t].x*n)))),this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+this.m_delta*(this.m_normals[e].x+this.m_normals[e].y*n)),Math.round(this.m_srcPoly[e].y+this.m_delta*(this.m_normals[e].y-this.m_normals[e].x*n))))},doMiter:function(e,t,n){var s=this.m_delta/n;this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+(this.m_normals[t].x+this.m_normals[e].x)*s),Math.round(this.m_srcPoly[e].y+(this.m_normals[t].y+this.m_normals[e].y)*s)))},doRound:function(e,t){for(var a,d,o=Math.atan2(this.m_sinA,this.m_normals[t].x*this.m_normals[e].x+this.m_normals[t].y*this.m_normals[e].y),i=Math.round(this.m_StepsPerRad*(o<0?-o:o)),c=i<1?1:i,n=this.m_normals[t].x,s=this.m_normals[t].y,r=0,l=c;r<l;)d=r++,this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+n*this.m_delta),Math.round(this.m_srcPoly[e].y+s*this.m_delta))),a=n,n=n*this.m_cos-this.m_sin*s,s=a*this.m_sin+s*this.m_cos;this.m_destPoly.push(new E(Math.round(this.m_srcPoly[e].x+this.m_normals[e].x*this.m_delta),Math.round(this.m_srcPoly[e].y+this.m_normals[e].y*this.m_delta)))},__class__:ar},ye=_["hxd.clipper.EndType"]={__ename__:!0,__constructs__:null,ClosedPol:{_hx_name:"ClosedPol",_hx_index:0,__enum__:"hxd.clipper.EndType",toString:s},ClosedLine:{_hx_name:"ClosedLine",_hx_index:1,__enum__:"hxd.clipper.EndType",toString:s},OpenButt:{_hx_name:"OpenButt",_hx_index:2,__enum__:"hxd.clipper.EndType",toString:s},OpenSquare:{_hx_name:"OpenSquare",_hx_index:3,__enum__:"hxd.clipper.EndType",toString:s},OpenRound:{_hx_name:"OpenRound",_hx_index:4,__enum__:"hxd.clipper.EndType",toString:s}},ye.__constructs__=[ye.ClosedPol,ye.ClosedLine,ye.OpenButt,ye.OpenSquare,ye.OpenRound],ye.__empty_constructs__=[ye.ClosedPol,ye.ClosedLine,ye.OpenButt,ye.OpenSquare,ye.OpenRound],dn=_["hxd.clipper.JoinType"]={__ename__:!0,__constructs__:null,Square:{_hx_name:"Square",_hx_index:0,__enum__:"hxd.clipper.JoinType",toString:s},Round:{_hx_name:"Round",_hx_index:1,__enum__:"hxd.clipper.JoinType",toString:s},Miter:{_hx_name:"Miter",_hx_index:2,__enum__:"hxd.clipper.JoinType",toString:s}},dn.__constructs__=[dn.Square,dn.Round,dn.Miter],dn.__empty_constructs__=[dn.Square,dn.Round,dn.Miter],ee=_["hxd.clipper.PolyFillType"]={__ename__:!0,__constructs__:null,EvenOdd:{_hx_name:"EvenOdd",_hx_index:0,__enum__:"hxd.clipper.PolyFillType",toString:s},NonZero:{_hx_name:"NonZero",_hx_index:1,__enum__:"hxd.clipper.PolyFillType",toString:s},Positive:{_hx_name:"Positive",_hx_index:2,__enum__:"hxd.clipper.PolyFillType",toString:s},Negative:{_hx_name:"Negative",_hx_index:3,__enum__:"hxd.clipper.PolyFillType",toString:s}},ee.__constructs__=[ee.EvenOdd,ee.NonZero,ee.Positive,ee.Negative],ee.__empty_constructs__=[ee.EvenOdd,ee.NonZero,ee.Positive,ee.Negative],we=_["hxd.clipper.PolyType"]={__ename__:!0,__constructs__:null,Subject:{_hx_name:"Subject",_hx_index:0,__enum__:"hxd.clipper.PolyType",toString:s},Clip:{_hx_name:"Clip",_hx_index:1,__enum__:"hxd.clipper.PolyType",toString:s}},we.__constructs__=[we.Subject,we.Clip],we.__empty_constructs__=[we.Subject,we.Clip],Zr=function(e,t,n,s){s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.left=e,this.top=t,this.right=n,this.bottom=s},c["hxd.clipper.Rect"]=Zr,Zr.__name__="hxd.clipper.Rect",Zr.prototype={__class__:Zr},Vn=function(){},c["hxd.earcut.EarNode"]=Vn,Vn.__name__="hxd.earcut.EarNode",Vn.prototype={__class__:Vn},sc=function(){},c["hxd.earcut.Earcut"]=sc,sc.__name__="hxd.earcut.Earcut",sc.prototype={triangulate_anon_y_Float_x_Float:function(e,t){var n,o=t!=null&&t.length>0,s=o?t[0]:e.length;return s<3?[]:(n=this.setLinkedList_triangulate_T(e,0,s,!0),t!=null&&(n=this.eliminateHoles_triangulate_T(e,t,n)),this.triangulateNode(n,e.length>80))},eliminateHoles_triangulate_T:function(e,t,n){for(var o,a,r,c,l,i=[],s=0,d=t.length;s<d;)a=s++,r=t[a],c=a==t.length-1?e.length:t[a+1],o=this.setLinkedList_eliminateHoles_T(e,r,c,!1),o==o.next&&(o.steiner=!0),i.push(this.getLeftmost(o));for(i.sort(b(this,this.compareX)),s=0;s<i.length;)l=i[s],++s,this.eliminateHole(l,n),n=this.filterPoints(n,n.next);return n},setLinkedList_eliminateHoles_T:function(e,t,n,s){for(var o,i,a,r,l,d,u,p,f=0,h=n-1,c=t,m=n;c<m;)a=c++,f+=(e[h].x-e[a].x)*(e[a].y+e[h].y),h=a;if(l=null,o=this.cache,o==null?(o=new Vn,o.allocNext=this.allocated,this.allocated=o):this.cache=o.next,o.i=-1,o.z=-1,o.x=0,o.y=0,o.next=null,o.prev=l,o.steiner=!1,o.prevZ=null,o.nextZ=null,l!=null&&(l.next=o),i=o,p=i,s==f>0)for(c=t,m=n;c<m;)a=c++,r=e[a],d=r.x,u=r.y,o=this.cache,o==null?(o=new Vn,o.allocNext=this.allocated,this.allocated=o):this.cache=o.next,o.i=a,o.z=-1,o.x=d,o.y=u,o.next=null,o.prev=i,o.steiner=!1,o.prevZ=null,o.nextZ=null,i!=null&&(i.next=o),i=o;else for(a=n-1;a>=t;)r=e[a],d=r.x,u=r.y,o=this.cache,o==null?(o=new Vn,o.allocNext=this.allocated,this.allocated=o):this.cache=o.next,o.i=a,o.z=-1,o.x=d,o.y=u,o.next=null,o.prev=i,o.steiner=!1,o.prevZ=null,o.nextZ=null,i!=null&&(i.next=o),i=o,--a;return i.next=p.next,i.next.prev=i,i},setLinkedList_triangulate_T:function(e,t,n,s){for(var o,i,a,r,l,d,u,p,f=0,h=n-1,c=t,m=n;c<m;)a=c++,f+=(e[h].x-e[a].x)*(e[a].y+e[h].y),h=a;if(l=null,o=this.cache,o==null?(o=new Vn,o.allocNext=this.allocated,this.allocated=o):this.cache=o.next,o.i=-1,o.z=-1,o.x=0,o.y=0,o.next=null,o.prev=l,o.steiner=!1,o.prevZ=null,o.nextZ=null,l!=null&&(l.next=o),i=o,p=i,s==f>0)for(c=t,m=n;c<m;)a=c++,r=e[a],d=r.x,u=r.y,o=this.cache,o==null?(o=new Vn,o.allocNext=this.allocated,this.allocated=o):this.cache=o.next,o.i=a,o.z=-1,o.x=d,o.y=u,o.next=null,o.prev=i,o.steiner=!1,o.prevZ=null,o.nextZ=null,i!=null&&(i.next=o),i=o;else for(a=n-1;a>=t;)r=e[a],d=r.x,u=r.y,o=this.cache,o==null?(o=new Vn,o.allocNext=this.allocated,this.allocated=o):this.cache=o.next,o.i=a,o.z=-1,o.x=d,o.y=u,o.next=null,o.prev=i,o.steiner=!1,o.prevZ=null,o.nextZ=null,i!=null&&(i.next=o),i=o,--a;return i.next=p.next,i.next.prev=i,i},triangulateNode:function(e,t){if(this.triangles=[],e=this.filterPoints(e),t&&e!=null){var n,s,o,i,a,c,l,d,r=e.x;for(this.minX=r,o=e.y,this.minY=o,s=e.next;s!=e;)i=s.x,a=s.y,i<this.minX&&(this.minX=i),a<this.minY&&(this.minY=a),i>r&&(r=i),a>o&&(o=a),s=s.next;c=r-this.minX,l=o-this.minY,this.size=c<l?l:c,this.hasSize=!0}else this.hasSize=!1;if(this.earcutLinked(e),d=this.triangles,this.triangles=null,n=this.allocated,this.cache!=null){for(;n!=this.cache;)n=n.allocNext;n=n.allocNext}for(;n!=null;)n.next=this.cache,this.cache=n,n=n.allocNext;return d},eliminateHole:function(e,t){if(t=this.findHoleBridge(e,t),t!=null){var n=this.splitPolygon(t,e);this.filterPoints(n,n.next)}},findHoleBridge:function(e,t){var i,a,r,c,l,u,h,m,p,g,v,b,j,y,_,w,O,x,C,n=t,d=e.x,o=e.y,f=-(1/0),s=null;do o<=n.y&&o>=n.next.y&&(m=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y),m<=d&&m>f&&(f=m,s=n.x<n.next.x?n:n.next)),n=n.next;while(n!=t)if(s==null)return null;for(C=s,u=1/0,n=s.next;n!=C;)d>=n.x&&n.x>=s.x?(y=o<s.y?d:f,j=s.x,b=s.y,v=o<s.y?f:d,i=n.x,a=n.y,O=(v-i)*(o-a)-(y-i)*(o-a)>=0&&(y-i)*(b-a)-(j-i)*(o-a)>=0&&(j-i)*(o-a)-(v-i)*(b-a)>=0):O=!1,O&&(p=o-n.y,h=(p<0?-p:p)/(d-n.x),h<u||h==u&&n.x>s.x?(g=n.prev,_=n.next,(n.y-g.y)*(_.x-n.x)-(n.x-g.x)*(_.y-n.y)<0?(w=n.next,(e.y-n.y)*(w.x-e.x)-(e.x-n.x)*(w.y-e.y)>=0?(c=n.prev,r=(c.y-n.y)*(e.x-c.x)-(c.x-n.x)*(e.y-c.y)>=0):r=!1):(x=n.prev,(e.y-n.y)*(x.x-e.x)-(e.x-n.x)*(x.y-e.y)<0?r=!0:(l=n.next,r=(l.y-n.y)*(e.x-l.x)-(l.x-n.x)*(e.y-l.y)<0))):r=!1,r&&(s=n,u=h)),n=n.next;return s},getLeftmost:function(e){var t=e,n=e;do t.x<n.x&&(n=t),t=t.next;while(t!=e)return n},compareX:function(e,t){return e.x-t.x>0?1:-1},equals:function(e,t){return e.x==t.x&&e.y==t.y},area:function(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)},intersects:function(e,t,n,s){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)>0!=(t.y-e.y)*(s.x-t.x)-(t.x-e.x)*(s.y-t.y)>0&&(s.y-n.y)*(e.x-s.x)-(s.x-n.x)*(e.y-s.y)>0!=(s.y-n.y)*(t.x-s.x)-(s.x-n.x)*(t.y-s.y)>0},locallyInside:function(e,t){var n,o=e.prev,s=e.next;return(e.y-o.y)*(s.x-e.x)-(e.x-o.x)*(s.y-e.y)<0?(s=e.next,(t.y-e.y)*(s.x-t.x)-(t.x-e.x)*(s.y-t.y)>=0&&(n=e.prev,(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)>=0)):(s=e.prev,(t.y-e.y)*(s.x-t.x)-(t.x-e.x)*(s.y-t.y)<0||(n=e.next,(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)<0))},filterPoints:function(e,t){if(e==null)return e;t==null&&(t=e);var s,o,i,a,r,n=e;do if(o=!1,n.steiner?s=!1:(i=n.next,n.x==i.x&&n.y==i.y?s=!0:(a=n.prev,r=n.next,s=(n.y-a.y)*(r.x-n.x)-(n.x-a.x)*(r.y-n.y)==0)),s){if(n.next.prev=n.prev,n.prev.next=n.next,n.prevZ!=null&&(n.prevZ.nextZ=n.nextZ),n.nextZ!=null&&(n.nextZ.prevZ=n.prevZ),t=n.prev,n=t,n==n.next)return null;o=!0}else n=n.next;while(o||n!=t)return t},removeNode:function(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ!=null&&(e.prevZ.nextZ=e.nextZ),e.nextZ!=null&&(e.nextZ.prevZ=e.prevZ)},allocNode:function(e,t,n,s){var o=this.cache;return o==null?(o=new Vn,o.allocNext=this.allocated,this.allocated=o):this.cache=o.next,o.i=e,o.z=-1,o.x=t,o.y=n,o.next=null,o.prev=s,o.steiner=!1,o.prevZ=null,o.nextZ=null,s!=null&&(s.next=o),o},earcutLinked:function(e,t){if(t==null&&(t=0),e==null)return;t==0&&this.hasSize&&this.indexCurve(e);for(var n,o,s=e;e.prev!=e.next;){if(o=e.prev,n=e.next,this.hasSize?this.isEarHashed(e):this.isEar(e)){this.triangles.push(o.i),this.triangles.push(e.i),this.triangles.push(n.i),e.next.prev=e.prev,e.prev.next=e.next,e.prevZ!=null&&(e.prevZ.nextZ=e.nextZ),e.nextZ!=null&&(e.nextZ.prevZ=e.prevZ),e=n.next,s=n.next;continue}if(e=n,e==s){switch(t){case 0:this.earcutLinked(this.filterPoints(e),1);break;case 1:e=this.cureLocalIntersections(e),this.earcutLinked(e,2);break;case 2:this.splitEarcut(e);break}break}}},isEar:function(e){var t,n,s,r,c,l,d,u,h,m,f,p,i=e.prev,o=e,a=e.next;if((o.y-i.y)*(a.x-o.x)-(o.x-i.x)*(a.y-o.y)>=0)return!1;for(t=e.next.next;t!=e.prev;){if(h=i.x,r=i.y,c=o.x,l=o.y,d=a.x,u=a.y,s=t.x,n=t.y,(d-s)*(r-n)-(h-s)*(u-n)>=0&&(h-s)*(l-n)-(c-s)*(r-n)>=0&&(c-s)*(u-n)-(d-s)*(l-n)>=0?(f=t.prev,p=t.next,m=(t.y-f.y)*(p.x-t.x)-(t.x-f.x)*(p.y-t.y)>=0):m=!1,m)return!1;t=t.next}return!0},isEarHashed:function(e){var t,n,s,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,a=e.prev,i=e,o=e.next;if((i.y-a.y)*(o.x-i.x)-(i.x-a.x)*(o.y-i.y)>=0)return!1;for(w=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,_=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,j=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,O=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,n=32767*(w-this.minX)/this.size|0,s=32767*(_-this.minY)/this.size|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,x=n|s<<1,n=32767*(j-this.minX)/this.size|0,s=32767*(O-this.minY)/this.size|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,y=n|s<<1,t=e.nextZ;t!=null&&t.z<=y;){if(t!=e.prev&&t!=e.next?(p=a.x,g=a.y,v=i.x,h=i.y,u=o.x,b=o.y,c=t.x,r=t.y,l=(u-c)*(g-r)-(p-c)*(b-r)>=0&&(p-c)*(h-r)-(v-c)*(g-r)>=0&&(v-c)*(b-r)-(u-c)*(h-r)>=0):l=!1,l?(f=t.prev,m=t.next,d=(t.y-f.y)*(m.x-t.x)-(t.x-f.x)*(m.y-t.y)>=0):d=!1,d)return!1;t=t.nextZ}for(t=e.prevZ;t!=null&&t.z>=x;){if(t!=e.prev&&t!=e.next?(p=a.x,g=a.y,v=i.x,h=i.y,u=o.x,b=o.y,c=t.x,r=t.y,l=(u-c)*(g-r)-(p-c)*(b-r)>=0&&(p-c)*(h-r)-(v-c)*(g-r)>=0&&(v-c)*(b-r)-(u-c)*(h-r)>=0):l=!1,l?(f=t.prev,m=t.next,d=(t.y-f.y)*(m.x-t.x)-(t.x-f.x)*(m.y-t.y)>=0):d=!1,d)return!1;t=t.prevZ}return!0},cureLocalIntersections:function(e){var t,n,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,s=e;do n=s.prev,t=s.next.next,i=s.next,(s.y-n.y)*(i.x-s.x)-(s.x-n.x)*(i.y-s.y)>0!=(s.y-n.y)*(t.x-s.x)-(s.x-n.x)*(t.y-s.y)>0&&(t.y-i.y)*(n.x-t.x)-(t.x-i.x)*(n.y-t.y)>0!=(t.y-i.y)*(s.x-t.x)-(t.x-i.x)*(s.y-t.y)>0?(j=n.prev,b=n.next,(n.y-j.y)*(b.x-n.x)-(n.x-j.x)*(b.y-n.y)<0?(h=n.next,(t.y-n.y)*(h.x-t.x)-(t.x-n.x)*(h.y-t.y)>=0?(d=n.prev,r=(d.y-n.y)*(t.x-d.x)-(d.x-n.x)*(t.y-d.y)>=0):r=!1):(g=n.prev,(t.y-n.y)*(g.x-t.x)-(t.x-n.x)*(g.y-t.y)<0?r=!0:(c=n.next,r=(c.y-n.y)*(t.x-c.x)-(c.x-n.x)*(t.y-c.y)<0))):r=!1,r?(m=t.prev,f=t.next,(t.y-m.y)*(f.x-t.x)-(t.x-m.x)*(f.y-t.y)<0?(p=t.next,(n.y-t.y)*(p.x-n.x)-(n.x-t.x)*(p.y-n.y)>=0?(u=t.prev,a=(u.y-t.y)*(n.x-u.x)-(u.x-t.x)*(n.y-u.y)>=0):a=!1):(v=t.prev,(n.y-t.y)*(v.x-n.x)-(n.x-t.x)*(v.y-n.y)<0?a=!0:(l=t.next,a=(l.y-t.y)*(n.x-l.x)-(l.x-t.x)*(n.y-l.y)<0))):a=!1,a&&(this.triangles.push(n.i),this.triangles.push(s.i),this.triangles.push(t.i),s.next.prev=s.prev,s.prev.next=s.next,s.prevZ!=null&&(s.prevZ.nextZ=s.nextZ),s.nextZ!=null&&(s.nextZ.prevZ=s.prevZ),o=s.next,o.next.prev=o.prev,o.prev.next=o.next,o.prevZ!=null&&(o.prevZ.nextZ=o.nextZ),o.nextZ!=null&&(o.nextZ.prevZ=o.prevZ),e=t,s=e),s=s.next;while(s!=e)return s},splitEarcut:function(e){var n,s,t=e;do{for(n=t.next.next;n!=t.prev;){if(t.i!=n.i&&this.isValidDiagonal(t,n)){s=this.splitPolygon(t,n),t=this.filterPoints(t,t.next),s=this.filterPoints(s,s.next),this.earcutLinked(t),this.earcutLinked(s);return}n=n.next}t=t.next}while(t!=e)},splitPolygon:function(e,t){var o,i,l,d,a=e.i,r=e.x,c=e.y,s=null,n=this.cache;return n==null?(n=new Vn,n.allocNext=this.allocated,this.allocated=n):this.cache=n.next,n.i=a,n.z=-1,n.x=r,n.y=c,n.next=null,n.prev=s,n.steiner=!1,n.prevZ=null,n.nextZ=null,s!=null&&(s.next=n),i=n,a=t.i,r=t.x,c=t.y,s=null,n=this.cache,n==null?(n=new Vn,n.allocNext=this.allocated,this.allocated=n):this.cache=n.next,n.i=a,n.z=-1,n.x=r,n.y=c,n.next=null,n.prev=s,n.steiner=!1,n.prevZ=null,n.nextZ=null,s!=null&&(s.next=n),o=n,l=e.next,d=t.prev,e.next=t,t.prev=e,i.next=l,l.prev=i,o.next=i,i.prev=o,d.next=o,o.prev=d,o},pointInTriangle:function(e,t,n,s,o,i,a,r){return(o-a)*(t-r)-(e-a)*(i-r)>=0&&(e-a)*(s-r)-(n-a)*(t-r)>=0&&(n-a)*(i-r)-(o-a)*(s-r)>=0},isValidDiagonal:function(e,t){if(e.x==t.x&&e.y==t.y)return!0;if(e.next.i!=t.i&&e.prev.i!=t.i&&!this.intersectsPolygon(e,t)){var n,o,i,a=e.prev,s=e.next;(e.y-a.y)*(s.x-e.x)-(e.x-a.x)*(s.y-e.y)<0?(s=e.next,(t.y-e.y)*(s.x-t.x)-(t.x-e.x)*(s.y-t.y)>=0?(n=e.prev,i=(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)>=0):i=!1):(s=e.prev,(t.y-e.y)*(s.x-t.x)-(t.x-e.x)*(s.y-t.y)<0?i=!0:(n=e.next,i=(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)<0))}else i=!1;return i?(a=t.prev,s=t.next,(t.y-a.y)*(s.x-t.x)-(t.x-a.x)*(s.y-t.y)<0?(s=t.next,(e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y)>=0?(n=t.prev,o=(n.y-t.y)*(e.x-n.x)-(n.x-t.x)*(e.y-n.y)>=0):o=!1):(s=t.prev,(e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y)<0?o=!0:(n=t.next,o=(n.y-t.y)*(e.x-n.x)-(n.x-t.x)*(e.y-n.y)<0))):o=!1,!!o&&this.middleInside(e,t)},middleInside:function(e,t){var n=e,s=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do n.y>o!=n.next.y>o&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(s=!s),n=n.next;while(n!=e)return s},intersectsPolygon:function(e,t){var s,o,n=e;do{if(n.i!=e.i&&n.next.i!=e.i&&n.i!=t.i&&n.next.i!=t.i?(s=n.next,o=(s.y-n.y)*(e.x-s.x)-(s.x-n.x)*(e.y-s.y)>0!=(s.y-n.y)*(t.x-s.x)-(s.x-n.x)*(t.y-s.y)>0&&(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)>0!=(t.y-e.y)*(s.x-t.x)-(t.x-e.x)*(s.y-t.y)>0):o=!1,o)return!0;n=n.next}while(n!=e)return!1},zOrder:function(e,t){var n=32767*(e-this.minX)/this.size|0,s=32767*(t-this.minY)/this.size|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765;return n|s<<1},indexCurve:function(e){var n,s,t=e;do t.z<0&&(n=32767*(t.x-this.minX)/this.size|0,s=32767*(t.y-this.minY)/this.size|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t.z=n|s<<1),t.prevZ=t.prev,t.nextZ=t.next,t=t.next;while(t!=e)t.prevZ.nextZ=null,t.prevZ=null,this.sortLinked(t)},sortLinked:function(e){var t,n,s,o,i,a,r,l,d,u,c=1;do{for(n=e,e=null,o=null,r=0;n!=null;){for(++r,t=n,i=0,l=0,d=c;l<d;)if(u=l++,++i,t=t.nextZ,t==null)break;for(a=c;i>0||a>0&&t!=null;)i==0?(s=t,t=t.nextZ,--a):a==0||t==null?(s=n,n=n.nextZ,--i):n.z<=t.z?(s=n,n=n.nextZ,--i):(s=t,t=t.nextZ,--a),o!=null?o.nextZ=s:e=s,s.prevZ=o,o=s;n=t}o.nextZ=null,c*=2}while(r>1)return e},__class__:sc},ic=function(){},c["hxd.fmt.bfnt.FontParser"]=ic,ic.__name__="hxd.fmt.bfnt.FontParser",ic.parse=function(e,n,s){var ve,a,E,W,X,J,se,le,Te,b,y,ie,D,ee,h,p,v,C,Ee,he,_,Ae,d,x,Se,g,w,te,H,oe,B,$,Z,ne,de,j,ce,re,r,c,f,je,me,Ce,fe,ue,ae,A,S,L,R,ye,we,Oe,T,z,N,P,I,V,U,K,q,ke,F,Y,G,Q,pe,xe,Me,Fe,O,l=null,i=new Vi(null,0),m=i.glyphs;switch(i.baseLine=0,ve=e.getInt32(0),ve){case 54938946:for(a=new Nt(e),a.set_position(a.pos+4),E=0;a.pos<a.totlen;){switch(W=a.readByte(),J=a.readInt32(),X=a.pos,W){case 1:i.size=i.initSize=a.readInt16(),a.set_position(a.pos+12),i.name=a.readUntil(0);break;case 2:i.lineHeight=a.readUInt16(),i.baseLine=a.readUInt16(),a.set_position(a.pos+4),E=a.readUInt16(),E!=1&&be.trace("Warning: BMF format only supports one page at the moment.",{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:220,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"});break;case 3:se=a.readUntil(0);try{i.tilePath=se,l=s(ge.join([ge.directory(n),se]))}catch{be.trace('Warning: Could not find referenced font texture at "'+se+'", trying to resolve same name as fnt!',{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:26,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"}),i.tilePath=new ge(n).file+".png",l=s(ge.withExtension(n,"png"))}break;case 4:for(le=J/20|0;le>0;)Te=a.readInt32(),y=l.sub(a.readUInt16(),a.readUInt16(),a.readUInt16(),a.readUInt16(),a.readInt16(),a.readInt16()),b=new ts(y,a.readInt16()),m.h[Te]=b,a.set_position(a.pos+2),--le;break;case 5:for(ie=J/10|0;ie>0;)D=a.readInt32(),ee=a.readInt32(),C=m.h[ee],C!=null?C.addKerning(D,a.readInt16()):a.set_position(a.pos+2),--ie;break}a.set_position(X+J)}break;case 1414415938:return new ca(new Nt(e)).read(function(e){try{i.tilePath=e,l=s(ge.join([ge.directory(n),e]))}catch{be.trace('Warning: Could not find referenced font texture at "'+e+'", trying to resolve same name as fnt!',{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:26,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"}),i.tilePath=new ge(n).file+".png",l=s(ge.withExtension(n,"png"))}return l});case 1836597052:case 1852794428:if(h=k.parse(e.toString()),v=h.firstElement(),v.nodeType!=k.Document&&v.nodeType!=k.Element)throw t.thrown("Invalid nodeType "+(v.nodeType==null?"null":_e.toString(v.nodeType)));if(h=v,al.resolve(h,"info")){for(p=Ho.resolve(h,"info"),i.name=$e.resolve(p,"face"),p=$e.resolve(Ho.resolve(h,"info"),"size"),i.size=i.initSize=o.parseInt(p),p=$e.resolve(Ho.resolve(h,"common"),"lineHeight"),i.lineHeight=o.parseInt(p),p=$e.resolve(Ho.resolve(h,"common"),"base"),i.baseLine=o.parseInt(p),Ee=Ho.resolve(h,"pages").elements();Ee.hasNext();)if(he=Ee.next(),$e.resolve(he,"id")=="0"){_=$e.resolve(he,"file");try{i.tilePath=_,l=s(ge.join([ge.directory(n),_]))}catch{be.trace('Warning: Could not find referenced font texture at "'+_+'", trying to resolve same name as fnt!',{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:26,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"}),i.tilePath=new ge(n).file+".png",l=s(ge.withExtension(n,"png"))}}else be.trace("Warning: BMF format only supports one page at the moment.",{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:62,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"});for(Ae=Ho.resolve(h,"chars").elements(),x=Ae;x.hasNext();){for(d=x.next(),y=l.sub(o.parseInt($e.resolve(d,"x")),o.parseInt($e.resolve(d,"y")),o.parseInt($e.resolve(d,"width")),o.parseInt($e.resolve(d,"height")),o.parseInt($e.resolve(d,"xoffset")),o.parseInt($e.resolve(d,"yoffset"))),b=new ts(y,o.parseInt($e.resolve(d,"xadvance"))),Se=Ho.resolve(h,"kernings").elements(),g=Se;g.hasNext();)w=g.next(),$e.resolve(w,"second")==$e.resolve(d,"id")&&b.addKerning(o.parseInt($e.resolve(w,"first")),o.parseInt($e.resolve(w,"amount")));ee=o.parseInt($e.resolve(d,"id")),m.h[ee]=b}}else{for(i.tilePath=new ge(n).file+".png",l=s(ge.withExtension(n,"png")),i.name=$e.resolve(h,"family"),p=$e.resolve(h,"size"),i.size=i.initSize=o.parseInt(p),p=$e.resolve(h,"height"),i.lineHeight=o.parseInt(p),te=[],x=h.elements();x.hasNext();){for(d=x.next(),H=$e.resolve(d,"rect").split(" "),oe=$e.resolve(d,"offset").split(" "),y=l.sub(o.parseInt(H[0]),o.parseInt(H[1]),o.parseInt(H[2]),o.parseInt(H[3]),o.parseInt(oe[0]),o.parseInt(oe[1])),b=new ts(y,o.parseInt($e.resolve(d,"width"))),B=$e.resolve(d,"code"),Z=M.startsWith(B,"&#")?o.parseInt(u.substr(B,2,B.length-3)):u.cca(B,0),g=d.elements();g.hasNext();)w=g.next(),$=$e.resolve(w,"id"),ne=M.startsWith($,"&#")?o.parseInt(u.substr($,2,$.length-3)):u.cca($,0),de=o.parseInt($e.resolve(w,"advance")),m.h.hasOwnProperty(ne)?m.h[ne].addKerning(Z,de):te.push({prev:Z,next:ne,adv:de});m.h[Z]=b}for(j=0;j<te.length;){if(g=te[j],++j,ce=m.h[g.next],ce==null)continue;ce.addKerning(g.prev,g.adv)}}break;case 1868983913:for(re=e.toString().split(`
`),r=new Ss(' *?([0-9a-zA-Z]+)=("[^"]+"|.+?)(?:[ \r]|$)',""),E=0,j=0;j<re.length;)switch(f=re[j],++j,c=f.indexOf(" "),u.substr(f,0,c)){case"char":for(W=0,v=0,je=0,me=0,Ce=0,fe=0,ue=0,ae=0;c<f.length&&r.matchSub(f,c);){switch(r.matched(1)){case"height":S=r.matched(2),Ce=o.parseInt(u.cca(S,0)==34?S.substring(1,S.length-1):S);break;case"id":Q=r.matched(2),W=o.parseInt(u.cca(Q,0)==34?Q.substring(1,Q.length-1):Q);break;case"width":G=r.matched(2),me=o.parseInt(u.cca(G,0)==34?G.substring(1,G.length-1):G);break;case"x":Y=r.matched(2),v=o.parseInt(u.cca(Y,0)==34?Y.substring(1,Y.length-1):Y);break;case"xadvance":q=r.matched(2),ae=o.parseInt(u.cca(q,0)==34?q.substring(1,q.length-1):q);break;case"xoffset":K=r.matched(2),fe=o.parseInt(u.cca(K,0)==34?K.substring(1,K.length-1):K);break;case"y":U=r.matched(2),je=o.parseInt(u.cca(U,0)==34?U.substring(1,U.length-1):U);break;case"yoffset":A=r.matched(2),ue=o.parseInt(u.cca(A,0)==34?A.substring(1,A.length-1):A);break}X=r.matchedPos(),c=X.pos+X.len}y=l.sub(v,je,me,Ce,fe,ue),b=new ts(y,ae),m.h[W]=b;break;case"common":for(;c<f.length&&r.matchSub(f,c);){switch(r.matched(1)){case"base":V=r.matched(2),i.baseLine=o.parseInt(u.cca(V,0)==34?V.substring(1,V.length-1):V);break;case"lineHeight":I=r.matched(2),i.lineHeight=o.parseInt(u.cca(I,0)==34?I.substring(1,I.length-1):I);break;case"pages":P=r.matched(2),E=o.parseInt(u.cca(P,0)==34?P.substring(1,P.length-1):P),E!=1&&be.trace("Warning: BMF format only supports one page at the moment.",{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:153,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"});break}pe=r.matchedPos(),c=pe.pos+pe.len}break;case"info":for(;c<f.length&&r.matchSub(f,c);){switch(r.matched(1)){case"face":R=r.matched(2),i.name=u.cca(R,0)==34?R.substring(1,R.length-1):R;break;case"size":L=r.matched(2),i.size=i.initSize=o.parseInt(u.cca(L,0)==34?L.substring(1,L.length-1):L);break}ye=r.matchedPos(),c=ye.pos+ye.len}break;case"kerning":for(D=0,we=0,Oe=0;c<f.length&&r.matchSub(f,c);){switch(r.matched(1)){case"amount":N=r.matched(2),Oe=o.parseInt(u.cca(N,0)==34?N.substring(1,N.length-1):N);break;case"first":z=r.matched(2),D=o.parseInt(u.cca(z,0)==34?z.substring(1,z.length-1):z);break;case"second":T=r.matched(2),we=o.parseInt(u.cca(T,0)==34?T.substring(1,T.length-1):T);break}ke=r.matchedPos(),c=ke.pos+ke.len}C=m.h[we],C!=null&&C.addKerning(D,Oe);break;case"page":for(;c<f.length&&r.matchSub(f,c);){if(r.matched(1)=="file"){F=r.matched(2),_=u.cca(F,0)==34?F.substring(1,F.length-1):F;try{i.tilePath=_,l=s(ge.join([ge.directory(n),_]))}catch{be.trace('Warning: Could not find referenced font texture at "'+_+'", trying to resolve same name as fnt!',{fileName:"hxd/fmt/bfnt/FontParser.hx",lineNumber:26,className:"hxd.fmt.bfnt.FontParser",methodName:"parse"}),i.tilePath=new ge(n).file+".png",l=s(ge.withExtension(n,"png"))}}xe=r.matchedPos(),c=xe.pos+xe.len}break}break;default:throw Me=ve,t.thrown("Unknown font signature "+M.hex(Me,8))}return m.h[32]==null&&(Fe=new ts(l.sub(0,0,0,0),i.size>>1),m.h[32]=Fe),i.tile=l,i.baseLine==0&&(i.baseLine=i.calcBaseLine()),O=m.h[65533],O==null&&(O=m.h[9633]),O==null&&(O=m.h[63]),O!=null&&(i.defaultChar=O),i},ca=function(e){this.i=e},c["hxd.fmt.bfnt.Reader"]=ca,ca.__name__="hxd.fmt.bfnt.Reader",ca.parse=function(e,t){return new ca(new Nt(e)).read(t)},ca.prototype={read:function(e){if(this.i.readString(4)!="BFNT"||this.i.readByte()!=0)throw t.thrown("Not a BFNT file!");var s,o,i,r,c,l,d,n=null,a=this.i.readByte();if(a==1)for(n=new Vi(this.i.readString(this.i.readUInt16()),this.i.readInt16()),n.tilePath=this.i.readString(this.i.readUInt16()),r=n.tile=e(n.tilePath),n.lineHeight=this.i.readInt16(),n.baseLine=this.i.readInt16(),c=this.i.readInt32();!0;){if(s=this.i.readInt32(),s==0)break;for(l=r.sub(this.i.readUInt16(),this.i.readUInt16(),this.i.readUInt16(),this.i.readUInt16(),this.i.readInt16(),this.i.readInt16()),o=new ts(l,this.i.readInt16()),n.glyphs.h[s]=o,s==c&&(n.defaultChar=o);!0;){if(i=this.i.readInt32(),i==0)break;o.addKerning(i,this.i.readInt16())}}else throw d=a,t.thrown("Unknown BFNT version: "+d);return n},__class__:ca},Gc=function(){},c["hxd.fmt.hdr.Reader"]=Gc,Gc.__name__="hxd.fmt.hdr.Reader",Gc.decode=function(e,n){for(var i,a,r,c,l,d,h,m,f,p,g,v,b,j,y,O,x,E,k,S,M,F,T,z,D,N,L,R,P,C=new Nt(e),s=0,w=0,_=Object.create(null);!0;){if(y=C.readLine(),y=="")break;if(u.cca(y,0)==35)continue;j=y.split("="),j.length>1&&(_[j.shift()]=j.join("="))}for(E=C.readLine().split(" "),w=o.parseInt(E[1]),s=o.parseInt(E[3]),L=_.GAMMA=="1",m=new A(new ArrayBuffer(s*w*4*4)),O=1,M=_.EXPOSURE,M!=null&&(b=parseFloat(M),(b<1e-12||b<1e12)&&(O=b)),k=n?1:.45454545454545453,i=[],c=0;c<256;)d=c++,i.push(d**k);for(g=i,i=[],c=0;c<256;)d=c++,i.push((2**(d-128)/(256*O))**k);if(P=i,i=_.FORMAT,i==null)throw v=i,t.thrown("Unsupported HDR format "+v);if(i=="32-bit_rle_rgbe")for(r=C.pos,N=s*4,l=new A(new ArrayBuffer(N)),F=s>>8|(s&255)<<8,c=0,D=w;c<D;){if(T=c++,S=e.getInt32(r),(S&65535)!=514||S>>>16!=F)l.blit(0,e,r,s*4),r+=s*4;else for(r+=4,p=0,z=s*4;p<z;)h=e.b[r++],h>128?(h-=128,l.fill(p,h,e.b[r++])):(l.blit(p,e,r,h),r+=h),p+=h;for(a=T*s*16,x=0,R=s;x<R;)f=x++,d=P[l.b[f+s*3]],m.setFloat(a,g[l.b[f]]*d),a+=4,m.setFloat(a,g[l.b[f+s]]*d),a+=4,m.setFloat(a,g[l.b[f+(s<<1)]]*d),a+=4,m.setFloat(a,1),a+=4}else throw v=i,t.thrown("Unsupported HDR format "+v);return{width:s,height:w,bytes:m,gamma:L}},mt=_["hxd.fmt.hmd.Property"]={__ename__:!0,__constructs__:null,CameraFOVY:(a=function(e){return{_hx_index:0,v:e,__enum__:"hxd.fmt.hmd.Property",toString:s}},a._hx_name="CameraFOVY",a.__params__=["v"],a),Unused_HasMaterialFlags:{_hx_name:"Unused_HasMaterialFlags",_hx_index:1,__enum__:"hxd.fmt.hmd.Property",toString:s},HasExtraTextures:{_hx_name:"HasExtraTextures",_hx_index:2,__enum__:"hxd.fmt.hmd.Property",toString:s},FourBonesByVertex:{_hx_name:"FourBonesByVertex",_hx_index:3,__enum__:"hxd.fmt.hmd.Property",toString:s},HasLod:{_hx_name:"HasLod",_hx_index:4,__enum__:"hxd.fmt.hmd.Property",toString:s},HasCollider:{_hx_name:"HasCollider",_hx_index:5,__enum__:"hxd.fmt.hmd.Property",toString:s}},mt.__constructs__=[mt.CameraFOVY,mt.Unused_HasMaterialFlags,mt.HasExtraTextures,mt.FourBonesByVertex,mt.HasLod,mt.HasCollider],mt.__empty_constructs__=[mt.Unused_HasMaterialFlags,mt.HasExtraTextures,mt.FourBonesByVertex,mt.HasLod,mt.HasCollider],ua=function(){},c["hxd.fmt.hmd.Position"]=ua,ua.__name__="hxd.fmt.hmd.Position",ua.prototype={loadQuaternion:function(e){e.x=this.qx,e.y=this.qy,e.z=this.qz,e.w=this.get_qw()},get_qw:function(){var e=1-(this.qx*this.qx+this.qy*this.qy+this.qz*this.qz);return e<0?-Math.sqrt(-e):Math.sqrt(e)},toMatrix:function(e){e==null&&(e=!1);var t=new L,n=ua.QTMP;return n.x=this.qx,n.y=this.qy,n.z=this.qz,n.w=this.get_qw(),n.toMatrix(t),e?(t.translate(this.x,this.y,this.z),t.scale(this.sx,this.sy,this.sz)):(t._11*=this.sx,t._12*=this.sx,t._13*=this.sx,t._21*=this.sy,t._22*=this.sy,t._23*=this.sy,t._31*=this.sz,t._32*=this.sz,t._33*=this.sz,t.translate(this.x,this.y,this.z)),t},__class__:ua},gc=function(){},c["hxd.fmt.hmd.Geometry"]=gc,gc.__name__="hxd.fmt.hmd.Geometry",gc.prototype={get_indexCount:function(){for(var s,t=0,e=0,n=this.indexCounts;e<n.length;)s=n[e],++e,t+=s;return t},__class__:gc},wc=function(){},c["hxd.fmt.hmd.BlendShape"]=wc,wc.__name__="hxd.fmt.hmd.BlendShape",wc.prototype={__class__:wc},Hr=function(){},c["hxd.fmt.hmd.Collider"]=Hr,Hr.__name__="hxd.fmt.hmd.Collider",Hr.prototype={__class__:Hr},pr=function(){},c["hxd.fmt.hmd.Material"]=pr,pr.__name__="hxd.fmt.hmd.Material",pr.prototype={__class__:pr},rc=function(){},c["hxd.fmt.hmd.SkinJoint"]=rc,rc.__name__="hxd.fmt.hmd.SkinJoint",rc.prototype={__class__:rc},pc=function(){},c["hxd.fmt.hmd.SkinSplit"]=pc,pc.__name__="hxd.fmt.hmd.SkinSplit",pc.prototype={__class__:pc},bc=function(){},c["hxd.fmt.hmd.Skin"]=bc,bc.__name__="hxd.fmt.hmd.Skin",bc.prototype={__class__:bc},ur=function(){},c["hxd.fmt.hmd.Model"]=ur,ur.__name__="hxd.fmt.hmd.Model",ur.prototype={getObjectName:function(){if(this.name==null)return this.name;var e=new RegExp("_*-*LOD0","".split("u").join(""));return this.name.replace(e,"")},isLOD:function(){return this.name.indexOf("LOD0")<0},isLOD0:function(e){return this.name!=null&&this.name.indexOf(e)!=-1&&this.name.indexOf("LOD0")!=-1},toLODName:function(e){return this.name+"LOD"+e},getLODInfos:function(){var n,s,e="LOD";if(this.name==null||this.name.length<=e.length)return{lodLevel:-1,modelName:null};if(u.substr(this.name,0,e.length)==e&&(n=o.parseInt(u.substr(this.name,e.length,1)),n!=null)){if(o.parseInt(u.substr(this.name,e.length+1,1))!=null)throw t.thrown("Did not expect a second number after LOD in "+this.name);return{lodLevel:n,modelName:u.substr(this.name,e.length,null)}}return s=this.name.length-e.length-1,u.substr(this.name,s,e.length)==e&&(n=o.parseInt(this.name.charAt(this.name.length-1)),n!=null)?{lodLevel:n,modelName:u.substr(this.name,0,s)}:{lodLevel:-1,modelName:null}},__class__:ur},he=_["hxd.fmt.hmd.AnimationFlag"]={__ename__:!0,__constructs__:null,HasPosition:{_hx_name:"HasPosition",_hx_index:0,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:s},HasRotation:{_hx_name:"HasRotation",_hx_index:1,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:s},HasScale:{_hx_name:"HasScale",_hx_index:2,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:s},HasUV:{_hx_name:"HasUV",_hx_index:3,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:s},HasAlpha:{_hx_name:"HasAlpha",_hx_index:4,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:s},SingleFrame:{_hx_name:"SingleFrame",_hx_index:5,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:s},HasProps:{_hx_name:"HasProps",_hx_index:6,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:s},Reserved:{_hx_name:"Reserved",_hx_index:7,__enum__:"hxd.fmt.hmd.AnimationFlag",toString:s}},he.__constructs__=[he.HasPosition,he.HasRotation,he.HasScale,he.HasUV,he.HasAlpha,he.SingleFrame,he.HasProps,he.Reserved],he.__empty_constructs__=[he.HasPosition,he.HasRotation,he.HasScale,he.HasUV,he.HasAlpha,he.SingleFrame,he.HasProps,he.Reserved],Dc=function(){},c["hxd.fmt.hmd.AnimationObject"]=Dc,Dc.__name__="hxd.fmt.hmd.AnimationObject",Dc.prototype={getStride:function(){var e=0;return(this.flags&1<<he.HasPosition._hx_index)!=0&&(e+=3),(this.flags&1<<he.HasRotation._hx_index)!=0&&(e+=3),(this.flags&1<<he.HasScale._hx_index)!=0&&(e+=3),(this.flags&1<<he.HasUV._hx_index)!=0&&(e+=2),(this.flags&1<<he.HasAlpha._hx_index)!=0&&++e,(this.flags&1<<he.HasProps._hx_index)!=0&&(e+=this.props.length),e},__class__:Dc},Tc=function(){},c["hxd.fmt.hmd.AnimationEvent"]=Tc,Tc.__name__="hxd.fmt.hmd.AnimationEvent",Tc.prototype={__class__:Tc},Ac=function(){},c["hxd.fmt.hmd.Animation"]=Ac,Ac.__name__="hxd.fmt.hmd.Animation",Ac.prototype={__class__:Ac},xa=function(){},c["hxd.fmt.hmd.Data"]=xa,xa.__name__="hxd.fmt.hmd.Data",xa.prototype={__class__:xa},Ca=function(e,t,n,s){this.size=e,this.offset=t,this.precision=s,this.def=n},c["hxd.fmt.hmd._Library.FormatMap"]=Ca,Ca.__name__="hxd.fmt.hmd._Library.FormatMap",Ca.prototype={__class__:Ca},Ea=function(){},c["hxd.fmt.hmd.GeometryBuffer"]=Ea,Ea.__name__="hxd.fmt.hmd.GeometryBuffer",Ea.prototype={__class__:Ea},es=function(e,t){this.resource=e,this.header=t,this.cachedPrimitives=[],this.cachedAnimations=new fe,this.cachedSkin=new fe},c["hxd.fmt.hmd.Library"]=es,es.__name__="hxd.fmt.hmd.Library",es.getDefaultLodConfig=function(){var n=Kt.currentInstance.fs,s=n instanceof Yo?n:null,t=es.baseLodConfig,t=ze.customizeLodConfig(t);return t},es.getDefaultDynamicBonesConfig=function(){var t=Kt.currentInstance.fs,s=t instanceof Yo?t:null,n=[];return n},es.prototype={getData:function(){var t=this.resource.entry,e=new A(new ArrayBuffer(t.get_size()-this.header.dataPosition));return t.readFull(e,this.header.dataPosition,e.length),e},getDefaultFormat:function(e){var o,i,a,n=[new ce("position",3)],s=[null];if(e>3&&(n.push(new ce("normal",3)),s.push(null)),e>6&&(n.push(new ce("uv",2)),s.push(null)),e>8&&(n.push(new ce("color",3)),o=1,i=1,a=1,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),s.push(new h(o,i,a))),e>11)throw t.thrown("Unsupported stride");return{format:y.make(n),defs:s}},load:function(e,n,s){s==null&&(s=-1);var o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,E,k,A,M,F,T,z,D,N,L,R,P,H,I,B,V,$,W,U,x=0,C=0,S=0;for(S==null&&(S=0),C==null&&(C=0),x==null&&(x=0),r=x,c=C,l=S,N=s<0?this.header.models:[this.header.models[s]],o=Tt._new(0),z=new Array(0),u=e.stride,f=-1,p=0;p<N.length;){if(g=N[p],++p,F=this.header.geometries[g.geometry],F==null)continue;for(b=0,k=g.materials;b<k.length;)if(w=k[b],++b,f<0&&(f=w),f!=w)throw t.thrown("Models have several materials");for(i=g.position.toMatrix(),a=this.getBuffers(F,e,n),$=o.pos/u|0,_=0,V=a.vertexes.length/u|0;_<V;)for(B=_++,d=B*u,r=a.vertexes[d++],c=a.vertexes[d++],l=a.vertexes[d++],L=r*i._11+c*i._21+l*i._31+i._41,I=r*i._12+c*i._22+l*i._32+i._42,R=r*i._13+c*i._23+l*i._33+i._43,r=L,c=I,l=R,o.pos==o.array.length&&(v=o.array.length<<1,v<128&&(v=128),T=new Float32Array(v),T.set(o.array),o.array=T),o.array[o.pos++]=r,o.pos==o.array.length&&(h=o.array.length<<1,h<128&&(h=128),D=new Float32Array(h),D.set(o.array),o.array=D),o.array[o.pos++]=c,o.pos==o.array.length&&(m=o.array.length<<1,m<128&&(m=128),A=new Float32Array(m),A.set(o.array),o.array=A),o.array[o.pos++]=l,M=0,P=u-3;M<P;)U=M++,H=a.vertexes[d++],o.pos==o.array.length&&(j=o.array.length<<1,j<128&&(j=128),E=new Float32Array(j),E.set(o.array),o.array=E),o.array[o.pos++]=H;for(y=0,O=a.indexes;y<O.length;)W=O[y],++y,z.push(W+$)}return{vertex:o,index:z}},getBuffers:function(e,n,s,o){o==0&&e.indexCounts.length==1&&(o=null);for(var r,v,ne,de,a,g,re,oe,f,te,c,l,d,u,h,m,p,b,_,w,O,S,P,Ee,i,U,ee,j,x,C,M,F,T,Y,G,X,Z,Oe,z,J,me,D,K,we,N,ie,ye,L,ce,ve,k,ue,fe,R,he,pe,I,le,be,B,ae,_e,V,Q,xe,$,q,E=[],W=0,Ce=0,se=!1,je=0,ge=n.inputs;je<ge.length;){if(r=ge[je++],v=e.vertexFormat.getInput(r.name),v==null){if(de=s==null?null:s[W],de==null)throw t.thrown("Missing required "+r.name);g=r.type,ne=new Ca(g==H.__cast(9,St)?1:g,0,de,0)}else{if(v.type!=r.type)throw t.thrown("Requested "+r.name+" "+(r.type==null?"null":Pt.toString(r.type))+" but found "+(v.type==null?"null":Pt.toString(v.type)));re=r.type,ne=new Ca(re==H.__cast(9,St)?1:re,e.vertexFormat.calculateInputOffset(v.name),null,v.precision),v.precision!=0&&(se=!0)}E.push(ne),oe=r.type,Ce+=oe==H.__cast(9,St)?1:oe,++W}if(f=e.vertexFormat.strideBytes,te=e.vertexCount*f,m=new A(new ArrayBuffer(te)),Z=this.resource.entry,Z.readFull(m,this.header.dataPosition+e.vertexPosition,te),G=this.header.dataPosition+e.indexPosition,F=e.vertexCount<=65536,M=F?2:4,o==null)S=e.get_indexCount()*M;else{for(Y=0,l=0,u=o;l<u;)r=l++,Y+=e.indexCounts[r];G+=Y*M,S=e.indexCounts[o]*M}if(b=new A(new ArrayBuffer(S)),Z.readFull(b,G,S),c=new Ea,o==null){for(c.vertexes=new Array(Ce*e.vertexCount),c.indexes=new Array(e.get_indexCount()),h=0,l=0,u=e.vertexCount;l<u;)for(d=l++,p=0;p<E.length;)if(a=E[p],++p,a.def==null)for(_=0,P=a.size;_<P;){if(r=_++,g=c.vertexes,W=h++,se)switch(a.precision){case 0:w=m.getFloat(d*f+(r<<2)+a.offset);break;case 1:w=y.float16to32(m.getUInt16(d*f+(r<<1)+a.offset));break;case 2:w=(m.b[d*f+r+a.offset]&255)/255;break;case 3:w=y.floatS8to32(m.b[d*f+r+a.offset]);break}else w=m.getFloat(d*f+(r<<2)+a.offset);g[W]=w}else switch(a.size){case 1:c.vertexes[h++]=a.def.x;break;case 2:c.vertexes[h++]=a.def.x,c.vertexes[h++]=a.def.y;break;case 3:c.vertexes[h++]=a.def.x,c.vertexes[h++]=a.def.y,c.vertexes[h++]=a.def.z;break;default:c.vertexes[h++]=a.def.x,c.vertexes[h++]=a.def.y,c.vertexes[h++]=a.def.z,c.vertexes[h++]=a.def.w}if(F)for(O=0,l=0,u=c.indexes.length;l<u;)r=l++,c.indexes[r]=b.b[O++]|b.b[O++]<<8;else for(l=0,u=c.indexes.length;l<u;)r=l++,c.indexes[r]=b.getInt32(r<<2)}else{for(Ee=e.indexCounts[o],U=new Array(e.vertexCount),i=Tt._new(0),c.indexes=new Array(Ee),O=0,ee=0,l=0,u=c.indexes.length;l<u;){if(r=l++,d=F?b.b[O++]|b.b[O++]<<8:b.getInt32(r<<2),C=U[d],C==0)for(++ee,C=ee,U[d]=C,p=0;p<E.length;)if(a=E[p],++p,a.def==null)for(_=0,P=a.size;_<P;){if(x=_++,se)switch(a.precision){case 0:j=m.getFloat(d*f+(x<<2)+a.offset);break;case 1:j=y.float16to32(m.getUInt16(d*f+(x<<1)+a.offset));break;case 2:j=(m.b[d*f+x+a.offset]&255)/255;break;case 3:j=y.floatS8to32(m.b[d*f+x+a.offset]);break}else j=m.getFloat(d*f+(x<<2)+a.offset);i.pos==i.array.length&&(T=i.array.length<<1,T<128&&(T=128),X=new Float32Array(T),X.set(i.array),i.array=X),i.array[i.pos++]=j}else switch(a.size){case 1:Oe=a.def.x,i.pos==i.array.length&&(z=i.array.length<<1,z<128&&(z=128),J=new Float32Array(z),J.set(i.array),i.array=J),i.array[i.pos++]=Oe;break;case 2:me=a.def.x,i.pos==i.array.length&&(D=i.array.length<<1,D<128&&(D=128),K=new Float32Array(D),K.set(i.array),i.array=K),i.array[i.pos++]=me,we=a.def.y,i.pos==i.array.length&&(N=i.array.length<<1,N<128&&(N=128),ie=new Float32Array(N),ie.set(i.array),i.array=ie),i.array[i.pos++]=we;break;case 3:ye=a.def.x,i.pos==i.array.length&&(L=i.array.length<<1,L<128&&(L=128),ce=new Float32Array(L),ce.set(i.array),i.array=ce),i.array[i.pos++]=ye,ve=a.def.y,i.pos==i.array.length&&(k=i.array.length<<1,k<128&&(k=128),ue=new Float32Array(k),ue.set(i.array),i.array=ue),i.array[i.pos++]=ve,fe=a.def.z,i.pos==i.array.length&&(R=i.array.length<<1,R<128&&(R=128),he=new Float32Array(R),he.set(i.array),i.array=he),i.array[i.pos++]=fe;break;default:pe=a.def.x,i.pos==i.array.length&&(I=i.array.length<<1,I<128&&(I=128),le=new Float32Array(I),le.set(i.array),i.array=le),i.array[i.pos++]=pe,be=a.def.y,i.pos==i.array.length&&(B=i.array.length<<1,B<128&&(B=128),ae=new Float32Array(B),ae.set(i.array),i.array=ae),i.array[i.pos++]=be,_e=a.def.z,i.pos==i.array.length&&(V=i.array.length<<1,V<128&&(V=128),Q=new Float32Array(V),Q.set(i.array),i.array=Q),i.array[i.pos++]=_e,xe=a.def.w,i.pos==i.array.length&&($=i.array.length<<1,$<128&&($=128),q=new Float32Array($),q.set(i.array),i.array=q),i.array[i.pos++]=xe}c.indexes[r]=C-1}for(g=i,l=[],u=0,p=g.pos;u<p;)r=u++,l.push(g.array[r]);c.vertexes=l}return c},makePrimitive:function(e){var n,s,i,a,c,l,d,u,r=e.geometry,o=this.cachedPrimitives[r];if(o!=null)return o;if(i=null,c=e.lods!=null,c){if(e.isLOD())return null;for(n=[],s=0,l=e.lods;s<l.length;)d=l[s],++s,n.push(this.header.models[d]);i=n,this.patchLodsMaterials(e,i)}else{if(a=e.getLODInfos(),a.lodLevel>0){for(n=0,s=this.header.models;n<s.length;)if(u=s[n],++n,u.isLOD0(a.modelName))return null;throw t.thrown("No LOD0 found for "+a.modelName+" in "+this.resource.entry.name)}a.lodLevel==0&&(i=this.findLODs(a.modelName,e),this.patchLodsMaterials(e,i),c=!0)}return o=new Mo(this.header.geometries[r],this.header.dataPosition,this,i),o.incref(),this.cachedPrimitives[r]=o,o},dispose:function(){for(var t,e=0,n=this.cachedPrimitives;e<n.length;)t=n[e],++e,t!=null&&t.decref();this.cachedPrimitives=[]},makeMaterial:function(e,t,n){var i,o=this.header.materials[t],s=rs.current.createMaterial();return s.name=o.name,s.model=this.resource,s.set_blendMode(o.blendMode),i=rs.current.loadMaterialProps(s),i==null&&(i=s.getDefaultModelProps()),o.diffuseTexture!=null&&(s.set_texture(n(o.diffuseTexture)),s.get_texture()==null&&s.set_texture(S.fromColor(16711935))),o.specularTexture!=null&&s.set_specularTexture(n(o.specularTexture)),o.normalMap!=null&&s.set_normalMap(n(o.normalMap)),s.set_props(i),s},makeSkin:function(e,t){var s,o,i,a,r,c,l,d,u,h,m,n=this.cachedSkin.h[e.name];if(n!=null)return n;for(n=new Tr(e.name,0,t.props!=null&&t.props.indexOf(mt.FourBonesByVertex)>=0?4:3),n.namedJoints=new fe,n.allJoints=[],n.boundJoints=[],n.rootJoints=[],o=0,a=e.joints;o<a.length;)i=a[o],++o,s=new ji,s.name=i.name,s.index=n.allJoints.length,s.defMat=i.position.toMatrix(),i.bind>=0&&(s.bindIndex=i.bind,s.transPos=i.transpos.toMatrix(!0),n.boundJoints[s.bindIndex]=s),i.parent>=0?(c=n.allJoints[i.parent],c.subs.push(s),s.parent=c):n.rootJoints.push(s),n.allJoints.push(s),n.namedJoints.h[s.name]=s;if(e.split!=null)for(n.splitJoints=[],o=0,a=e.split;o<a.length;){for(l=a[o],++o,h=n.splitJoints,m=l.materialIndex,d=[],r=0,u=l.joints;r<u.length;)s=u[r],++r,d.push(n.allJoints[s]);h.push({material:m,joints:d})}return this.cachedSkin.h[e.name]=n,n},getModelProperty:function(e,n,s){for(var o,i,r,c,a=0,l=this.header.models;a<l.length;)if(o=l[a],++a,o.name==e){if(o.props!=null)for(i=0,r=o.props;i<r.length;)if(c=r[i],++i,c._hx_index==n._hx_index)return Y.enumParameters(c)[0];return s}if(s==null)throw t.thrown("Model "+e+" not found");return s},findLODs:function(e){if(e==null)return null;for(var s,o,i=[],a=0,r=this.header.models;a<r.length;){if(o=r[a],++a,s=o.getLODInfos(),s.lodLevel<1)continue;if(s.modelName==e){if(i[s.lodLevel-1]!=null)throw t.thrown("Multiple LODs with the same level : "+o.name);i[s.lodLevel-1]=o}}return i},patchLodsMaterials:function(e,n){for(var s,o,i,a,r,l,d,u,h,m,c=0;c<n.length;){for(s=n[c],++c,o=0,l=s.materials;o<l.length;){if(h=l[o],++o,e.materials.indexOf(h)!=-1)continue;throw t.thrown("Model "+s.name+" has a material that isn't used by "+e.name+". This is not supported.")}for(d=this.header.geometries[s.geometry],i=[],a=0,u=0,m=e.materials.length;u<m;)r=u++,e.materials[r]==s.materials[a]?(i[r]=d.indexCounts[a],++a):i[r]=0;d.indexCounts=i}},makeObject:function(e){if(e==null&&(e=function(){return S.fromColor(16711935)}),this.header.models.length==0)throw t.thrown("This file does not contain any model");for(var n,s,o,i,a,r,c,l,d,u,h,m,f,p,b,j,y,_,w,O,x,C,E,A,v=[],g=0,k=this.header.models;g<k.length;){if(s=k[g],++g,s.geometry<0)n=new se;else{if(a=this.makePrimitive(s),a==null)continue;if(s.skin!=null){for(u=this.makeSkin(s.skin,this.header.geometries[s.geometry]),u.primitive=a,b=[],d=0,f=s.materials;d<f.length;)A=f[d],++d,b.push(this.makeMaterial(s,A,e));n=new Ne(u,b)}else if(s.materials.length==1)n=new me(a,this.makeMaterial(s,s.materials[0],e));else{for(m=[],c=0,p=s.materials;c<p.length;)w=p[c],++c,m.push(this.makeMaterial(s,w,e));n=new Qt(a,m)}}n.name=s.getObjectName(),E=s.position.toMatrix(),n.defaultTransform=E,r=1,j=!0,j?n.flags|=r:n.flags&=~r,C=j,C&&(n.flags&131072)!=0&&(x=262144,n.flags|=x),v.push(n),h=v[s.parent],h!=null&&h.addChild(n),O=this.resource.entry.get_directory(),_=n instanceof me?n:null,y=_!=null?_.primitive:null,o={resourceDirectory:O,resourceName:this.resource.entry.name,objectName:n.name,hmd:y instanceof Mo?y:null,skin:n instanceof Ne?n:null,collide:null},i={},i[ze.LOD_CONFIG]=es.getDefaultLodConfig(o.resourceDirectory),i[ze.DYN_BONES_CONFIG]=es.getDefaultDynamicBonesConfig(o.resourceDirectory),ze.current.loadLodConfig(o,i),ze.current.loadDynamicBonesConfig(o,i),ze.current.loadModelProps(o)}return l=v[0],l!=null&&(r=256,l.flags|=r),l},loadAnimation:function(e){var s,o,i,a,n=this.cachedAnimations.h[e??""];if(n!=null)return n;if(n=null,e==null){if(this.header.animations.length==0)return null;n=this.header.animations[0]}else{for(o=0,i=this.header.animations;o<i.length;)if(a=i[o],++o,a.name==e){n=a;break}if(n==null)throw t.thrown("Animation "+e+" not found !")}return s=this.header.version<=2?this.makeLinearAnimation(n):this.makeAnimation(n),s.speed=n.speed,s.loop=n.loop,n.events!=null&&s.setEvents(n.events),s.resourcePath=this.resource.entry.get_path(),this.cachedAnimations.h[n.name]=s,e==null&&(this.cachedAnimations.h[""]=s),s},makeAnimation:function(e){for(var t,s,o,a,r,c,l,m,f,p,g,v,b,d=new Oi(e.name,e.frames,e.sampling),i=0,u=[],h=[],n=0,j=e.objects;n<j.length;)if(t=j[n],++n,s=d.addObject(t.name,0),o=1,(t.flags&1<<he.SingleFrame._hx_index)!=0?(s.layout|=1<<ae.SingleFrame._hx_index,u.push(s),o=0):h.push(s),(t.flags&1<<he.HasPosition._hx_index)!=0&&(s.layout|=1<<ae.Position._hx_index,i+=3*o),(t.flags&1<<he.HasRotation._hx_index)!=0&&(s.layout|=1<<ae.Rotation._hx_index,i+=3*o),(t.flags&1<<he.HasScale._hx_index)!=0&&(s.layout|=1<<ae.Scale._hx_index,i+=3*o),(t.flags&1<<he.HasUV._hx_index)!=0&&(s.layout|=1<<ae.UV._hx_index,i+=2*o),(t.flags&1<<he.HasAlpha._hx_index)!=0&&(s.layout|=1<<ae.Alpha._hx_index,i+=o),(t.flags&1<<he.HasProps._hx_index)!=0)for(m=0,p=t.props.length;m<p;)f=m++,r=s,f>0&&(r=d.addObject(t.name,0),o==0?u.push(r):h.push(r)),r.layout|=1<<ae.Property._hx_index,r.propName=t.props[f],i+=o;for(a=0,n=0;n<u.length;)c=u[n],++n,c.dataOffset=a,a+=c.getStride();for(g=a,n=0;n<h.length;)c=h[n],++n,c.dataOffset=a,a+=c.getStride();return v=this.resource.entry,b=i*e.frames+g,l=new A(new ArrayBuffer(b*4)),v.readFull(l,this.header.dataPosition+e.dataPosition,l.length),d.setData(new Float32Array(l.b.buffer),i),d},makeLinearAnimation:function(e){for(var t,n,s,o,a,r,c,d,u,h,m,p,g,v,b,j,y,_,w,O,x,C,E,k,S,M,F,z,D,N,L,R,P,H,I,l=new Fi(e.name,e.frames,e.sampling),f=this.resource.entry,i=this.header.dataPosition+e.dataPosition,A=0,T=e.objects;A<T.length;){if(s=T[A],++A,d=(s.flags&1<<he.HasPosition._hx_index)!=0,r=(s.flags&1<<he.HasRotation._hx_index)!=0,a=(s.flags&1<<he.HasScale._hx_index)!=0,d||r||a){for(c=e.frames,(s.flags&1<<he.SingleFrame._hx_index)!=0&&(c=1),E=new Array(c),_=((d?3:0)+(r?3:0)+(a?3:0))*4*c,o=f.fetchBytes(i,_),i+=_,n=0,y=0,I=c;y<I;)z=y++,t=new Qr,d?(t.tx=o.getFloat(n),n+=4,t.ty=o.getFloat(n),n+=4,t.tz=o.getFloat(n),n+=4):(t.tx=0,t.ty=0,t.tz=0),r?(t.qx=o.getFloat(n),n+=4,t.qy=o.getFloat(n),n+=4,t.qz=o.getFloat(n),n+=4,g=1-(t.qx*t.qx+t.qy*t.qy+t.qz*t.qz),t.qw=g<0?-Math.sqrt(-g):Math.sqrt(g)):(t.qx=0,t.qy=0,t.qz=0,t.qw=1),a?(t.sx=o.getFloat(n),n+=4,t.sy=o.getFloat(n),n+=4,t.sz=o.getFloat(n),n+=4):(t.sx=1,t.sy=1,t.sz=1),E[z]=t;l.addCurve(s.name,E,!0,r,a)}if((s.flags&1<<he.HasUV._hx_index)!=0){for(p=new Array(e.frames*2),v=8*e.frames,P=f.fetchBytes(i,v),i+=v,O=0,L=p.length;O<L;)C=O++,p[C]=P.getFloat(C*4);l.addUVCurve(s.name,p)}if((s.flags&1<<he.HasAlpha._hx_index)!=0){for(h=new Array(e.frames),k=4*e.frames,N=f.fetchBytes(i,k),i+=k,S=0,F=h.length;S<F;)M=S++,h[M]=N.getFloat(M*4);l.addAlphaCurve(s.name,h)}if((s.flags&1<<he.HasProps._hx_index)!=0)for(u=0,b=s.props;u<b.length;){for(D=b[u],++u,m=new Array(e.frames),x=4*e.frames,R=f.fetchBytes(i,x),i+=x,w=0,H=m.length;w<H;)j=w++,m[j]=R.getFloat(j*4);l.addPropCurve(s.name,D,m)}}return l},loadSkin:function(e,n,s){if(s==null&&(s=!0),n.vertexWeights!=null)return;var Ue,je,fe,$e,r,c,u,v,b,he,ue,de,le,re,ae,Ve,Q,xe,ke,be,Le,i,l,S,De,m,f,p,O,E,z,N,L,P,Ne,Pe,Te,He,Ae,Ie,Ee,Be,d,Oe,ve,ye,J,ee,te,ne,se,oe,ie,o,a,g,j,_,w,x,We,Re,k,A,M,F,T,_e,we,R,H,I,$,W,U,q,Y,X,Me,Fe,B,V,Z,ze,Se,D,K,G,me,pe,ge,C=n.bonesPerVertex;if(C!=3&&C!=4)throw t.thrown("assert");for(Ue=C==4,n.vertexCount=e.vertexCount,je=y.make([new ce("position",3),new ce("weights",3),new ce("indexes",9)]),fe=this.getBuffers(e,je),$e=je.stride,n.vertexWeights=new Array(n.vertexCount*C),n.vertexJoints=new Array(n.vertexCount*C),c=0,u=n.boundJoints;c<u.length;)r=u[c],++c,r.offsets=new Ce;if(b=fe.vertexes,v=0,he=1e20,ue=-1e20,de=1e20,le=-1e20,re=1e20,ae=-1e20,Ve=NaN,n.splitJoints==null){for(xe=[],c=0,u=n.boundJoints;c<u.length;)r=u[c],++c,xe[r.bindIndex]=r;Q=[{index:0,pos:0,count:fe.indexes.length,joints:xe}]}else{for(v=0,ke=[],be=0,c=0,u=e.indexCounts;c<u.length;)Le=u[c],++c,ke.push(be),be+=Le;for(c=[],u=0,S=n.splitJoints;u<S.length;)r=S[u],++u,c.push({index:v,pos:ke[v],count:e.indexCounts[v++],joints:r.joints});Q=c}for(c=0;c<Q.length;)for(l=Q[c],++c,u=l.pos,S=l.pos+l.count;u<S;){if(v=u++,De=fe.indexes[v],O=De*$e,m=b[O],isNaN(m))continue;for(b[O++]=Ve,p=b[O++],f=b[O++],N=b[O++],L=b[O++],z=b[O++],P=0,E=De*C,n.vertexWeights[E]=N,n.vertexWeights[E+1]=L,n.vertexWeights[E+2]=z,Ue&&(P=1-N-L-z,n.vertexWeights[E+3]=P),Ne=(N==0?1:0)|(L==0?2:0)|(z==0?4:0)|(P==0?8:0),Pe=yt.floatToI32(b[O++]),m<he&&(he=m),m>ue&&(ue=m),p<de&&(de=p),p>le&&(le=p),f<re&&(re=f),f>ae&&(ae=f),Te=0,He=C;Te<He;){if(Ae=Te++,(Ne&1<<Ae)!=0){n.vertexJoints[E++]=-1;continue}Ie=Pe>>(Ae<<3)&255,r=l.joints[Ie],i=r.offsets,m<i.xMin&&(i.xMin=m),m>i.xMax&&(i.xMax=m),p<i.yMin&&(i.yMin=p),p>i.yMax&&(i.yMax=p),f<i.zMin&&(i.zMin=f),f>i.zMax&&(i.zMax=f),n.vertexJoints[E++]=r.bindIndex}}if(s)for(v=n.allJoints.length-1,Ee=0,Be=(ue-he)*(le-de)*(ae-re);v>=0;){if(r=n.allJoints[v--],r.offsets==null||r.parent==null||r.parent.offsets==null)continue;if(d=r.parent.offsets,i=r.offsets,Oe=i.xMax-i.xMin,ve=i.yMax-i.yMin,ye=i.zMax-i.zMin,m=(i.xMin+i.xMax)*.5,p=(i.yMin+i.yMax)*.5,f=(i.zMin+i.zMax)*.5,l=Math.sqrt(Oe*Oe+ve*ve+ye*ye)*.5,l==null&&(l=1),f==null&&(f=0),p==null&&(p=0),m==null&&(m=0),J=m,ee=p,te=f,ne=l,ne==null&&(ne=0),te==null&&(te=0),ee==null&&(ee=0),J==null&&(J=0),se=J,oe=ee,ie=te,x=ne,d.xMin<=se-x&&d.yMin<=oe-x&&d.zMin<=ie-x&&d.xMax>=se+x&&d.yMax>=oe+x&&d.zMax>=ie+x){r.offsets=null,++Ee;continue}if(o=new Ce,o.xMin=d.xMin,o.xMax=d.xMax,o.yMin=d.yMin,o.yMax=d.yMax,o.zMin=d.zMin,o.zMax=d.zMax,a=o,w=se,_=oe,j=ie,g=x,w-g<a.xMin&&(a.xMin=w-g),w+g>a.xMax&&(a.xMax=w+g),_-g<a.yMin&&(a.yMin=_-g),_+g>a.yMax&&(a.yMax=_+g),j-g<a.zMin&&(a.zMin=j-g),j+g>a.zMax&&(a.zMax=j+g),We=Math.sqrt(Be*1.5/((a.xMax-a.xMin)*(a.yMax-a.yMin)*(a.zMax-a.zMin))),Re=(a.xMax-a.xMin)*(a.yMax-a.yMin)*(a.zMax-a.zMin)/((d.xMax-d.xMin)*(d.yMax-d.yMin)*(d.zMax-d.zMin)),Re<We){r.parent.offsets=a,r.offsets=null,++Ee;continue}}for(c=0,u=n.allJoints;c<u.length;){if(r=u[c],++c,r.offsets==null){r.offsetRay=-1;continue}o=r.offsets,m=(o.xMin+o.xMax)*.5,p=(o.yMin+o.yMax)*.5,f=(o.zMin+o.zMax)*.5,f==null&&(f=0),p==null&&(p=0),m==null&&(m=0),w=m,_=p,j=f,j==null&&(j=0),_==null&&(_=0),w==null&&(w=0),M=w,T=_,F=j,o.xMax-o.xMin>o.yMax-o.yMin&&o.xMax-o.xMin>o.zMax-o.zMin?(_e=o.yMax-o.yMin,we=o.zMax-o.zMin,l=(_e<we?we:_e)*.5,X=o.xMin+l,Y=T,q=F,q==null&&(q=0),Y==null&&(Y=0),X==null&&(X=0),A=new h(X,Y,q),U=o.xMax-l,W=T,$=F,$==null&&($=0),W==null&&(W=0),U==null&&(U=0),k=new h(U,W,$)):o.yMax-o.yMin>o.zMax-o.zMin?(Me=o.xMax-o.xMin,Fe=o.zMax-o.zMin,l=(Me<Fe?Fe:Me)*.5,V=M,B=o.yMin+l,I=F,I==null&&(I=0),B==null&&(B=0),V==null&&(V=0),A=new h(V,B,I),Z=M,R=o.yMax-l,H=F,H==null&&(H=0),R==null&&(R=0),Z==null&&(Z=0),k=new h(Z,R,H)):(ze=o.xMax-o.xMin,Se=o.yMax-o.yMin,l=(ze<Se?Se:ze)*.5,K=M,G=T,D=o.zMin+l,D==null&&(D=0),G==null&&(G=0),K==null&&(K=0),A=new h(K,G,D),me=M,pe=T,ge=o.zMax-l,ge==null&&(ge=0),pe==null&&(pe=0),me==null&&(me=0),k=new h(me,pe,ge)),o.xMin=A.x,o.yMin=A.y,o.zMin=A.z,o.xMax=k.x,o.yMax=k.y,o.zMax=k.z,r.offsetRay=l}},__class__:es},Qn=function(e){this.i=e},c["hxd.fmt.hmd.Reader"]=Qn,Qn.__name__="hxd.fmt.hmd.Reader",Qn.prototype={readProperty:function(){var n,e=this.i.readByte();switch(e){case 0:return mt.CameraFOVY(this.i.readFloat());case 1:throw t.thrown("Obsolete HasMaterialFlags");case 2:return mt.HasExtraTextures;case 3:return mt.FourBonesByVertex;case 4:return mt.HasLod;case 5:return mt.HasCollider;default:throw n=e,t.thrown("Unknown property #"+n)}},readProps:function(){if(this.version==1)return null;var e,t,s,o,n=this.i.readByte();if(n==0)return null;for(e=[],t=0,s=n;t<s;)o=t++,e.push(this.readProperty());return e},readName:function(){var e=this.i.readByte();return e==255?null:this.i.readString(e)},readCachedName:function(){var t,e=this.readName();return e==null?null:(Qn.HMD_STRINGS==null&&(Qn.HMD_STRINGS=new fe),t=Qn.HMD_STRINGS.h[e],t??(Qn.HMD_STRINGS.h[e]=e,e))},readPosition:function(e){e==null&&(e=!0);var t=new ua;return t.x=this.i.readFloat(),t.y=this.i.readFloat(),t.z=this.i.readFloat(),t.qx=this.i.readFloat(),t.qy=this.i.readFloat(),t.qz=this.i.readFloat(),e?(t.sx=this.i.readFloat(),t.sy=this.i.readFloat(),t.sz=this.i.readFloat()):(t.sx=1,t.sy=1,t.sz=1),t},readBounds:function(){var e=new Ce;return e.xMin=this.i.readFloat(),e.yMin=this.i.readFloat(),e.zMin=this.i.readFloat(),e.xMax=this.i.readFloat(),e.yMax=this.i.readFloat(),e.zMax=this.i.readFloat(),e},readSkin:function(){var e,t,n,s,o,i,a,r,c,l,d,h,m,u=this.readCachedName();if(u==null)return null;for(t=new bc,t.props=this.readProps(),t.name=u,t.joints=[],n=0,o=this.i.readUInt16();n<o;)d=n++,e=new rc,e.props=this.readProps(),e.name=this.readCachedName(),s=this.i.readUInt16(),i=(s&32768)!=0,i&&(s&=32767),e.parent=s-1,e.position=this.readPosition(i),e.bind=this.i.readUInt16()-1,e.bind>=0&&(e.transpos=this.readPosition(i)),t.joints.push(e);if(r=this.i.readByte(),r>0)for(t.split=[],n=0,o=r;n<o;){for(d=n++,a=new pc,a.materialIndex=this.i.readByte(),c=[],l=0,h=this.i.readByte();l<h;)m=l++,c.push(this.i.readUInt16());a.joints=c,t.split.push(a)}return t},readLods:function(){for(var o,n=this.i.readInt32(),e=[],t=0,s=n;t<s;)o=t++,e.push(this.i.readInt32());return e},readHeader:function(e){e==null&&(e=!1);var n,o,i,a,r,c,l,d,h,m,p,g,v,b,j,_,w,O,x,C,E,k,A,S,M,F,z,D,N,L,R,P,H,I,f=this,s=new xa,T=this.i.readString(3);if(T!="HMD")throw u.cca(T,0)==59?t.thrown("FBX was not converted to HMD"):t.thrown("Invalid HMD header "+encodeURIComponent(T));if(this.version=this.i.readByte(),this.version>4)throw t.thrown("Can't read HMD v"+this.version);for(s.version=this.version,s.geometries=[],s.dataPosition=this.i.readInt32(),e&&(this.i=new Nt(this.i.read(s.dataPosition-12))),s.props=this.readProps(),o=0,c=this.i.readInt32();o<c;){for(j=o++,l=new gc,l.props=this.readProps(),l.vertexCount=this.i.readInt32(),k=f.i.readByte(),i=[],a=0,m=f.i.readByte();a<m;)E=a++,C=f.readCachedName(),v=f.i.readByte(),i.push(new ce(C,v&15,v>>4));if(_=y.make(i),k!=_.stride)throw t.thrown("assert");for(l.vertexFormat=_,l.vertexPosition=this.i.readInt32(),x=this.i.readByte(),x==255&&(x=this.i.readInt32()),h=[],p=0,g=x;p<g;)R=p++,h.push(this.i.readInt32());l.indexCounts=h,l.indexPosition=this.i.readInt32(),l.bounds=this.readBounds(),s.geometries.push(l)}for(s.materials=[],o=0,c=this.i.readInt32();o<c;)j=o++,n=new pr,n.props=this.readProps(),n.name=this.readName(),n.diffuseTexture=this.readName(),n.blendMode=Qn.BLEND[this.i.readByte()],this.i.readByte(),this.i.readFloat(),n.props!=null&&n.props.indexOf(mt.HasExtraTextures)>=0&&(n.specularTexture=this.readName(),n.normalMap=this.readName()),s.materials.push(n);for(s.models=[],F=!1,o=0,c=this.i.readInt32();o<c;){if(j=o++,n=new ur,n.props=this.readProps(),n.name=this.readCachedName(),n.parent=this.i.readInt32()-1,n.follow=this.readCachedName(),n.position=this.readPosition(),n.geometry=this.i.readInt32()-1,s.models.push(n),n.geometry<0)continue;for(n.materials=[],S=this.i.readByte(),S==255&&(S=this.i.readInt32()),i=0,a=S;i<a;)E=i++,n.materials.push(this.i.readInt32());n.skin=this.readSkin(),n.props!=null&&(n.lods=n.props.indexOf(mt.HasLod)!=-1?this.readLods():null,n.props.indexOf(mt.HasCollider)!=-1&&(n.collider=this.i.readInt32(),F=!0))}for(s.animations=[],o=0,c=this.i.readInt32();o<c;){for(j=o++,r=new Ac,r.props=this.readProps(),r.name=this.readName(),r.frames=this.i.readInt32(),r.sampling=this.i.readFloat(),r.speed=this.i.readFloat(),M=this.i.readByte(),r.loop=(M&1)!=0,r.dataPosition=this.i.readInt32(),r.objects=[],i=0,a=this.i.readInt32();i<a;)if(E=i++,w=new Dc,w.name=this.readCachedName(),O=this.i.readByte(),O==null&&(O=0),w.flags=O,r.objects.push(w),(w.flags&1<<he.HasProps._hx_index)!=0){for(m=[],h=0,p=this.i.readByte();h<p;)P=h++,m.push(this.readName());w.props=m}if((M&2)!=0)for(r.events=[],g=0,D=this.i.readInt32();g<D;)R=g++,A=new Tc,A.frame=this.i.readInt32(),A.data=this.readCachedName(),r.events.push(A);s.animations.push(r)}if(s.version>=4)for(N=this.i.readInt32(),s.shapes=[],o=0,c=N;o<c;){for(j=o++,d=new wc,d.name=this.readName(),d.geom=this.i.readInt32()-1,d.vertexCount=this.i.readInt32(),k=f.i.readByte(),i=[],a=0,m=f.i.readByte();a<m;)E=a++,C=f.readCachedName(),v=f.i.readByte(),i.push(new ce(C,v&15,v>>4));if(_=y.make(i),k!=_.stride)throw t.thrown("assert");d.vertexFormat=_,d.vertexPosition=this.i.readInt32(),d.indexCount=this.i.readInt32(),d.remapPosition=this.i.readInt32(),s.shapes.push(d)}if(F)for(s.colliders=[],L=this.i.readInt32(),o=0,c=L;o<c;){for(j=o++,b=new Hr,z=this.i.readInt32(),i=[],a=0,m=z;a<m;)H=a++,i.push(this.i.readInt32());for(b.vertexCounts=i,b.vertexPosition=this.i.readInt32(),h=[],p=0,g=z;p<g;)I=p++,h.push(this.i.readInt32());b.indexCounts=h,b.indexPosition=this.i.readInt32(),s.colliders.push(b)}return s},read:function(){var e=this.readHeader();return e.data=this.i.read(this.i.readInt32()),e},__class__:Qn},qs=function(){},c["hxd.fs.FileEntry"]=qs,qs.__name__="hxd.fs.FileEntry",qs.prototype={getBytes:function(){return null},readBytes:function(){throw t.thrown("readBytes() not implemented")},fetchBytes:function(e,t){var s,n=qs.TMP_BYTES;return(n==null||n.length<t)&&(s=t+65535&-65536,n=new A(new ArrayBuffer(s)),qs.TMP_BYTES=n),this.readFull(n,e,t),n},readFull:function(e,n,s){if(this.readBytes(e,0,n,s)<s)throw t.thrown(new fn)},getSign:function(){var e=this.fetchBytes(0,4);return e.b[0]|e.b[1]<<8|e.b[2]<<16|e.b[3]<<24},getText:function(){return this.getBytes().toString()},open:function(){return new bs(this)},load:function(e){if(!this.get_isAvailable())throw t.thrown("load() not implemented");e!=null&&e()},loadBitmap:function(){throw t.thrown("loadBitmap() not implemented")},watch:function(){},exists:function(){return!1},get:function(){return null},iterator:function(){return null},get_isAvailable:function(){return!0},get_isDirectory:function(){return!1},get_size:function(){return 0},get_path:function(){throw t.thrown("path() not implemented")},get_directory:function(){var e=this.get_path().lastIndexOf("/");return e<0?"":u.substr(this.get_path(),0,e)},get_extension:function(){var e=this.name.lastIndexOf(".");return e<0?"":u.substr(this.name,e+1,null).toLowerCase()},__class__:qs},Ma=function(e,t){this.fullPath=e,this.name=e.split("/").pop(),this.bytes=t},c["hxd.fs.BytesFileEntry"]=Ma,Ma.__name__="hxd.fs.BytesFileEntry",Ma.__super__=qs,Ma.prototype=g(qs.prototype,{get_path:function(){return this.fullPath},getBytes:function(){return this.bytes},readBytes:function(e,t,n,s){return n+s>this.bytes.length&&(s=this.bytes.length-n),s<0&&(s=0),e.blit(t,this.bytes,n,s),s},load:function(e){Us.delay(e,1)},loadBitmap:function(e){switch(ge.extension(this.fullPath).toLowerCase()){case"gif":n="image/gif";break;case"jpeg":case"jpg":n="image/jpeg";break;case"png":n="image/png";break;default:throw t.thrown("Cannot determine image encoding, try adding an extension to the resource path")}var n,o,s=new Image;s.onload=function(){e(s)},o=Nn.encode(this.bytes),s.src="data:"+n+";base64,"+o},exists:function(){return!1},get:function(){return null},iterator:function(){return new Qa([])},get_size:function(){return this.bytes.length},__class__:Ma}),Po=function(){},c["hxd.fs.FileSystem"]=Po,Po.__name__="hxd.fs.FileSystem",Po.__isInterface__=!0,Po.prototype={__class__:Po},Wo=function(){},c["hxd.fs.BytesFileSystem"]=Wo,Wo.__name__="hxd.fs.BytesFileSystem",Wo.__interfaces__=[Po],Wo.prototype={getRoot:function(){throw t.thrown("Not implemented")},getBytes:function(){throw t.thrown("Not implemented")},exists:function(e){return this.getBytes(e)!=null},get:function(e){var n=this.getBytes(e);if(n==null)throw t.thrown("Resource not found '"+e+"'");return new Ma(e,n)},dispose:function(){},dir:function(){throw t.thrown("Not implemented")},__class__:Wo},la=function(e,t,n,s){this.fs=e,this.name=t,this.relPath=n,this.data=s},c["hxd.fs._EmbedFileSystem.EmbedEntry"]=la,la.__name__="hxd.fs._EmbedFileSystem.EmbedEntry",la.__super__=qs,la.prototype=g(qs.prototype,{init:function(){if(this.bytes==null&&(this.bytes=Xi.getBytes(this.data),this.bytes==null))throw t.thrown("Missing resource "+this.data)},getBytes:function(){return this.bytes==null&&this.init(),this.bytes},readBytes:function(e,t,n,s){return this.bytes==null&&this.init(),n+s>this.bytes.length&&(s=this.bytes.length-n),s<0&&(s=0),e.blit(t,this.bytes,n,s),s},load:function(e){e!=null&&Us.delay(e,1)},loadBitmap:function(e){for(var i,a,r,c,l,d,s=null,n=0,o=Xi.content;n<o.length;)if(a=o[n],++n,a.name==this.data){s=a.data;break}if(s==null)throw t.thrown("Missing resource "+this.data);for(i=new Image,i.onload=function(){e(i)},r="",c=s.length*6>>3,n=0,o=(3-c*4%3)%3;n<o;)d=n++,r+="=";l="data:image/"+this.get_extension()+";base64,"+s,i.src=l+r},get_isDirectory:function(){return this.fs.isDirectory(this.relPath)},get_path:function(){return this.relPath=="."?"<root>":this.relPath},exists:function(e){return this.fs.exists(this.relPath=="."?e:this.relPath+"/"+e)},get:function(e){return this.fs.get(this.relPath=="."?e:this.relPath+"/"+e)},get_size:function(){return this.init(),this.bytes.length},iterator:function(){return new Qa(this.fs.subFiles(this.relPath))},__class__:la}),Vs=function(e){this.root=e},c["hxd.fs.EmbedFileSystem"]=Vs,Vs.__name__="hxd.fs.EmbedFileSystem",Vs.__interfaces__=[Po],Vs.resolve=function(e){return"R_"+e.replace(Vs.invalidChars.r,"_")},Vs.prototype={getRoot:function(){return new la(this,"root",".",null)},splitPath:function(e){return e=="."?[]:e.split("/")},subFiles:function(e){for(var i,a,r,o=this.root,n=0,s=this.splitPath(e);n<s.length;)r=s[n],++n,o=q.field(o,r);if(o==null)throw t.thrown(e+" is not a directory");for(i=q.fields(o),i.sort(q.compare),n=[],s=0;s<i.length;)a=i[s],++s,n.push(this.get(e=="."?a:e+"/"+a));return n},isDirectory:function(e){for(var o,t=this.root,n=0,s=this.splitPath(e);n<s.length;)o=s[n],++n,t=q.field(t,o);return t!=null&&t!=!0},exists:function(e){for(var o,t=this.root,n=0,s=this.splitPath(e);n<s.length;)if(o=s[n],++n,t=q.field(t,o),t==null)return!1;return!0},get:function(e){if(!this.exists(e))throw t.thrown(new Lo(e));var n=Vs.resolve(e);return new la(this,e.split("/").pop(),e,n)},dispose:function(){},dir:function(e){return this.subFiles(e)},__class__:Vs},bs=function(e){this.nextReadPos=0,this.cacheLen=0,this.cachePos=0,this.entry=e},c["hxd.fs.FileInput"]=bs,bs.__name__="hxd.fs.FileInput",bs.__super__=Io,bs.prototype=g(Io.prototype,{fetch:function(e){e==null&&(e=256);var n,s,o=this.cache;if((this.cache==null||this.cache.length<e)&&(this.cache=bs.PREFETCH_CACHE,this.cache!=null&&this.cache.length>=e?bs.PREFETCH_CACHE=null:this.cache=new A(new ArrayBuffer(e))),n=0,this.cacheLen>0&&(n=this.cacheLen,e-=this.cacheLen,this.cache.blit(0,o,this.cachePos,this.cacheLen)),s=this.entry.readBytes(this.cache,n,this.nextReadPos,e),this.cachePos=0,this.cacheLen=n+s,this.nextReadPos+=s,this.cacheLen==0)throw t.thrown(new fn)},skip:function(e){if(this.cacheLen>0){var n=this.cacheLen,t=n>e?e:n;this.cachePos+=t,this.cacheLen-=t,e-=t}this.nextReadPos+=e},readByte:function(){this.cacheLen==0&&this.fetch();var e=this.cache.b[this.cachePos++];return this.cacheLen--,e},readBytes:function(e,t,n){var s,i,o=0;if(n<256&&this.cacheLen<n&&this.fetch(),this.cacheLen>0){if(i=this.cacheLen,s=n>i?i:n,e.blit(t,this.cache,this.cachePos,s),this.cachePos+=s,this.cacheLen-=s,n-=s,n==0)return s;t+=s,o+=s}return n>0&&(s=this.entry.readBytes(e,t,this.nextReadPos,n),this.nextReadPos+=s,o+=s),o},close:function(){this.cache!=null&&(bs.PREFETCH_CACHE==null||bs.PREFETCH_CACHE.length<this.cache.length)&&(bs.PREFETCH_CACHE=this.cache),this.cache=null,this.cacheLen=0},__class__:bs}),Qc={},Qc._new=function(e){return e},Qc.toBitmap=function(e){var t=new ns(e.width,e.height);return t.ctx.drawImage(e,0,0),t},Qc.toNative=function(e){return e},Yo=function(){throw t.thrown("Local file system is not supported for this platform")},c["hxd.fs.LocalFileSystem"]=Yo,Yo.__name__="hxd.fs.LocalFileSystem",Yo.__interfaces__=[Po],Yo.prototype={exists:function(){return!1},get:function(){return null},getRoot:function(){return null},dispose:function(){},dir:function(){return null},__class__:Yo},Lo=function(e){this.path=e},c["hxd.fs.NotFound"]=Lo,Lo.__name__="hxd.fs.NotFound",Lo.prototype={toString:function(){return"Resource file not found '"+this.path+"'"},__class__:Lo},bo=function(){},c["hxd.fs.SourceLoader"]=bo,bo.__name__="hxd.fs.SourceLoader",bo.isActive=function(){return bo.RELOAD_LFS.length>0},bo.resolve=function(e){for(var o,n=0,s=bo.RELOAD_LFS;n<s.length;){o=s[n],++n;try{return o.get(e)}catch(e){if(!(t.caught(e).unwrap()instanceof Lo))throw e}}return null},wn=function(){this.stack=[];var e,t,n,s,o,a,r,c,l,d,h,m,f,p,i=rl.callStack();for(i.shift(),n=0;n<i.length;)switch(e=i[n],++n,e._hx_index){case 0:break;case 1:h=e.m;break;case 2:l=e.s,d=e.column,t=e.file,r=e.line,o=t.indexOf("\\std/"),o>0&&(t=u.substr(t,o+5,null)),s=t+":"+r,this.stack.push(s),this.position==null&&(a=t.indexOf("/"),c=a<0?"":u.substr(t,0,a),wn.ENGINE_PACKAGES.indexOf(c)<0&&(this.position=s));break;case 3:m=e.classname,f=e.method;break;case 4:p=e.v;break}this.position==null&&(this.position=this.stack[0])},c["hxd.impl.AllocPos"]=wn,wn.__name__="hxd.impl.AllocPos",wn.make=function(){return wn.ENABLED?new wn:null},wn.prototype={__class__:wn},Ba={},Ba.toInt=function(e){return e},Ut=function(){},c["hxd.impl.Allocator"]=Ut,Ut.__name__="hxd.impl.Allocator",Ut.set=function(e){Ut.inst=e},Ut.get=function(){return Ut.inst==null&&(Ut.inst=new Ut),Ut.inst},Ut.prototype={toBufferFlags:function(e){switch(e){case 0:return[ve.Dynamic];case 1:return null;case 2:return[ve.UniformBuffer,ve.Dynamic];case 3:return[ve.UniformBuffer,ve.ReadWriteBuffer];case 4:return[ve.UniformBuffer]}},fromBufferFlags:function(e){if(e==0)return 1;if(e==ol.from(ve.Dynamic))return 0;var t=1<<ve.UniformBuffer._hx_index|1<<ve.Dynamic._hx_index;return t==null&&(t=0),e==t?2:(t=1<<ve.UniformBuffer._hx_index|1<<ve.ReadWriteBuffer._hx_index,t==null&&(t=0),e==t?3:e==ol.from(ve.UniformBuffer)?4:0)},allocBuffer:function(e,t,n){return n==null&&(n=0),new wt(e,t,this.toBufferFlags(n))},ofFloats:function(e,t,n){n==null&&(n=0);var s=Math.ceil(e.pos/t.stride);return this.ofSubFloats(e,s,t,n)},ofSubFloats:function(e,t,n,s){s==null&&(s=0);var o=this.allocBuffer(t,n,s);return o.uploadFloats(e,0,t),o},disposeBuffer:function(e){e.dispose()},allocIndexBuffer:function(e,t){return t==null&&(t=!1),rn._new(e,t)},ofIndexes:function(e,t){t==null&&(t=-1),t<0&&e!=null&&(t=e.length);var n=this.allocIndexBuffer(t);return rn.uploadIndexes(n,e,0,t),n},disposeIndexBuffer:function(e){e.dispose()},onContextLost:function(){},allocFloats:function(e){var t=e;return t==null&&(t=0),Tt._new(t)},disposeFloats:function(){},allocIndexes:function(e){var t=e;return t==null&&(t=0),new Array(t)},disposeIndexes:function(){},__class__:Ut},Ic=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator"]=Ic,Ic.__name__="hxd.impl.ArrayIterator",Ic.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Ic},Wa=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator_h2d_Object"]=Wa,Wa.__name__="hxd.impl.ArrayIterator_h2d_Object",Wa.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Wa},Kr=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator_h2d_col_IPoint"]=Kr,Kr.__name__="hxd.impl.ArrayIterator_h2d_col_IPoint",Kr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Kr},Ur=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator_h2d_col_IPolygon"]=Ur,Ur.__name__="hxd.impl.ArrayIterator_h2d_col_IPolygon",Ur.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Ur},Wr=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator_h2d_col_Point"]=Wr,Wr.__name__="hxd.impl.ArrayIterator_h2d_col_Point",Wr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Wr},Br=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator_h2d_col_Polygon"]=Br,Br.__name__="hxd.impl.ArrayIterator_h2d_col_Polygon",Br.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Br},zr=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator_h2d_col_Segment"]=zr,zr.__name__="hxd.impl.ArrayIterator_h2d_col_Segment",zr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:zr},Fr=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator_h3d_scene_Object"]=Fr,Fr.__name__="hxd.impl.ArrayIterator_h3d_scene_Object",Fr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Fr},Qa=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator_hxd_fs_FileEntry"]=Qa,Qa.__name__="hxd.impl.ArrayIterator_hxd_fs_FileEntry",Qa.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:Qa},kr=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator_hxd_res_Any"]=kr,kr.__name__="hxd.impl.ArrayIterator_hxd_res_Any",kr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:kr},xr=function(e){this.i=0,this.a=e,this.l=this.a.length},c["hxd.impl.ArrayIterator_hxd_snd_Channel"]=xr,xr.__name__="hxd.impl.ArrayIterator_hxd_snd_Channel",xr.prototype={hasNext:function(){return this.i<this.l},next:function(){return this.a[this.i++]},__class__:xr},wr=function(){},c["hxd.impl.AsyncLoader"]=wr,wr.__name__="hxd.impl.AsyncLoader",wr.__isInterface__=!0,wr.prototype={__class__:wr},go={},go._new=function(e){return new A(new ArrayBuffer(e+7>>3))},go.get=function(e,t){return(e.b[t>>3]&1<<(t&7))!=0},go.set=function(e,t){var n=t>>3;e.b[n]|=1<<(t&7)},go.unset=function(e,t){var n=t>>3;e.b[n]&=~(1<<(t&7))},go.toggle=function(e,t,n){var s=t>>3,o=e.b[s],i=1<<(t&7);e.b[s]=n?o|i:o&~i},go.clear=function(e,t){t==null&&(t=!1),e.fill(0,e.length,t?255:0)},an=_["hxd.impl.MouseMode"]={__ename__:!0,__constructs__:null,Absolute:{_hx_name:"Absolute",_hx_index:0,__enum__:"hxd.impl.MouseMode",toString:s},Relative:(a=function(e,t){return{_hx_index:1,callback:e,restorePos:t,__enum__:"hxd.impl.MouseMode",toString:s}},a._hx_name="Relative",a.__params__=["callback","restorePos"],a),AbsoluteUnbound:(a=function(e){return{_hx_index:2,restorePos:e,__enum__:"hxd.impl.MouseMode",toString:s}},a._hx_name="AbsoluteUnbound",a.__params__=["restorePos"],a)},an.__constructs__=[an.Absolute,an.Relative,an.AbsoluteUnbound],an.__empty_constructs__=[an.Absolute],$c={},$c._new=function(e){return e},$c.get=function(e,t){return e[t]},$c.set=function(e,t,n){return e[t]=n,n},$c.fromBytes=function(e){return e.b},or=function(e,t){Wo.call(this),this.path=e,this.bytes=t},c["hxd.res._Any.SingleFileSystem"]=or,or.__name__="hxd.res._Any.SingleFileSystem",or.__super__=Wo,or.prototype=g(Wo.prototype,{getBytes:function(e){return e==this.path?this.bytes:null},__class__:or}),dt=function(e){this.entry=e},c["hxd.res.Resource"]=dt,dt.__name__="hxd.res.Resource",dt.prototype={get_name:function(){return this.entry.name},toString:function(){return this.entry.get_path()},watch:function(e){dt.LIVE_UPDATE&&this.entry.watch(e)},__class__:dt},ho=function(e,t){dt.call(this,t),this.loader=e},c["hxd.res.Any"]=ho,ho.__name__="hxd.res.Any",ho.fromBytes=function(e,t){var n=new or(e,t);return new Kt(n).load(e)},ho.__super__=dt,ho.prototype=g(dt.prototype,{toModel:function(){return this.loader.loadCache(this.entry.get_path(),lr)},toTexture:function(){return this.toImage().toTexture()},toTile:function(){return this.toImage().toTile()},toText:function(){return this.entry.getText()},toImage:function(){return this.loader.loadCache(this.entry.get_path(),We)},toSound:function(){return this.loader.loadCache(this.entry.get_path(),Ms)},toPrefab:function(){return this.loader.loadCache(this.entry.get_path(),dt)},toAnimGraph:function(){return this.loader.loadCache(this.entry.get_path(),dt)},to:function(e){return this.loader.loadCache(this.entry.get_path(),e)},iterator:function(){for(var n,t=[],e=this.entry.iterator();e.i<e.l;)n=e.a[e.i++],t.push(new ho(this.loader,n));return new kr(t)},__class__:ho}),vr=function(e){dt.call(this,e),this.loader=Kt.currentInstance},c["hxd.res.BitmapFont"]=vr,vr.__name__="hxd.res.BitmapFont",vr.__super__=dt,vr.prototype=g(dt.prototype,{toFont:function(){return this.font==null&&(this.font=ic.parse(this.entry.getBytes(),this.entry.get_path(),b(this,this.resolveTile))),this.font},toSdfFont:function(e,t,n,s){s==null&&(s=-1),n==null&&(n=.5),t==null&&(t=0),this.sdfFonts==null&&(this.sdfFonts=[]),e==null&&(e=this.toFont().size);for(var o,i,c,l,d,a=0,r=this.sdfFonts;a<r.length;)if(o=r[a],++a,i=o.type,i._hx_index==1&&(c=i.channel,l=i.alphaCutoff,d=i.smoothing,o.size==e&&c==t&&l==n&&d==s))return o;return o=ic.parse(this.entry.getBytes(),this.entry.get_path(),b(this,this.resolveSdfTile)),o.type=$i.SignedDistanceField(t,n,s),o.resizeTo(e),this.sdfFonts.push(o),o},resolveSdfTile:function(e){var t=this.loader.load(e).toTexture();return t.set_filter(Dn.Linear),Ue.fromTexture(t)},resolveTile:function(e){return this.loader.load(e).toTile()},__class__:vr}),gs={},gs.get_useLoadBitmap=function(e){return e==0},gs.toInt=function(e){return e},gs.getName=function(e){switch(e){case 0:return"JPG";case 1:return"PNG";case 2:return"GIF";case 3:return"TGA";case 4:return"DDS";case 5:return"RAW";case 6:return"HDR"}},kt=_["hxd.res.ImageInfoFlag"]={__ename__:!0,__constructs__:null,IsCube:{_hx_name:"IsCube",_hx_index:0,__enum__:"hxd.res.ImageInfoFlag",toString:s},Dxt10Header:{_hx_name:"Dxt10Header",_hx_index:1,__enum__:"hxd.res.ImageInfoFlag",toString:s}},kt.__constructs__=[kt.IsCube,kt.Dxt10Header],kt.__empty_constructs__=[kt.IsCube,kt.Dxt10Header],hr=function(){this.layerCount=1,this.mipOffset=0,this.mipLevels=1,this.height=0,this.width=0,this.flags=0},c["hxd.res.ImageInfo"]=hr,hr.__name__="hxd.res.ImageInfo",hr.prototype={__class__:hr},We=function(e){this.watchRegistered=!1,dt.call(this,e)},c["hxd.res.Image"]=We,We.__name__="hxd.res.Image",We.customCheckInfo=function(){},We.setupTextureFlags=function(){},We.__super__=dt,We.prototype=g(dt.prototype,{getFormat:function(){return this.getInfo().dataFormat},getPixelFormat:function(){return this.getInfo().pixelFormat},getSize:function(){return this.getInfo()},getInfo:function(){if(this.inf!=null)return this.inf;this.inf=new hr;var e,s,i,a,r,c,l,d,u,h,m,p,g,v,b,j,y,_,w,O,x,C,E,k,n=this.entry.open();n.fetch(256);try{j=n.readUInt16()}catch(e){if(t.caught(e).unwrap()instanceof fn)j=0;else throw e}switch(j){case 16163:for(this.inf.dataFormat=6;n.readLine()!="";);v=n.readLine().split(" "),this.inf.pixelFormat=f.RGBA32F,this.inf.height=o.parseInt(v[1]),this.inf.width=o.parseInt(v[3]);break;case 17476:switch(this.inf.dataFormat=4,n.skip(10),this.inf.height=n.readInt32(),this.inf.width=n.readInt32(),n.skip(8),this.inf.mipLevels=n.readInt32(),n.skip(48),k=n.readInt32(),r=n.readInt32(),d=n.readInt32(),l=n.readInt32(),i=n.readInt32(),c=n.readInt32(),a=n.readInt32(),E=n.readInt32(),O=n.readInt32(),(O&65024)==65024&&(this.inf.flags|=1<<kt.IsCube._hx_index),r&16777215){case 0:if(r==808540228){switch(n.skip(12),this.inf.flags|=1<<kt.Dxt10Header._hx_index,s=n.readInt32(),s){case 28:e=f.RGBA;break;case 71:e=f.S3TC(1);break;case 74:e=f.S3TC(2);break;case 77:e=f.S3TC(3);break;case 95:e=f.S3TC(6);break;case 98:e=f.S3TC(7);break;default:throw t.thrown(this.entry.get_path()+" has unsupported DXGI format "+s)}this.inf.pixelFormat=e,u=n.readInt32(),n.skip(4),this.inf.layerCount=n.readInt32()}else switch(d){case 16:if(l==65535)if(i==0)if(c==0)if(a==0)this.inf.pixelFormat=f.R16U;else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));break;case 32:switch(l){case 255:if(i==65280)if(c==16711680)if(a==-16777216)this.inf.pixelFormat=f.RGBA;else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));break;case 65535:if(i==-65536)if(c==0)if(a==0)this.inf.pixelFormat=f.RG16U;else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));break;case 16711680:if(i==65280)if(c==255)if(a==-16777216)this.inf.pixelFormat=f.BGRA;else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));else throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a));break;default:throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a))}break;default:throw t.thrown("Unsupported RGB DDS "+d+"bits "+M.hex(l)+"/"+M.hex(i)+"/"+M.hex(c)+"/"+M.hex(a))}break;case 36:if(r==808540228){switch(n.skip(12),this.inf.flags|=1<<kt.Dxt10Header._hx_index,s=n.readInt32(),s){case 28:e=f.RGBA;break;case 71:e=f.S3TC(1);break;case 74:e=f.S3TC(2);break;case 77:e=f.S3TC(3);break;case 95:e=f.S3TC(6);break;case 98:e=f.S3TC(7);break;default:throw t.thrown(this.entry.get_path()+" has unsupported DXGI format "+s)}this.inf.pixelFormat=e,u=n.readInt32(),n.skip(4),this.inf.layerCount=n.readInt32()}else this.inf.pixelFormat=f.RGBA16U;break;case 111:if(r==808540228){switch(n.skip(12),this.inf.flags|=1<<kt.Dxt10Header._hx_index,s=n.readInt32(),s){case 28:e=f.RGBA;break;case 71:e=f.S3TC(1);break;case 74:e=f.S3TC(2);break;case 77:e=f.S3TC(3);break;case 95:e=f.S3TC(6);break;case 98:e=f.S3TC(7);break;default:throw t.thrown(this.entry.get_path()+" has unsupported DXGI format "+s)}this.inf.pixelFormat=e,u=n.readInt32(),n.skip(4),this.inf.layerCount=n.readInt32()}else this.inf.pixelFormat=f.R16F;break;case 112:if(r==808540228){switch(n.skip(12),this.inf.flags|=1<<kt.Dxt10Header._hx_index,s=n.readInt32(),s){case 28:e=f.RGBA;break;case 71:e=f.S3TC(1);break;case 74:e=f.S3TC(2);break;case 77:e=f.S3TC(3);break;case 95:e=f.S3TC(6);break;case 98:e=f.S3TC(7);break;default:throw t.thrown(this.entry.get_path()+" has unsupported DXGI format "+s)}this.inf.pixelFormat=e,u=n.readInt32(),n.skip(4),this.inf.layerCount=n.readInt32()}else this.inf.pixelFormat=f.RG16F;break;case 113:if(r==808540228){switch(n.skip(12),this.inf.flags|=1<<kt.Dxt10Header._hx_index,s=n.readInt32(),s){case 28:e=f.RGBA;break;case 71:e=f.S3TC(1);break;case 74:e=f.S3TC(2);break;case 77:e=f.S3TC(3);break;case 95:e=f.S3TC(6);break;case 98:e=f.S3TC(7);break;default:throw t.thrown(this.entry.get_path()+" has unsupported DXGI format "+s)}this.inf.pixelFormat=e,u=n.readInt32(),n.skip(4),this.inf.layerCount=n.readInt32()}else this.inf.pixelFormat=f.RGBA16F;break;case 114:if(r==808540228){switch(n.skip(12),this.inf.flags|=1<<kt.Dxt10Header._hx_index,s=n.readInt32(),s){case 28:e=f.RGBA;break;case 71:e=f.S3TC(1);break;case 74:e=f.S3TC(2);break;case 77:e=f.S3TC(3);break;case 95:e=f.S3TC(6);break;case 98:e=f.S3TC(7);break;default:throw t.thrown(this.entry.get_path()+" has unsupported DXGI format "+s)}this.inf.pixelFormat=e,u=n.readInt32(),n.skip(4),this.inf.layerCount=n.readInt32()}else this.inf.pixelFormat=f.R32F;break;case 115:if(r==808540228){switch(n.skip(12),this.inf.flags|=1<<kt.Dxt10Header._hx_index,s=n.readInt32(),s){case 28:e=f.RGBA;break;case 71:e=f.S3TC(1);break;case 74:e=f.S3TC(2);break;case 77:e=f.S3TC(3);break;case 95:e=f.S3TC(6);break;case 98:e=f.S3TC(7);break;default:throw t.thrown(this.entry.get_path()+" has unsupported DXGI format "+s)}this.inf.pixelFormat=e,u=n.readInt32(),n.skip(4),this.inf.layerCount=n.readInt32()}else this.inf.pixelFormat=f.RG32F;break;case 116:if(r==808540228){switch(n.skip(12),this.inf.flags|=1<<kt.Dxt10Header._hx_index,s=n.readInt32(),s){case 28:e=f.RGBA;break;case 71:e=f.S3TC(1);break;case 74:e=f.S3TC(2);break;case 77:e=f.S3TC(3);break;case 95:e=f.S3TC(6);break;case 98:e=f.S3TC(7);break;default:throw t.thrown(this.entry.get_path()+" has unsupported DXGI format "+s)}this.inf.pixelFormat=e,u=n.readInt32(),n.skip(4),this.inf.layerCount=n.readInt32()}else this.inf.pixelFormat=f.RGBA32F;break;case 4805697:switch(y=(r>>>24)-48,y){case 1:e=f.S3TC(4);break;case 2:e=f.S3TC(5);break;default:e=null}this.inf.pixelFormat=e;break;case 5527620:switch(_=(r>>>24)-48,_){case 1:e=f.S3TC(1);break;case 2:case 3:e=f.S3TC(2);break;case 4:case 5:e=f.S3TC(3);break;default:e=null}this.inf.pixelFormat=e;break;default:if(r==808540228){switch(n.skip(12),this.inf.flags|=1<<kt.Dxt10Header._hx_index,s=n.readInt32(),s){case 28:e=f.RGBA;break;case 71:e=f.S3TC(1);break;case 74:e=f.S3TC(2);break;case 77:e=f.S3TC(3);break;case 95:e=f.S3TC(6);break;case 98:e=f.S3TC(7);break;default:throw t.thrown(this.entry.get_path()+" has unsupported DXGI format "+s)}this.inf.pixelFormat=e,u=n.readInt32(),n.skip(4),this.inf.layerCount=n.readInt32()}}if(this.inf.pixelFormat==null)throw b=String.fromCodePoint(r&255)+String.fromCodePoint(r>>8&255)+String.fromCodePoint(r>>16&255)+String.fromCodePoint(r>>>24),(r&255)==r&&(b=""+r),t.thrown(this.entry.get_path()+" has unsupported 4CC "+b);break;case 18759:this.inf.dataFormat=2,this.inf.pixelFormat=f.BGRA,n.readInt32(),this.inf.width=n.readUInt16(),this.inf.height=n.readUInt16();break;case 20617:for(this.inf.dataFormat=1,n.set_bigEndian(!0),n.skip(6);!0;){if(w=n.readInt32(),n.readInt32()==1229472850){switch(this.inf.width=n.readInt32(),this.inf.height=n.readInt32(),g=n.readByte(),p=n.readByte(),g){case 8:e=f.BGRA;break;case 16:switch(p){case 0:e=f.R16U;break;case 2:e=f.RGBA16U;break;case 4:e=f.RG16U;break;case 6:e=f.RGBA16U;break;default:throw t.thrown("Unsupported png format "+g+"/"+p+"("+this.entry.get_path()+")")}break;default:throw t.thrown("Unsupported png format "+g+"/"+p+"("+this.entry.get_path()+")")}this.inf.pixelFormat=e;break}n.skip(w+4)}break;case 55551:this.inf.dataFormat=0,this.inf.pixelFormat=f.BGRA,n.set_bigEndian(!0);_hx_loop3:for(;!0;)switch(n.readUInt16()){case 65472:case 65473:case 65474:x=n.readUInt16(),C=n.readByte(),this.inf.height=n.readUInt16(),this.inf.width=n.readUInt16();break _hx_loop3;default:n.skip(n.readUInt16()-2)}break;default:if(this.entry.get_extension()=="tga")this.inf.dataFormat=3,this.inf.pixelFormat=f.ARGB,n.skip(10),this.inf.width=n.readUInt16(),this.inf.height=n.readUInt16();else if(this.entry.get_extension()=="raw"){if(this.inf.dataFormat=5,this.inf.pixelFormat=f.R32F,h=Math.sqrt(this.entry.get_size()>>2)|0,this.entry.get_size()!=h*h*4)if(m=Math.sqrt(this.entry.get_size()>>1)|0,this.entry.get_size()==m*m*2)this.inf.pixelFormat=f.R16F,h=m;else throw t.thrown("RAW format does not match 32 bit per components on "+h+"x"+h);this.inf.width=this.inf.height=h}else throw t.thrown("Unsupported texture format "+this.entry.get_path())}if(n.close(),this.inf.pixelFormat==null)throw t.thrown("Unsupported internal format ("+this.entry.get_path()+")");if(We.MIPMAP_MAX_SIZE!=0&&this.inf.mipLevels>1)for(;((this.inf.width|this.inf.height)&7)==0&&this.inf.width>>1>=We.MIPMAP_MAX_SIZE&&this.inf.height>>1>=We.MIPMAP_MAX_SIZE;)this.inf.width>>=1,this.inf.height>>=1,this.inf.mipLevels--,this.inf.mipOffset++;return We.customCheckInfo(this),this.inf},getPixels:function(e,n){switch(n==null&&(n=0),this.getInfo().dataFormat){case 0:var i,a,r,c,l,d,u,h,m,p,g,v,b,j,y,_,w,O,x,C,E,k,S,M,F,T,z,D,s=this.entry.getBytes();if(this.inf.pixelFormat!=f.BGRA)throw t.thrown("No support to decode "+o.string(this.inf.pixelFormat)+" on this platform ("+this.entry.get_path()+")");try{g=Me.decode(s)}catch(e){throw z=t.caught(e).unwrap(),t.thrown("Failed to decode JPG "+this.entry.get_path()+" ("+o.string(z)+")")}i=new G(g.width,g.height,g.pixels,f.BGRA);break;case 1:switch(s=this.entry.getBytes(),O=new Oc(new Nt(s)),O.checkCRC=!1,i=G.alloc(this.inf.width,this.inf.height,this.inf.pixelFormat),_=O.read(),this.inf.pixelFormat._hx_index){case 1:tt.extract32(_,i.bytes,!1);break;case 18:case 19:case 20:case 21:M=i.bytes,this.inf.pixelFormat==f.RGBA16U?(c=tt.getHeader(_).color,w=c._hx_index==1&&c.alpha==!1):w=!1,tt.extract(_,M,w);break;default:throw t.thrown("No support to decode "+o.string(this.inf.pixelFormat)+" on this platform ("+this.entry.get_path()+")")}break;case 2:s=this.entry.getBytes(),C=new cc(new Nt(s)).read(),e==f.RGBA?i=new G(this.inf.width,this.inf.height,vn.extractFullRGBA(C,0),f.RGBA):i=new G(this.inf.width,this.inf.height,vn.extractFullBGRA(C,0),f.BGRA);break;case 3:if(s=this.entry.getBytes(),l=new Lc(new Nt(s)).read(),l.header.imageType!=Xe.UncompressedTrueColor||l.header.bitsPerPixel!=32)throw t.thrown("Not supported TGA "+o.string(l.header.imageType)+"/"+l.header.bitsPerPixel);if(r=l.header.width,a=l.header.height,e==f.RGBA)for(i=G.alloc(r,a,f.RGBA),s=i.bytes,c=0,m=r*a;c<m;)h=c++,d=l.imageData[h],d=d>>>24|d<<8,s.setInt32(h<<2,d);else for(i=G.alloc(r,a,f.ARGB),y=qc.fromPixels(i),g=0,c=0,m=a;c<m;)for(S=c++,x=0,T=r;x<T;)F=x++,d=l.imageData[g++],y.bytes.setInt32((F+S*y.width<<2)+y.offset,d>>>24|d>>8&65280|d<<8&16711680|d<<24);switch(l.header.imageOrigin._hx_index){case 0:i.flipY();break;case 2:break;default:throw t.thrown("Not supported "+o.string(l.header.imageOrigin))}break;case 4:if(u=128,v=0,(this.inf.flags&1<<kt.Dxt10Header._hx_index)!=0&&(u+=20),n+=this.inf.mipOffset,n>0){for(b=this.inf.mipLevels+this.inf.mipOffset,D=G.calcStride(1,this.inf.pixelFormat),k=n/b|0,v=n%b,E=0,c=0,m=b;c<m;)if(h=c++,r=this.inf.width<<this.inf.mipOffset>>h,a=this.inf.height<<this.inf.mipOffset>>h,r==0&&(r=1),a==0&&(a=1),p=G.calcDataSize(r,a,this.inf.pixelFormat),E+=p,h<v)u+=p;else if(k==0)break;u+=E*k}r=this.inf.width>>v-this.inf.mipOffset,a=this.inf.height>>v-this.inf.mipOffset,r==0&&(r=1),a==0&&(a=1),this.inf.mipLevels+this.inf.mipOffset==1&&(this.inf.flags&1<<kt.IsCube._hx_index)==0?s=this.entry.getBytes():(p=G.calcDataSize(r,a,this.inf.pixelFormat),s=new A(new ArrayBuffer(p)),this.entry.readFull(s,u,p),u=0),i=new G(r,a,s,this.inf.pixelFormat,u);break;case 5:s=this.entry.getBytes(),i=new G(this.inf.width,this.inf.height,s,this.inf.pixelFormat);break;case 6:j=Gc.decode(this.entry.getBytes(),!1),i=new G(j.width,j.height,j.bytes,this.inf.pixelFormat);break}return e!=null&&i.convert(e),i},toBitmap:function(){this.getInfo();var e=new ns(this.inf.width,this.inf.height),t=this.getPixels();return e.setPixels(t),t.dispose(),e},watchCallb:function(){var e,t=this.inf;this.inf=null;try{this.getInfo()}catch{this.inf=t;return}e=this.getInfo(),(t.width!=e.width||t.height!=e.height)&&this.tex.resize(e.width,e.height),this.tex.realloc=null,this.loadTexture()},asyncLoad:function(e){if(this.tex!=null){var t,n=this.tex;t=n.t==null&&(n.isDepth()||n.realloc==null)}else t=!0;if(t)return;this.tex.dispose(),this.tex.flags&=-1-(1<<w.Loading._hx_index),this.tex.format=this.inf.pixelFormat,this.tex.width=this.inf.width,this.tex.height=this.inf.height,this.loadTexture(e)},loadTexture:function(e){var n,t=this;if(this.getInfo().dataFormat==0){this.tex.flags|=1<<w.Loading._hx_index,this.entry.loadBitmap(function(e){var n,o,i,s=Qc.toBitmap(e);if(t.tex.alloc(),t.tex.uploadBitmap(s),s.ctx=null,s.pixel=null,t.tex.realloc=function(){t.loadTexture()},t.tex.flags&=-1-(1<<w.Loading._hx_index),t.tex.waitLoads!=null)for(o=t.tex.waitLoads,t.tex.waitLoads=null,n=0;n<o.length;)i=o[n],++n,i();We.ENABLE_AUTO_WATCH&&!t.watchRegistered&&(t.watchRegistered=!0,t.watch(b(t,t.watchCallb)))});return}n=function(){if((t.enableAsyncLoading||(t.tex.flags&1<<w.AsyncLoading._hx_index)!=0)&&e==null&&We.ASYNC_LOADER!=null&&We.ASYNC_LOADER.isSupported(t)){t.tex.dispose(),t.tex.format=f.RGBA,t.tex.width=1,t.tex.height=1,t.tex.customMipLevels=1,t.tex.flags|=1<<w.Loading._hx_index,t.tex.alloc(),t.tex.uploadPixels(We.BLACK_1x1),t.tex.width=t.inf.width,t.tex.height=t.inf.height,We.ASYNC_LOADER.load(t),t.tex.realloc=function(){t.loadTexture()};return}var n,s,o,i,a,r,c,l,d,h,m,p,g,v,j,y,_,O,x,C,E,k=u.now()/1e3;if(t.tex.customMipLevels=t.inf.mipLevels,t.tex.alloc(),t.inf.dataFormat==4)for(o=128,(t.inf.flags&1<<kt.Dxt10Header._hx_index)!=0&&(o+=20),n=0,r=t.tex.get_layerCount();n<r;){for(c=n++,s=0,d=t.inf.mipOffset;s<d;)i=s++,C=t.inf.width<<t.inf.mipOffset>>i,y=t.inf.height<<t.inf.mipOffset>>i,x=G.calcDataSize(C,y,t.inf.pixelFormat),o+=x;for(v=0,O=t.inf.mipLevels;v<O;)h=v++,l=t.inf.width>>h,a=t.inf.height>>h,l==0&&(l=1),a==0&&(a=1),m=G.calcDataSize(l,a,t.inf.pixelFormat),_=e??t.entry.fetchBytes(o,m),t.tex.uploadPixels(new G(l,a,_,t.inf.pixelFormat,e==null?0:o),h,c),o+=m}else for(n=0,r=t.tex.get_layerCount();n<r;)for(c=n++,s=0,d=t.inf.mipLevels;s<d;)i=s++,j=t.getPixels(t.tex.format,c*t.inf.mipLevels+i),t.tex.uploadPixels(j,i,c),j.dispose();We.LOG_TEXTURE_LOAD&&e==null&&(g=(u.now()/1e3-k)*1e3,n=t.inf.pixelFormat,n._hx_index==22?(r=n.v,p=!0):p=!1,E=p?"DXT":gs.getName(t.inf.dataFormat),be.trace(E+" "+(g|0)+"."+(g*10|0)%10+"ms "+t.inf.width+"x"+t.inf.height+" "+t.entry.get_path(),{fileName:"hxd/res/Image.hx",lineNumber:628,className:"hxd.res.Image",methodName:"loadTexture"})),t.tex.realloc=function(){t.loadTexture()},We.ENABLE_AUTO_WATCH&&!t.watchRegistered&&(t.watchRegistered=!0,t.watch(b(t,t.watchCallb)))},this.entry.get_isAvailable()?n():this.entry.load(n)},toTexture:function(){var e,t,n=this;return this.tex!=null?this.tex:(this.getInfo(),t=[w.NoAlloc],e=this.inf.pixelFormat,(e==f.BGRA||e==f.ARGB||e==f.RGBA)&&(e=S.nativeFormat),(this.inf.flags&1<<kt.IsCube._hx_index)!=0&&t.push(w.Cube),this.inf.mipLevels>1&&(t.push(w.MipMapped),t.push(w.ManualMipMapGen)),this.inf.layerCount>1?this.tex=new oa(this.inf.width,this.inf.height,this.inf.layerCount,t,e):this.tex=new S(this.inf.width,this.inf.height,t,e),We.DEFAULT_FILTER!=Dn.Linear&&this.tex.set_filter(We.DEFAULT_FILTER),this.tex.setName(this.entry.get_path()),We.setupTextureFlags(this.tex),(this.tex.flags&1<<w.IsArray._hx_index)!=0||(this.tex.flags&1<<w.LazyLoading._hx_index)==0?this.loadTexture():this.tex.realloc=function(){n.loadTexture()},this.tex)},toTile:function(){return this.getInfo(),Ue.fromTexture(this.toTexture()).sub(0,0,this.inf.width,this.inf.height)},__class__:We}),Kt=function(e){this.fs=e,this.cache=new fe},c["hxd.res.Loader"]=Kt,Kt.__name__="hxd.res.Loader",Kt.prototype={cleanCache:function(){this.cache=new fe},dir:function(e){for(var o,n=[],s=this.fs.dir(e),t=0;t<s.length;)o=s[t],++t,n.push(new ho(this,o));return n},exists:function(e){return this.fs.exists(e)},load:function(e){return new ho(this,this.fs.get(e))},loadCache:function(e,n){var i,a,s=this.cache.h[e];if(s==null)i=this.fs.get(e),a=Kt.currentInstance,Kt.currentInstance=this,s=Y.createInstance(n,[i]),Kt.currentInstance=a,this.cache.h[e]=s;else if((H.__downcastCheck(s,n)?s:null)==null)throw t.thrown(e+" has been reintrepreted from "+o.string(H.getClass(s))+" to "+o.string(n));return s},dispose:function(){this.cleanCache(),this.fs.dispose()},__class__:Kt},lr=function(e){dt.call(this,e)},c["hxd.res.Model"]=lr,lr.__name__="hxd.res.Model",lr.__super__=dt,lr.prototype=g(dt.prototype,{toHmd:function(){var e=this.entry.open(),t=new Qn(e).readHeader();return e.close(),new es(this,t)},__class__:lr}),Yi=_["hxd.res.Filter"]={__ename__:!0,__constructs__:null,Fast:{_hx_name:"Fast",_hx_index:0,__enum__:"hxd.res.Filter",toString:s},Chromatic:{_hx_name:"Chromatic",_hx_index:1,__enum__:"hxd.res.Filter",toString:s}},Yi.__constructs__=[Yi.Fast,Yi.Chromatic],Yi.__empty_constructs__=[Yi.Fast,Yi.Chromatic],Zc={},Zc._new=function(e){return e},Zc.get=function(e,t){return e.b[t]},Zc.set=function(e,t,n){e.b[t]=n},Ki=function(){},c["hxd.res._NanoJpeg.Component"]=Ki,Ki.__name__="hxd.res._NanoJpeg.Component",Ki.prototype={__class__:Ki},Me=function(){this.comps=[new Ki,new Ki,new Ki].slice(0),this.qtab=[new Array(64),new Array(64),new Array(64),new Array(64)].slice(0),this.counts=new Array(16),this.block=new Array(64),this.njZZ=[0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63].slice(0),this.vlctab=[null,null,null,null,null,null,null,null].slice(0)},c["hxd.res.NanoJpeg"]=Me,Me.__name__="hxd.res.NanoJpeg",Me.CF=function(e){var t=e+64>>7;return t<0?0:t>255?255:t},Me.njClip=function(e){return e<0?0:e>255?255:e},Me.decode=function(e,t,n,s){return s==null&&(s=-1),n==null&&(n=0),Me.inst==null&&(Me.inst=new Me),Me.inst.njInit(e,n,s,t),Me.inst.njDecode()},Me.prototype={alloc:function(e){return new A(new ArrayBuffer(e))},free:function(){},njInit:function(e,t,n,s){this.bytes=e,this.pos=t,this.filter=s??Yi.Chromatic,n<0&&(n=e.length-t),this.vlctab[0]==null&&(this.vlctab[0]=new A(new ArrayBuffer(131072))),this.vlctab[1]==null&&(this.vlctab[1]=new A(new ArrayBuffer(131072))),this.vlctab[2]==null&&(this.vlctab[2]=new A(new ArrayBuffer(131072))),this.vlctab[3]==null&&(this.vlctab[3]=new A(new ArrayBuffer(131072))),this.size=n,this.qtused=0,this.qtavail=0,this.rstinterval=0,this.length=0,this.buf=0,this.bufbits=0,this.progressive=!1,this.comps[0].dcpred=0,this.comps[1].dcpred=0,this.comps[2].dcpred=0},cleanup:function(){this.bytes=null;for(var t,e=0,n=this.comps;e<n.length;)t=n[e],++e,t.pixels!=null&&(t.pixels=null);this.vlctab[0]!=null&&(this.vlctab[0]=null),this.vlctab[1]!=null&&(this.vlctab[1]=null),this.vlctab[2]!=null&&(this.vlctab[2]=null),this.vlctab[3]!=null&&(this.vlctab[3]=null),this.vlctab[4]!=null&&(this.vlctab[4]=null),this.vlctab[5]!=null&&(this.vlctab[5]=null),this.vlctab[6]!=null&&(this.vlctab[6]=null),this.vlctab[7]!=null&&(this.vlctab[7]=null)},njSkip:function(e){this.pos+=e,this.size-=e,this.length-=e},syntax:function(){},get:function(e){return this.bytes.b[this.pos+e]},njDecode16:function(e){return this.bytes.b[this.pos+e]<<8|this.bytes.b[this.pos+(e+1)]},njByteAlign:function(){this.bufbits&=248},njShowBits:function(e){if(e==0)return 0;for(;this.bufbits<e;){if(this.size<=0){this.buf=this.buf<<8|255,this.bufbits+=8;continue}var t,n=this.bytes.b[this.pos];if(this.pos++,this.size--,this.bufbits+=8,this.buf=this.buf<<8|n,n==255)switch(t=this.bytes.b[this.pos],this.pos++,this.size--,t){case 217:this.size=0;break;case 0:case 255:break;default:this.buf=this.buf<<8|t,this.bufbits+=8}}return this.buf>>this.bufbits-e&(1<<e)-1},njSkipBits:function(e){this.bufbits<e&&this.njShowBits(e),this.bufbits-=e},njGetBits:function(e){var t=this.njShowBits(e);return this.bufbits-=e,t},njDecodeLength:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2},njSkipMarker:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2;var e=this.length;this.pos+=e,this.size-=e,this.length-=e},njDecodeSOF:function(){switch(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2,this.bytes.b[this.pos]!=8&&this.notSupported(),this.height=this.bytes.b[this.pos+1]<<8|this.bytes.b[this.pos+2],this.width=this.bytes.b[this.pos+3]<<8|this.bytes.b[this.pos+4],this.ncomp=this.bytes.b[this.pos+5],this.pos+=6,this.size-=6,this.length-=6,this.ncomp){case 1:case 3:break;default:this.notSupported()}for(var e,o,i,t=0,n=0,s=0,a=this.ncomp;s<a;)o=s++,e=this.comps[o],e.cid=this.bytes.b[this.pos],e.ssx=this.bytes.b[this.pos+1]>>4,(e.ssx&e.ssx-1)!=0&&this.notSupported(),e.ssy=this.bytes.b[this.pos+1]&15,(e.ssy&e.ssy-1)!=0&&this.notSupported(),e.qtsel=this.bytes.b[this.pos+2],this.pos+=3,this.size-=3,this.length-=3,this.qtused|=1<<e.qtsel,e.ssx>t&&(t=e.ssx),e.ssy>n&&(n=e.ssy);for(this.ncomp==1&&(e=this.comps[0],n=1,t=n,e.ssx=e.ssy=t),this.mbsizex=t<<3,this.mbsizey=n<<3,this.mbwidth=(this.width+this.mbsizex-1)/this.mbsizex|0,this.mbheight=(this.height+this.mbsizey-1)/this.mbsizey|0,s=0,a=this.ncomp;s<a;)o=s++,e=this.comps[o],e.width=(this.width*e.ssx+t-1)/t|0,e.stride=e.width+7&2147483640,e.height=(this.height*e.ssy+n-1)/n|0,e.stride=this.mbwidth*this.mbsizex*e.ssx/t|0,(e.width<3&&e.ssx!=t||e.height<3&&e.ssy!=n)&&this.notSupported(),e.pixels=new A(new ArrayBuffer(e.stride*(this.mbheight*this.mbsizey*e.ssy/n|0)));i=this.length,this.pos+=i,this.size-=i,this.length-=i},njDecodeDQT:function(){for(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2;this.length>=65;){var e,t,s,n=this.bytes.b[this.pos];for(this.qtavail|=1<<n,s=this.qtab[n],e=0;e<64;)t=e++,s[t]=this.bytes.b[this.pos+(t+1)];this.pos+=65,this.size-=65,this.length-=65}},njDecodeDHT:function(){for(this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2;this.length>=17;){var e,t,n,s,i,a,r,c,l,d,u,h,m,f,o=this.bytes.b[this.pos],o=o>>4&1|(o&3)<<1;for(this.counts[0]=this.bytes.b[this.pos+1],this.counts[1]=this.bytes.b[this.pos+2],this.counts[2]=this.bytes.b[this.pos+3],this.counts[3]=this.bytes.b[this.pos+4],this.counts[4]=this.bytes.b[this.pos+5],this.counts[5]=this.bytes.b[this.pos+6],this.counts[6]=this.bytes.b[this.pos+7],this.counts[7]=this.bytes.b[this.pos+8],this.counts[8]=this.bytes.b[this.pos+9],this.counts[9]=this.bytes.b[this.pos+10],this.counts[10]=this.bytes.b[this.pos+11],this.counts[11]=this.bytes.b[this.pos+12],this.counts[12]=this.bytes.b[this.pos+13],this.counts[13]=this.bytes.b[this.pos+14],this.counts[14]=this.bytes.b[this.pos+15],this.counts[15]=this.bytes.b[this.pos+16],this.pos+=17,this.size-=17,this.length-=17,s=this.vlctab[o],t=0,i=65536,r=65536,a=1;a<17;){if(n=a++,r>>=1,e=this.counts[n-1],e==0)continue;for(i-=e<<16-n,c=0,d=e;c<d;)for(u=c++,h=this.bytes.b[this.pos+u],l=0,m=r;l<m;)f=l++,s.b[t++]=n,s.b[t++]=h;this.pos+=e,this.size-=e,this.length-=e}for(;i--!=0;)s.b[t]=0,t+=2}},njDecodeDRI:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2,this.rstinterval=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1];var e=this.length;this.pos+=e,this.size-=e,this.length-=e},njGetVLC:function(e){var s,t=this.njShowBits(16),n=e.b[t<<1];return this.bufbits<n&&this.njShowBits(n),this.bufbits-=n,t=e.b[t<<1|1],this.vlcCode=t,n=t&15,n==0?0:(s=this.njShowBits(n),this.bufbits-=n,t=s,t<1<<n-1&&(t+=(-1<<n)+1),t)},njRowIDCT:function(e){var n,l,d,u,s=this.block[e+4]<<11,o=this.block[e+6],i=this.block[e+2],t=this.block[e+1],c=this.block[e+7],a=this.block[e+5],r=this.block[e+3];if((s|o|i|t|c|a|r)==0){l=this.block[e+7]=this.block[e]<<3,u=this.block[e+6]=l,l=this.block[e+5]=u,u=this.block[e+4]=l,l=this.block[e+3]=u,u=this.block[e+2]=l,l=this.block[e+1]=u,this.block[e]=l;return}d=(this.block[e]<<11)+128,n=565*(t+c),t=n+2276*t,c=n-3406*c,n=2408*(a+r),a=n-799*a,r=n-4017*r,n=d+s,d-=s,s=1108*(i+o),o=s-3784*o,i=s+1568*i,s=t+a,t-=a,a=c+r,c-=r,r=n+i,n-=i,i=d+o,d-=o,o=181*(t+c)+128>>8,t=181*(t-c)+128>>8,this.block[e]=r+s>>8,this.block[e+1]=i+o>>8,this.block[e+2]=d+t>>8,this.block[e+3]=n+a>>8,this.block[e+4]=n-a>>8,this.block[e+5]=d-t>>8,this.block[e+6]=i-o>>8,this.block[e+7]=r-s>>8},njColIDCT:function(e,t,n,s){var o,r,m,i=this.block[e+32]<<8,c=this.block[e+48],l=this.block[e+16],a=this.block[e+8],h=this.block[e+56],d=this.block[e+40],u=this.block[e+24];if((i|c|l|a|h|d|u)==0){o=(this.block[e]+32>>6)+128,i=o<0?0:o>255?255:o,t.b[n]=i,n+=s,t.b[n]=i,n+=s,t.b[n]=i,n+=s,t.b[n]=i,n+=s,t.b[n]=i,n+=s,t.b[n]=i,n+=s,t.b[n]=i,n+=s,t.b[n]=i,n+=s;return}m=(this.block[e]<<8)+8192,r=565*(a+h)+4,a=r+2276*a>>3,h=r-3406*h>>3,r=2408*(d+u)+4,d=r-799*d>>3,u=r-4017*u>>3,r=m+i,m-=i,i=1108*(l+c)+4,c=i-3784*c>>3,l=i+1568*l>>3,i=a+d,a-=d,d=h+u,h-=u,u=r+l,r-=l,l=m+c,m-=c,c=181*(a+h)+128>>8,a=181*(a-h)+128>>8,o=(u+i>>14)+128,t.b[n]=o<0?0:o>255?255:o,n+=s,o=(l+c>>14)+128,t.b[n]=o<0?0:o>255?255:o,n+=s,o=(m+a>>14)+128,t.b[n]=o<0?0:o>255?255:o,n+=s,o=(r+d>>14)+128,t.b[n]=o<0?0:o>255?255:o,n+=s,o=(r-d>>14)+128,t.b[n]=o<0?0:o>255?255:o,n+=s,o=(m-a>>14)+128,t.b[n]=o<0?0:o>255?255:o,n+=s,o=(l-c>>14)+128,t.b[n]=o<0?0:o>255?255:o,n+=s,o=(u-i>>14)+128,t.b[n]=o<0?0:o>255?255:o},njDecodeBlock:function(e,t){for(var n,s,o,i,a,r,c,l,d,u,h,f,p,g,v,b,j,_,w,O,x,C,E,k,A,M,m=e.pixels,y=0,S=0;S<64;)M=S++,this.block[M]=0;O=e,A=O.dcpred,C=this.vlctab[e.dctabsel],j=this.njShowBits(16),b=C.b[j<<1],this.bufbits<b&&this.njShowBits(b),this.bufbits-=b,j=C.b[j<<1|1],this.vlcCode=j,b=j&15,b==0?w=0:(_=this.njShowBits(b),this.bufbits-=b,j=_,j<1<<b-1&&(j+=(-1<<b)+1),w=j),O.dcpred=A+w,k=this.qtab[e.qtsel],E=this.vlctab[e.actabsel],this.block[0]=e.dcpred*k[0];do{if(j=this.njShowBits(16),b=E.b[j<<1],this.bufbits<b&&this.njShowBits(b),this.bufbits-=b,j=E.b[j<<1|1],this.vlcCode=j,b=j&15,b==0?x=0:(_=this.njShowBits(b),this.bufbits-=b,j=_,j<1<<b-1&&(j+=(-1<<b)+1),x=j),this.vlcCode==0)break;y+=(this.vlcCode>>4)+1,this.block[this.njZZ[y]]=x*k[y]}while(y<63)i=0,o=this.block[i+4]<<11,u=this.block[i+6],d=this.block[i+2],a=this.block[i+1],h=this.block[i+7],l=this.block[i+5],c=this.block[i+3],(o|u|d|a|h|l|c)==0?(g=this.block[i+7]=this.block[i]<<3,v=this.block[i+6]=g,g=this.block[i+5]=v,v=this.block[i+4]=g,g=this.block[i+3]=v,v=this.block[i+2]=g,g=this.block[i+1]=v,this.block[i]=g):(p=(this.block[i]<<11)+128,r=565*(a+h),a=r+2276*a,h=r-3406*h,r=2408*(l+c),l=r-799*l,c=r-4017*c,r=p+o,p-=o,o=1108*(d+u),u=o-3784*u,d=o+1568*d,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,this.block[i]=c+o>>8,this.block[i+1]=d+u>>8,this.block[i+2]=p+a>>8,this.block[i+3]=r+l>>8,this.block[i+4]=r-l>>8,this.block[i+5]=p-a>>8,this.block[i+6]=d-u>>8,this.block[i+7]=c-o>>8),i=8,o=this.block[i+4]<<11,u=this.block[i+6],d=this.block[i+2],a=this.block[i+1],h=this.block[i+7],l=this.block[i+5],c=this.block[i+3],(o|u|d|a|h|l|c)==0?(g=this.block[i+7]=this.block[i]<<3,v=this.block[i+6]=g,g=this.block[i+5]=v,v=this.block[i+4]=g,g=this.block[i+3]=v,v=this.block[i+2]=g,g=this.block[i+1]=v,this.block[i]=g):(p=(this.block[i]<<11)+128,r=565*(a+h),a=r+2276*a,h=r-3406*h,r=2408*(l+c),l=r-799*l,c=r-4017*c,r=p+o,p-=o,o=1108*(d+u),u=o-3784*u,d=o+1568*d,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,this.block[i]=c+o>>8,this.block[i+1]=d+u>>8,this.block[i+2]=p+a>>8,this.block[i+3]=r+l>>8,this.block[i+4]=r-l>>8,this.block[i+5]=p-a>>8,this.block[i+6]=d-u>>8,this.block[i+7]=c-o>>8),i=16,o=this.block[i+4]<<11,u=this.block[i+6],d=this.block[i+2],a=this.block[i+1],h=this.block[i+7],l=this.block[i+5],c=this.block[i+3],(o|u|d|a|h|l|c)==0?(g=this.block[i+7]=this.block[i]<<3,v=this.block[i+6]=g,g=this.block[i+5]=v,v=this.block[i+4]=g,g=this.block[i+3]=v,v=this.block[i+2]=g,g=this.block[i+1]=v,this.block[i]=g):(p=(this.block[i]<<11)+128,r=565*(a+h),a=r+2276*a,h=r-3406*h,r=2408*(l+c),l=r-799*l,c=r-4017*c,r=p+o,p-=o,o=1108*(d+u),u=o-3784*u,d=o+1568*d,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,this.block[i]=c+o>>8,this.block[i+1]=d+u>>8,this.block[i+2]=p+a>>8,this.block[i+3]=r+l>>8,this.block[i+4]=r-l>>8,this.block[i+5]=p-a>>8,this.block[i+6]=d-u>>8,this.block[i+7]=c-o>>8),i=24,o=this.block[i+4]<<11,u=this.block[i+6],d=this.block[i+2],a=this.block[i+1],h=this.block[i+7],l=this.block[i+5],c=this.block[i+3],(o|u|d|a|h|l|c)==0?(g=this.block[i+7]=this.block[i]<<3,v=this.block[i+6]=g,g=this.block[i+5]=v,v=this.block[i+4]=g,g=this.block[i+3]=v,v=this.block[i+2]=g,g=this.block[i+1]=v,this.block[i]=g):(p=(this.block[i]<<11)+128,r=565*(a+h),a=r+2276*a,h=r-3406*h,r=2408*(l+c),l=r-799*l,c=r-4017*c,r=p+o,p-=o,o=1108*(d+u),u=o-3784*u,d=o+1568*d,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,this.block[i]=c+o>>8,this.block[i+1]=d+u>>8,this.block[i+2]=p+a>>8,this.block[i+3]=r+l>>8,this.block[i+4]=r-l>>8,this.block[i+5]=p-a>>8,this.block[i+6]=d-u>>8,this.block[i+7]=c-o>>8),i=32,o=this.block[i+4]<<11,u=this.block[i+6],d=this.block[i+2],a=this.block[i+1],h=this.block[i+7],l=this.block[i+5],c=this.block[i+3],(o|u|d|a|h|l|c)==0?(g=this.block[i+7]=this.block[i]<<3,v=this.block[i+6]=g,g=this.block[i+5]=v,v=this.block[i+4]=g,g=this.block[i+3]=v,v=this.block[i+2]=g,g=this.block[i+1]=v,this.block[i]=g):(p=(this.block[i]<<11)+128,r=565*(a+h),a=r+2276*a,h=r-3406*h,r=2408*(l+c),l=r-799*l,c=r-4017*c,r=p+o,p-=o,o=1108*(d+u),u=o-3784*u,d=o+1568*d,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,this.block[i]=c+o>>8,this.block[i+1]=d+u>>8,this.block[i+2]=p+a>>8,this.block[i+3]=r+l>>8,this.block[i+4]=r-l>>8,this.block[i+5]=p-a>>8,this.block[i+6]=d-u>>8,this.block[i+7]=c-o>>8),i=40,o=this.block[i+4]<<11,u=this.block[i+6],d=this.block[i+2],a=this.block[i+1],h=this.block[i+7],l=this.block[i+5],c=this.block[i+3],(o|u|d|a|h|l|c)==0?(g=this.block[i+7]=this.block[i]<<3,v=this.block[i+6]=g,g=this.block[i+5]=v,v=this.block[i+4]=g,g=this.block[i+3]=v,v=this.block[i+2]=g,g=this.block[i+1]=v,this.block[i]=g):(p=(this.block[i]<<11)+128,r=565*(a+h),a=r+2276*a,h=r-3406*h,r=2408*(l+c),l=r-799*l,c=r-4017*c,r=p+o,p-=o,o=1108*(d+u),u=o-3784*u,d=o+1568*d,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,this.block[i]=c+o>>8,this.block[i+1]=d+u>>8,this.block[i+2]=p+a>>8,this.block[i+3]=r+l>>8,this.block[i+4]=r-l>>8,this.block[i+5]=p-a>>8,this.block[i+6]=d-u>>8,this.block[i+7]=c-o>>8),i=48,o=this.block[i+4]<<11,u=this.block[i+6],d=this.block[i+2],a=this.block[i+1],h=this.block[i+7],l=this.block[i+5],c=this.block[i+3],(o|u|d|a|h|l|c)==0?(g=this.block[i+7]=this.block[i]<<3,v=this.block[i+6]=g,g=this.block[i+5]=v,v=this.block[i+4]=g,g=this.block[i+3]=v,v=this.block[i+2]=g,g=this.block[i+1]=v,this.block[i]=g):(p=(this.block[i]<<11)+128,r=565*(a+h),a=r+2276*a,h=r-3406*h,r=2408*(l+c),l=r-799*l,c=r-4017*c,r=p+o,p-=o,o=1108*(d+u),u=o-3784*u,d=o+1568*d,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,this.block[i]=c+o>>8,this.block[i+1]=d+u>>8,this.block[i+2]=p+a>>8,this.block[i+3]=r+l>>8,this.block[i+4]=r-l>>8,this.block[i+5]=p-a>>8,this.block[i+6]=d-u>>8,this.block[i+7]=c-o>>8),i=56,o=this.block[i+4]<<11,u=this.block[i+6],d=this.block[i+2],a=this.block[i+1],h=this.block[i+7],l=this.block[i+5],c=this.block[i+3],(o|u|d|a|h|l|c)==0?(g=this.block[i+7]=this.block[i]<<3,v=this.block[i+6]=g,g=this.block[i+5]=v,v=this.block[i+4]=g,g=this.block[i+3]=v,v=this.block[i+2]=g,g=this.block[i+1]=v,this.block[i]=g):(p=(this.block[i]<<11)+128,r=565*(a+h),a=r+2276*a,h=r-3406*h,r=2408*(l+c),l=r-799*l,c=r-4017*c,r=p+o,p-=o,o=1108*(d+u),u=o-3784*u,d=o+1568*d,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,this.block[i]=c+o>>8,this.block[i+1]=d+u>>8,this.block[i+2]=p+a>>8,this.block[i+3]=r+l>>8,this.block[i+4]=r-l>>8,this.block[i+5]=p-a>>8,this.block[i+6]=d-u>>8,this.block[i+7]=c-o>>8),s=t,f=e.stride,o=this.block[32]<<8,u=this.block[48],d=this.block[16],a=this.block[8],h=this.block[56],l=this.block[40],c=this.block[24],(o|u|d|a|h|l|c)==0?(n=(this.block[0]+32>>6)+128,o=n<0?0:n>255?255:n,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f):(p=(this.block[0]<<8)+8192,r=565*(a+h)+4,a=r+2276*a>>3,h=r-3406*h>>3,r=2408*(l+c)+4,l=r-799*l>>3,c=r-4017*c>>3,r=p+o,p-=o,o=1108*(d+u)+4,u=o-3784*u>>3,d=o+1568*d>>3,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,n=(c+o>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d+u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p+a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r+l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r-l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p-a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d-u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(c-o>>14)+128,m.b[s]=n<0?0:n>255?255:n),s=1+t,f=e.stride,o=this.block[33]<<8,u=this.block[49],d=this.block[17],a=this.block[9],h=this.block[57],l=this.block[41],c=this.block[25],(o|u|d|a|h|l|c)==0?(n=(this.block[1]+32>>6)+128,o=n<0?0:n>255?255:n,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f):(p=(this.block[1]<<8)+8192,r=565*(a+h)+4,a=r+2276*a>>3,h=r-3406*h>>3,r=2408*(l+c)+4,l=r-799*l>>3,c=r-4017*c>>3,r=p+o,p-=o,o=1108*(d+u)+4,u=o-3784*u>>3,d=o+1568*d>>3,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,n=(c+o>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d+u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p+a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r+l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r-l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p-a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d-u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(c-o>>14)+128,m.b[s]=n<0?0:n>255?255:n),s=2+t,f=e.stride,o=this.block[34]<<8,u=this.block[50],d=this.block[18],a=this.block[10],h=this.block[58],l=this.block[42],c=this.block[26],(o|u|d|a|h|l|c)==0?(n=(this.block[2]+32>>6)+128,o=n<0?0:n>255?255:n,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f):(p=(this.block[2]<<8)+8192,r=565*(a+h)+4,a=r+2276*a>>3,h=r-3406*h>>3,r=2408*(l+c)+4,l=r-799*l>>3,c=r-4017*c>>3,r=p+o,p-=o,o=1108*(d+u)+4,u=o-3784*u>>3,d=o+1568*d>>3,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,n=(c+o>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d+u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p+a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r+l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r-l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p-a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d-u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(c-o>>14)+128,m.b[s]=n<0?0:n>255?255:n),s=3+t,f=e.stride,o=this.block[35]<<8,u=this.block[51],d=this.block[19],a=this.block[11],h=this.block[59],l=this.block[43],c=this.block[27],(o|u|d|a|h|l|c)==0?(n=(this.block[3]+32>>6)+128,o=n<0?0:n>255?255:n,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f):(p=(this.block[3]<<8)+8192,r=565*(a+h)+4,a=r+2276*a>>3,h=r-3406*h>>3,r=2408*(l+c)+4,l=r-799*l>>3,c=r-4017*c>>3,r=p+o,p-=o,o=1108*(d+u)+4,u=o-3784*u>>3,d=o+1568*d>>3,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,n=(c+o>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d+u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p+a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r+l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r-l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p-a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d-u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(c-o>>14)+128,m.b[s]=n<0?0:n>255?255:n),s=4+t,f=e.stride,o=this.block[36]<<8,u=this.block[52],d=this.block[20],a=this.block[12],h=this.block[60],l=this.block[44],c=this.block[28],(o|u|d|a|h|l|c)==0?(n=(this.block[4]+32>>6)+128,o=n<0?0:n>255?255:n,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f):(p=(this.block[4]<<8)+8192,r=565*(a+h)+4,a=r+2276*a>>3,h=r-3406*h>>3,r=2408*(l+c)+4,l=r-799*l>>3,c=r-4017*c>>3,r=p+o,p-=o,o=1108*(d+u)+4,u=o-3784*u>>3,d=o+1568*d>>3,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,n=(c+o>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d+u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p+a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r+l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r-l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p-a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d-u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(c-o>>14)+128,m.b[s]=n<0?0:n>255?255:n),s=5+t,f=e.stride,o=this.block[37]<<8,u=this.block[53],d=this.block[21],a=this.block[13],h=this.block[61],l=this.block[45],c=this.block[29],(o|u|d|a|h|l|c)==0?(n=(this.block[5]+32>>6)+128,o=n<0?0:n>255?255:n,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f):(p=(this.block[5]<<8)+8192,r=565*(a+h)+4,a=r+2276*a>>3,h=r-3406*h>>3,r=2408*(l+c)+4,l=r-799*l>>3,c=r-4017*c>>3,r=p+o,p-=o,o=1108*(d+u)+4,u=o-3784*u>>3,d=o+1568*d>>3,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,n=(c+o>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d+u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p+a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r+l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r-l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p-a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d-u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(c-o>>14)+128,m.b[s]=n<0?0:n>255?255:n),s=6+t,f=e.stride,o=this.block[38]<<8,u=this.block[54],d=this.block[22],a=this.block[14],h=this.block[62],l=this.block[46],c=this.block[30],(o|u|d|a|h|l|c)==0?(n=(this.block[6]+32>>6)+128,o=n<0?0:n>255?255:n,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f):(p=(this.block[6]<<8)+8192,r=565*(a+h)+4,a=r+2276*a>>3,h=r-3406*h>>3,r=2408*(l+c)+4,l=r-799*l>>3,c=r-4017*c>>3,r=p+o,p-=o,o=1108*(d+u)+4,u=o-3784*u>>3,d=o+1568*d>>3,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,n=(c+o>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d+u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p+a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r+l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r-l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p-a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d-u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(c-o>>14)+128,m.b[s]=n<0?0:n>255?255:n),s=7+t,f=e.stride,o=this.block[39]<<8,u=this.block[55],d=this.block[23],a=this.block[15],h=this.block[63],l=this.block[47],c=this.block[31],(o|u|d|a|h|l|c)==0?(n=(this.block[7]+32>>6)+128,o=n<0?0:n>255?255:n,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f,m.b[s]=o,s+=f):(p=(this.block[7]<<8)+8192,r=565*(a+h)+4,a=r+2276*a>>3,h=r-3406*h>>3,r=2408*(l+c)+4,l=r-799*l>>3,c=r-4017*c>>3,r=p+o,p-=o,o=1108*(d+u)+4,u=o-3784*u>>3,d=o+1568*d>>3,o=a+l,a-=l,l=h+c,h-=c,c=r+d,r-=d,d=p+u,p-=u,u=181*(a+h)+128>>8,a=181*(a-h)+128>>8,n=(c+o>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d+u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p+a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r+l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(r-l>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(p-a>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(d-u>>14)+128,m.b[s]=n<0?0:n>255?255:n,s+=f,n=(c-o>>14)+128,m.b[s]=n<0?0:n>255?255:n)},notSupported:function(){throw t.thrown("This JPG file is not supported")},njDecodeScan:function(){this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2,this.bytes.b[this.pos]!=this.ncomp&&this.notSupported(),this.pos+=1,this.size-=1,this.length-=1;for(var e,t,s,o,i,a,r,l,d,u,h,m,f,p,g,v,b,n=0,c=this.ncomp;n<c;)s=n++,e=this.comps[s],e.dctabsel=this.bytes.b[this.pos+1]>>4<<1,e.actabsel=(this.bytes.b[this.pos+1]&3)<<1|1,this.pos+=2,this.size-=2,this.length-=2;for(r=this.bytes.b[this.pos],t=this.bytes.b[this.pos+1],f=this.bytes.b[this.pos+2],(!this.progressive&&r!=0||t!=63-r||f!=0)&&this.notSupported(),t=this.length,this.pos+=t,this.size-=t,this.length-=t,o=0,i=0,l=this.rstinterval,d=0;!0;){for(n=0,c=this.ncomp;n<c;)for(s=n++,e=this.comps[s],u=0,h=e.ssy;u<h;)for(m=u++,a=0,p=e.ssx;a<p;)g=a++,this.njDecodeBlock(e,(i*e.ssy+m)*e.stride+o*e.ssx+g<<3);if(++o>=this.mbwidth&&(o=0,++i>=this.mbheight))break;this.rstinterval!=0&&--l==0&&(this.bufbits&=248,v=this.njShowBits(16),this.bufbits-=16,b=v,d=d+1&7,l=this.rstinterval,this.comps[0].dcpred=0,this.comps[1].dcpred=0,this.comps[2].dcpred=0)}},njUpsampleH:function(e){for(var s,a,r,c,l,d,u,h,m,f,p,j,b=e.width-3,g=new A(new ArrayBuffer(e.width*e.height<<1)),i=g,n=e.pixels,t=0,o=0,v=0,y=e.height;v<y;){for(j=v++,d=139*n.b[t]+-11*n.b[t+1]+64>>7,i.b[o]=d<0?0:d>255?255:d,a=104*n.b[t]+27*n.b[t+1]+-3*n.b[t+2]+64>>7,i.b[o+1]=a<0?0:a>255?255:a,h=28*n.b[t]+109*n.b[t+1]+-9*n.b[t+2]+64>>7,i.b[o+2]=h<0?0:h>255?255:h,f=0,p=b;f<p;)s=f++,r=-9*n.b[t+s]+111*n.b[t+s+1]+29*n.b[t+s+2]+-3*n.b[t+s+3]+64>>7,i.b[o+(s<<1)+3]=r<0?0:r>255?255:r,m=-3*n.b[t+s]+29*n.b[t+s+1]+111*n.b[t+s+2]+-9*n.b[t+s+3]+64>>7,i.b[o+(s<<1)+4]=m<0?0:m>255?255:m;t+=e.stride,o+=e.width<<1,u=28*n.b[t-1]+109*n.b[t-2]+-9*n.b[t-3]+64>>7,i.b[o-3]=u<0?0:u>255?255:u,l=104*n.b[t-1]+27*n.b[t-2]+-3*n.b[t-3]+64>>7,i.b[o-2]=l<0?0:l>255?255:l,c=139*n.b[t-1]+-11*n.b[t-2]+64>>7,i.b[o-1]=c<0?0:c>255?255:c}e.width<<=1,e.stride=e.width,e.pixels=g},njUpsampleV:function(e){for(var c,l,d,u,h,m,f,p,g,v,b,_,i=e.width,o=e.stride,r=o+o,y=new A(new ArrayBuffer(e.width*e.height<<1)),t=0,s=0,a=y,n=e.pixels,j=0,w=i;j<w;){for(v=j++,s=v,t=s,h=139*n.b[t]+-11*n.b[t+o]+64>>7,a.b[s]=h<0?0:h>255?255:h,s+=i,m=104*n.b[t]+27*n.b[t+o]+-3*n.b[t+r]+64>>7,a.b[s]=m<0?0:m>255?255:m,s+=i,f=28*n.b[t]+109*n.b[t+o]+-9*n.b[t+r]+64>>7,a.b[s]=f<0?0:f>255?255:f,s+=i,t+=o,g=0,b=e.height-2;g<b;)_=g++,l=-9*n.b[t-o]+111*n.b[t]+29*n.b[t+o]+-3*n.b[t+r]+64>>7,a.b[s]=l<0?0:l>255?255:l,s+=i,p=-3*n.b[t-o]+29*n.b[t]+111*n.b[t+o]+-9*n.b[t+r]+64>>7,a.b[s]=p<0?0:p>255?255:p,s+=i,t+=o;t+=o,d=28*n.b[t]+109*n.b[t-o]+-9*n.b[t-r]+64>>7,a.b[s]=d<0?0:d>255?255:d,s+=i,c=104*n.b[t]+27*n.b[t-o]+-3*n.b[t-r]+64>>7,a.b[s]=c<0?0:c>255?255:c,s+=i,u=139*n.b[t]+-11*n.b[t-o]+64>>7,a.b[s]=u<0?0:u>255?255:u}e.height<<=1,e.stride=e.width,e.pixels=y},njUpsample:function(e){for(var t,n,s,o,i,a,c,l,d,h,m,r=0,u=0;e.width<this.width;)e.width<<=1,++r;for(;e.height<this.height;)e.height<<=1,++u;for(s=new A(new ArrayBuffer(e.width*e.height)),o=e.pixels,i=0,a=s,t=0,c=e.height;t<c;)for(l=t++,d=(l>>u)*e.stride,n=0,h=e.width;n<h;)m=n++,a.b[i++]=o.b[(m>>r)+d];e.stride=e.width,e.pixels=s},njConvert:function(){for(var e,n,o,i,a,r,c,l,d,u,h,f,p,g,v,b,j,y,_,w,O,x,C,E,s=0,m=this.ncomp;s<m;){switch(_=s++,e=this.comps[_],this.filter._hx_index){case 0:(e.width<this.width||e.height<this.height)&&this.njUpsample(e);break;case 1:for(;e.width<this.width||e.height<this.height;)e.width<this.width&&this.njUpsampleH(e),e.height<this.height&&this.njUpsampleV(e);break}if(e.width<this.width||e.height<this.height)throw t.thrown("assert")}if(g=new A(new ArrayBuffer(this.width*this.height*4)),this.ncomp==3)for(j=this.comps[0].pixels,b=this.comps[1].pixels,O=this.comps[2].pixels,n=g,f=0,u=0,h=0,o=0,s=0,m=this.height;s<m;){for(E=s++,p=0,y=this.width;p<y;)C=p++,c=j.b[f++]<<8,l=b.b[u++]-128,d=O.b[h++]-128,r=c+359*d+128>>8,v=r<0?0:r>255?255:r,a=c-88*l-183*d+128>>8,w=a<0?0:a>255?255:a,i=c+454*l+128>>8,x=i<0?0:i>255?255:i,n.b[o++]=x,n.b[o++]=w,n.b[o++]=v,n.b[o++]=255;f+=this.comps[0].stride-this.width,u+=this.comps[1].stride-this.width,h+=this.comps[2].stride-this.width}else throw t.thrown("TODO");return g},njDecode:function(){if(this.size<2||this.bytes.b[this.pos]!=255||this.bytes.b[this.pos+1]!=216)throw t.thrown("This file is not a JPEG");this.pos+=2,this.size-=2,this.length-=2;_hx_loop1:for(;!0;)switch(this.pos+=2,this.size-=2,this.length-=2,this.bytes.b[this.pos+-1]){case 192:this.njDecodeSOF();break;case 194:if(this.progressive=!0,this.progressive)throw t.thrown("Unsupported progressive JPG");this.vlctab[4]==null&&(this.vlctab[4]=new A(new ArrayBuffer(131072))),this.vlctab[5]==null&&(this.vlctab[5]=new A(new ArrayBuffer(131072))),this.vlctab[6]==null&&(this.vlctab[6]=new A(new ArrayBuffer(131072))),this.vlctab[7]==null&&(this.vlctab[7]=new A(new ArrayBuffer(131072))),this.njDecodeSOF();break;case 195:throw t.thrown("Unsupported lossless JPG");case 196:this.njDecodeDHT();break;case 218:this.njDecodeScan();break _hx_loop1;case 219:this.njDecodeDQT();break;case 221:this.njDecodeDRI();break;case 254:this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2;var e,s,n=this.length;this.pos+=n,this.size-=n,this.length-=n;break;default:switch(this.bytes.b[this.pos+-1]&240){case 192:throw t.thrown("Unsupported jpeg type "+(this.bytes.b[this.pos+-1]&15));case 224:this.length=this.bytes.b[this.pos]<<8|this.bytes.b[this.pos+1],this.pos+=2,this.size-=2,this.length-=2,e=this.length,this.pos+=e,this.size-=e,this.length-=e;break;default:throw t.thrown("Unsupported jpeg tag 0x"+M.hex(this.bytes.b[this.pos+-1],2))}}return s=this.njConvert(),this.cleanup(),{pixels:s,width:this.width,height:this.height}},__class__:Me},di=_["hxd.res.SoundFormat"]={__ename__:!0,__constructs__:null,Wav:{_hx_name:"Wav",_hx_index:0,__enum__:"hxd.res.SoundFormat",toString:s},Mp3:{_hx_name:"Mp3",_hx_index:1,__enum__:"hxd.res.SoundFormat",toString:s},OggVorbis:{_hx_name:"OggVorbis",_hx_index:2,__enum__:"hxd.res.SoundFormat",toString:s}},di.__constructs__=[di.Wav,di.Mp3,di.OggVorbis],di.__empty_constructs__=[di.Wav,di.Mp3,di.OggVorbis],Ms=function(e){this.lastPlay=0,dt.call(this,e)},c["hxd.res.Sound"]=Ms,Ms.__name__="hxd.res.Sound",Ms.supportedFormat=function(e){switch(e._hx_index){case 0:case 1:return!0;case 2:return!1}},Ms.startWorker=function(){return!1},Ms.__super__=dt,Ms.prototype=g(dt.prototype,{getData:function(){if(this.data!=null)return this.data;var e=this.entry.getBytes();switch(e.b[0]){case 73:case 255:this.data=new Ga(e);break;case 79:throw t.thrown("OGG format requires -lib stb_ogg_sound (for "+this.entry.get_path()+")");case 82:this.data=new Li(e);break;default:}if(this.data==null)throw t.thrown("Unsupported sound format "+this.entry.get_path());return Ms.ENABLE_AUTO_WATCH&&this.watch(b(this,this.watchCallb)),this.data},dispose:function(){this.stop(),this.data=null},stop:function(){this.channel!=null&&(this.channel.stop(),this.channel=null)},play:function(e,t,n,s){return t==null&&(t=1),e==null&&(e=!1),this.lastPlay=u.now()/1e3,this.channel=ue.get().play(this,n,s),this.channel.loop=e,this.channel.set_volume(t),this.channel},watchCallb:function(){var e,n,s,o,t=this.data;if(this.data=null,e=this.getData(),t!=null&&(t.channels!=e.channels||t.samples!=e.samples||t.sampleFormat!=e.sampleFormat||t.samplingRate!=e.samplingRate))for(o=ue.get(),s=o.getAll(this);s.hasNext();)n=s.next(),n.duration=e.get_duration(),n.set_position(n.position)},__class__:Ms}),vs=function(){this.volume=1,this.bindedEffects=[],this.effects=[],this.mute=!1,this.priority=0},c["hxd.snd.ChannelBase"]=vs,vs.__name__="hxd.snd.ChannelBase",vs.prototype={getEffect:function(e){if(this.effects==null)return null;for(var n,s,t=0,o=this.effects;t<o.length;)if(n=o[t],++t,s=H.__downcastCheck(n,e)?n:null,s!=null)return s;return null},set_volume:function(e){return this.currentFade=null,this.volume=e},fadeTo:function(e,t,n){t==null&&(t=1),this.currentFade={start:u.now()/1e3,duration:t,startVolume:this.volume,targetVolume:e,onEnd:n}},updateCurrentVolume:function(e){if(this.currentFade!=null){var t=this.currentFade,n=e-t.start;n>=t.duration?(this.set_volume(t.targetVolume),t.onEnd!=null&&t.onEnd()):(this.set_volume(t.startVolume+n/t.duration*(t.targetVolume-t.startVolume)),this.currentFade=t)}this.currentVolume=this.volume},addEffect:function(e){if(e==null)throw t.thrown("Can't add null effect");if(this.effects.indexOf(e)>=0)throw t.thrown("effect already added on this channel");return this.effects.push(e),e},removeEffect:function(e){u.remove(this.effects,e)},__class__:vs},hi=function(){this.queue=[],this.positionChanged=!1,this.isLoading=!1,this.isVirtual=!1,this.lastStamp=0,this.audibleVolume=1,this.allowVirtual=!0,this.loop=!1,this.pause=!1,this.position=0,vs.call(this),this.id=hi.ID++},c["hxd.snd.Channel"]=hi,hi.__name__="hxd.snd.Channel",hi.__super__=vs,hi.prototype=g(vs.prototype,{onEnd:function(){},set_position:function(e){return this.lastStamp=u.now()/1e3,this.positionChanged=!0,e>this.duration?e=this.duration:e<0&&(e=0),this.position=e},set_pause:function(e){return e||(this.lastStamp=u.now()/1e3),this.pause=e},updateCurrentVolume:function(e){if(this.pause&&this.currentFade!=null){var t,n,s,o=this.currentFade;this.currentFade=null,this.updateCurrentVolume(e),this.currentFade=o}if(vs.prototype.updateCurrentVolume.call(this,e),this.channelGroup.updateCurrentVolume(e),this.currentVolume*=this.channelGroup.currentVolume*this.soundGroup.volume,this.manager!=null){for(t=0,n=this.channelGroup.effects;t<n.length;)s=n[t],++t,this.currentVolume*=s.getVolumeModifier();for(t=0,n=this.effects;t<n.length;)s=n[t],++t,this.currentVolume*=s.getVolumeModifier()}},calcAudibleVolume:function(e){if(this.updateCurrentVolume(e),this.audibleVolume=this.currentVolume,this.manager!=null){for(var s,t=0,n=this.channelGroup.effects;t<n.length;)s=n[t],++t,this.audibleVolume=s.applyAudibleVolumeModifier(this.audibleVolume);for(t=0,n=this.effects;t<n.length;)s=n[t],++t,this.audibleVolume=s.applyAudibleVolumeModifier(this.audibleVolume)}},queueSound:function(e){this.queue.push(e)},stop:function(){this.manager!=null&&this.manager.releaseChannel(this)},isReleased:function(){return this.manager==null},__class__:hi}),er=function(e){vs.call(this),this.name=e},c["hxd.snd.ChannelGroup"]=er,er.__name__="hxd.snd.ChannelGroup",er.__super__=vs,er.prototype=g(vs.prototype,{__class__:er}),Zt=_["hxd.snd.SampleFormat"]={__ename__:!0,__constructs__:null,UI8:{_hx_name:"UI8",_hx_index:0,__enum__:"hxd.snd.SampleFormat",toString:s},I16:{_hx_name:"I16",_hx_index:1,__enum__:"hxd.snd.SampleFormat",toString:s},F32:{_hx_name:"F32",_hx_index:2,__enum__:"hxd.snd.SampleFormat",toString:s}},Zt.__constructs__=[Zt.UI8,Zt.I16,Zt.F32],Zt.__empty_constructs__=[Zt.UI8,Zt.I16,Zt.F32],ko=function(){},c["hxd.snd.Data"]=ko,ko.__name__="hxd.snd.Data",ko.formatBytes=function(e){switch(e._hx_index){case 0:return 1;case 1:return 2;case 2:return 4}},ko.prototype={isLoading:function(){return!1},decode:function(e,n,s,o){var i,a,r=this.getBytesPerSample();if(s<0||o<0||n<0||n+o*r>e.length)throw i="sampleStart = "+s,i+=" sampleCount = "+o,i+=" outPos = "+n,i+=" bpp = "+r,i+=" out.length = "+e.length,t.thrown(i);if(s+o>=this.samples){a=0,s<this.samples&&(a=this.samples-s,this.decodeBuffer(e,n,s,a)),e.fill(n+a*r,(o-a)*r,0);return}this.decodeBuffer(e,n,s,o)},resample:function(e,t,n){if(this.sampleFormat==t&&this.samplingRate==e&&this.channels==n)return this;var o,i,r,a=Math.ceil(this.samples*(e/this.samplingRate)),c=this.getBytesPerSample(),s=new A(new ArrayBuffer(c*this.samples));switch(this.decodeBuffer(s,0,0,this.samples),r=n*a,t._hx_index){case 0:o=1;break;case 1:o=2;break;case 2:o=4;break}return i=new A(new ArrayBuffer(r*o)),this.resampleBuffer(i,0,s,0,e,t,n,this.samples),s=new Li(null),s.channels=n,s.samples=a,s.sampleFormat=t,s.samplingRate=e,s.rawData=i,s},resampleBuffer:function(e,t,n,s,o,i,a,r){var c,l,d,u,m,f,p,g,v,j,y,_,w,O,x,C,k,A,S,M,F,T,z,D,N,L,R,b=this.getBytesPerSample(),E=Math.ceil(r*(o/this.samplingRate)),h=r!=E;if(!h&&this.sampleFormat==Zt.I16&&i==Zt.I16&&a==1&&this.channels==2){for(g=s,x=t,m=0,j=r;m<j;)O=m++,d=n.getUInt16(g),g+=2,p=n.getUInt16(g),g+=2,(d^p)>=32768?((d&32768)!=0&&(d|=-65536),(p&32768)!=0&&(p|=-65536),M=d+p>>1&65535):M=d+p>>1,e.setUInt16(x,M),x+=2;return}for(F=this.channels,k=a<F?a:F,D=a-k,u=0,c=0,m=0,j=E;m<j;){for(O=m++,S=O/(E-1)*(r-1),_=S|0,z=S-_,l=s+_*b,_==r-1&&(h=!1),A=0,T=k;A<T;){switch(L=A++,v=0,this.sampleFormat._hx_index){case 0:f=n.b[l]/255,h&&(v=n.b[l+b]/255),++l;break;case 1:y=n.getUInt16(l),f=((y&32768)==0?y:y|-65536)/32768,h&&(w=n.getUInt16(l+b),v=((w&32768)==0?w:w|-65536)/32768),l+=2;break;case 2:f=n.getFloat(l),h&&(v=n.getFloat(l+b)),l+=4;break}switch(u=h?f+z*(v-f):f,i._hx_index){case 0:c=(u+1)*128|0,c>255&&(c=255),e.b[t++]=c;break;case 1:c=u*32768|0,c>32767&&(c=32767),c&=65535,e.setUInt16(t,c),t+=2;break;case 2:e.setFloat(t,u),t+=4;break}}for(C=0,N=D;C<N;)switch(R=C++,i._hx_index){case 0:e.b[t++]=c;break;case 1:e.setUInt16(t,c),t+=2;break;case 2:e.setFloat(t,u),t+=4;break}}},decodeBuffer:function(){throw t.thrown("Not implemented")},getBytesPerSample:function(){var e;switch(this.sampleFormat._hx_index){case 0:e=1;break;case 1:e=2;break;case 2:e=4;break}return this.channels*e},load:function(e){e()},get_duration:function(){return this.samples/this.samplingRate},__class__:ko},On=function(){},c["hxd.snd.EffectDriver"]=On,On.__name__="hxd.snd.EffectDriver",On.prototype={acquire:function(){},release:function(){},update:function(){},bind:function(){},apply:function(){},unbind:function(){},__class__:On},Er=_["hxd.snd.DriverFeature"]={__ename__:!0,__constructs__:null,MasterVolume:{_hx_name:"MasterVolume",_hx_index:0,__enum__:"hxd.snd.DriverFeature",toString:s}},Er.__constructs__=[Er.MasterVolume],Er.__empty_constructs__=[Er.MasterVolume],Za=function(){},c["hxd.snd.Driver"]=Za,Za.__name__="hxd.snd.Driver",Za.__isInterface__=!0,Za.prototype={__class__:Za},Xn=function(e){this.refs=0,this.priority=0,this.retainTime=0,this.lastStamp=0;var t=ue.get().driver;t!=null&&(this.driver=t.getEffectDriver(e))},c["hxd.snd.Effect"]=Xn,Xn.__name__="hxd.snd.Effect",Xn.prototype={applyAudibleVolumeModifier:function(e){return e},getVolumeModifier:function(){return 1},__class__:Xn},Sr=function(){this.position=new h(0,0,0),this.velocity=new h(0,0,0);var e=1,t=0,n=0;n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.direction=new h(e,t,n),e=0,t=0,n=1,n==null&&(n=0),t==null&&(t=0),e==null&&(e=0),this.up=new h(e,t,n)},c["hxd.snd.Listener"]=Sr,Sr.__name__="hxd.snd.Listener",Sr.prototype={syncCamera:function(e){var n,o,i,a,t=this.position,s=e.pos;t.x=s.x,t.y=s.y,t.z=s.z,t=this.direction,o=e.target.x-e.pos.x,i=e.target.y-e.pos.y,a=e.target.z-e.pos.z,a==null&&(a=0),i==null&&(i=0),o==null&&(o=0),t.x=o,t.y=i,t.z=a,t=this.direction,n=t.x*t.x+t.y*t.y+t.z*t.z,n<1e-20?n=0:n=1/Math.sqrt(n),t.x*=n,t.y*=n,t.z*=n,t=this.up,s=e.up,t.x=s.x,t.y=s.y,t.z=s.z},__class__:Sr},Pi=function(e){this.start=0,this.playing=!1,this.volume=-1,this.id=Pi.ID++,this.handle=e.createSource(),this.buffers=[]},c["hxd.snd.Source"]=Pi,Pi.__name__="hxd.snd.Source",Pi.prototype={dispose:function(){ue.get().driver.destroySource(this.handle)},__class__:Pi},Xa=function(e){this.end=0,this.handle=e.createBuffer(),this.refs=0,this.lastStop=u.now()/1e3},c["hxd.snd.Buffer"]=Xa,Xa.__name__="hxd.snd.Buffer",Xa.prototype={dispose:function(){ue.get().driver.destroyBuffer(this.handle)},__class__:Xa},ue=function(){this.suspended=!1,this.timeOffset=0;try{this.driver=new qa}catch(e){if(typeof t.caught(e).unwrap()=="string")this.driver=null;else throw e}if(this.masterVolume=1,this.hasMasterVolume=this.driver==null||this.driver.hasFeature(Er.MasterVolume),this.masterSoundGroup=new Dr("master"),this.masterChannelGroup=new er("master"),this.listener=new Sr,this.soundBufferMap=new fe,this.soundBufferKeys=[],this.freeStreamBuffers=[],this.effectGC=[],this.soundBufferCount=0,this.driver!=null){this.sources=[];for(var s,e=0,n=ue.MAX_SOURCES;e<n;)s=e++,this.sources.push(new Pi(this.driver))}this.cachedBytes=new A(new ArrayBuffer(24)),this.resampleBytes=new A(new ArrayBuffer(ue.STREAM_BUFFER_SAMPLE_COUNT*2))},c["hxd.snd.Manager"]=ue,ue.__name__="hxd.snd.Manager",ue.get=function(){return ue.instance==null&&(ue.instance=new ue,ue.instance.updateEvent=Bt.add((a=ue.instance,b(a,a.update))),ue.instance.updateEvent.isBlocking=!1),ue.instance},ue.regEffect=function(e,t){for(var n=e;n!=null;){if(n==t)return e;n=n.next}return t.next=e,t},ue.prototype={getTmpBytes:function(e){return this.cachedBytes.length<e&&(this.cachedBytes=new A(new ArrayBuffer(e))),this.cachedBytes},getResampleBytes:function(e){return this.resampleBytes.length<e&&(this.resampleBytes=new A(new ArrayBuffer(e))),this.resampleBytes},stopAll:function(){for(;this.channels!=null;)this.channels.stop()},stopAllNotLooping:function(){for(var t,e=this.channels;e!=null;)t=e.next,e.loop||e.stop(),e=t},stopByName:function(e){for(var n,t=this.channels;t!=null;)n=t.next,t.soundGroup!=null&&t.soundGroup.name==e&&t.stop(),t=n},getAll:function(e){for(var t=this.channels,n=[];t!=null;)t.sound==e&&n.push(t),t=t.next;return new xr(n)},cleanCache:function(){for(var e,n,s,t=0;t<this.soundBufferKeys.length;){if(e=this.soundBufferKeys[t],n=this.soundBufferMap.h[e],++t,n.refs>0)continue;s=this.soundBufferMap,Object.prototype.hasOwnProperty.call(s.h,e)&&delete s.h[e],u.remove(this.soundBufferKeys,e),--t,n.dispose(),--this.soundBufferCount}},dispose:function(){if(this.stopAll(),this.driver!=null){for(var n,s,o,i,a,r,c,l,e=0,t=this.sources;e<t.length;)a=t[e],++e,a.dispose();for(s=this.soundBufferMap.h,r=s,o=Object.keys(s),c=o.length,i=0;i<c;)n=r[o[i++]],n.dispose();for(e=0,t=this.freeStreamBuffers;e<t.length;)n=t[e],++e,n.dispose();for(e=0,t=this.effectGC;e<t.length;)l=t[e],++e,l.driver.release();this.driver.dispose()}this.sources=null,this.soundBufferMap=null,this.soundBufferKeys=null,this.freeStreamBuffers=null,this.effectGC=null,this.updateEvent.stop(),ue.instance=null},play:function(e,n,s){s==null&&(s=this.masterSoundGroup),n==null&&(n=this.masterChannelGroup);var i,a=e.getData();if(a.samples==0)throw t.thrown(o.string(e)+" has no samples");return i=new hi,i.sound=e,i.duration=a.get_duration(),i.manager=this,i.soundGroup=s,i.channelGroup=n,i.next=this.channels,i.isLoading=a.isLoading(),i.isVirtual=this.driver==null,i.lastStamp=u.now()/1e3,this.channels=i,i},updateVirtualChannels:function(e){for(var n,s,t=this.channels;t!=null;){if(t.pause||!t.isVirtual||t.isLoading){t=t.next;continue}for(s=e-t.lastStamp,t.set_position(t.position+(s<0?0:s)),t.lastStamp=e,n=t.next;t.position>=t.duration;)if(t.set_position(t.position-t.duration),t.onEnd(),n!=null&&n.manager==null&&(n=null),t.queue.length>0)t.sound=t.queue.shift(),t.duration=t.sound.getData().get_duration();else if(!t.loop){this.releaseChannel(t);break}t=n}},update:function(){if(this.timeOffset!=0){for(var n,s,o,i,a,r,c,l,d,h,m,f,p,g,v,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,B,e=this.channels;e!=null;)e.lastStamp+=this.timeOffset,e.currentFade!=null&&(e.currentFade.start+=this.timeOffset),e=e.next;for(s=0,a=this.sources;s<a.length;)for(n=a[s],++s,d=0,j=n.buffers;d<j.length;)m=j[d],++d,m.lastStop+=this.timeOffset;this.timeOffset=0}if(this.now=u.now()/1e3,this.driver==null){this.updateVirtualChannels(this.now);return}for(s=0,a=this.sources;s<a.length;){if(n=a[s],++s,e=n.channel,e==null)continue;if(e.positionChanged){this.releaseSource(n);continue}for(O=null,P=this.driver.getProcessedBuffers(n.handle),d=0,j=P;d<j;){if(g=d++,m=this.unqueueBuffer(n),m==null)continue;O=m,m.isEnd&&(e.sound=m.sound,e.duration=m.sound.getData().get_duration(),e.set_position(e.duration),e.positionChanged=!1,e.onEnd(),n.start=0)}if(n.buffers.length==0){O.isEnd?e.queue.length>0?(e.sound=e.queue.shift(),e.duration=e.sound.getData().get_duration(),e.set_position(0),this.releaseSource(n)):e.loop?(e.set_position(0),this.releaseSource(n)):this.releaseChannel(e):(e.set_position((O.start+O.samples)/O.sampleRate),this.releaseSource(n));continue}e.sound=n.buffers[0].sound,e.duration=e.sound.getData().get_duration(),k=this.driver.getPlayedSampleCount(n.handle),k<0&&(k=0),e.set_position(n.start/this.targetRate+k/n.buffers[0].sampleRate),e.positionChanged=!1,n.buffers.length<ue.BUFFER_QUEUE_LENGTH&&(x=n.buffers[n.buffers.length-1],x.isEnd?e.queue.length>0?(I=e.queue[0],this.queueBuffer(n,I,0)&&e.queue.shift()):e.loop&&this.queueBuffer(n,x.sound,0):this.queueBuffer(n,x.sound,x.start+x.samples))}for(e=this.channels;e!=null;)e.calcAudibleVolume(this.now),e.isLoading&&!e.sound.getData().isLoading()&&(e.isLoading=!1),e.isVirtual=this.suspended||e.pause||e.mute||e.channelGroup.mute||e.allowVirtual&&e.audibleVolume<ue.VIRTUAL_VOLUME_THRESHOLD||e.isLoading,e=e.next;if(p=this.channels,A=b(this,this.sortChannel),p==null)M=null;else{for(y=1,h=0,f=0;!0;){for(l=p,p=null,v=null,_=0;l!=null;){for(++_,i=l,h=0,s=0,a=y;s<a;)if(g=s++,++h,i=i.next,i==null)break;for(f=y;h>0||f>0&&i!=null;)h==0?(o=i,i=i.next,--f):f==0||i==null||A(l,i)<=0?(o=l,l=l.next,--h):(o=i,i=i.next,--f),v!=null?v.next=o:p=o,v=o;l=i}if(v.next=null,_<=1)break;y*=2}M=p}for(this.channels=M,D=0,e=this.channels;e!=null&&!e.isVirtual;)++D>this.sources.length?e.isVirtual=!0:e.soundGroup.maxAudible>=0&&(e.soundGroup.lastUpdate!=this.now&&(e.soundGroup.lastUpdate=this.now,e.soundGroup.numAudible=0),++e.soundGroup.numAudible>e.soundGroup.maxAudible&&(e.isVirtual=!0,--D)),e=e.next;for(s=0,a=this.sources;s<a.length;){if(n=a[s],++s,n.channel==null||!n.channel.isVirtual)continue;this.releaseSource(n)}for(e=this.channels;e!=null;){if(e.source!=null||e.isVirtual){e=e.next;continue}for(n=null,s=0,a=this.sources;s<a.length;)if(L=a[s],++s,L.channel==null){n=L;break}if(n==null)throw t.thrown("could not get a source");n.channel=e,e.source=n,this.checkTargetFormat(e.sound.getData(),e.soundGroup.mono),n.start=Math.floor(e.position*this.targetRate),n.start<0&&(n.start=0),this.queueBuffer(n,e.sound,n.start),e.positionChanged=!1,e=e.next}for(w=null,R=this.hasMasterVolume?1:this.masterVolume,s=0,a=this.sources;s<a.length;){if(n=a[s],++s,e=n.channel,e==null)continue;for(C=e.currentVolume*R,n.volume!=C&&(C<0&&(C=0),n.volume=C,this.driver.setSourceVolume(n.handle,C)),n.playing||(this.driver.playSource(n.handle),n.playing=!0),g=e.bindedEffects.length;--g>=0;)o=e.bindedEffects[g],e.effects.indexOf(o)<0&&e.channelGroup.effects.indexOf(o)<0&&this.unbindEffect(e,n,o);for(d=0,j=e.channelGroup.effects;d<j.length;)F=j[d],++d,e.bindedEffects.indexOf(F)<0&&this.bindEffect(e,n,F);for(S=0,T=e.effects;S<T.length;)z=T[S],++S,e.bindedEffects.indexOf(z)<0&&this.bindEffect(e,n,z);for(E=0,N=e.bindedEffects;E<N.length;)H=N[E],++E,w=ue.regEffect(w,H)}if(p=w,A=b(this,this.sortEffect),p==null)w=null;else{for(y=1,h=0,f=0;!0;){for(l=p,p=null,v=null,_=0;l!=null;){for(++_,i=l,h=0,s=0,a=y;s<a;)if(g=s++,++h,i=i.next,i==null)break;for(f=y;h>0||f>0&&i!=null;)h==0?(o=i,i=i.next,--f):f==0||i==null||A(l,i)<=0?(o=l,l=l.next,--h):(o=i,i=i.next,--f),v!=null?v.next=o:p=o,v=o;l=i}if(v.next=null,_<=1)break;y*=2}w=p}for(o=w;o!=null;)o.driver.update(o),o=o.next;for(s=0,a=this.sources;s<a.length;){if(n=a[s],++s,e=n.channel,e==null)continue;for(d=0,j=e.bindedEffects;d<j.length;)o=j[d],++d,o.driver.apply(o,n.handle)}for(s=0,a=this.effectGC;s<a.length;)if(o=a[s],++s,this.now-o.lastStamp>o.retainTime){o.driver.release(),u.remove(this.effectGC,o);break}if(this.updateVirtualChannels(this.now),r=this.listener.direction,c=r.x*r.x+r.y*r.y+r.z*r.z,c<1e-20?c=0:c=1/Math.sqrt(c),r.x*=c,r.y*=c,r.z*=c,r=this.listener.up,c=r.x*r.x+r.y*r.y+r.z*r.z,c<1e-20?c=0:c=1/Math.sqrt(c),r.x*=c,r.y*=c,r.z*=c,this.hasMasterVolume&&this.driver.setMasterVolume(this.masterVolume),this.driver.setListenerParams(this.listener.position,this.listener.direction,this.listener.up,this.listener.velocity),this.driver.update(),this.soundBufferCount>=ue.SOUND_BUFFER_CACHE_SIZE)for(B=u.now()/1e3,g=0;g<this.soundBufferKeys.length;){if(c=this.soundBufferKeys[g],m=this.soundBufferMap.h[c],++g,m.refs>0||m.lastStop+60>B)continue;r=this.soundBufferMap,Object.prototype.hasOwnProperty.call(r.h,c)&&delete r.h[c],u.remove(this.soundBufferKeys,c),--g,m.dispose(),--this.soundBufferCount}},progressiveDecodeBuffer:function(e,t,n){var s,o,i,a,r=t.getData(),c=Math.ceil(ue.STREAM_BUFFER_SAMPLE_COUNT/ue.BUFFER_STREAM_SPLIT);return(e.streamStart!=n||e.streamSound!=t)&&(e.streamSound=t,e.streamStart=n,e.streamPos=n),o=n+ue.STREAM_BUFFER_SAMPLE_COUNT,e.streamPos==o||(i=r.getBytesPerSample(),a=ue.STREAM_BUFFER_SAMPLE_COUNT*i,(e.streamBuffer==null||e.streamBuffer.length<a)&&(e.streamBuffer=new A(new ArrayBuffer(a)),e.streamPos=n),s=o-e.streamPos,s>c&&(s=c),r.decode(e.streamBuffer,(e.streamPos-n)*i,e.streamPos,s),e.streamPos+=s,e.streamPos==o)},queueBuffer:function(e,t,n){var i=t.getData(),o=e.channel.soundGroup,s=null;if(i.get_duration()<=ue.STREAM_DURATION)s=this.getSoundBuffer(t,o),this.driver.queueBuffer(e.handle,s.handle,n,!0);else{if(e.buffers.length>0&&ue.BUFFER_STREAM_SPLIT>1&&!this.progressiveDecodeBuffer(e,t,n))return!1;s=this.getStreamBuffer(e,t,o,n),this.driver.queueBuffer(e.handle,s.handle,0,s.isEnd)}return e.buffers.push(s),!0},unqueueBuffer:function(e){var t=e.buffers.shift();return t==null?null:(this.driver.unqueueBuffer(e.handle,t.handle),t.isStream?this.freeStreamBuffers.unshift(t):--t.refs==0&&(t.lastStop=u.now()/1e3),t)},bindEffect:function(e,t,n){n.refs==0&&!u.remove(this.effectGC,n)&&n.driver.acquire(),++n.refs,n.driver.bind(n,t.handle),e.bindedEffects.push(n)},unbindEffect:function(e,t,n){n.driver.unbind(n,t.handle),u.remove(e.bindedEffects,n),--n.refs==0&&(n.lastStamp=this.now,this.effectGC.push(n))},releaseSource:function(e){if(e.channel!=null){for(var s,t=0,n=e.channel.bindedEffects.slice();t<n.length;)s=n[t],++t,this.unbindEffect(e.channel,e,s);e.channel.bindedEffects=[],e.channel.source=null,e.channel=null}for(e.playing&&(e.playing=!1,this.driver.stopSource(e.handle),e.volume=-1);e.buffers.length>0;)this.unqueueBuffer(e)},checkTargetFormat:function(e,t){t==null&&(t=!1),this.targetRate=e.samplingRate,this.targetChannels=t||e.channels==1?1:2;var n;switch(e.sampleFormat._hx_index){case 0:n=Zt.UI8;break;case 1:n=Zt.I16;break;case 2:n=Zt.F32;break}return this.targetFormat=n,this.targetChannels==e.channels&&this.targetFormat==e.sampleFormat&&this.targetRate==e.samplingRate},getSoundBuffer:function(e,t){var n,a=this,o=e.getData(),i=t.mono,s=e.entry.get_path();return i&&o.channels!=1&&(s+="mono"),n=this.soundBufferMap.h[s],n==null&&(n=new Xa(this.driver),n.isStream=!1,n.isEnd=!0,n.sound=e,o.load(function(){a.fillSoundBuffer(n,o,i)}),this.soundBufferMap.h[s]=n,this.soundBufferKeys.push(s),++this.soundBufferCount),++n.refs,n},fillSoundBuffer:function(e,t,n){n==null&&(n=!1),this.checkTargetFormat(t,n)||(t=t.resample(this.targetRate,this.targetFormat,this.targetChannels));var s=t.samples*t.getBytesPerSample(),o=this.getTmpBytes(s);t.decode(o,0,0,t.samples),this.driver.setBufferData(e.handle,o,s,this.targetFormat,this.targetChannels,this.targetRate),e.sampleRate=this.targetRate,e.samples=t.samples},getStreamBuffer:function(e,t,n,s){var i,r,c,l,d,u,a=t.getData(),o=this.freeStreamBuffers.shift();if(o==null&&(o=new Xa(this.driver),o.isStream=!0),i=ue.STREAM_BUFFER_SAMPLE_COUNT,s+i>=a.samples?(i=a.samples-s,o.isEnd=!0):o.isEnd=!1,o.sound=t,o.samples=i,o.start=s,c=i*a.getBytesPerSample(),e.streamSound==t&&e.streamStart==s){for(;!this.progressiveDecodeBuffer(e,t,s););r=e.streamBuffer}else r=this.getTmpBytes(c),a.decode(r,0,s,i);if(!this.checkTargetFormat(a,n.mono)){switch(u=Math.ceil(i*(this.targetRate/a.samplingRate))*this.targetChannels,this.targetFormat._hx_index){case 0:l=1;break;case 1:l=2;break;case 2:l=4;break}c=u*l,d=this.getResampleBytes(c),a.resampleBuffer(d,0,r,0,this.targetRate,this.targetFormat,this.targetChannels,i),r=d}return this.driver.setBufferData(o.handle,r,c,this.targetFormat,this.targetChannels,this.targetRate),o.sampleRate=this.targetRate,o},sortChannel:function(e,t){return e.isVirtual!=t.isVirtual?e.isVirtual?1:-1:e.channelGroup.priority!=t.channelGroup.priority?e.channelGroup.priority<t.channelGroup.priority?1:-1:e.priority!=t.priority?e.priority<t.priority?1:-1:e.audibleVolume!=t.audibleVolume?e.audibleVolume<t.audibleVolume?1:-1:e.id<t.id?1:-1},sortEffect:function(e,t){return t.priority-e.priority},releaseChannel:function(e){if(e.manager==null)return;if(this.channels==e)this.channels=e.next;else{for(var n,s,o,i,t=this.channels;t.next!=e;)t=t.next;t.next=e.next}for(n=0,o=e.effects;n<o.length;)i=o[n],++n,e.removeEffect(i);e.source!=null&&this.releaseSource(e.source),e.next=null,e.manager=null,e.effects=null,e.bindedEffects=null,e.currentFade=null,s=e.sound,s!=null&&s.channel==e&&(s.channel=null)},__class__:ue},Ga=function(e){var t,n,s,o,a,r,c,l,d,u,h,i=new jc(new Nt(e)).read();for(this.samples=i.sampleCount,t=i.frames[0].data,n=-1,a=0,d=t.length-24;a<d;)if(s=a++,t.b[s]==76&&t.b[s+1]==65&&t.b[s+2]==77&&t.b[s+3]==69){n=s;break}if(n>=0&&(r=t.b[n+21]<<16|t.b[n+22]<<8|t.b[n+23],u=r>>12,h=r&4095,this.samples-=u+h+1152),c=i.frames[0].header,this.sampleFormat=Zt.F32,this.samplingRate=Se.srEnum2Num(c.samplingRate),this.channels=c.channelMode==mn.Mono?1:2,o=z.get(),o==null)return;o.decodeAudioData(e.b.bufferValue,b(this,this.processBuffer)),l=o.sampleRate|0,this.samples=Math.ceil(this.samples*l/this.samplingRate),this.samplingRate=l},c["hxd.snd.Mp3Data"]=Ga,Ga.__name__="hxd.snd.Mp3Data",Ga.__super__=ko,Ga.prototype=g(ko.prototype,{isLoading:function(){return this.buffer==null},load:function(e){this.buffer!=null?e():this.onEnd=e},processBuffer:function(e){var n,s,o,i,a,r,t=e.getChannelData(0);if(this.samples=e.length,this.channels==1){this.buffer=A.ofData(t.buffer);return}for(a=e.numberOfChannels<2?t:e.getChannelData(1),n=new Float32Array(t.length*2),s=0,o=0,r=e.length;o<r;)i=o++,n[s++]=t[i],n[s++]=a[i];this.buffer=A.ofData(n.buffer),this.onEnd!=null&&(this.onEnd(),this.onEnd=null)},decodeBuffer:function(e,t,n,s){this.buffer==null?e.fill(t,s*4*this.channels,0):e.blit(t,this.buffer,n*4*this.channels,s*4*this.channels)},__class__:Ga}),Dr=function(e){this.name=e,this.maxAudible=-1,this.volume=1,this.mono=!1},c["hxd.snd.SoundGroup"]=Dr,Dr.__name__="hxd.snd.SoundGroup",Dr.prototype={__class__:Dr},Li=function(e){e!=null&&this.init(new Mc(new Nt(e)).read())},c["hxd.snd.WavData"]=Li,Li.__name__="hxd.snd.WavData",Li.__super__=ko,Li.prototype=g(ko.prototype,{init:function(e){var s,n=e.header;switch(this.samplingRate=n.samplingRate,this.channels=n.channels,n.bitsPerSample){case 8:s=Zt.UI8;break;case 16:s=Zt.I16;break;default:throw t.thrown("Unsupported WAV "+n.bitsPerSample+" bits")}this.sampleFormat=s,this.rawData=e.data,this.samples=this.rawData.length/this.getBytesPerSample()|0},decodeBuffer:function(e,t,n,s){var o=this.getBytesPerSample();e.blit(t,this.rawData,n*o,s*o)},__class__:Li}),Lr=function(){Xn.call(this,"lowpass"),this.priority=100,this.gainHF=1},c["hxd.snd.effect.LowPass"]=Lr,Lr.__name__="hxd.snd.effect.LowPass",Lr.__super__=Xn,Lr.prototype=g(Xn.prototype,{__class__:Lr}),Rr=function(e){e==null&&(e=1),Xn.call(this,"pitch"),this.value=e},c["hxd.snd.effect.Pitch"]=Rr,Rr.__name__="hxd.snd.effect.Pitch",Rr.__super__=Xn,Rr.prototype=g(Xn.prototype,{__class__:Rr}),Pr=function(){Xn.call(this,"spatialization"),this.position=new h(0,0,0),this.velocity=new h(0,0,0),this.direction=new h(0,0,0),this.referenceDistance=1,this.rollOffFactor=1},c["hxd.snd.effect.Spatialization"]=Pr,Pr.__name__="hxd.snd.effect.Spatialization",Pr.__super__=Xn,Pr.prototype=g(Xn.prototype,{getVolumeModifier:function(){if(this.fadeDistance==null)return 1;var e,t=ue.get().listener.position,n=this.position,o=n.x-t.x,i=n.y-t.y,a=n.z-t.z,s=Math.sqrt(o*o+i*i+a*a);return this.maxDistance!=null?s-=this.maxDistance:s-=this.referenceDistance,e=1-s/this.fadeDistance,e>1&&(e=1),e<0&&(e=0),e},applyAudibleVolumeModifier:function(e){var c,s=ue.get().listener.position,o=this.position,i=o.x-s.x,a=o.y-s.y,r=o.z-s.z,t=Math.sqrt(i*i+a*a+r*r),n=this.referenceDistance;return t<n&&(t=n),this.maxDistance!=null&&(n=this.maxDistance,t>n&&(t=n)),c=this.referenceDistance/(this.referenceDistance+this.rollOffFactor*(t-this.referenceDistance)),e*c},__class__:Pr}),dr=function(){},c["hxd.snd.webaudio.BufferHandle"]=dr,dr.__name__="hxd.snd.webaudio.BufferHandle",dr.prototype={__class__:dr},Ir=function(){this.buffers=[],this.sampleOffset=0,this.pitch=1,this.firstPlay=!0},c["hxd.snd.webaudio.SourceHandle"]=Ir,Ir.__name__="hxd.snd.webaudio.SourceHandle",Ir.prototype={updateDestination:function(){this.destination=this.gain,this.lowPass!=null&&(this.lowPass.connect(this.destination),this.destination=this.lowPass),this.panner!=null&&(this.panner.connect(this.destination),this.destination=this.panner),this.gain.connect(z.destination);for(var t,e=0,n=this.buffers;e<n.length;)t=n[e],++e,t.node!=null&&t.restart(this)},applyPitch:function(){for(var s,t=0,e=0,n=this.buffers;e<n.length;)s=n[e],++e,t=s.readjust(t,this)},__class__:Ir},Ya=function(){},c["hxd.snd.webaudio.BufferPlayback"]=Ya,Ya.__name__="hxd.snd.webaudio.BufferPlayback",Ya.prototype={get_currentSample:function(){return this.consumed?this.buffer.samples:this.node==null||!this.dirty||this.node.context.currentTime<this.lastTime?0:(this.lastSamples+=Math.floor((this.node.context.currentTime-this.lastTime)*this.buffer.inst.sampleRate*this.node.playbackRate.value),this.lastTime=this.node.context.currentTime,this.lastSamples)},set:function(e,t){this.buffer=e,this.offset=isNaN(t)?0:t,this.dirty=!1,this.consumed=!1,this.starts=0,this.ends=0},start:function(e,t,n){if(this.dirty=!0,this.consumed=!1,this.node!=null&&this.stop(),t.firstPlay&&this.buffer.samples>10){t.firstPlay=!1;for(var s,o,i,a,r=[],c=0,l=this.buffer.inst.numberOfChannels;c<l;)s=c++,r.push(this.buffer.inst.getChannelData(s));for(a=r,i=0,o=0;i<10;){for(s=0;s<a.length;)a[s][i]*=o,++s;++i,o+=.1,o>1&&(o=1)}}return this.node=e.createBufferSource(),this.node.buffer=this.buffer.inst,this.node.addEventListener("ended",b(this,this.onBufferConsumed)),this.node.connect(t.destination),this.node.playbackRate.value=t.pitch,this.node.start(n,this.offset),this.lastSamples=0,this.lastTime=n,this.starts=n,this.ends=n+(this.buffer.inst.duration-this.offset)/t.pitch},readjust:function(e,t){if(this.consumed||this.node==null)return this.ends;var s,o=t.driver.ctx,n=o.currentTime;return this.node.playbackRate.setValueAtTime(t.pitch,n),s=n-this.starts,s<0?this.start(o,t,e==0?n:e):(this.starts=n-s/t.pitch,this.ends=this.starts+(this.buffer.inst.duration-this.offset)/t.pitch)},restart:function(e){if(this.consumed||this.node==null)return;var t=z.get();t.currentTime>this.starts?(this.offset+=(t.currentTime-this.starts)*e.pitch,this.start(t,e,t.currentTime)):this.start(t,e,this.starts)},stop:function(e){e==null&&(e=!0),this.node!=null&&(this.node.removeEventListener("ended",b(this,this.onBufferConsumed)),e?this.node.disconnect():this.node.stop(),this.node=null)},onBufferConsumed:function(){this.node.removeEventListener("ended",b(this,this.onBufferConsumed)),this.node.disconnect(),this.node=null,this.consumed=!0},clear:function(){this.buffer=null,this.node=null},__class__:Ya},z=function(){},c["hxd.snd.webaudio.Context"]=z,z.__name__="hxd.snd.webaudio.Context",z.get=function(){if(z.ctx==null){try{z.ctx=new AudioContext}catch{try{z.ctx=new window.webkitAudioContext}catch{z.ctx=null}}if(z.ctx==null)throw t.thrown("WebAudio API not available in this browser!");z.ctx.state=="suspended"&&z.waitForPageInput(),z.ctx.addEventListener("statechange",function(){z.ctx.state=="suspended"&&z.waitForPageInput()}),z.bufferPool=[],z.gainPool=[],z.masterGain=z.ctx.createGain(),z.masterGain.connect(z.ctx.destination),z.destination=z.masterGain}return z.ctx},z.getGain=function(){return z.gainPool.length!=0?z.gainPool.pop():z.ctx.createGain()},z.putGain=function(e){z.gainPool.push(e),e.gain.value=1},z.waitForPageInput=function(){z.suspended||(window.document.addEventListener("click",z.resumeContext),window.document.addEventListener("keydown",z.resumeContext),window.document.body.addEventListener("keydown",z.resumeContext),window.document.body.addEventListener("touchend",z.resumeContext),z.suspended=!0)},z.resumeContext=function(){z.suspended&&(z.ctx!=null&&z.ctx.resume(),window.document.removeEventListener("click",z.resumeContext),window.document.removeEventListener("keydown",z.resumeContext),window.document.body.removeEventListener("keydown",z.resumeContext),window.document.body.removeEventListener("touchend",z.resumeContext),z.suspended=!1)},z.getBuffer=function(e,t,n){for(var s,o=0,i=z.bufferPool;o<i.length;)if(s=i[o],++o,s.channels==e&&s.samples==t&&s.rate==n)return s.pool.length!=0?s.pool.pop():z.ctx.createBuffer(e,t,n);return s=new $r(e,t,n),z.bufferPool.push(s),z.ctx.createBuffer(e,t,n)},z.putBuffer=function(e){for(var t,o=e.sampleRate|0,n=0,s=z.bufferPool;n<s.length;)if(t=s[n],++n,t.channels==e.numberOfChannels&&t.samples==e.length&&t.rate==o){t.pool.push(e);break}},$r=function(e,t,n){this.pool=[],this.channels=e,this.samples=t,this.rate=n},c["hxd.snd.webaudio._Context.BufferPool"]=$r,$r.__name__="hxd.snd.webaudio._Context.BufferPool",$r.prototype={__class__:$r},qa=function(){this.playbackPool=[],this.ctx=z.get()},c["hxd.snd.webaudio.Driver"]=qa,qa.__name__="hxd.snd.webaudio.Driver",qa.__interfaces__=[Za],qa.prototype={getBuffer:function(e,t,n){return z.getBuffer(e,t,n)},putBuffer:function(e){z.putBuffer(e)},getGain:function(){return z.gainPool.length!=0?z.gainPool.pop():z.ctx.createGain()},putGain:function(e){z.gainPool.push(e),e.gain.value=1},hasFeature:function(){return!0},setMasterVolume:function(e){z.masterGain.gain.value=e},setListenerParams:function(e,t,n){this.ctx.listener.setPosition(-e.x,e.y,e.z),this.ctx.listener.setOrientation(-t.x,t.y,t.z,-n.x,n.y,n.z)},createSource:function(){var e=new Ir;return e.driver=this,e.gain=z.gainPool.length!=0?z.gainPool.pop():z.ctx.createGain(),e.updateDestination(),e},playSource:function(e){if(!e.playing&&(e.playing=!0,e.buffers.length!=0))for(var n,s=this.ctx.currentTime,t=0,o=e.buffers;t<o.length;){if(n=o[t],++t,n.consumed)continue;s=n.start(this.ctx,e,s)}},stopSource:function(e){e.playing=!1,e.sampleOffset=0},setSourceVolume:function(e,t){e.gain.gain.value=t},destroySource:function(e){this.stopSource(e),e.gain.disconnect(),e.driver=null;var t,n,s,o=e.gain;for(z.gainPool.push(o),o.gain.value=1,e.gain=null,t=0,s=e.buffers;t<s.length;)n=s[t],++t,n.stop(),n.clear(),this.playbackPool.push(n);e.buffers=[]},createBuffer:function(){var e=new dr;return e.samples=0,e},setBufferData:function(e,t,n,s,o,i){switch(s._hx_index){case 0:f=1;break;case 1:f=2;break;case 2:f=4;break}var a,r,c,l,u,h,m,f,p,g,v,d=n/f/o|0;if(e.samples=d,d==0)return;switch(e.inst==null?e.inst=z.getBuffer(o,d,i):(e.inst.sampleRate!=i||e.inst.numberOfChannels!=o||e.inst.length!=d)&&(z.putBuffer(e.inst),e.inst=z.getBuffer(o,d,i)),s._hx_index){case 0:if(p=new Uint8Array(t.b.bufferValue),o==1)for(u=e.inst.getChannelData(0),a=0,c=d;a<c;)r=a++,u[r]=(p[r]-128)/128;else for(h=e.inst.getChannelData(0),m=e.inst.getChannelData(1),l=0,a=0,c=d;a<c;)r=a++,h[r]=(p[l]-128)/128,m[r]=(p[l+1]-128)/128,l+=o;break;case 1:if(g=new Int16Array(t.b.bufferValue),o==1)for(u=e.inst.getChannelData(0),a=0,c=d;a<c;)r=a++,u[r]=g[r]/32768;else for(h=e.inst.getChannelData(0),m=e.inst.getChannelData(1),l=0,a=0,c=d;a<c;)r=a++,h[r]=g[l]/32768,m[r]=g[l+1]/32768,l+=o;break;case 2:if(v=new Float32Array(t.b.bufferValue),o==1)for(u=e.inst.getChannelData(0),a=0,c=d;a<c;)r=a++,u[r]=v[r];else for(h=e.inst.getChannelData(0),m=e.inst.getChannelData(1),l=0,a=0,c=d;a<c;)r=a++,h[r]=v[l],m[r]=v[l+1],l+=o;break}},destroyBuffer:function(e){e.inst!=null&&z.putBuffer(e.inst),e.inst=null},queueBuffer:function(e,t,n,s){var i,a,r,c,o=this.playbackPool.length!=0?this.playbackPool.pop():new Ya;if(t.inst==null)return;o.set(t,n/t.inst.length*t.inst.duration),t.isEnd=s,e.buffers.push(o),e.playing&&(e.buffers.length!=1?(i=e.buffers[e.buffers.length-2].ends,c=this.ctx,isFinite(i)?(r=this.ctx.currentTime,a=i<r?r:i):a=this.ctx.currentTime,o.start(c,e,a)):o.start(this.ctx,e,this.ctx.currentTime))},unqueueBuffer:function(e,t){for(var n,s=0;s<e.buffers.length;)if(n=e.buffers[s],n.buffer==t){e.buffers.splice(s,1),n.stop(!t.isEnd),n.clear(),this.playbackPool.push(n);break}t.isEnd||!e.playing?e.sampleOffset=0:e.sampleOffset+=t.samples},getProcessedBuffers:function(e){for(var o,n=0,t=0,s=e.buffers;t<s.length;)o=s[t],++t,o.consumed&&++n;return n},getPlayedSampleCount:function(e){for(var t,n=0,s=null,o=0,i=e.buffers;o<i.length;)if(t=i[o],++o,t.consumed)n+=t.buffer.samples;else if(t.dirty){s=t;break}return s!=null?e.sampleOffset+n+s.get_currentSample():e.sampleOffset+n},update:function(){},dispose:function(){},getEffectDriver:function(e){switch(e){case"lowpass":return new Ka;case"pitch":return new Ua;case"spatialization":return new $a;default:return new On}},get_masterGain:function(){return z.masterGain},set_destination:function(e){return z.destination=e},get_destination:function(){return z.destination},__class__:qa},Ka=function(){this.pool=[],On.call(this)},c["hxd.snd.webaudio.LowPassDriver"]=Ka,Ka.__name__="hxd.snd.webaudio.LowPassDriver",Ka.__super__=On,Ka.prototype=g(On.prototype,{get:function(e){if(this.pool.length!=0)return this.pool.pop();var t=e.createBiquadFilter();return t.type="lowpass",t},bind:function(e,t){t.lowPass=this.get(t.driver.ctx),t.updateDestination(),this.apply(e,t)},apply:function(e,t){var s=40,n=t.driver.ctx.sampleRate/2,o=Math.log(n/s)/Math.LN2;t.lowPass.frequency.value=n*2**(o*(e.gainHF-1))},unbind:function(e,t){this.pool.push(t.lowPass),t.lowPass.disconnect(),t.lowPass=null,t.driver!=null&&t.updateDestination()},__class__:Ka}),Ua=function(){On.call(this)},c["hxd.snd.webaudio.PitchDriver"]=Ua,Ua.__name__="hxd.snd.webaudio.PitchDriver",Ua.__super__=On,Ua.prototype=g(On.prototype,{apply:function(e,t){t.pitch!=e.value&&(t.pitch=e.value,t.applyPitch())},unbind:function(e,t){t.pitch=1,t.applyPitch()},__class__:Ua}),$a=function(){this.pool=[],On.call(this)},c["hxd.snd.webaudio.SpatializationDriver"]=$a,$a.__name__="hxd.snd.webaudio.SpatializationDriver",$a.__super__=On,$a.prototype=g(On.prototype,{get:function(e){if(this.pool.length!=0)return this.pool.pop();var t=e.createPanner();return t},bind:function(e,t){t.panner=this.get(t.driver.ctx),t.updateDestination(),this.apply(e,t)},apply:function(e,t){t.panner.setPosition(-e.position.x,e.position.y,e.position.z),t.panner.setOrientation(-e.direction.x,e.direction.y,e.direction.z),t.panner.rolloffFactor=e.rollOffFactor,t.panner.refDistance=e.referenceDistance;var n=e.maxDistance==null?340282347e30:e.maxDistance;t.panner.maxDistance=n},unbind:function(e,t){this.pool.push(t.panner),t.panner.disconnect(),t.panner=null,t.driver!=null&&t.updateDestination()},__class__:$a}),Qe=_["hxsl.BufferKind"]={__ename__:!0,__constructs__:null,Uniform:{_hx_name:"Uniform",_hx_index:0,__enum__:"hxsl.BufferKind",toString:s},Storage:{_hx_name:"Storage",_hx_index:1,__enum__:"hxsl.BufferKind",toString:s},RW:{_hx_name:"RW",_hx_index:2,__enum__:"hxsl.BufferKind",toString:s},Partial:{_hx_name:"Partial",_hx_index:3,__enum__:"hxsl.BufferKind",toString:s},StoragePartial:{_hx_name:"StoragePartial",_hx_index:4,__enum__:"hxsl.BufferKind",toString:s},RWPartial:{_hx_name:"RWPartial",_hx_index:5,__enum__:"hxsl.BufferKind",toString:s}},Qe.__constructs__=[Qe.Uniform,Qe.Storage,Qe.RW,Qe.Partial,Qe.StoragePartial,Qe.RWPartial],Qe.__empty_constructs__=[Qe.Uniform,Qe.Storage,Qe.RW,Qe.Partial,Qe.StoragePartial,Qe.RWPartial],Ke=_["hxsl.TexDimension"]={__ename__:!0,__constructs__:null,T1D:{_hx_name:"T1D",_hx_index:0,__enum__:"hxsl.TexDimension",toString:s},T2D:{_hx_name:"T2D",_hx_index:1,__enum__:"hxsl.TexDimension",toString:s},T3D:{_hx_name:"T3D",_hx_index:2,__enum__:"hxsl.TexDimension",toString:s},TCube:{_hx_name:"TCube",_hx_index:3,__enum__:"hxsl.TexDimension",toString:s}},Ke.__constructs__=[Ke.T1D,Ke.T2D,Ke.T3D,Ke.TCube],Ke.__empty_constructs__=[Ke.T1D,Ke.T2D,Ke.T3D,Ke.TCube],i=_["hxsl.Type"]={__ename__:!0,__constructs__:null,TVoid:{_hx_name:"TVoid",_hx_index:0,__enum__:"hxsl.Type",toString:s},TInt:{_hx_name:"TInt",_hx_index:1,__enum__:"hxsl.Type",toString:s},TBool:{_hx_name:"TBool",_hx_index:2,__enum__:"hxsl.Type",toString:s},TFloat:{_hx_name:"TFloat",_hx_index:3,__enum__:"hxsl.Type",toString:s},TString:{_hx_name:"TString",_hx_index:4,__enum__:"hxsl.Type",toString:s},TVec:(a=function(e,t){return{_hx_index:5,size:e,t,__enum__:"hxsl.Type",toString:s}},a._hx_name="TVec",a.__params__=["size","t"],a),TMat3:{_hx_name:"TMat3",_hx_index:6,__enum__:"hxsl.Type",toString:s},TMat4:{_hx_name:"TMat4",_hx_index:7,__enum__:"hxsl.Type",toString:s},TMat3x4:{_hx_name:"TMat3x4",_hx_index:8,__enum__:"hxsl.Type",toString:s},TBytes:(a=function(e){return{_hx_index:9,size:e,__enum__:"hxsl.Type",toString:s}},a._hx_name="TBytes",a.__params__=["size"],a),TSampler:(a=function(e,t){return{_hx_index:10,dim:e,isArray:t,__enum__:"hxsl.Type",toString:s}},a._hx_name="TSampler",a.__params__=["dim","isArray"],a),TRWTexture:(a=function(e,t,n){return{_hx_index:11,dim:e,isArray:t,channels:n,__enum__:"hxsl.Type",toString:s}},a._hx_name="TRWTexture",a.__params__=["dim","isArray","channels"],a),TMat2:{_hx_name:"TMat2",_hx_index:12,__enum__:"hxsl.Type",toString:s},TStruct:(a=function(e){return{_hx_index:13,vl:e,__enum__:"hxsl.Type",toString:s}},a._hx_name="TStruct",a.__params__=["vl"],a),TFun:(a=function(e){return{_hx_index:14,variants:e,__enum__:"hxsl.Type",toString:s}},a._hx_name="TFun",a.__params__=["variants"],a),TArray:(a=function(e,t){return{_hx_index:15,t:e,size:t,__enum__:"hxsl.Type",toString:s}},a._hx_name="TArray",a.__params__=["t","size"],a),TBuffer:(a=function(e,t,n){return{_hx_index:16,t:e,size:t,kind:n,__enum__:"hxsl.Type",toString:s}},a._hx_name="TBuffer",a.__params__=["t","size","kind"],a),TChannel:(a=function(e){return{_hx_index:17,size:e,__enum__:"hxsl.Type",toString:s}},a._hx_name="TChannel",a.__params__=["size"],a)},i.__constructs__=[i.TVoid,i.TInt,i.TBool,i.TFloat,i.TString,i.TVec,i.TMat3,i.TMat4,i.TMat3x4,i.TBytes,i.TSampler,i.TRWTexture,i.TMat2,i.TStruct,i.TFun,i.TArray,i.TBuffer,i.TChannel],i.__empty_constructs__=[i.TVoid,i.TInt,i.TBool,i.TFloat,i.TString,i.TMat3,i.TMat4,i.TMat3x4,i.TMat2],v=_["hxsl.VecType"]={__ename__:!0,__constructs__:null,VInt:{_hx_name:"VInt",_hx_index:0,__enum__:"hxsl.VecType",toString:s},VFloat:{_hx_name:"VFloat",_hx_index:1,__enum__:"hxsl.VecType",toString:s},VBool:{_hx_name:"VBool",_hx_index:2,__enum__:"hxsl.VecType",toString:s}},v.__constructs__=[v.VInt,v.VFloat,v.VBool],v.__empty_constructs__=[v.VInt,v.VFloat,v.VBool],ke=_["hxsl.SizeDecl"]={__ename__:!0,__constructs__:null,SConst:(a=function(e){return{_hx_index:0,v:e,__enum__:"hxsl.SizeDecl",toString:s}},a._hx_name="SConst",a.__params__=["v"],a),SVar:(a=function(e){return{_hx_index:1,v:e,__enum__:"hxsl.SizeDecl",toString:s}},a._hx_name="SVar",a.__params__=["v"],a)},ke.__constructs__=[ke.SConst,ke.SVar],ke.__empty_constructs__=[],De=function(e,t){this.msg=e,this.pos=t},c["hxsl.Error"]=De,De.__name__="hxsl.Error",De.t=function(e,n){throw t.thrown(new De(e,n))},De.prototype={toString:function(){return"Error("+this.msg+")@"+o.string(this.pos)},__class__:De},O=_["hxsl.VarKind"]={__ename__:!0,__constructs__:null,Global:{_hx_name:"Global",_hx_index:0,__enum__:"hxsl.VarKind",toString:s},Input:{_hx_name:"Input",_hx_index:1,__enum__:"hxsl.VarKind",toString:s},Param:{_hx_name:"Param",_hx_index:2,__enum__:"hxsl.VarKind",toString:s},Var:{_hx_name:"Var",_hx_index:3,__enum__:"hxsl.VarKind",toString:s},Local:{_hx_name:"Local",_hx_index:4,__enum__:"hxsl.VarKind",toString:s},Output:{_hx_name:"Output",_hx_index:5,__enum__:"hxsl.VarKind",toString:s},Function:{_hx_name:"Function",_hx_index:6,__enum__:"hxsl.VarKind",toString:s}},O.__constructs__=[O.Global,O.Input,O.Param,O.Var,O.Local,O.Output,O.Function],O.__empty_constructs__=[O.Global,O.Input,O.Param,O.Var,O.Local,O.Output,O.Function],I=_["hxsl.VarQualifier"]={__ename__:!0,__constructs__:null,Const:(a=function(e){return{_hx_index:0,max:e,__enum__:"hxsl.VarQualifier",toString:s}},a._hx_name="Const",a.__params__=["max"],a),Private:{_hx_name:"Private",_hx_index:1,__enum__:"hxsl.VarQualifier",toString:s},Nullable:{_hx_name:"Nullable",_hx_index:2,__enum__:"hxsl.VarQualifier",toString:s},PerObject:{_hx_name:"PerObject",_hx_index:3,__enum__:"hxsl.VarQualifier",toString:s},Name:(a=function(e){return{_hx_index:4,n:e,__enum__:"hxsl.VarQualifier",toString:s}},a._hx_name="Name",a.__params__=["n"],a),Shared:{_hx_name:"Shared",_hx_index:5,__enum__:"hxsl.VarQualifier",toString:s},Precision:(a=function(e){return{_hx_index:6,p:e,__enum__:"hxsl.VarQualifier",toString:s}},a._hx_name="Precision",a.__params__=["p"],a),Range:(a=function(e,t){return{_hx_index:7,min:e,max:t,__enum__:"hxsl.VarQualifier",toString:s}},a._hx_name="Range",a.__params__=["min","max"],a),Ignore:{_hx_name:"Ignore",_hx_index:8,__enum__:"hxsl.VarQualifier",toString:s},PerInstance:(a=function(e){return{_hx_index:9,v:e,__enum__:"hxsl.VarQualifier",toString:s}},a._hx_name="PerInstance",a.__params__=["v"],a),Doc:(a=function(e){return{_hx_index:10,s:e,__enum__:"hxsl.VarQualifier",toString:s}},a._hx_name="Doc",a.__params__=["s"],a),Borrow:(a=function(e){return{_hx_index:11,source:e,__enum__:"hxsl.VarQualifier",toString:s}},a._hx_name="Borrow",a.__params__=["source"],a),Sampler:(a=function(e){return{_hx_index:12,name:e,__enum__:"hxsl.VarQualifier",toString:s}},a._hx_name="Sampler",a.__params__=["name"],a),Final:{_hx_name:"Final",_hx_index:13,__enum__:"hxsl.VarQualifier",toString:s},Flat:{_hx_name:"Flat",_hx_index:14,__enum__:"hxsl.VarQualifier",toString:s}},I.__constructs__=[I.Const,I.Private,I.Nullable,I.PerObject,I.Name,I.Shared,I.Precision,I.Range,I.Ignore,I.PerInstance,I.Doc,I.Borrow,I.Sampler,I.Final,I.Flat],I.__empty_constructs__=[I.Private,I.Nullable,I.PerObject,I.Shared,I.Ignore,I.Final,I.Flat],zo=_["hxsl.Prec"]={__ename__:!0,__constructs__:null,Low:{_hx_name:"Low",_hx_index:0,__enum__:"hxsl.Prec",toString:s},Medium:{_hx_name:"Medium",_hx_index:1,__enum__:"hxsl.Prec",toString:s},High:{_hx_name:"High",_hx_index:2,__enum__:"hxsl.Prec",toString:s}},zo.__constructs__=[zo.Low,zo.Medium,zo.High],zo.__empty_constructs__=[zo.Low,zo.Medium,zo.High],m=_["hxsl.Const"]={__ename__:!0,__constructs__:null,CNull:{_hx_name:"CNull",_hx_index:0,__enum__:"hxsl.Const",toString:s},CBool:(a=function(e){return{_hx_index:1,b:e,__enum__:"hxsl.Const",toString:s}},a._hx_name="CBool",a.__params__=["b"],a),CInt:(a=function(e){return{_hx_index:2,v:e,__enum__:"hxsl.Const",toString:s}},a._hx_name="CInt",a.__params__=["v"],a),CFloat:(a=function(e){return{_hx_index:3,v:e,__enum__:"hxsl.Const",toString:s}},a._hx_name="CFloat",a.__params__=["v"],a),CString:(a=function(e){return{_hx_index:4,v:e,__enum__:"hxsl.Const",toString:s}},a._hx_name="CString",a.__params__=["v"],a)},m.__constructs__=[m.CNull,m.CBool,m.CInt,m.CFloat,m.CString],m.__empty_constructs__=[m.CNull],qe=_["hxsl.ExprDef"]={__ename__:!0,__constructs__:null,EConst:(a=function(e){return{_hx_index:0,c:e,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EConst",a.__params__=["c"],a),EIdent:(a=function(e){return{_hx_index:1,i:e,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EIdent",a.__params__=["i"],a),EParenthesis:(a=function(e){return{_hx_index:2,e,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EParenthesis",a.__params__=["e"],a),EField:(a=function(e,t){return{_hx_index:3,e,f:t,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EField",a.__params__=["e","f"],a),EBinop:(a=function(e,t,n){return{_hx_index:4,op:e,e1:t,e2:n,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EBinop",a.__params__=["op","e1","e2"],a),EUnop:(a=function(e,t){return{_hx_index:5,op:e,e1:t,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EUnop",a.__params__=["op","e1"],a),ECall:(a=function(e,t){return{_hx_index:6,e,args:t,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="ECall",a.__params__=["e","args"],a),EBlock:(a=function(e){return{_hx_index:7,el:e,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EBlock",a.__params__=["el"],a),EVars:(a=function(e){return{_hx_index:8,v:e,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EVars",a.__params__=["v"],a),EFunction:(a=function(e){return{_hx_index:9,f:e,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EFunction",a.__params__=["f"],a),EIf:(a=function(e,t,n){return{_hx_index:10,econd:e,eif:t,eelse:n,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EIf",a.__params__=["econd","eif","eelse"],a),EDiscard:{_hx_name:"EDiscard",_hx_index:11,__enum__:"hxsl.ExprDef",toString:s},EFor:(a=function(e,t,n){return{_hx_index:12,v:e,loop:t,block:n,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EFor",a.__params__=["v","loop","block"],a),EReturn:(a=function(e){return{_hx_index:13,e,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EReturn",a.__params__=["e"],a),EBreak:{_hx_name:"EBreak",_hx_index:14,__enum__:"hxsl.ExprDef",toString:s},EContinue:{_hx_name:"EContinue",_hx_index:15,__enum__:"hxsl.ExprDef",toString:s},EArray:(a=function(e,t){return{_hx_index:16,e,eindex:t,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EArray",a.__params__=["e","eindex"],a),EArrayDecl:(a=function(e){return{_hx_index:17,el:e,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EArrayDecl",a.__params__=["el"],a),ESwitch:(a=function(e,t,n){return{_hx_index:18,e,cases:t,def:n,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="ESwitch",a.__params__=["e","cases","def"],a),EWhile:(a=function(e,t,n){return{_hx_index:19,cond:e,loop:t,normalWhile:n,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EWhile",a.__params__=["cond","loop","normalWhile"],a),EMeta:(a=function(e,t,n){return{_hx_index:20,name:e,args:t,e:n,__enum__:"hxsl.ExprDef",toString:s}},a._hx_name="EMeta",a.__params__=["name","args","e"],a)},qe.__constructs__=[qe.EConst,qe.EIdent,qe.EParenthesis,qe.EField,qe.EBinop,qe.EUnop,qe.ECall,qe.EBlock,qe.EVars,qe.EFunction,qe.EIf,qe.EDiscard,qe.EFor,qe.EReturn,qe.EBreak,qe.EContinue,qe.EArray,qe.EArrayDecl,qe.ESwitch,qe.EWhile,qe.EMeta],qe.__empty_constructs__=[qe.EDiscard,qe.EBreak,qe.EContinue],n=_["hxsl.TExprDef"]={__ename__:!0,__constructs__:null,TConst:(a=function(e){return{_hx_index:0,c:e,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TConst",a.__params__=["c"],a),TVar:(a=function(e){return{_hx_index:1,v:e,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TVar",a.__params__=["v"],a),TGlobal:(a=function(e){return{_hx_index:2,g:e,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TGlobal",a.__params__=["g"],a),TParenthesis:(a=function(e){return{_hx_index:3,e,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TParenthesis",a.__params__=["e"],a),TBlock:(a=function(e){return{_hx_index:4,el:e,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TBlock",a.__params__=["el"],a),TBinop:(a=function(e,t,n){return{_hx_index:5,op:e,e1:t,e2:n,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TBinop",a.__params__=["op","e1","e2"],a),TUnop:(a=function(e,t){return{_hx_index:6,op:e,e1:t,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TUnop",a.__params__=["op","e1"],a),TVarDecl:(a=function(e,t){return{_hx_index:7,v:e,init:t,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TVarDecl",a.__params__=["v","init"],a),TCall:(a=function(e,t){return{_hx_index:8,e,args:t,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TCall",a.__params__=["e","args"],a),TSwiz:(a=function(e,t){return{_hx_index:9,e,regs:t,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TSwiz",a.__params__=["e","regs"],a),TIf:(a=function(e,t,n){return{_hx_index:10,econd:e,eif:t,eelse:n,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TIf",a.__params__=["econd","eif","eelse"],a),TDiscard:{_hx_name:"TDiscard",_hx_index:11,__enum__:"hxsl.TExprDef",toString:s},TReturn:(a=function(e){return{_hx_index:12,e,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TReturn",a.__params__=["e"],a),TFor:(a=function(e,t,n){return{_hx_index:13,v:e,it:t,loop:n,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TFor",a.__params__=["v","it","loop"],a),TContinue:{_hx_name:"TContinue",_hx_index:14,__enum__:"hxsl.TExprDef",toString:s},TBreak:{_hx_name:"TBreak",_hx_index:15,__enum__:"hxsl.TExprDef",toString:s},TArray:(a=function(e,t){return{_hx_index:16,e,index:t,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TArray",a.__params__=["e","index"],a),TArrayDecl:(a=function(e){return{_hx_index:17,el:e,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TArrayDecl",a.__params__=["el"],a),TSwitch:(a=function(e,t,n){return{_hx_index:18,e,cases:t,def:n,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TSwitch",a.__params__=["e","cases","def"],a),TWhile:(a=function(e,t,n){return{_hx_index:19,e,loop:t,normalWhile:n,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TWhile",a.__params__=["e","loop","normalWhile"],a),TMeta:(a=function(e,t,n){return{_hx_index:20,m:e,args:t,e:n,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TMeta",a.__params__=["m","args","e"],a),TField:(a=function(e,t){return{_hx_index:21,e,name:t,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TField",a.__params__=["e","name"],a),TSyntax:(a=function(e,t,n){return{_hx_index:22,target:e,code:t,args:n,__enum__:"hxsl.TExprDef",toString:s}},a._hx_name="TSyntax",a.__params__=["target","code","args"],a)},n.__constructs__=[n.TConst,n.TVar,n.TGlobal,n.TParenthesis,n.TBlock,n.TBinop,n.TUnop,n.TVarDecl,n.TCall,n.TSwiz,n.TIf,n.TDiscard,n.TReturn,n.TFor,n.TContinue,n.TBreak,n.TArray,n.TArrayDecl,n.TSwitch,n.TWhile,n.TMeta,n.TField,n.TSyntax],n.__empty_constructs__=[n.TDiscard,n.TContinue,n.TBreak],de=_["hxsl.FunctionKind"]={__ename__:!0,__constructs__:null,Vertex:{_hx_name:"Vertex",_hx_index:0,__enum__:"hxsl.FunctionKind",toString:s},Fragment:{_hx_name:"Fragment",_hx_index:1,__enum__:"hxsl.FunctionKind",toString:s},Init:{_hx_name:"Init",_hx_index:2,__enum__:"hxsl.FunctionKind",toString:s},Helper:{_hx_name:"Helper",_hx_index:3,__enum__:"hxsl.FunctionKind",toString:s},Main:{_hx_name:"Main",_hx_index:4,__enum__:"hxsl.FunctionKind",toString:s}},de.__constructs__=[de.Vertex,de.Fragment,de.Init,de.Helper,de.Main],de.__empty_constructs__=[de.Vertex,de.Fragment,de.Init,de.Helper,de.Main],l=_["hxsl.TGlobal"]={__ename__:!0,__constructs__:null,Radians:{_hx_name:"Radians",_hx_index:0,__enum__:"hxsl.TGlobal",toString:s},Degrees:{_hx_name:"Degrees",_hx_index:1,__enum__:"hxsl.TGlobal",toString:s},Sin:{_hx_name:"Sin",_hx_index:2,__enum__:"hxsl.TGlobal",toString:s},Cos:{_hx_name:"Cos",_hx_index:3,__enum__:"hxsl.TGlobal",toString:s},Tan:{_hx_name:"Tan",_hx_index:4,__enum__:"hxsl.TGlobal",toString:s},Asin:{_hx_name:"Asin",_hx_index:5,__enum__:"hxsl.TGlobal",toString:s},Acos:{_hx_name:"Acos",_hx_index:6,__enum__:"hxsl.TGlobal",toString:s},Atan:{_hx_name:"Atan",_hx_index:7,__enum__:"hxsl.TGlobal",toString:s},Pow:{_hx_name:"Pow",_hx_index:8,__enum__:"hxsl.TGlobal",toString:s},Exp:{_hx_name:"Exp",_hx_index:9,__enum__:"hxsl.TGlobal",toString:s},Log:{_hx_name:"Log",_hx_index:10,__enum__:"hxsl.TGlobal",toString:s},Exp2:{_hx_name:"Exp2",_hx_index:11,__enum__:"hxsl.TGlobal",toString:s},Log2:{_hx_name:"Log2",_hx_index:12,__enum__:"hxsl.TGlobal",toString:s},Sqrt:{_hx_name:"Sqrt",_hx_index:13,__enum__:"hxsl.TGlobal",toString:s},Inversesqrt:{_hx_name:"Inversesqrt",_hx_index:14,__enum__:"hxsl.TGlobal",toString:s},Abs:{_hx_name:"Abs",_hx_index:15,__enum__:"hxsl.TGlobal",toString:s},Sign:{_hx_name:"Sign",_hx_index:16,__enum__:"hxsl.TGlobal",toString:s},Floor:{_hx_name:"Floor",_hx_index:17,__enum__:"hxsl.TGlobal",toString:s},Ceil:{_hx_name:"Ceil",_hx_index:18,__enum__:"hxsl.TGlobal",toString:s},Fract:{_hx_name:"Fract",_hx_index:19,__enum__:"hxsl.TGlobal",toString:s},Mod:{_hx_name:"Mod",_hx_index:20,__enum__:"hxsl.TGlobal",toString:s},Min:{_hx_name:"Min",_hx_index:21,__enum__:"hxsl.TGlobal",toString:s},Max:{_hx_name:"Max",_hx_index:22,__enum__:"hxsl.TGlobal",toString:s},Clamp:{_hx_name:"Clamp",_hx_index:23,__enum__:"hxsl.TGlobal",toString:s},Mix:{_hx_name:"Mix",_hx_index:24,__enum__:"hxsl.TGlobal",toString:s},InvLerp:{_hx_name:"InvLerp",_hx_index:25,__enum__:"hxsl.TGlobal",toString:s},Step:{_hx_name:"Step",_hx_index:26,__enum__:"hxsl.TGlobal",toString:s},Smoothstep:{_hx_name:"Smoothstep",_hx_index:27,__enum__:"hxsl.TGlobal",toString:s},Length:{_hx_name:"Length",_hx_index:28,__enum__:"hxsl.TGlobal",toString:s},Distance:{_hx_name:"Distance",_hx_index:29,__enum__:"hxsl.TGlobal",toString:s},Dot:{_hx_name:"Dot",_hx_index:30,__enum__:"hxsl.TGlobal",toString:s},Cross:{_hx_name:"Cross",_hx_index:31,__enum__:"hxsl.TGlobal",toString:s},Normalize:{_hx_name:"Normalize",_hx_index:32,__enum__:"hxsl.TGlobal",toString:s},LReflect:{_hx_name:"LReflect",_hx_index:33,__enum__:"hxsl.TGlobal",toString:s},Texture:{_hx_name:"Texture",_hx_index:34,__enum__:"hxsl.TGlobal",toString:s},TextureLod:{_hx_name:"TextureLod",_hx_index:35,__enum__:"hxsl.TGlobal",toString:s},Texel:{_hx_name:"Texel",_hx_index:36,__enum__:"hxsl.TGlobal",toString:s},TextureSize:{_hx_name:"TextureSize",_hx_index:37,__enum__:"hxsl.TGlobal",toString:s},ToInt:{_hx_name:"ToInt",_hx_index:38,__enum__:"hxsl.TGlobal",toString:s},ToFloat:{_hx_name:"ToFloat",_hx_index:39,__enum__:"hxsl.TGlobal",toString:s},ToBool:{_hx_name:"ToBool",_hx_index:40,__enum__:"hxsl.TGlobal",toString:s},Vec2:{_hx_name:"Vec2",_hx_index:41,__enum__:"hxsl.TGlobal",toString:s},Vec3:{_hx_name:"Vec3",_hx_index:42,__enum__:"hxsl.TGlobal",toString:s},Vec4:{_hx_name:"Vec4",_hx_index:43,__enum__:"hxsl.TGlobal",toString:s},IVec2:{_hx_name:"IVec2",_hx_index:44,__enum__:"hxsl.TGlobal",toString:s},IVec3:{_hx_name:"IVec3",_hx_index:45,__enum__:"hxsl.TGlobal",toString:s},IVec4:{_hx_name:"IVec4",_hx_index:46,__enum__:"hxsl.TGlobal",toString:s},BVec2:{_hx_name:"BVec2",_hx_index:47,__enum__:"hxsl.TGlobal",toString:s},BVec3:{_hx_name:"BVec3",_hx_index:48,__enum__:"hxsl.TGlobal",toString:s},BVec4:{_hx_name:"BVec4",_hx_index:49,__enum__:"hxsl.TGlobal",toString:s},Mat2:{_hx_name:"Mat2",_hx_index:50,__enum__:"hxsl.TGlobal",toString:s},Mat3:{_hx_name:"Mat3",_hx_index:51,__enum__:"hxsl.TGlobal",toString:s},Mat4:{_hx_name:"Mat4",_hx_index:52,__enum__:"hxsl.TGlobal",toString:s},Mat3x4:{_hx_name:"Mat3x4",_hx_index:53,__enum__:"hxsl.TGlobal",toString:s},Saturate:{_hx_name:"Saturate",_hx_index:54,__enum__:"hxsl.TGlobal",toString:s},Pack:{_hx_name:"Pack",_hx_index:55,__enum__:"hxsl.TGlobal",toString:s},Unpack:{_hx_name:"Unpack",_hx_index:56,__enum__:"hxsl.TGlobal",toString:s},PackNormal:{_hx_name:"PackNormal",_hx_index:57,__enum__:"hxsl.TGlobal",toString:s},UnpackNormal:{_hx_name:"UnpackNormal",_hx_index:58,__enum__:"hxsl.TGlobal",toString:s},ScreenToUv:{_hx_name:"ScreenToUv",_hx_index:59,__enum__:"hxsl.TGlobal",toString:s},UvToScreen:{_hx_name:"UvToScreen",_hx_index:60,__enum__:"hxsl.TGlobal",toString:s},DFdx:{_hx_name:"DFdx",_hx_index:61,__enum__:"hxsl.TGlobal",toString:s},DFdy:{_hx_name:"DFdy",_hx_index:62,__enum__:"hxsl.TGlobal",toString:s},Fwidth:{_hx_name:"Fwidth",_hx_index:63,__enum__:"hxsl.TGlobal",toString:s},ChannelRead:{_hx_name:"ChannelRead",_hx_index:64,__enum__:"hxsl.TGlobal",toString:s},ChannelReadLod:{_hx_name:"ChannelReadLod",_hx_index:65,__enum__:"hxsl.TGlobal",toString:s},ChannelFetch:{_hx_name:"ChannelFetch",_hx_index:66,__enum__:"hxsl.TGlobal",toString:s},ChannelTextureSize:{_hx_name:"ChannelTextureSize",_hx_index:67,__enum__:"hxsl.TGlobal",toString:s},Trace:{_hx_name:"Trace",_hx_index:68,__enum__:"hxsl.TGlobal",toString:s},VertexID:{_hx_name:"VertexID",_hx_index:69,__enum__:"hxsl.TGlobal",toString:s},InstanceID:{_hx_name:"InstanceID",_hx_index:70,__enum__:"hxsl.TGlobal",toString:s},FragCoord:{_hx_name:"FragCoord",_hx_index:71,__enum__:"hxsl.TGlobal",toString:s},FrontFacing:{_hx_name:"FrontFacing",_hx_index:72,__enum__:"hxsl.TGlobal",toString:s},FloatBitsToInt:{_hx_name:"FloatBitsToInt",_hx_index:73,__enum__:"hxsl.TGlobal",toString:s},FloatBitsToUint:{_hx_name:"FloatBitsToUint",_hx_index:74,__enum__:"hxsl.TGlobal",toString:s},IntBitsToFloat:{_hx_name:"IntBitsToFloat",_hx_index:75,__enum__:"hxsl.TGlobal",toString:s},UintBitsToFloat:{_hx_name:"UintBitsToFloat",_hx_index:76,__enum__:"hxsl.TGlobal",toString:s},RoundEven:{_hx_name:"RoundEven",_hx_index:77,__enum__:"hxsl.TGlobal",toString:s},SetLayout:{_hx_name:"SetLayout",_hx_index:78,__enum__:"hxsl.TGlobal",toString:s},ImageStore:{_hx_name:"ImageStore",_hx_index:79,__enum__:"hxsl.TGlobal",toString:s},ComputeVar_GlobalInvocation:{_hx_name:"ComputeVar_GlobalInvocation",_hx_index:80,__enum__:"hxsl.TGlobal",toString:s},ComputeVar_LocalInvocation:{_hx_name:"ComputeVar_LocalInvocation",_hx_index:81,__enum__:"hxsl.TGlobal",toString:s},ComputeVar_WorkGroup:{_hx_name:"ComputeVar_WorkGroup",_hx_index:82,__enum__:"hxsl.TGlobal",toString:s},ComputeVar_LocalInvocationIndex:{_hx_name:"ComputeVar_LocalInvocationIndex",_hx_index:83,__enum__:"hxsl.TGlobal",toString:s},AtomicAdd:{_hx_name:"AtomicAdd",_hx_index:84,__enum__:"hxsl.TGlobal",toString:s},GroupMemoryBarrier:{_hx_name:"GroupMemoryBarrier",_hx_index:85,__enum__:"hxsl.TGlobal",toString:s},UnpackSnorm4x8:{_hx_name:"UnpackSnorm4x8",_hx_index:86,__enum__:"hxsl.TGlobal",toString:s},UnpackUnorm4x8:{_hx_name:"UnpackUnorm4x8",_hx_index:87,__enum__:"hxsl.TGlobal",toString:s},Transpose:{_hx_name:"Transpose",_hx_index:88,__enum__:"hxsl.TGlobal",toString:s}},l.__constructs__=[l.Radians,l.Degrees,l.Sin,l.Cos,l.Tan,l.Asin,l.Acos,l.Atan,l.Pow,l.Exp,l.Log,l.Exp2,l.Log2,l.Sqrt,l.Inversesqrt,l.Abs,l.Sign,l.Floor,l.Ceil,l.Fract,l.Mod,l.Min,l.Max,l.Clamp,l.Mix,l.InvLerp,l.Step,l.Smoothstep,l.Length,l.Distance,l.Dot,l.Cross,l.Normalize,l.LReflect,l.Texture,l.TextureLod,l.Texel,l.TextureSize,l.ToInt,l.ToFloat,l.ToBool,l.Vec2,l.Vec3,l.Vec4,l.IVec2,l.IVec3,l.IVec4,l.BVec2,l.BVec3,l.BVec4,l.Mat2,l.Mat3,l.Mat4,l.Mat3x4,l.Saturate,l.Pack,l.Unpack,l.PackNormal,l.UnpackNormal,l.ScreenToUv,l.UvToScreen,l.DFdx,l.DFdy,l.Fwidth,l.ChannelRead,l.ChannelReadLod,l.ChannelFetch,l.ChannelTextureSize,l.Trace,l.VertexID,l.InstanceID,l.FragCoord,l.FrontFacing,l.FloatBitsToInt,l.FloatBitsToUint,l.IntBitsToFloat,l.UintBitsToFloat,l.RoundEven,l.SetLayout,l.ImageStore,l.ComputeVar_GlobalInvocation,l.ComputeVar_LocalInvocation,l.ComputeVar_WorkGroup,l.ComputeVar_LocalInvocationIndex,l.AtomicAdd,l.GroupMemoryBarrier,l.UnpackSnorm4x8,l.UnpackUnorm4x8,l.Transpose],l.__empty_constructs__=[l.Radians,l.Degrees,l.Sin,l.Cos,l.Tan,l.Asin,l.Acos,l.Atan,l.Pow,l.Exp,l.Log,l.Exp2,l.Log2,l.Sqrt,l.Inversesqrt,l.Abs,l.Sign,l.Floor,l.Ceil,l.Fract,l.Mod,l.Min,l.Max,l.Clamp,l.Mix,l.InvLerp,l.Step,l.Smoothstep,l.Length,l.Distance,l.Dot,l.Cross,l.Normalize,l.LReflect,l.Texture,l.TextureLod,l.Texel,l.TextureSize,l.ToInt,l.ToFloat,l.ToBool,l.Vec2,l.Vec3,l.Vec4,l.IVec2,l.IVec3,l.IVec4,l.BVec2,l.BVec3,l.BVec4,l.Mat2,l.Mat3,l.Mat4,l.Mat3x4,l.Saturate,l.Pack,l.Unpack,l.PackNormal,l.UnpackNormal,l.ScreenToUv,l.UvToScreen,l.DFdx,l.DFdy,l.Fwidth,l.ChannelRead,l.ChannelReadLod,l.ChannelFetch,l.ChannelTextureSize,l.Trace,l.VertexID,l.InstanceID,l.FragCoord,l.FrontFacing,l.FloatBitsToInt,l.FloatBitsToUint,l.IntBitsToFloat,l.UintBitsToFloat,l.RoundEven,l.SetLayout,l.ImageStore,l.ComputeVar_GlobalInvocation,l.ComputeVar_LocalInvocation,l.ComputeVar_WorkGroup,l.ComputeVar_LocalInvocationIndex,l.AtomicAdd,l.GroupMemoryBarrier,l.UnpackSnorm4x8,l.UnpackUnorm4x8,l.Transpose],xn=_["hxsl.SyntaxArgAccess"]={__ename__:!0,__constructs__:null,Read:{_hx_name:"Read",_hx_index:0,__enum__:"hxsl.SyntaxArgAccess",toString:s},Write:{_hx_name:"Write",_hx_index:1,__enum__:"hxsl.SyntaxArgAccess",toString:s},ReadWrite:{_hx_name:"ReadWrite",_hx_index:2,__enum__:"hxsl.SyntaxArgAccess",toString:s}},xn.__constructs__=[xn.Read,xn.Write,xn.ReadWrite],xn.__empty_constructs__=[xn.Read,xn.Write,xn.ReadWrite],B=_["hxsl.Component"]={__ename__:!0,__constructs__:null,X:{_hx_name:"X",_hx_index:0,__enum__:"hxsl.Component",toString:s},Y:{_hx_name:"Y",_hx_index:1,__enum__:"hxsl.Component",toString:s},Z:{_hx_name:"Z",_hx_index:2,__enum__:"hxsl.Component",toString:s},W:{_hx_name:"W",_hx_index:3,__enum__:"hxsl.Component",toString:s}},B.__constructs__=[B.X,B.Y,B.Z,B.W],B.__empty_constructs__=[B.X,B.Y,B.Z,B.W],r=function(){},c["hxsl.Tools"]=r,r.__name__="hxsl.Tools",r.allocVarId=function(){return++r.UID},r.getTexUVSize=function(e,t){t==null&&(t=!1);var n;switch(e._hx_index){case 0:n=1;break;case 1:n=2;break;case 2:case 3:n=3;break}return t&&++n,n},r.getDimSize=function(e,t){t==null&&(t=!1);var n;switch(e._hx_index){case 0:n=1;break;case 2:n=3;break;case 1:case 3:n=2;break}return t&&++n,n},r.getName=function(e){if(e.qualifiers==null)return e.name;for(var n,o,t=0,s=e.qualifiers;t<s.length;)if(n=s[t],++t,n._hx_index==4)return o=n.n,o;return e.name},r.getDoc=function(e){if(e.qualifiers==null)return null;for(var n,o,t=0,s=e.qualifiers;t<s.length;)if(n=s[t],++t,n._hx_index==10)return o=n.s,o;return null},r.getConstBits=function(e){var t,s,o,i,a,n=e.type;switch(n._hx_index){case 1:for(t=0,o=e.qualifiers;t<o.length;)if(i=o[t],++t,i._hx_index==0){if(a=i.max,a!=null){for(s=0;a>=1<<s;)++s;return s}return 8}break;case 2:return 1;case 16:switch(t=n.t,t=n.size,n.kind._hx_index){case 3:case 4:case 5:return r.MAX_PARTIAL_MAPPINGS_BITS;default:}break;case 17:return t=n.size,3+r.MAX_CHANNELS_BITS;default:}return 0},r.isConst=function(e){var n,s,o,i,t=e.type;switch(t._hx_index){case 16:switch(n=t.t,n=t.size,t.kind._hx_index){case 3:case 4:case 5:s=!0;break;default:s=!1}break;case 17:n=t.size,s=!0;break;default:s=!1}if(s)return!0;if(e.qualifiers!=null)for(t=0,n=e.qualifiers;t<n.length;)if(o=n[t],++t,o._hx_index==0)return i=o.max,!0;return!1},r.isStruct=function(e){var n,t=e.type;return t._hx_index==13&&(n=t.vl,!0)},r.isArray=function(e){var n,t=e.type;return t._hx_index==15&&(n=t.t,n=t.size,!0)},r.hasQualifier=function(e,t){if(e.qualifiers!=null)for(var o,n=0,s=e.qualifiers;n<s.length;)if(o=s[n],++n,o==t)return!0;return!1},r.hasBorrowQualifier=function(e,t){if(e.qualifiers!=null)for(var s,i,n=0,o=e.qualifiers;n<o.length;)if(s=o[n],++n,s._hx_index==11)return i=s.source,t==i;return!1},r.isTexture=function(e){switch(e._hx_index){case 10:var t=e.dim,t=e.isArray;return!0;case 11:return t=e.dim,t=e.isArray,t=e.channels,!0;case 17:return t=e.size,!0;default:return!1}},r.toString=function(e){switch(e._hx_index){case 5:var t,n,s,o,a,c,l,d,h,m,f,p,g,v,b=e.size,i=e.t;switch(i._hx_index){case 0:t="i";break;case 1:t="";break;case 2:t="b";break}return t+"vec"+b;case 9:return g=e.size,"Bytes"+g;case 10:return a=e.dim,d=e.isArray,"Sampler"+u.substr(_[a.__enum__].__constructs__[a._hx_index]._hx_name,1,null)+(d?"Array":"");case 11:return a=e.dim,d=e.isArray,p=e.channels,"RWTexture"+u.substr(_[a.__enum__].__constructs__[a._hx_index]._hx_name,1,null)+(d?"Array":"")+"<"+(p==1?"Float":"Vec"+p)+">";case 13:for(m=e.vl,f=[],l=0;l<m.length;)s=m[l],++l,f.push(s.name+" : "+r.toString(s.type));return"{"+f.join(",")+"}";case 15:switch(i=e.t,n=e.size,c=r.toString(i)+"[",n._hx_index){case 0:h=n.v,o=""+h;break;case 1:s=n.v,o=s.name;break}return c+o+"]";case 16:switch(i=e.t,n=e.size,v=e.kind,v._hx_index){case 0:t="Buffer";break;case 1:t="StorageBuffer";break;case 2:t="RWBuffer";break;case 3:t="PartialBuffer";break;case 4:t="StoragePartialBuffer";break;case 5:t="RWPartialBuffer";break}switch(c=t+" "+r.toString(i)+"[",n._hx_index){case 0:h=n.v,o=""+h;break;case 1:s=n.v,o=s.name;break}return c+o+"]";default:return u.substr(_[e.__enum__].__constructs__[e._hx_index]._hx_name,1,null)}},r.toType=function(e){switch(e._hx_index){case 0:return i.TInt;case 1:return i.TFloat;case 2:return i.TBool}},r.hasSideEffect=function(e){var e,t,s,o,i,a,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,n=e.e;switch(n._hx_index){case 0:return t=n.c,!1;case 1:return t=n.v,!1;case 2:return t=n.g,!1;case 3:return e=n.e,r.hasSideEffect(e);case 4:for(a=n.el,t=0;t<a.length;)if(e=a[t],++t,r.hasSideEffect(e))return!0;return!1;case 5:switch(t=n.op,o=n.e1,s=n.e2,t._hx_index){case 4:return!0;case 20:return c=t.op,!0;default:return u=o,y=s,!!r.hasSideEffect(u)||r.hasSideEffect(y)}break;case 6:return t=n.op,u=n.e1,r.hasSideEffect(u);case 7:return t=n.v,t=n.init,!0;case 8:if(t=n.e,o=n.args,s=t.e,c=t.p,c=t.t,s._hx_index==2){if(s.g._hx_index==78)return!0;if(e=t,i=o,s=e.e,s._hx_index==2)switch(c=s.g,c._hx_index){case 79:case 84:case 85:return!0;default:_=c}else return!0;for(s=0;s<i.length;)if(l=i[s],++s,r.hasSideEffect(l))return!0;return!1}else{if(e=t,i=o,t=e.e,t._hx_index==2)switch(o=t.g,o._hx_index){case 79:case 84:case 85:return!0;default:_=o}else return!0;for(t=0;t<i.length;)if(l=i[t],++t,r.hasSideEffect(l))return!0;return!1}break;case 9:return t=n.regs,e=n.e,r.hasSideEffect(e);case 10:return g=n.econd,j=n.eif,p=n.eelse,!!(r.hasSideEffect(g)||r.hasSideEffect(j))||p!=null&&r.hasSideEffect(p);break;case 12:return t=n.e,!0;case 13:return t=n.v,v=n.it,d=n.loop,!!r.hasSideEffect(v)||r.hasSideEffect(d);break;case 11:case 14:case 15:return!0;case 16:return e=n.e,b=n.index,!!r.hasSideEffect(e)||r.hasSideEffect(b);break;case 17:for(a=n.el,t=0;t<a.length;)if(e=a[t],++t,r.hasSideEffect(e))return!0;return!1;case 18:for(e=n.e,f=n.cases,m=n.def,t=0;t<f.length;){for(h=f[t],++t,o=0,s=h.values;o<s.length;)if(w=s[o],++o,r.hasSideEffect(w))return!0;if(r.hasSideEffect(h.expr))return!0}return!!r.hasSideEffect(e)||m!=null&&r.hasSideEffect(m);break;case 19:return t=n.normalWhile,e=n.e,d=n.loop,!!r.hasSideEffect(e)||r.hasSideEffect(d);break;case 20:return t=n.m,t=n.args,e=n.e,r.hasSideEffect(e);case 21:return t=n.name,e=n.e,r.hasSideEffect(e);case 22:return t=n.target,t=n.code,t=n.args,!0}},r.iter=function(e,t){var e,s,o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,n=e.e;switch(n._hx_index){case 0:s=n.c;break;case 1:s=n.v;break;case 2:s=n.g;break;case 3:e=n.e,t(e);break;case 4:for(o=n.el,s=0;s<o.length;)e=o[s],++s,t(e);break;case 5:s=n.op,a=n.e1,j=n.e2,t(a),t(j);break;case 6:s=n.op,a=n.e1,t(a);break;case 7:s=n.v,f=n.init,f!=null&&t(f);break;case 8:for(e=n.e,i=n.args,t(e),s=0;s<i.length;)b=i[s],++s,t(b);break;case 9:s=n.regs,e=n.e,t(e);break;case 10:v=n.econd,y=n.eif,l=n.eelse,t(v),t(y),l!=null&&t(l);break;case 12:e=n.e,e!=null&&t(e);break;case 13:s=n.v,p=n.it,c=n.loop,t(p),t(c);break;case 11:case 14:case 15:break;case 16:e=n.e,g=n.index,t(e),t(g);break;case 17:for(o=n.el,s=0;s<o.length;)e=o[s],++s,t(e);break;case 18:for(e=n.e,d=n.cases,m=n.def,t(e),s=0;s<d.length;){for(h=d[s],++s,r=0,u=h.values;r<u.length;)_=u[r],++r,t(_);t(h.expr)}m!=null&&t(m);break;case 19:s=n.normalWhile,e=n.e,c=n.loop,t(e),t(c);break;case 20:s=n.m,s=n.args,e=n.e,t(e);break;case 21:s=n.name,e=n.e,t(e);break;case 22:for(s=n.target,s=n.code,i=n.args,n=0;n<i.length;)w=i[n],++n,t(w.e);break}},r.map=function(e,t){var o,i,a,r,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,s=e.e;switch(s._hx_index){case 0:a=s.c,i=e.e;break;case 1:a=s.v,i=e.e;break;case 2:a=s.g,i=e.e;break;case 3:o=s.e,i=n.TParenthesis(t(o));break;case 4:for(l=s.el,a=[],r=0;r<l.length;)o=l[r],++r,a.push(t(o));i=n.TBlock(a);break;case 5:h=s.op,o=s.e1,O=s.e2,i=n.TBinop(h,t(o),t(O));break;case 6:h=s.op,o=s.e1,i=n.TUnop(h,t(o));break;case 7:d=s.v,g=s.init,i=n.TVarDecl(d,g!=null?t(g):null);break;case 8:for(o=s.e,c=s.args,f=t(o),a=[],r=0;r<c.length;)z=c[r],++r,a.push(t(z));i=n.TCall(f,a);break;case 9:o=s.e,u=s.regs,i=n.TSwiz(t(o),u);break;case 10:k=s.econd,E=s.eif,j=s.eelse,i=n.TIf(t(k),t(E),j!=null?t(j):null);break;case 12:o=s.e,i=n.TReturn(o!=null?t(o):null);break;case 13:d=s.v,C=s.it,m=s.loop,i=n.TFor(d,t(C),t(m));break;case 11:case 14:case 15:i=e.e;break;case 16:o=s.e,x=s.index,i=n.TArray(t(o),t(x));break;case 17:for(l=s.el,a=[],r=0;r<l.length;)o=l[r],++r,a.push(t(o));i=n.TArrayDecl(a);break;case 18:for(o=s.e,_=s.cases,w=s.def,f=t(o),a=[],r=0;r<_.length;){for(u=_[r],++r,y=[],p=0,v=u.values;p<v.length;)d=v[p],++p,y.push(t(d));a.push({values:y,expr:t(u.expr)})}i=n.TSwitch(f,a,w==null?null:t(w));break;case 19:o=s.e,m=s.loop,A=s.normalWhile,i=n.TWhile(t(o),t(m),A);break;case 20:S=s.m,c=s.args,o=s.e,i=n.TMeta(S,c,t(o));break;case 21:o=s.e,M=s.name,i=n.TField(t(o),M);break;case 22:for(F=s.target,T=s.code,c=s.args,s=[],a=0;a<c.length;)b=c[a],++a,s.push({e:t(b.e),access:b.access});i=n.TSyntax(F,T,s);break}return{e:i,t:e.t,p:e.p}},r.size=function(e){switch(e._hx_index){case 0:return 0;case 1:case 3:return 1;case 2:case 4:return 0;case 5:var n,s,o,a,c,t=e.t,i=e.size;return i;case 6:return 9;case 7:return 16;case 8:return 12;case 9:return s=e.size,s;case 10:return t=e.dim,t=e.isArray,0;case 11:return t=e.dim,t=e.isArray,t=e.channels,0;case 12:return 4;case 13:for(c=e.vl,s=0,t=0;t<c.length;)n=c[t],++t,s+=r.size(n.type);return s;case 14:return t=e.variants,0;case 15:switch(t=e.t,o=e.size,o._hx_index){case 0:return n=o.v,a=t,r.size(a)*n;case 1:return t=o.v,0}break;case 16:return t=e.size,o=e.kind,t._hx_index==0?(n=t.v,a=e.t,r.size(a)*n):0;break;case 17:return i=e.size,i}},r.evalConst=function(e){var n,s,o,i,c,l,d,u,m,f,p,g,v,b,y,a=e.e;switch(a._hx_index){case 0:switch(d=a.c,d._hx_index){case 0:return null;case 1:return y=d.b,y;case 2:return b=d.v,b;case 3:return p=d.v,p;case 4:return v=d.v,v}break;case 8:if(c=a.e,f=a.args,a=c.e,g=c.p,g=c.t,a._hx_index==2)switch(a.g._hx_index){case 41:case 42:for(u=f,a=[],c=0;c<u.length;)m=u[c],++c,a.push(r.evalConst(m));return n=a,n.length==1?(i=n[0],o=n[0],s=n[0],s==null&&(s=0),o==null&&(o=0),i==null&&(i=0),new h(i,o,s)):(i=n[0],o=n[1],s=n[2],s==null&&(s=0),o==null&&(o=0),i==null&&(i=0),new h(i,o,s));case 43:for(u=f,a=[],c=0;c<u.length;)m=u[c],++c,a.push(r.evalConst(m));return n=a,n.length==1?(i=n[0],o=n[0],s=n[0],l=n[0],l==null&&(l=1),s==null&&(s=0),o==null&&(o=0),i==null&&(i=0),new j(i,o,s,l)):(i=n[0],o=n[1],s=n[2],l=n[3],l==null&&(l=1),s==null&&(s=0),o==null&&(o=0),i==null&&(i=0),new j(i,o,s,l));default:throw t.thrown("Unhandled constant init "+Z.toString(e))}else throw t.thrown("Unhandled constant init "+Z.toString(e));break;default:throw t.thrown("Unhandled constant init "+Z.toString(e))}},D=function(){},c["hxsl.Tools2"]=D,D.__name__="hxsl.Tools2",D.toString=function(e){var t=_[e.__enum__].__constructs__[e._hx_index]._hx_name;return t.charAt(0).toLowerCase()+u.substr(t,1,null)},el=function(){},c["hxsl.Tools3"]=el,el.__name__="hxsl.Tools3",el.toString=function(e){return Z.shaderToString(e)},tl=function(){},c["hxsl.Tools4"]=tl,tl.__name__="hxsl.Tools4",tl.toString=function(e){return Z.toString(e)},Eo=function(){this.Batch_Count__=0,P.call(this)},c["hxsl.BatchShader"]=Eo,Eo.__name__="hxsl.BatchShader",Eo.__super__=P,Eo.prototype=g(P.prototype,{get_Batch_HasOffset:function(){return this.Batch_HasOffset__},set_Batch_HasOffset:function(e){return this.constModified=!0,this.Batch_HasOffset__=e},get_Batch_UseStorage:function(){return this.Batch_UseStorage__},set_Batch_UseStorage:function(e){return this.constModified=!0,this.Batch_UseStorage__=e},get_Batch_Count:function(){return this.Batch_Count__},set_Batch_Count:function(e){return this.constModified=!0,this.Batch_Count__=e},get_Batch_Buffer:function(){return this.Batch_Buffer__},set_Batch_Buffer:function(e){return this.Batch_Buffer__=e},get_Batch_StorageBuffer:function(){return this.Batch_StorageBuffer__},set_Batch_StorageBuffer:function(e){return this.Batch_StorageBuffer__=e},updateConstants:function(e){this.constBits=0,this.Batch_HasOffset__&&(this.constBits|=1),this.Batch_UseStorage__&&(this.constBits|=2);var n=this.Batch_Count__;if(n>>>13!=0)throw t.thrown("Batch_Count is out of range "+n+">"+8191+", consider using @const(MAX_VALUE)");this.constBits|=n<<2,this.updateConstantsFinal(e)},getParamValue:function(e){switch(e){case 0:return this.Batch_HasOffset__;case 1:return this.Batch_UseStorage__;case 2:return this.Batch_Count__;case 3:return this.Batch_Buffer__;case 4:return this.Batch_StorageBuffer__;default:}return null},getParamFloatValue:function(e){return e==2?this.Batch_Count__:0},setParamIndexValue:function(e,t){switch(e){case 0:this.Batch_HasOffset__=t;break;case 1:this.Batch_UseStorage__=t;break;case 2:this.Batch_Count__=t;break;case 3:this.Batch_Buffer__=t;break;case 4:this.Batch_StorageBuffer__=t;break;default:}},setParamIndexFloatValue:function(){},clone:function(){var e=Object.create(Eo.prototype);return e.shader=this.shader,e.Batch_HasOffset__=this.Batch_HasOffset__,e.Batch_UseStorage__=this.Batch_UseStorage__,e.Batch_Count__=this.Batch_Count__,e.Batch_Buffer__=this.Batch_Buffer__,e.Batch_StorageBuffer__=this.Batch_StorageBuffer__,e},__class__:Eo}),Wc=function(e){this.forcedPerInstance=e},c["hxsl.BatchInstanceParams"]=Wc,Wc.__name__="hxsl.BatchInstanceParams",Wc.prototype={getSignature:function(){if(this.cachedSignature==null){for(var n,s,o,e=0,t=this.forcedPerInstance;e<t.length;)o=t[e],++e,o.params.sort(q.compare);for(e=[],t=0,n=this.forcedPerInstance;t<n.length;)s=n[t],++t,e.push(s.shader+"="+s.params.join(","));this.cachedSignature=u.substr(pn.encode(e.join(";")),0,8)}return this.cachedSignature},__class__:Wc},Fa=function(){this.minId=0,this.nexts=[]},c["hxsl.SearchMap"]=Fa,Fa.__name__="hxsl.SearchMap",Fa.prototype={set:function(e,t){if(this.minId==0){this.minId=e,this.nexts=[t];return}var s,o,i,a,n=e-this.minId;if(n<0){for(s=[],o=0,a=this.nexts.length;o<a;)i=o++,s[i-n]=this.nexts[i];this.nexts=s,this.minId+=n,n=0}this.nexts[n]=t},get:function(e){return this.nexts[e-this.minId]},__class__:Fa},Mn=function(){this.linkCache=new Fa,this.linkShaders=new fe,this.batchShaders=new Rt,this.batchShadersParams=new fe,this.byID=new fe},c["hxsl.Cache"]=Mn,Mn.__name__="hxsl.Cache",Mn.get=function(){var e=Mn.INST;return e==null&&(e=new Mn,Mn.INST=e),e},Mn.set=function(e){Mn.INST=e},Mn.clear=function(){Mn.INST=null},Mn.prototype={getLinkShader:function(e){for(var s,a,c,d,h,f,p,g,b,j,_,w,C,E,x=[],y=0;y<e.length;)C=e[y],++y,x.push(o.string(C));return p=x.join(","),c=this.linkShaders.h[p],c??(d=new st(""),w=u.substr(pn.encode(p),0,8),d.data={name:"shaderLinker_"+w,vars:[],funs:[]},s=null,f=Object.create(null),b=0,h=i.TVec(4,v.VFloat),g=function(e,t,o,a){for(var c,l,d=[],u=t,h=0,m=o.length;h<m;)c=h++,l=a(o[o.length-1-c],u-(o.length-1-c)),u-=r.size(l.t),d.unshift(l);return{e:n.TCall({e:n.TGlobal(e),t:i.TVoid,p:s},d),t:i.TVec(t,v.VFloat),p:s}},j=function(e,n,s){var i,c,a=s==null?e:r.getName(s)+"."+e,o=f[a];if(o!=null)return o;if(o={id:r.allocVarId(),name:e,type:n,kind:O.Var,parent:s},s==null)d.data.vars.push(o);else if(i=s.type,i._hx_index==13)c=i.vl,c.push(o);else throw t.thrown("assert");return f[a]=o,o},a=null,a=function(e,t){switch(e._hx_index){case 0:var r,c,d,u,p,b,o=e.v;return{e:n.TConst(m.CFloat(o)),t:i.TFloat,p:s};case 1:if(u=e.v,p=e.size,o=f[u],o!=null)return{e:n.TVar(o),t:o.type,p:s};for(c=u.split("."),d=null;c.length>1;)d=j(c.shift(),i.TStruct([]),d);return p!=null&&(t=p),o=j(c.shift(),t==1?i.TFloat:i.TVec(t,v.VFloat),d),{e:n.TVar(o),t:o.type,p:s};case 2:return o=e.v,{e:n.TCall({e:n.TGlobal(l.PackNormal),t:i.TVoid,p:s},[a(o,3)]),t:h,p:s};case 3:return o=e.v,{e:n.TCall({e:n.TGlobal(l.Pack),t:i.TVoid,p:s},[a(o,1)]),t:h,p:s};case 4:return r=e.a,g(l.Vec2,2,r,a);case 5:return r=e.a,g(l.Vec3,3,r,a);case 6:return r=e.a,g(l.Vec4,4,r,a);case 7:return o=e.a,b=e.swiz,{e:n.TSwiz(a(o,4),b),t:i.TVec(b.length,v.VFloat),p:s}}},E=function(e){b+=1;var t={id:r.allocVarId(),type:h,name:"OUTPUT"+(b-1),kind:O.Output};return d.data.vars.push(t),{e:n.TBinop(T.OpAssign,{e:n.TVar(t),t:h,p:s},a(e,4)),t:i.TVoid,p:s}},_=function(e,t){for(var l,u,h={id:r.allocVarId(),type:i.TFun([]),name:(""+o.string(e)).toLowerCase(),kind:O.Function},c=[],a=0;a<t.length;)l=t[a],++a,c.push(E(l));u={kind:e,ref:h,args:[],ret:i.TVoid,expr:{e:n.TBlock(c),p:s,t:i.TVoid}},d.data.funs.push(u)},_(de.Vertex,[vt.Value("output.position")]),_(de.Fragment,e),c=Object.create(P.prototype),c.shader=d,this.linkShaders.h[p]=c,c.updateConstantsFinal(null),c)},link:function(e,t){for(var s,i,a,r,n=this.linkCache,o=e,c=null;o!=c;)a=o.s,o=o.next,r=a,i=r.instance,s=n.nexts[i.id-n.minId],s==null&&(s=new Fa,n.set(i.id,s)),n=s;return n.linked==null&&(n.linked=this.compileRuntimeShader(e,t)),n.linked},compileRuntimeShader:function(e,n){for(var s,o,i,a,r,l,h,m,f,p,g,v,b,j,y,_,x,C,E,k,A,S,M,c=[],F=0,d=e,w=null;d!=w;)i=d.s,d=d.next,l=i,h=l.instance,c.push({inst:h,p:l.priority,index:F++});c.reverse(),et.sort(c,function(e,t){return t.p-e.p}),b=new Hc(n);try{for(o=[],s=0;s<c.length;)l=c[s],++s,o.push(l.inst.shader);i=b.link(o)}catch(e){if(s=t.caught(e).unwrap(),s instanceof De){for(f=s,s=[],r=0;r<c.length;)l=c[r],++r,s.push(Z.shaderToString(l.inst.shader));throw E=s,f.msg+=`

in

`+E.join(`
-----
`),t.thrown(f)}throw e}if(n==Ft.Batch)for(p=null,p=function(e){e.qualifiers!=null&&e.qualifiers.indexOf(I.PerObject)>=0&&(e.qualifiers.length==1?e.qualifiers=null:(e.qualifiers=e.qualifiers.slice(),u.remove(e.qualifiers,I.PerObject)),e.kind!=O.Var&&(e.kind=O.Local));var e,n,t=e.type;if(t._hx_index==13)for(n=t.vl,t=0;t<n.length;)e=n[t],++t,p(e)},o=0,s=i.vars;o<s.length;)m=s[o],++o,p(m);S=i,y=new jr;try{_=y.split(i,n==Ft.Batch)}catch(e){throw s=t.caught(e).unwrap(),s instanceof De?(f=s,f.msg+=`

in

`+Z.shaderToString(i),t.thrown(f)):e}for(g=new le,o=0,s=b.allVars;o<s.length;)if(m=s[o],++o,m.v.kind==O.Param){if(r=m.v.type,r._hx_index==13){M=r.vl;continue}v=c[m.instanceIndex],x=y.varMap.h[m.v.__id__],g.h[x==null?m.id:x.id]={instance:v.index,index:v.inst.params.h[m.merged[0].id]}}for(S=_,C=(new kc).dce(_),a=this.buildRuntimeShader(C,g),a.mode=n,o=[],d=e,w=null;d!=w;)i=d.s,d=d.next,l=i,o.push(new hc(l.shader,l.constBits));for(a.spec={instances:o,signature:null},o=0,s=c.length;o<s;)h=o++,i=c[c.length-1-h],a.spec.instances[i.index].index=h;for(o=[],s=0,r=a.spec.instances;s<r.length;)h=r[s],++s,o.push(h.shader.data.name+"_"+h.bits+"_"+h.index);for(k=o,A=k.join(":"),a.spec.signature=pn.encode(A),o=[],s=0,r=a.getShaders();s<r.length;)i=r[s],++s,o.push(Z.shaderToString(i.data));return a.signature=pn.encode(o.join("")),j=this.byID.h[a.signature],j!=null?a.id=j.id:this.byID.h[a.signature]=a,a},buildRuntimeShader:function(e,n){var o,i,a,r,s=new ta;for(s.globals=new le,a=0;a<e.length;){switch(r=e[a],++a,r.name){case"fragment":o=de.Fragment;break;case"main":o=de.Main;break;case"vertex":o=de.Vertex;break;default:throw t.thrown("assert")}switch(i=this.flattenShader(r,o,n),i.kind=o,o._hx_index){case 0:s.vertex=i;break;case 1:s.fragment=i;break;case 4:s.vertex=i;break;default:throw t.thrown("assert")}this.initGlobals(s,i)}return s},initGlobals:function(e,t){for(var n=t.globals;n!=null;)e.globals.h[n.gid]=!0,n=n.next;for(n=t.params;n!=null;)n.perObjectGlobal!=null&&(e.globals.h[n.perObjectGlobal.gid]=!0),n=n.next},getPath:function(e){return e.parent==null?e.name:this.getPath(e.parent)+"."+e.name},flattenShader:function(e,n,s){var n,i,a,c,l,d,h,m,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,H,I,B,V,$,W,U,K,q,P=new ft,o=new mc,Y=P.flatten(e,n),u=[],f=[];for(o.texturesCount=0,T=P.allocData.keys();T.hasNext();)switch(g=T.next(),v=P.allocData.h[g.__id__],g.kind._hx_index){case 0:for(a=[],m=0;m<v.length;)b=v[m],++m,b.v!=null&&a.push(new Zi(b.pos,this.getPath(b.v),b.v.type));for(j=a,R=0,H=j.length-1;R<H;)p=R++,j[p].next=j[p+1];if(w=g.type,w._hx_index==15)if(_=w.t,S=w.size,_._hx_index==5)if(_.size==4)if(_.t._hx_index==1)if(S._hx_index==0)W=S.v,o.globals=j[0],o.globalsSize=W;else throw t.thrown("assert");else throw t.thrown("assert");else throw t.thrown("assert");else throw t.thrown("assert");else throw t.thrown("assert");break;case 2:for(c=[],h=0,x=0;x<v.length;){if(i=v[x],++x,i.v==null)continue;if(l=s.h[i.v.id],l==null){E=new ei(i.v.name,i.pos,-1,-1,i.v.type),E.perObjectGlobal=new Zi(-1,this.getPath(i.v),i.v.type),c.push(E),++h;continue}M=new ei(i.v.name,i.pos,l.instance,l.index,i.v.type),O=i.v.type,O._hx_index==15?(U=O.size,$=O.t,r.isTexture($)?(M.pos=-i.size,h+=i.size):++h):++h,c.push(M)}for(D=0,I=c.length-1;D<I;)L=D++,c[L].next=c[L+1];if(y=g.type,y._hx_index==15)if(d=y.t,k=y.size,N=d,r.isTexture(N))u.push({t:N,all:c}),o.texturesCount+=h;else switch(d._hx_index){case 5:if(d.size==4)if(d.t._hx_index==1)if(k._hx_index==0)B=k.v,o.params=c[0],o.paramsSize=B;else throw t.thrown("assert");else throw t.thrown("assert");else throw t.thrown("assert");break;case 16:for(q=d.t,K=d.size,n=d.kind,C=0;C<c.length;)F=c[C],++C,F!=null&&f.push(F);break;default:throw t.thrown("assert")}else throw t.thrown("assert");break;default:throw t.thrown("assert")}if(u.length>0)for(u.sort(function(e,t){var o,i,a,r,c,s=e.t,n=t.t;switch(s._hx_index){case 10:return n._hx_index==10?(i=n.dim,a=n.isArray,o=s.isArray,r=s.dim,o!=a?o?1:-1:r._hx_index-i._hx_index):e.t._hx_index-t.t._hx_index;break;case 11:return c=s.channels,n._hx_index==11?(c=n.channels,i=n.dim,a=n.isArray,o=s.isArray,r=s.dim,o!=a?o?1:-1:r._hx_index-i._hx_index):e.t._hx_index-t.t._hx_index;break;default:return e.t._hx_index-t.t._hx_index}}),o.textures=u[0].all[0],a=1,m=u.length;a<m;)p=a++,z=u[p-1].all,V=z[z.length-1],V.next=u[p].all[0];for(f.length>0&&f.sort(function(e,t){var o,i,a,n=e.type,s=t.type;return n._hx_index==16?(o=n.t,o=n.size,s._hx_index==16?(o=s.t,o=s.size,i=s.kind,a=n.kind,a._hx_index-i._hx_index):e.type._hx_index-t.type._hx_index):e.type._hx_index-t.type._hx_index}),l=null,a=0;a<f.length;)A=f[a],++a,o.buffers==null?(o.buffers=A,l=o.buffers):(l.next=A,l=l.next);return o.bufferCount=f.length,o.globals==null&&(o.globalsSize=0),o.params==null&&(o.paramsSize=0),o.data=Y,o},makeBatchShader:function(e,t,n){if(n==null)s=this.batchShaders;else{var s,o,i,a=this.batchShadersParams,r=n.getSignature();s=a.h[r],s==null&&(s=new Rt,a=this.batchShadersParams,r=n.getSignature(),a.h[r]=s)}return o=s.h[e.__id__],o==null&&(o=this.createBatchShader(e,t,n),s.set(e,o)),i=Object.create(Eo.prototype),i.shader=o.shader,i.params=o.params,i.paramsSize=o.size,i},isPerInstance:function(e){if(e.qualifiers==null)return!1;for(var t,s,i,n=0,o=e.qualifiers;n<o.length;){switch(s=o[n],++n,s._hx_index){case 3:t=!0;break;case 9:i=s.v,t=!0;break;default:t=!1}if(t)return!0}return!1},createBatchShader:function(e,s,a){var a,c,d,h,g,_,w,x,C,E,k,S,M,F,z,D,U,Z,J,ee,b,j,y,A,N,L,R,P,H,V,$,W,K,q,G,X,te,ne,Q=this,f=new st(""),se=u.substr(a==null?e.spec.signature:pn.encode(e.spec.signature+a.getSignature()),0,8),p=function(e,t,n){return{id:r.allocVarId(),type:t,name:e,kind:n}},Y=[];if(a!=null)for(S=a.forcedPerInstance,U=1,x=S.length-1,_=s;_!=null&&x>=0;)_.s.shader.data.name==S[x].shader&&(Y[U]=S[x].params,--x),++U,_=_.next;for(c=null,w=p("Batch_HasOffset",i.TBool,O.Param),D=p("Batch_Start",i.TFloat,O.Input),w.qualifiers=[I.Const()],D.qualifiers=[I.PerInstance(1)],C=p("Batch_UseStorage",i.TBool,O.Param),E=p("Batch_Count",i.TInt,O.Param),z=p("Batch_Buffer",i.TBuffer(i.TVec(4,v.VFloat),ke.SVar(E),Qe.Uniform),O.Param),F=p("Batch_StorageBuffer",i.TBuffer(i.TVec(4,v.VFloat),ke.SConst(0),Qe.RW),O.Param),M=p("Batch_Offset",i.TInt,O.Local),Z={e:n.TVar(z),p:c,t:z.type},J={e:n.TVar(F),p:c,t:F.type},k={e:n.TVar(M),p:c,t:M.type},ee=i.TVec(4,v.VFloat),$=16,E.qualifiers=[I.Const(1<<$)],C.qualifiers=[I.Const()],f.data={name:"batchShader_"+se,vars:[E,w,C,z,F,M,D],funs:[]},A=null,A=function(e,t,n){if(e.kind==n&&e.name==t)return e;var e,o,i,s=e.type;if(s._hx_index==13)for(o=s.vl,s=0;s<o.length;)if(e=o[s],++s,i=A(e,t,n),i!=null)return i;return null},R=function(e){var n,i,a,r,c,l,d,h,o=s;if(e.perObjectGlobal!=null)for(h=e.perObjectGlobal.path.split(".");o!=null;){for(n=0,i=o.s.shader.data.vars;n<i.length;){if(c=i[n],++n,c.name!=h[0])continue;if(a=A(c,e.name,O.Global),a!=null)return a}o=o.next}else{for(l=e.instance-1;l>0;)--l,o=o.next;for(r=e.name;!0;){for(n=0,i=o.s.shader.data.vars;n<i.length;)if(c=i[n],++n,a=A(c,r,O.Param),a!=null)return a;if(d=u.cca(r,r.length-1),d>=48&&d<=57)r=u.substr(r,0,-1);else break}}throw t.thrown("Var not found "+e.name)},a=null,h=[],H=[],V=function(e){var n,s,i,r,c,l,d,u,m,p,f=e.perObjectGlobal!=null?-e.perObjectGlobal.gid:e.instance*1024+e.index;if(H.indexOf(f)>=0)return;switch(H.push(f),n=e.type,n._hx_index){case 3:r=1;break;case 5:if(n.t._hx_index==1)p=n.size,r=p;else throw t.thrown("Unsupported batch var type "+o.string(e.type));break;case 7:r=16;break;default:throw t.thrown("Unsupported batch var type "+o.string(e.type))}if(r>=4)for(d=h.length<<2,n=0,c=r>>2;n<c;)i=n++,h.push(15);else if(r==1){{for(s=-1,n=0,c=h.length;n<c;)i=n++,h[i]!=15&&(s<0||h[s]<h[i])&&(s=i);for(s<0&&(s=h.length,h.push(0)),d=s<<2,n=0;n<4;)if(l=n++,u=3-l,(h[s]&1<<u)==0){h[s]|=1<<u,d+=u;break}}}else{for(l=r==2?3:7,s=-1,n=0,c=h.length;n<c;)if(i=n++,(h[i]&l)==0){h[i]|=l,s=i;break}s<0&&(s=h.length,h.push(l)),d=s<<2}m=new ei(e.name,d,e.instance,e.index,e.type),m.perObjectGlobal=e.perObjectGlobal,m.next=a,a=m},d=e.vertex.params;d!=null;)y=R(d),j=Y[d.instance],(j!=null&&j.indexOf(y.name)>=0||Q.isPerInstance(y))&&V(d),d=d.next;for(d=e.fragment.params;d!=null;)y=R(d),j=Y[d.instance],(j!=null&&j.indexOf(y.name)>=0||Q.isPerInstance(y))&&V(d),d=d.next;for(N=new Rt,X=[[B.X],[B.Y],[B.Z],[B.W]],g=function(e,t){return{e:n.TArray(e,{e:n.TBinop(T.OpAdd,k,{e:n.TConst(m.CInt(t)),t:i.TInt,p:c}),t:i.TInt,p:c}),t:ee,p:c}},G=function(e){var t,n,s,a,r,c,l,o=p(e.name,e.type,O.Local);if(e.perObjectGlobal!=null)for(t=e.perObjectGlobal.path.split("."),t.pop(),s=o;t.length>0;)l=t.join("."),r=t.pop(),n=N.h[t.__id__],n==null&&(n=p(r,i.TStruct([]),O.Local),N.set(t,n)),a=n.type,a._hx_index==13&&(c=a.vl,c.push(s)),s.parent=n,s=n;return f.data.vars.push(o),o},q=function(e,s,o){var r,d,u,a=o.pos>>2,h=o.type;switch(h._hx_index){case 3:r={p:c,t:o.type,e:n.TSwiz(g(s,a),X[o.pos&3])};break;case 5:switch(d=h.t,h.size){case 2:if(d._hx_index==1){switch(o.pos&3){case 0:u=[B.X,B.Y];break;case 1:u=[B.Y,B.Z];break;default:u=[B.Z,B.W]}r={p:c,t:o.type,e:n.TSwiz(g(s,a),u)}}else throw t.thrown("assert");break;case 3:if(d._hx_index==1)r={p:c,t:o.type,e:n.TSwiz(g(s,a),(o.pos&3)==0?[B.X,B.Y,B.Z]:[B.Y,B.Z,B.W])};else throw t.thrown("assert");break;case 4:if(d._hx_index==1)r=g(s,a);else throw t.thrown("assert");break;default:throw t.thrown("assert")}break;case 7:r={p:c,t:o.type,e:n.TCall({e:n.TGlobal(l.Mat4),t:i.TVoid,p:c},[g(s,a),g(s,a+1),g(s,a+2),g(s,a+3)])};break;default:throw t.thrown("assert")}return{p:c,e:n.TBinop(T.OpAssign,{e:n.TVar(e),p:c,t:o.type},r),t:i.TVoid}},K=[],W=[],L=h.length,d=a;d!=null;)P=G(d),K.push(q(P,Z,d)),W.push(q(P,J,d)),d=d.next;return b=[],b.push({p:c,e:n.TBinop(T.OpAssign,k,{e:n.TGlobal(l.InstanceID),t:i.TInt,p:c}),t:i.TVoid}),b.push({p:c,e:n.TIf({e:n.TVar(w),t:i.TBool,p:c},{p:c,e:n.TBinop(T.OpAssignOp(T.OpAdd),k,{e:n.TCall({e:n.TGlobal(l.ToInt),t:i.TVoid,p:c},[{p:c,t:i.TFloat,e:n.TVar(D)}]),t:i.TInt,p:c}),t:i.TVoid},null),t:i.TVoid}),b.push({p:c,t:i.TInt,e:n.TBinop(T.OpAssignOp(T.OpMult),k,{e:n.TConst(m.CInt(L)),t:i.TInt,p:c})}),b.push({p:c,e:n.TIf({e:n.TVar(C),t:i.TBool,p:c},{p:c,e:n.TBlock(W),t:i.TVoid},{p:c,e:n.TBlock(K),t:i.TVoid}),t:i.TVoid}),te=p("init",i.TFun([]),O.Function),ne={kind:de.Init,ref:te,args:[],ret:i.TVoid,expr:{e:n.TBlock(b),p:c,t:i.TVoid}},f.data.funs.push(ne),f.consts=new qo(E,2,$+1),f.consts.globalId=0,f.consts.next=new qo(w,0,1),f.consts.next.globalId=0,f.consts.next.next=new qo(C,1,1),f.consts.next.next.globalId=0,{shader:f,params:a,size:L}},__class__:Mn},Re=_["hxsl.Channel"]={__ename__:!0,__constructs__:null,Unknown:{_hx_name:"Unknown",_hx_index:0,__enum__:"hxsl.Channel",toString:s},R:{_hx_name:"R",_hx_index:1,__enum__:"hxsl.Channel",toString:s},G:{_hx_name:"G",_hx_index:2,__enum__:"hxsl.Channel",toString:s},B:{_hx_name:"B",_hx_index:3,__enum__:"hxsl.Channel",toString:s},A:{_hx_name:"A",_hx_index:4,__enum__:"hxsl.Channel",toString:s},PackedFloat:{_hx_name:"PackedFloat",_hx_index:5,__enum__:"hxsl.Channel",toString:s},PackedNormal:{_hx_name:"PackedNormal",_hx_index:6,__enum__:"hxsl.Channel",toString:s}},Re.__constructs__=[Re.Unknown,Re.R,Re.G,Re.B,Re.A,Re.PackedFloat,Re.PackedNormal],Re.__empty_constructs__=[Re.Unknown,Re.R,Re.G,Re.B,Re.A,Re.PackedFloat,Re.PackedNormal],ui=_["hxsl._Checker.FieldAccess"]={__ename__:!0,__constructs__:null,FField:(a=function(e){return{_hx_index:0,e,__enum__:"hxsl._Checker.FieldAccess",toString:s}},a._hx_name="FField",a.__params__=["e"],a),FGlobal:(a=function(e,t,n){return{_hx_index:1,g:e,arg:t,variants:n,__enum__:"hxsl._Checker.FieldAccess",toString:s}},a._hx_name="FGlobal",a.__params__=["g","arg","variants"],a)},ui.__constructs__=[ui.FField,ui.FGlobal],ui.__empty_constructs__=[],te=_["hxsl._Checker.WithType"]={__ename__:!0,__constructs__:null,NoValue:{_hx_name:"NoValue",_hx_index:0,__enum__:"hxsl._Checker.WithType",toString:s},Value:{_hx_name:"Value",_hx_index:1,__enum__:"hxsl._Checker.WithType",toString:s},InBlock:{_hx_name:"InBlock",_hx_index:2,__enum__:"hxsl._Checker.WithType",toString:s},With:(a=function(e){return{_hx_index:3,t:e,__enum__:"hxsl._Checker.WithType",toString:s}},a._hx_name="With",a.__params__=["t"],a)},te.__constructs__=[te.NoValue,te.Value,te.InBlock,te.With],te.__empty_constructs__=[te.NoValue,te.Value,te.InBlock],C=function(){this.globals=C.initGlobals()},c["hxsl.Checker"]=C,C.__name__="hxsl.Checker",C.initGlobals=function(){var r,re,j,je,s,c,d,A,T,Re,Le,e,a,m,g,v,y,L,H,B,Y,Q,J,ie,f,Me,R,De,Ce,I,Ae,Fe,$,W,U,Oe,K,q,xe,G,X,Ee,Z,Ne,pe,te,qe,le,oe,ze,ve,b,ce,se,ne,$e,Be,me,ee,ge,Te,Ie,He,Pe,N,we,p,w,ae,M,V,Se,E,F,be,k,P,_e,z,ye,h,x,S,he,Ve,ue,We,Ue,de,n=C.GLOBALS;if(C.GLOBALS!=null)return C.GLOBALS;for(n=new fe,r=[i.TFloat,C.vec2,C.vec3,C.vec4],re=[i.TInt,C.ivec2,C.ivec3,C.ivec4],j=[i.TFloat,i.TBool,i.TInt],je=[i.TMat2,i.TMat3,i.TMat4],d=[],s=0;s<r.length;)c=r[s],++s,d.push({args:[{name:"value",type:c}],ret:c});for(A=d,d=[],s=0;s<r.length;)c=r[s],++s,d.push({args:[{name:"a",type:c},{name:"b",type:c}],ret:c});for(T=d,d=[],s=0;s<r.length;)c=r[s],++s,d.push({args:[{name:"a",type:c},{name:"b",type:i.TFloat}],ret:c});for(Re=d,d=[],s=0;s<je.length;)c=je[s],++s,d.push({args:[{name:"value",type:c}],ret:c});for(Le=d,v=[{dim:Ke.T1D,arr:!1,uv:i.TFloat,iuv:i.TInt},{dim:Ke.T2D,arr:!1,uv:C.vec2,iuv:C.ivec2},{dim:Ke.T3D,arr:!1,uv:C.vec3,iuv:C.ivec3},{dim:Ke.TCube,arr:!1,uv:C.vec3,iuv:C.ivec3},{dim:Ke.T1D,arr:!0,uv:C.vec2,iuv:C.ivec2},{dim:Ke.T2D,arr:!0,uv:C.vec3,iuv:C.ivec3},{dim:Ke.TCube,arr:!0,uv:C.vec4,iuv:C.ivec4}],g=Object.create(null),d=0,s=l.__empty_constructs__.slice();d<s.length;){switch(a=s[d],++d,a._hx_index){case 7:e=A.concat(T);break;case 8:e=T;break;case 20:case 21:case 22:e=T.concat(Re);break;case 23:for(H=[{args:[{name:"value",type:i.TInt},{name:"min",type:i.TInt},{name:"max",type:i.TInt}],ret:i.TInt}],B=0;B<r.length;)c=r[B],++B,H.push({args:[{name:"value",type:c},{name:"min",type:c},{name:"max",type:c}],ret:c}),c!=i.TFloat&&H.push({args:[{name:"value",type:c},{name:"min",type:i.TFloat},{name:"max",type:i.TFloat}],ret:c});e=H;break;case 24:for(L=[],U=0;U<r.length;)m=r[U],++U,L.push({args:[{name:"x",type:m},{name:"y",type:m},{name:"a",type:m}],ret:m}),m!=i.TFloat&&L.push({args:[{name:"x",type:m},{name:"y",type:m},{name:"a",type:i.TFloat}],ret:m});e=L;break;case 25:e=[{args:[{name:"a",type:i.TFloat},{name:"x",type:i.TFloat},{name:"y",type:i.TFloat}],ret:i.TFloat}];break;case 26:for(Y=[],Q=0;Q<r.length;)y=r[Q],++Q,Y.push({args:[{name:"edge",type:y},{name:"x",type:y}],ret:y}),y!=i.TFloat&&Y.push({args:[{name:"edge",type:i.TFloat},{name:"x",type:y}],ret:y});e=Y;break;case 27:for(J=[],ie=0;ie<r.length;)f=r[ie],++ie,J.push({args:[{name:"edge0",type:f},{name:"edge1",type:f},{name:"x",type:f}],ret:f}),f!=i.TFloat&&J.push({args:[{name:"edge0",type:i.TFloat},{name:"edge1",type:i.TFloat},{name:"x",type:f}],ret:f});e=J;break;case 28:for(Me=[],R=0;R<r.length;)De=r[R],++R,Me.push({args:[{name:"value",type:De}],ret:i.TFloat});e=Me;break;case 29:case 30:for(Ce=[],I=0;I<r.length;)Ae=r[I],++I,Ce.push({args:[{name:"a",type:Ae},{name:"b",type:Ae}],ret:i.TFloat});e=Ce;break;case 31:e=[{args:[{name:"a",type:C.vec3},{name:"b",type:C.vec3}],ret:C.vec3}];break;case 32:e=A;break;case 33:e=T;break;case 34:for(Fe=[],$=0;$<v.length;)W=v[$],++$,Fe.push({args:[{name:"tex",type:i.TSampler(W.dim,W.arr)},{name:"uv",type:W.uv}],ret:C.vec4});e=Fe;break;case 35:for(Oe=[],K=0;K<v.length;)q=v[K],++K,Oe.push({args:[{name:"tex",type:i.TSampler(q.dim,q.arr)},{name:"uv",type:q.uv},{name:"lod",type:i.TFloat}],ret:C.vec4});e=Oe;break;case 36:for(xe=[],G=0;G<v.length;)X=v[G],++G,xe.push({args:[{name:"tex",type:i.TSampler(X.dim,X.arr)},{name:"pos",type:X.iuv}],ret:C.vec4});e=xe;break;case 37:e=[];break;case 38:for(Ee=[],Z=0;Z<j.length;)Ne=j[Z],++Z,Ee.push({args:[{name:"value",type:Ne}],ret:i.TInt});e=Ee;break;case 39:for(pe=[],te=0;te<j.length;)qe=j[te],++te,pe.push({args:[{name:"value",type:qe}],ret:i.TFloat});e=pe;break;case 40:for(le=[],oe=0;oe<j.length;)ze=j[oe],++oe,le.push({args:[{name:"value",type:ze}],ret:i.TBool});e=le;break;case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:e=[];break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 54:case 77:e=A;break;case 55:e=[{args:[{name:"value",type:i.TFloat}],ret:C.vec4}];break;case 56:e=[{args:[{name:"value",type:C.vec4}],ret:i.TFloat}];break;case 57:e=[{args:[{name:"value",type:C.vec3}],ret:C.vec4}];break;case 58:e=[{args:[{name:"value",type:C.vec4}],ret:C.vec3}];break;case 59:e=[{args:[{name:"screenPos",type:C.vec2}],ret:C.vec2}];break;case 60:e=[{args:[{name:"uv",type:C.vec2}],ret:C.vec2}];break;case 61:case 62:case 63:e=A;break;case 64:e=[{args:[{name:"channel",type:i.TChannel(1)},{name:"uv",type:C.vec2}],ret:i.TFloat},{args:[{name:"channel",type:i.TChannel(2)},{name:"uv",type:C.vec2}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(3)},{name:"uv",type:C.vec2}],ret:C.vec3},{args:[{name:"channel",type:i.TChannel(4)},{name:"uv",type:C.vec2}],ret:C.vec4}];break;case 65:e=[{args:[{name:"channel",type:i.TChannel(1)},{name:"uv",type:C.vec2},{name:"lod",type:i.TFloat}],ret:i.TFloat},{args:[{name:"channel",type:i.TChannel(2)},{name:"uv",type:C.vec2},{name:"lod",type:i.TFloat}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(3)},{name:"uv",type:C.vec2},{name:"lod",type:i.TFloat}],ret:C.vec3},{args:[{name:"channel",type:i.TChannel(4)},{name:"uv",type:C.vec2},{name:"lod",type:i.TFloat}],ret:C.vec4}];break;case 66:e=[{args:[{name:"channel",type:i.TChannel(1)},{name:"pos",type:C.ivec2}],ret:i.TFloat},{args:[{name:"channel",type:i.TChannel(2)},{name:"pos",type:C.ivec2}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(3)},{name:"pos",type:C.ivec2}],ret:C.vec3},{args:[{name:"channel",type:i.TChannel(4)},{name:"pos",type:C.ivec2}],ret:C.vec4},{args:[{name:"channel",type:i.TChannel(1)},{name:"pos",type:C.ivec2},{name:"lod",type:i.TInt}],ret:i.TFloat},{args:[{name:"channel",type:i.TChannel(2)},{name:"pos",type:C.ivec2},{name:"lod",type:i.TInt}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(3)},{name:"pos",type:C.ivec2},{name:"lod",type:i.TInt}],ret:C.vec3},{args:[{name:"channel",type:i.TChannel(4)},{name:"pos",type:C.ivec2},{name:"lod",type:i.TInt}],ret:C.vec4}];break;case 67:e=[{args:[{name:"channel",type:i.TChannel(1)}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(2)}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(3)}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(4)}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(1)},{name:"lod",type:i.TInt}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(2)},{name:"lod",type:i.TInt}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(3)},{name:"lod",type:i.TInt}],ret:C.vec2},{args:[{name:"channel",type:i.TChannel(4)},{name:"lod",type:i.TInt}],ret:C.vec2}];break;case 69:case 70:case 71:case 72:e=null;break;case 73:case 74:for(ve=[],b=0,ce=r;b<ce.length;)se=ce[b],ne=b++,$e=ne,Be=se,ve.push({args:[{name:"x",type:Be}],ret:re[$e]});e=ve;break;case 75:case 76:for(me=[],ee=0,ge=r;ee<ge.length;)Te=ge[ee],Ie=ee++,He=Ie,Pe=Te,me.push({args:[{name:"x",type:re[He]}],ret:Pe});e=me;break;case 78:e=[{args:[{name:"x",type:i.TInt},{name:"y",type:i.TInt},{name:"z",type:i.TInt}],ret:i.TVoid},{args:[{name:"x",type:i.TInt},{name:"y",type:i.TInt}],ret:i.TVoid},{args:[{name:"x",type:i.TInt}],ret:i.TVoid}];break;case 79:e=[];break;case 84:e=[{args:[{name:"buf",type:i.TBuffer(i.TInt,ke.SConst(0),Qe.RW)},{name:"index",type:i.TInt},{name:"data",type:i.TInt}],ret:i.TInt}];break;case 68:case 85:e=[];break;case 86:if(_[a.__enum__].__constructs__[a._hx_index]._hx_name.indexOf("_")>0){switch(N=_[a.__enum__].__constructs__[a._hx_index]._hx_name,we=N.indexOf("_"),w=u.substr(N,0,we),w=w.charAt(0).toLowerCase()+u.substr(w,1,null),p=g[w],p==null&&(p=[],g[w]=p),a._hx_index){case 80:case 81:case 82:ae=C.ivec3;break;case 83:ae=i.TInt;break;default:throw t.thrown("Unknown type for global var "+o.string(a))}M=u.substr(N,we+1,null),M=M.charAt(0).toLowerCase()+u.substr(M,1,null),p.push({name:M,type:ae}),e=null}else e=[{args:[{name:"value",type:i.TInt}],ret:C.vec4}];break;case 87:if(_[a.__enum__].__constructs__[a._hx_index]._hx_name.indexOf("_")>0){switch(V=_[a.__enum__].__constructs__[a._hx_index]._hx_name,Se=V.indexOf("_"),E=u.substr(V,0,Se),E=E.charAt(0).toLowerCase()+u.substr(E,1,null),F=g[E],F==null&&(F=[],g[E]=F),a._hx_index){case 80:case 81:case 82:be=C.ivec3;break;case 83:be=i.TInt;break;default:throw t.thrown("Unknown type for global var "+o.string(a))}k=u.substr(V,Se+1,null),k=k.charAt(0).toLowerCase()+u.substr(k,1,null),F.push({name:k,type:be}),e=null}else e=[{args:[{name:"value",type:i.TInt}],ret:C.vec4}];break;case 88:e=Le;break;default:if(_[a.__enum__].__constructs__[a._hx_index]._hx_name.indexOf("_")>0){switch(P=_[a.__enum__].__constructs__[a._hx_index]._hx_name,_e=P.indexOf("_"),x=u.substr(P,0,_e),x=x.charAt(0).toLowerCase()+u.substr(x,1,null),z=g[x],z==null&&(z=[],g[x]=z),a._hx_index){case 80:case 81:case 82:ye=C.ivec3;break;case 83:ye=i.TInt;break;default:throw t.thrown("Unknown type for global var "+o.string(a))}S=u.substr(P,_e+1,null),S=S.charAt(0).toLowerCase()+u.substr(S,1,null),z.push({name:S,type:ye}),e=null}else throw t.thrown("Unsupported global "+o.string(a))}e!=null&&(h=D.toString(a),n.h[h]={t:i.TFun(e),g:a})}for(n.h.vertexID={t:i.TInt,g:l.VertexID},n.h.instanceID={t:i.TInt,g:l.InstanceID},n.h.fragCoord={t:C.vec4,g:l.FragCoord},n.h.frontFacing={t:i.TBool,g:l.FrontFacing},he=g,Ve=he,ue=Object.keys(he),We=ue.length,b=0;b<We;){for(h=ue[b++],ne=h,se=Ve[h],Ue=ne,p=se,d=[],s=0;s<p.length;)de=p[s],++s,d.push({name:de.name,kind:O.Global,type:de.type,id:0});n.h[Ue]={t:i.TStruct(d),g:null}}return n.h.int=n.h.toInt,n.h.float=n.h.toFloat,n.h.reflect=n.h.lReflect,n.h["ivec"+2]=n.h["iVec"+2],h="iVec"+2,Object.prototype.hasOwnProperty.call(n.h,h)&&delete n.h[h],n.h["ivec"+3]=n.h["iVec"+3],h="iVec"+3,Object.prototype.hasOwnProperty.call(n.h,h)&&delete n.h[h],n.h["ivec"+4]=n.h["iVec"+4],h="iVec"+4,Object.prototype.hasOwnProperty.call(n.h,h)&&delete n.h[h],Object.prototype.hasOwnProperty.call(n.h,"lReflect")&&delete n.h.lReflect,Object.prototype.hasOwnProperty.call(n.h,"toInt")&&delete n.h.toInt,Object.prototype.hasOwnProperty.call(n.h,"toFloat")&&delete n.h.toFloat,C.GLOBALS=n,n},C.prototype={error:function(e,t){return De.t(e,t)},warning:function(){},loadShader:function(){throw t.thrown("Not implemented")},check:function(e,t){this.vars=new fe,this.inits=[],this.inLoop=!1,this.inWhile=!1;var s,a,c,l,d,h,m,f,p,g,v,b,y,_,w,x,C,E,k,A,S,j=[];for(this.checkExpr(t,j,!1,!1),p=[],a=0;a<j.length;){for(E=j[a],++a,m=E.p,c=E.f,d=[],_=0,w=c.args;_<w.length;)l=w[_],++_,l.type==null&&this.error("Argument type required",m),l.expr!=null&&this.error("Optional argument not supported",m),l.kind==null&&(l.kind=O.Local),l.kind!=O.Local&&this.error("Argument should be local",m),l.qualifiers.length!=0&&this.error("No qualifier allowed for argument",m),d.push({id:r.allocVarId(),name:l.name,kind:O.Local,type:l.type});switch(v=d,c.name){case"fragment":h=de.Fragment;break;case"main":h=de.Main;break;case"vertex":h=de.Vertex;break;default:h=M.startsWith(c.name,"__init__")?de.Init:de.Helper}for(v.length!=0&&h!=de.Helper&&this.error(o.string(h)+" function should have no argument",m),f=r.allocVarId(),A=c.name,x=[],y=0;y<v.length;)C=v[y],++y,x.push({type:C.type,name:C.name});b={id:f,name:A,kind:O.Function,type:i.TFun([{args:x,ret:c.ret==null?i.TVoid:c.ret}])},S={kind:h,ref:b,args:v,ret:c.ret==null?i.TVoid:c.ret,expr:null},Object.prototype.hasOwnProperty.call(this.vars.h,b.name)&&this.error("Duplicate function name",m),this.vars.h[b.name]=b,p.push(S)}for(a=0,d=p.length;a<d;)s=a++,this.typeFun(p[s],j[s].f.expr);for(g=[],a=0,d=this.inits.slice();a<d.length;)s=d[a],++a,s.v.kind==O.Local&&(g.push({e:n.TBinop(T.OpAssign,{e:n.TVar(s.v),p:s.e.p,t:s.v.type},s.e),p:s.e.p,t:s.v.type}),u.remove(this.inits,s));return g.length>0&&(f={id:r.allocVarId(),name:"__init__consts__",kind:O.Function,type:i.TFun([{args:[],ret:i.TVoid}])},Object.prototype.hasOwnProperty.call(this.vars.h,f.name)&&this.error("assert",g[0].p),this.vars.h[f.name]=f,p.push({kind:de.Init,ref:f,args:[],ret:i.TVoid,expr:{e:n.TBlock(g),p:g[0].p,t:i.TVoid}})),k=ha.array(this.vars),k.sort(function(e,t){return(e.id<0?-e.id:e.id)-(t.id<0?-t.id:t.id)}),{name:e,vars:k,funs:p}},saveVars:function(){for(var e,t=new fe,n=this.vars.h,a=n,s=Object.keys(n),i=s.length,o=0;o<i;)e=s[o++],t.h[e]=this.vars.h[e];return t},typeFun:function(e,t){for(var s,i=this.saveVars(),n=0,o=e.args;n<o.length;)s=o[n],++n,this.vars.h[s.name]=s;this.curFun=e,e.expr=this.typeExpr(t,te.NoValue),this.vars=i},tryUnify:function(e,t){if(Y.enumEq(e,t))return!0;switch(e._hx_index){case 5:if(t._hx_index==5){var n,i,a,r,c,l,d,u,m,f,p,g,v,b,j=t.size,s=t.t,o=e.t,h=e.size;if(h==j&&o==s)return!0}break;case 10:if(t._hx_index==10)return a=t.dim,r=t.isArray,c=e.isArray,l=e.dim,l==a&&c==r;break;case 11:if(t._hx_index==11)return a=t.dim,r=t.isArray,d=t.channels,u=e.channels,c=e.isArray,l=e.dim,l==a&&c==r&&u==d;break;case 15:if(t._hx_index==15){switch(s=t.t,n=t.size,i=e.size,o=e.t,i._hx_index){case 0:if(n._hx_index==0){if(m=n.v,f=i.v,f!=m)return!1}else return!1;break;case 1:if(n._hx_index==1){if(p=n.v,g=i.v,g!=p)return!1}else return!1;break;default:return!1}return this.tryUnify(o,s)}break;case 17:if(t._hx_index==17&&(v=t.size,b=e.size,b==v))return!0;break;default:}return!1},unify:function(e,t,n){this.tryUnify(e,t)||this.error(r.toString(e)+" should be "+r.toString(t),n)},unifyExpr:function(e,t){if(!this.tryUnify(e.t,t)){if(e.t==i.TInt&&t==i.TFloat){this.toFloat(e);return}this.error(r.toString(e.t)+" should be "+r.toString(t),e.p)}},checkWrite:function(e){var t,n,s,i,a,o=e.e;switch(o._hx_index){case 1:switch(i=o.v,i.kind._hx_index){case 2:switch(t=i.type,t._hx_index){case 11:s=t.dim,s=t.isArray,s=t.channels,n=!0;break;case 16:switch(s=t.t,s=t.size,t.kind._hx_index){case 2:case 5:n=!0;break;default:n=!1}break;default:n=!1}if(n)return;break;case 4:if(i.qualifiers==null||i.qualifiers.indexOf(I.Final)<0)return;switch(t=i.type,t._hx_index){case 11:s=t.dim,s=t.isArray,s=t.channels,n=!0;break;case 16:switch(s=t.t,s=t.size,t.kind._hx_index){case 2:case 5:n=!0;break;default:n=!1}break;default:n=!1}if(n)return;break;case 3:case 5:return;default:}break;case 9:t=o.regs,a=o.e,this.checkWrite(a);return;case 16:t=o.index,a=o.e,this.checkWrite(a);return;case 21:t=o.name,a=o.e,this.checkWrite(a);return;default:}this.error("This expression cannot be assigned",e.p)},typeWith:function(e,t){if(t==null)return this.typeExpr(e,te.Value);var n=this.typeExpr(e,te.With(t));return this.unifyExpr(n,t),n},typeExpr:function(e,s){var o,h,_,E,k,F,ve,a,d,f,p,g,b,j,y,x,A,z,L,B,Oe,w,W,de,P,G,le,we,je,S,Pe,Ae,Fe,Te,re,ye,D,R,H,ee,$,_e,V,be,N,U,se,Z,ne,Se,fe,K,Q,he,ue,oe,xe,Me,ae,I,X,ce,Ee,pe,ge,q,ie,me,ze,De,Ne,Le,Re,Ce,J=this,c=null,v=e.expr;switch(v._hx_index){case 0:switch(F=v.c,F._hx_index){case 0:c=i.TVoid;break;case 1:o=F.b,c=i.TBool;break;case 2:E=F.v,s._hx_index==3?s.t._hx_index==3?(F=m.CFloat(E),c=i.TFloat):c=i.TInt:c=i.TInt;break;case 3:o=F.v,c=i.TFloat;break;case 4:o=F.v,c=i.TString;break}h=n.TConst(F);break;case 1:if(k=v.i,_=this.vars.h[k],_!=null){switch(k){case"fragment":case"main":case"vertex":ve=!1;break;default:ve=!M.startsWith(k,"__init__")}ve||this.error("Function cannot be accessed",e.pos),c=_.type,h=n.TVar(_)}else A=this.globals.h[k],A!=null&&A.g!=null?(c=A.t,h=n.TGlobal(A.g)):k=="PI"?(c=i.TFloat,h=n.TConst(m.CFloat(Math.PI))):h=this.error("Unknown identifier '"+k+"'",e.pos);break;case 2:p=v.e,b=this.typeExpr(p,s),c=b.t,h=n.TParenthesis(b);break;case 3:if(o=v.e,f=v.f,a=o.expr,g=o.pos,a._hx_index==1)if(k=a.i,y=f,this.vars.h[k]==null&&this.globals.h[k]!=null&&this.globals.h[k].g==null)if(a=this.globals.h[k].t,a._hx_index==13){for(z=a.vl,a=0;a<z.length;)if(_=z[a],++a,_.name==y)return A=k.charAt(0).toUpperCase()+u.substr(k,1,null)+"_"+y.charAt(0).toUpperCase()+u.substr(y,1,null),{e:n.TGlobal(Y.createEnum(l,A,null)),t:_.type,p:e.pos};for(W=k+" field should be ",a=[],g=0;g<z.length;)_=z[g],++g,a.push(_.name);h=this.error(W+a.join("|"),e.pos)}else throw t.thrown("assert");else switch(p=o,y=f,d=this.typeExpr(p,te.Value),j=this.fieldAccess(d,y,s,e.pos),j==null&&this.error(r.toString(d.t)+" has no field '"+y+"'",e.pos),j._hx_index){case 0:L=j.e,c=L.t,h=L.e;break;case 1:a=j.g,a=j.arg,a=j.variants,h=this.error("Global function must be called immediately",e.pos);break}else switch(p=o,y=f,d=this.typeExpr(p,te.Value),j=this.fieldAccess(d,y,s,e.pos),j==null&&this.error(r.toString(d.t)+" has no field '"+y+"'",e.pos),j._hx_index){case 0:L=j.e,c=L.t,h=L.e;break;case 1:o=j.g,o=j.arg,o=j.variants,h=this.error("Global function must be called immediately",e.pos);break}break;case 4:switch(B=v.op,p=v.e1,b=v.e2,d=this.typeExpr(p,te.Value),x=this.typeExpr(b,te.With(d.t)),B._hx_index){case 4:this.checkWrite(d),this.unify(x.t,d.t,x.p),c=d.t;break;case 20:Oe=B.op,this.checkWrite(d),this.unify(this.typeBinop(Oe,d,x,e.pos),d.t,x.p),c=d.t;break;default:c=this.typeBinop(B,d,x,e.pos)}h=n.TBinop(B,d,x);break;case 5:switch(B=v.op,p=v.e1,d=this.typeExpr(p,te.Value),B._hx_index){case 0:case 1:switch(d.t._hx_index){case 1:case 3:break;default:this.error("Cannot increment "+r.toString(d.t),e.pos)}c=i.TVoid,h=n.TBinop(T.OpAssignOp(B==ln.OpIncrement?T.OpAdd:T.OpSub),d,{e:n.TConst(m.CInt(1)),t:i.TInt,p:d.p});break;case 2:this.unifyExpr(d,i.TBool),c=i.TBool,h=n.TUnop(B,d);break;case 3:switch(o=d.t,o._hx_index){case 1:case 3:break;case 5:switch(f=o.size,o.t._hx_index){case 0:case 1:break;default:this.error("Cannot negate "+r.toString(d.t),e.pos)}break;default:this.error("Cannot negate "+r.toString(d.t),e.pos)}c=d.t,h=n.TUnop(B,d);break;default:h=this.error("Operation non supported",e.pos)}break;case 6:if(o=v.e,f=v.args,a=o.expr,g=o.pos,a._hx_index==3)if(g=a.e,w=g.expr,de=g.pos,w._hx_index==1){if(w.i=="Syntax"){for(G=a.f,P=f,P.length==0&&this.error("Syntax."+G+" should have a string as first argument",e.pos),a=P[0].expr,a._hx_index==0?(g=a.c,g._hx_index==4?(we=g.v,le=we):le=this.error("Syntax."+G+" should have a string as first argument",P[0].pos)):le=this.error("Syntax."+G+" should have a string as first argument",P[0].pos),je=[],a=1,g=P.length;a<g;)if(E=a++,S=P[E],w=S.expr,w._hx_index==20)switch(de=w.name,Pe=w.args,Ae=w.e,de){case"r":case"rw":case"w":switch(Fe=de,Te=Ae,W=this.typeExpr(Te,te.Value),Fe){case"r":re=xn.Read;break;case"rw":re=xn.ReadWrite;break;case"w":re=xn.Write;break;default:throw t.thrown("assert")}je.push({e:W,access:re});break;default:this.error("Syntax."+G+" arguments should have an access meta of @r, @w or @rw",S.pos)}else this.error("Syntax."+G+" arguments should have an access meta of @r, @w or @rw",S.pos);return{e:n.TSyntax(G,le,je),t:i.TVoid,p:e.pos}}if(p=o,P=f,ye=function(t){var n,o,s=t.t;return s._hx_index==14?(o=s.variants,n=J.unifyCallParams(t,P,o,e.pos),c=n.t,n.e):J.error(r.toString(t.t)+" cannot be called",e.pos)},a=p.expr,a._hx_index==3)switch(d=a.e,y=a.f,H=this.typeExpr(d,te.Value),j=this.fieldAccess(H,y,s,e.pos),j==null&&this.error(r.toString(H.t)+" has no field '"+y+"'",e.pos),j._hx_index){case 0:L=j.e,h=ye(L);break;case 1:if(A=j.g,S=j.arg,R=j.variants,D={e:n.TGlobal(A),t:i.TFun(R),p:H.p},R.length==0){for(a=[],g=0;g<P.length;)ee=P[g],++g,a.push(this.typeExpr(ee,te.Value));$=a,$.unshift(S),b=this.specialGlobal(A,D,$,e.pos),c=b.t,h=b.e}else{if(b=this.unifyCallParams(D,P,R,e.pos),a=b.e,g=D.t,a._hx_index==8)if(w=a.e,g._hx_index==14)if(w=g.variants,w.length==1)y=w[0],$=a.args,$.unshift(S),y.args.unshift({name:"_",type:S.t});else throw t.thrown("assert");else throw t.thrown("assert");else throw t.thrown("assert");c=b.t,h=b.e}break}else h=ye(this.typeExpr(p,te.Value))}else if(p=o,$=f,_e=function(t){var n,o,s=t.t;return s._hx_index==14?(o=s.variants,n=J.unifyCallParams(t,$,o,e.pos),c=n.t,n.e):J.error(r.toString(t.t)+" cannot be called",e.pos)},a=p.expr,a._hx_index==3)switch(d=a.e,y=a.f,H=this.typeExpr(d,te.Value),j=this.fieldAccess(H,y,s,e.pos),j==null&&this.error(r.toString(H.t)+" has no field '"+y+"'",e.pos),j._hx_index){case 0:L=j.e,h=_e(L);break;case 1:if(A=j.g,S=j.arg,R=j.variants,D={e:n.TGlobal(A),t:i.TFun(R),p:H.p},R.length==0){for(a=[],g=0;g<$.length;)ee=$[g],++g,a.push(this.typeExpr(ee,te.Value));V=a,V.unshift(S),b=this.specialGlobal(A,D,V,e.pos),c=b.t,h=b.e}else{if(b=this.unifyCallParams(D,$,R,e.pos),a=b.e,g=D.t,a._hx_index==8)if(w=a.e,g._hx_index==14)if(w=g.variants,w.length==1)y=w[0],V=a.args,V.unshift(S),y.args.unshift({name:"_",type:S.t});else throw t.thrown("assert");else throw t.thrown("assert");else throw t.thrown("assert");c=b.t,h=b.e}break}else h=_e(this.typeExpr(p,te.Value));else if(p=o,V=f,be=function(t){var n,o,s=t.t;return s._hx_index==14?(o=s.variants,n=J.unifyCallParams(t,V,o,e.pos),c=n.t,n.e):J.error(r.toString(t.t)+" cannot be called",e.pos)},o=p.expr,o._hx_index==3)switch(d=o.e,y=o.f,H=this.typeExpr(d,te.Value),j=this.fieldAccess(H,y,s,e.pos),j==null&&this.error(r.toString(H.t)+" has no field '"+y+"'",e.pos),j._hx_index){case 0:L=j.e,h=be(L);break;case 1:if(A=j.g,S=j.arg,R=j.variants,D={e:n.TGlobal(A),t:i.TFun(R),p:H.p},R.length==0){for(o=[],f=0;f<V.length;)ee=V[f],++f,o.push(this.typeExpr(ee,te.Value));U=o,U.unshift(S),b=this.specialGlobal(A,D,U,e.pos),c=b.t,h=b.e}else{if(b=this.unifyCallParams(D,V,R,e.pos),o=b.e,f=D.t,o._hx_index==8)if(a=o.e,f._hx_index==14)if(a=f.variants,a.length==1)y=a[0],U=o.args,U.unshift(S),y.args.unshift({name:"_",type:S.t});else throw t.thrown("assert");else throw t.thrown("assert");else throw t.thrown("assert");c=b.t,h=b.e}break}else h=be(this.typeExpr(p,te.Value));break;case 7:for(N=v.el,se=this.saveVars(),Z=N.slice(),ne=[],s=this.propagate(s),Z.length==0&&s!=te.NoValue&&this.error("Value expected",e.pos);!0;){if(p=Z.shift(),p==null)break;o=p.expr,o._hx_index==8&&(z=o.v,z.length>1&&(Se=z.shift(),Z.unshift(p),p={expr:qe.EVars([Se]),pos:p.pos})),f=p.expr,f._hx_index==8?(a=f.v,fe=te.InBlock):fe=Z.length==0?s:te.NoValue,Q=this.typeExpr(p,fe),Z.length!=0&&!r.hasSideEffect(Q)&&this.warning("This expression has no side effect",p.pos),ne.push(Q)}this.vars=se,c=s==te.NoValue?i.TVoid:ne[ne.length-1].t,h=n.TBlock(ne);break;case 8:if(z=v.v,s!=te.InBlock&&this.error("Cannot declare a variable outside of a block",e.pos),z.length!=1)throw t.thrown("assert");_=z[0],_.kind==null&&(_.kind=O.Local),_.kind!=O.Local&&this.error("Should be local var",e.pos),_.qualifiers.length!=0&&this.error("Unexpected qualifier",e.pos),K=this.makeVar(z[0],e.pos),he=_.expr==null?null:this.typeWith(_.expr,K.type),K.type==null&&(he==null&&this.error("Type required for unitialized local var",e.pos),K.type=he.t),this.vars.h[K.name]=K,c=i.TVoid,h=n.TVarDecl(K,he);break;case 9:throw o=v.f,t.thrown("assert");case 10:ue=v.econd,p=v.eif,b=v.eelse,s=this.propagate(s),oe=this.typeWith(ue,i.TBool),d=this.typeExpr(p,s),x=b==null?null:this.typeExpr(b,s),s==te.NoValue?(c=i.TVoid,h=n.TIf(oe,d,x)):(x==null&&this.error("Missing else",e.pos),this.tryUnify(d.t,x.t)?c=d.t:(this.unifyExpr(x,d.t),c=x.t),h=n.TIf(oe,d,x));break;case 11:c=i.TVoid,h=n.TDiscard;break;case 12:_=v.v,xe=v.loop,Me=v.block,c=i.TVoid,ae=this.typeExpr(xe,te.Value),o=ae.t,o._hx_index==15?(f=o.size,I=o.t,X={id:r.allocVarId(),name:_,type:I,kind:O.Local},se=this.vars.h[X.name],this.vars.h[X.name]=X,ce=this.inLoop,this.inLoop=!0,Ee=this.typeExpr(Me,te.NoValue),this.inLoop=ce,se==null?(pe=X.name,ge=this.vars,Object.prototype.hasOwnProperty.call(ge.h,pe)&&delete ge.h[pe]):this.vars.h[X.name]=se,h=n.TFor(X,ae,Ee)):h=this.error("Cannot iterate on "+r.toString(ae.t),ae.p);break;case 13:p=v.e,p==null!=(this.curFun.ret==i.TVoid)&&this.error("This function should return "+r.toString(this.curFun.ret),e.pos),b=p==null?null:this.typeWith(p,this.curFun.ret),c=i.TVoid,h=n.TReturn(b);break;case 14:this.inLoop||this.error("Break outside loop",e.pos),c=i.TVoid,h=n.TBreak;break;case 15:this.inLoop||this.error("Continue outside loop",e.pos),c=i.TVoid,h=n.TContinue;break;case 16:switch(p=v.e,b=v.eindex,d=this.typeExpr(p,te.Value),x=this.typeExpr(b,te.With(i.TInt)),this.unify(x.t,i.TInt,x.p),o=d.t,o._hx_index){case 5:switch(f=o.size,o.t._hx_index){case 0:c=i.TInt;break;case 1:c=i.TFloat;break;default:this.error("Cannot index "+r.toString(d.t)+" : should be an array",e.pos)}break;case 6:c=C.vec3;break;case 7:case 8:c=C.vec4;break;case 12:c=C.vec2;break;case 15:I=o.t,q=o.size,f=x.e,q._hx_index==0?f._hx_index==0&&(a=f.c,a._hx_index==2&&(g=a.v,E=g,_=q.v,E>=_?this.error("Indexing outside array bounds",e.pos):(E=g,E<0&&this.error("Cannot index with negative value",e.pos)))):f._hx_index==0&&(a=f.c,a._hx_index==2&&(E=a.v,E<0&&this.error("Cannot index with negative value",e.pos))),c=I;break;case 16:switch(f=o.t,a=o.size,o.kind._hx_index){case 0:case 3:q=a,I=f,o=x.e,q._hx_index==0?o._hx_index==0&&(g=o.c,g._hx_index==2&&(w=g.v,E=w,_=q.v,E>=_?this.error("Indexing outside array bounds",e.pos):(E=w,E<0&&this.error("Cannot index with negative value",e.pos)))):o._hx_index==0&&(g=o.c,g._hx_index==2&&(E=g.v,E<0&&this.error("Cannot index with negative value",e.pos))),c=I;break;default:q=a,I=f,c=I}break;default:this.error("Cannot index "+r.toString(d.t)+" : should be an array",e.pos)}h=n.TArray(d,x);break;case 17:for(N=v.el,N.length==0&&this.error("Empty array not supported",e.pos),o=[],f=0;f<N.length;)p=N[f],++f,o.push(this.typeExpr(p,te.Value));for(N=o,I=N[0].t,o=1,f=N.length;o<f;)E=o++,this.unifyExpr(N[E],I);c=i.TArray(I,ke.SConst(N.length)),h=n.TArrayDecl(N);break;case 18:for(p=v.e,ie=v.cases,me=v.def,Q=this.typeExpr(p,te.Value),o=[],f=0;f<ie.length;){for(F=ie[f],++f,a=[],g=0,w=F.values;g<w.length;)_=w[g],++g,a.push(this.typeWith(_,Q.t));o.push({values:a,expr:this.typeExpr(F.expr,s)})}ie=o,ze=me==null?null:this.typeExpr(me,s),c=i.TVoid,h=n.TSwitch(Q,ie,ze);break;case 19:ue=v.cond,De=v.loop,Ne=v.normalWhile,c=i.TVoid,oe=this.typeWith(ue,i.TBool),ce=this.inLoop,Le=this.inWhile,this.inLoop=!0,this.inWhile=!0,Re=this.typeExpr(De,te.NoValue),this.inLoop=ce,this.inWhile=Le,h=n.TWhile(oe,Re,Ne);break;case 20:for(k=v.name,U=v.args,p=v.e,b=this.typeExpr(p,s),c=b.t,v=[],o=0;o<U.length;){switch(F=U[o],++o,f=F.expr,f._hx_index){case 0:Ce=f.c,W=Ce;break;case 1:E=f.i,W=m.CString(E);break;default:W=this.error("Metadata parameter should be constant",F.pos)}v.push(W)}h=n.TMeta(k,v,b);break}if(c==null)throw t.thrown("assert");return{e:h,t:c,p:e.pos}},propagate:function(e){return e._hx_index==2?te.NoValue:e},checkExpr:function(e,n,s,i){var a,r,c,l,d,m,f,p,g,v,b,j,y,_,w,x,C,k,A,S,F,E=this,h=e.expr;switch(h._hx_index){case 6:if(r=h.e,c=h.args,d=r.expr,F=r.pos,d._hx_index==1)switch(d.i){case"extends":if(c.length==1){l=c[0],b=[],x=null,x=function(e){var n,s,o,i,a,t=e.expr;switch(t._hx_index){case 0:n=t.c,n._hx_index==4?(s=n.v,b.push(s)):E.error("Should be a shader type path",e.pos);break;case 1:o=t.i,b.push(o);break;case 3:i=t.e,a=t.f,x(i),b.push(a);break;default:E.error("Should be a shader type path",e.pos)}},x(l),m=null;try{m=this.loadShader(b.join("."))}catch(e){if(d=t.caught(e).unwrap(),d instanceof De)g=d,this.error(o.string(g),l.pos);else throw e}m!=null&&this.checkExpr(m,n,s,!0)}else this.error("This expression is not allowed at shader declaration level",e.pos);break;case"import":if(c.length==1){l=c[0],y=[],_=null,_=function(e){var n,s,o,t=e.expr;switch(t._hx_index){case 1:n=t.i,y.push(n);break;case 3:s=t.e,o=t.f,_(s),y.push(o);break;default:E.error("Should be a shader type path",e.pos)}},_(l),m=null;try{m=this.loadShader(y.join("."))}catch(e){if(c=t.caught(e),d=c.unwrap(),c instanceof pa)throw g=c,g;g=d,this.error(o.string(g),l.pos)}m!=null&&this.checkExpr(m,n,!0,i)}else this.error("This expression is not allowed at shader declaration level",e.pos);break;default:this.error("This expression is not allowed at shader declaration level",e.pos)}else this.error("This expression is not allowed at shader declaration level",e.pos);break;case 7:for(S=h.el,r=0;r<S.length;)l=S[r],++r,this.checkExpr(l,n,s,i);break;case 8:for(A=h.v,r=0;r<A.length;){if(a=A[r],++r,a.kind==null)for(a.kind=O.Local,c=0,d=a.qualifiers;c<d.length;)C=d[c],++c,C._hx_index==0&&(F=C.max,a.kind=O.Param);if(j=null,a.expr!=null&&(a.kind!=O.Param&&a.kind!=O.Local&&this.error("Cannot initialize variable declaration if not @param or local",a.expr.pos),l=this.typeExpr(a.expr,a.type==null?te.Value:te.With(a.type)),a.type==null?a.type=l.t:this.unify(l.t,a.type,a.expr.pos),this.checkConst(l),j=l),a.type==null&&this.error("Type required for variable declaration",e.pos),s&&a.kind==O.Param)continue;switch(Object.prototype.hasOwnProperty.call(this.vars.h,a.name)&&this.error("Duplicate var decl '"+a.name+"'",e.pos),p=this.makeVar(a,e.pos),f=p.type,f._hx_index){case 10:f.dim._hx_index==2&&f.isArray==!0&&this.error("Unsupported texture type",e.pos);break;case 11:k=f.channels,f.dim._hx_index==2?f.isArray==!0?this.error("Unsupported texture type",e.pos):k==3&&this.error("Unsupported texture type",e.pos):k==3&&this.error("Unsupported texture type",e.pos);break;default:}j!=null?this.inits.push({v:p,e:j}):p.qualifiers!=null&&p.qualifiers.indexOf(I.Final)>=0&&this.error("Final variable needs initializer",e.pos),this.vars.h[p.name]=p}break;case 9:if(v=h.f,s&&(v.name=="fragment"||v.name=="vertex"||M.startsWith(v.name,"__init__")))return;for(h=0,r=n.slice();h<r.length;)w=r[h],++h,w.f.name==v.name&&w.inherit&&u.remove(n,w);n.push({f:v,p:e.pos,inherit:i||s});break;default:this.error("This expression is not allowed at shader declaration level",e.pos)}},checkConst:function(e){var n,s,o,i,a,r,c,l,t=e.e;switch(t._hx_index){case 0:n=t.c;break;case 3:s=t.e,this.checkConst(s);break;case 8:if(n=t.e,r=t.args,o=n.e,c=n.p,c=n.t,o._hx_index==2)switch(o.g._hx_index){case 41:case 42:case 43:case 44:case 45:case 46:for(i=r,n=0;n<i.length;)l=i[n],++n,this.checkConst(l);break;default:this.error("This expression should be constant",e.p)}else this.error("This expression should be constant",e.p);break;case 17:for(a=t.el,t=0;t<a.length;)s=a[t],++t,this.checkConst(s);break;default:this.error("This expression should be constant",e.p)}},makeVar:function(e,t,n){var i,a,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,x,C,E,k,A,S,M,s={id:r.allocVarId(),name:e.name,kind:e.kind,type:e.type,qualifiers:e.qualifiers};if(n!=null&&(s.parent=n),s.kind==null?n==null?s.kind=O.Local:s.kind=n.kind:n!=null&&s.kind!=n.kind&&(n.kind._hx_index==0?s.kind._hx_index!=3&&this.error("Variable "+o.string(n.kind)+" cannot be changed to "+o.string(s.kind),t):this.error("Variable "+o.string(n.kind)+" cannot be changed to "+o.string(s.kind),t)),e.qualifiers.length>0)for(s.qualifiers=e.qualifiers,h=0,m=e.qualifiers;h<m.length;)switch(i=m[h],++h,i._hx_index){case 0:for(j=i.max,l=n;l!=null;)r.isStruct(l)||this.error("@const only allowed in structure",t),l=l.parent;s.kind!=O.Global&&s.kind!=O.Param&&this.error("@const only allowed on parameter or global",t);break;case 1:break;case 2:s.kind!=O.Param&&this.error("@nullable only allowed on parameter or global",t);break;case 3:s.kind!=O.Global&&this.error("@perObject only allowed on global",t);break;case 4:k=i.n,n!=null&&this.error("Cannot have an explicit name for a structure variable",t),s.kind!=O.Global&&this.error("Explicit name is only allowed for global var",t);break;case 5:n!=null&&this.error("Cannot share a structure field",t),s.kind!=O.Param&&this.error("Can only share a @param",t);break;case 6:if(x=i.p,d=e.type,d==null)this.error("Precision qualifier not supported on "+o.string(e.type),t);else switch(d._hx_index){case 3:break;case 5:v=d.size,d.t._hx_index!=1&&this.error("Precision qualifier not supported on "+o.string(e.type),t);break;default:this.error("Precision qualifier not supported on "+o.string(e.type),t)}break;case 7:if(_=i.min,g=i.max,c=e.type,c==null)this.error("Precision qualifier not supported on "+o.string(e.type),t);else switch(c._hx_index){case 1:case 3:break;case 5:b=c.size,c.t._hx_index!=1&&this.error("Precision qualifier not supported on "+o.string(e.type),t);break;default:this.error("Precision qualifier not supported on "+o.string(e.type),t)}break;case 8:break;case 9:f=i.v,s.kind!=O.Input&&s.kind!=O.Param&&(s.kind!=O.Global||e.qualifiers.indexOf(I.PerObject)<0)&&this.error("@perInstance only allowed on input/param",t);break;case 10:y=i.s;break;case 11:p=i.source,e.kind!=O.Local&&this.error("Borrow should not have a type qualifier",t);break;case 12:if(w=i.name,a=e.type,a==null)this.error("Sampler should be on sampler type or sampler array",t);else switch(a._hx_index){case 10:C=a.dim,E=a.isArray;break;case 15:u=a.t,A=a.size,u._hx_index==10?(S=u.dim,M=u.isArray):this.error("Sampler should be on sampler type or sampler array",t);break;default:this.error("Sampler should be on sampler type or sampler array",t)}break;case 13:s.kind!=O.Local&&this.error("final only allowed on local",t);break;case 14:s.kind!=O.Local&&this.error("flat only allowed on local",t);break}return s.type!=null&&(s.type=this.makeVarType(s.type,s,t)),s},makeVarType:function(e,n,s){switch(e._hx_index){case 13:var o,a,c,l,d,u,h,m,f,p,v,b,j,_,w,g=e.vl,y=g.slice();for(n.type=i.TStruct(y),o=0,m=y.length;o<m;)w=o++,l=y[w],y[w]=this.makeVar({type:l.type,qualifiers:l.qualifiers,name:l.name,kind:l.kind,expr:null},s,n);return n.type;case 15:switch(c=e.t,u=e.size,c._hx_index==15&&(o=c.t,o=c.size,this.error("Multidimentional arrays are not allowed",s)),u._hx_index){case 0:o=u.v,h=u;break;case 1:for(l=u.v,v=l.name.split("."),a=null,o=0;o<v.length;){if(f=v[o],++o,a==null){if(a=this.vars.h[f],a==null&&n!=null){for(d=n;d.parent!=null;)d=d.parent;d.name==f&&(a=d)}}else if(m=a.type,m._hx_index==13){for(g=m.vl,b=null,p=0;p<g.length;)if(j=g[p],++p,j.name==f){b=j;break}a=b}else a=null;if(a==null)break}a==null&&this.error("Array size variable '"+l.name+"'not found",s),r.isConst(a)||this.error("Array size variable '"+l.name+"'should be a constant",s),h=ke.SVar(a);break}switch(c=this.makeVarType(c,n,s),e._hx_index){case 15:return o=e.t,o=e.size,i.TArray(c,h);case 16:return o=e.t,o=e.size,_=e.kind,i.TBuffer(c,h,_);default:throw t.thrown("assert")}break;case 16:switch(o=e.kind,c=e.t,u=e.size,c._hx_index==15&&(o=c.t,o=c.size,this.error("Multidimentional arrays are not allowed",s)),u._hx_index){case 0:o=u.v,h=u;break;case 1:for(l=u.v,v=l.name.split("."),a=null,o=0;o<v.length;){if(f=v[o],++o,a==null){if(a=this.vars.h[f],a==null&&n!=null){for(d=n;d.parent!=null;)d=d.parent;d.name==f&&(a=d)}}else if(m=a.type,m._hx_index==13){for(g=m.vl,b=null,p=0;p<g.length;)if(j=g[p],++p,j.name==f){b=j;break}a=b}else a=null;if(a==null)break}a==null&&this.error("Array size variable '"+l.name+"'not found",s),r.isConst(a)||this.error("Array size variable '"+l.name+"'should be a constant",s),h=ke.SVar(a);break}switch(c=this.makeVarType(c,n,s),e._hx_index){case 15:return o=e.t,o=e.size,i.TArray(c,h);case 16:return o=e.t,o=e.size,_=e.kind,i.TBuffer(c,h,_);default:throw t.thrown("assert")}break;default:return e}},isParentArray:function(e){if(e.parent==null)return!1;var n,t=e.parent.type;switch(t._hx_index){case 13:return n=t.vl,this.isParentArray(e.parent);case 15:return n=t.t,n=t.size,!0;case 16:return n=t.t,n=t.size,n=t.kind,!0;default:return!1}},fieldAccess:function(e,t,s,o){var c,d,u,h,m,f,p,g,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,a=e.t;if(a._hx_index==13){for(E=a.vl,f=null,a=0;a<E.length;)if(m=E[a],++a,m.name==t){f=m;break}_=f==null?null:this.isParentArray(f)?{e:n.TField(e,t),t:f.type,p:o}:{e:n.TVar(f),t:f.type,p:o}}else _=null;if(_!=null)return ui.FField(_);if(p=this.globals.h[t],p==null){switch(a=e.t,t){case"fetch":switch(a._hx_index){case 10:c=a.dim,c=a.isArray,d=l.Texel;break;case 17:c=a.size,d=l.ChannelFetch;break;default:d=null}break;case"fetchLod":switch(a._hx_index){case 10:c=a.dim,c=a.isArray,d=l.Texel;break;case 17:c=a.size,d=l.ChannelFetch;break;default:d=null}break;case"get":switch(a._hx_index){case 10:c=a.dim,c=a.isArray,d=l.Texture;break;case 17:c=a.size,d=l.ChannelRead;break;default:d=null}break;case"getLod":switch(a._hx_index){case 10:c=a.dim,c=a.isArray,d=l.TextureLod;break;case 17:c=a.size,d=l.ChannelReadLod;break;default:d=null}break;case"size":switch(a._hx_index){case 10:c=a.dim,c=a.isArray,d=l.TextureSize;break;case 11:c=a.dim,c=a.isArray,c=a.channels,d=l.TextureSize;break;case 17:c=a.size,d=l.ChannelTextureSize;break;default:d=null}break;case"store":a._hx_index==11?(c=a.dim,c=a.isArray,c=a.channels,d=l.ImageStore):d=null;break;default:d=null}d!=null&&(t=="get"&&this.inWhile&&this.error("Cannot use .get() in while loop, use .getLod instead",o),z=this.globals,T=D.toString(d),p=z.h[T])}if(p!=null){if(a=p.t,a._hx_index==14){for(j=a.variants,y=[],a=0;a<j.length;){if(m=j[a],++a,m.args.length==0||!this.tryUnify(e.t,m.args[0].type))continue;x=m.args.slice(),x.shift(),y.push({args:x,ret:m.ret})}if(y.length>0||j.length==0)return ui.FGlobal(p.g,e,y)}if(a=e.t,p.g._hx_index==28&&a._hx_index==15)return c=a.t,c=a.size,ui.FField({e:n.TCall({e:n.TGlobal(l.Length),t:i.TVoid,p:o},[e]),t:i.TInt,p:o})}switch(a=e.t,a._hx_index){case 1:h=v.VInt,u=1;break;case 2:h=v.VBool,u=1;break;case 3:h=v.VFloat,u=1;break;case 5:w=a.size,S=a.t,h=S,u=w;break;case 9:w=a.size,h=v.VFloat,u=w;break;default:h=null,u=0}if(u>0&&t.length<=4){for(M="xrsygtzbpwaq",F=[B.X,B.Y,B.Z,B.W],b=-1,g=[],a=0,c=t.length;a<c;){if(C=a++,O=M.indexOf(t.charAt(C)),O<0)return null;if(k=O%3,b<0)b=k;else if(k!=b)return null;A=O/3|0,A>=u&&this.error(r.toString(e.t)+" does not have component "+t.charAt(C),o),g.push(F[A])}return ui.FField({e:n.TSwiz(e,g),t:g.length==1?r.toType(h):i.TVec(g.length,h),p:o})}return null},getSizeType:function(e,n){switch(e){case 1:return n==v.VInt?i.TInt:i.TFloat;break;case 2:return n==v.VInt?C.ivec2:C.vec2;break;case 3:return n==v.VInt?C.ivec3:C.vec3;break;case 4:return n==v.VInt?C.ivec4:C.vec4;break;default:throw t.thrown("assert")}},specialGlobal:function(e,s,a,c){var l,d,u,h,m,f,g,j,y,_,w,O,x,E,k,A,S,M,F,T,b=this,p=null;switch(e._hx_index){case 37:switch(a.length!=1&&this.error("TextureSize() requires one single argument",c),l=a[0].t,l._hx_index){case 10:x=l.dim,E=l.isArray,p=this.getSizeType(r.getDimSize(x,E),v.VFloat);break;case 11:d=l.channels,x=l.dim,E=l.isArray,p=this.getSizeType(r.getDimSize(x,E),v.VFloat);break;default:this.unify(a[0].t,i.TSampler(Ke.T2D,!1),a[0].p),p=C.vec2}break;case 41:if(u=i.TFloat,g=!1,a.length==1&&(u==i.TInt||u==i.TFloat)&&(l=a[0].t,l._hx_index==5&&(y=l.size,f=l.t,(f==v.VInt||f==v.VFloat)&&y==2&&(g=!0))),!g){for(m=0,l=0;l<a.length;)h=a[l],++l,d=h.t,d._hx_index==5?(_=d.size,j=d.t,r.toType(j)!=u&&b.unify(h.t,u,h.p),m+=_):(b.unifyExpr(h,u),++m);m!=2&&m>1&&b.error(D.toString(e)+" requires "+2+" "+r.toString(u)+" values but has "+m,c)}p=i.TVec(2,v.VFloat);break;case 42:if(u=i.TFloat,g=!1,a.length==1&&(u==i.TInt||u==i.TFloat)&&(l=a[0].t,l._hx_index==5&&(y=l.size,f=l.t,(f==v.VInt||f==v.VFloat)&&y==3&&(g=!0))),!g){for(m=0,l=0;l<a.length;)h=a[l],++l,d=h.t,d._hx_index==5?(_=d.size,j=d.t,r.toType(j)!=u&&b.unify(h.t,u,h.p),m+=_):(b.unifyExpr(h,u),++m);m!=3&&m>1&&b.error(D.toString(e)+" requires "+3+" "+r.toString(u)+" values but has "+m,c)}p=i.TVec(3,v.VFloat);break;case 43:if(u=i.TFloat,g=!1,a.length==1&&(u==i.TInt||u==i.TFloat)&&(l=a[0].t,l._hx_index==5&&(y=l.size,f=l.t,(f==v.VInt||f==v.VFloat)&&y==4&&(g=!0))),!g){for(m=0,l=0;l<a.length;)h=a[l],++l,d=h.t,d._hx_index==5?(_=d.size,j=d.t,r.toType(j)!=u&&b.unify(h.t,u,h.p),m+=_):(b.unifyExpr(h,u),++m);m!=4&&m>1&&b.error(D.toString(e)+" requires "+4+" "+r.toString(u)+" values but has "+m,c)}p=i.TVec(4,v.VFloat);break;case 44:case 45:case 46:switch(e._hx_index){case 44:j=2;break;case 45:j=3;break;case 46:j=4;break;default:throw t.thrown("assert")}if(a.length==1)switch(a[0].t._hx_index){case 1:case 3:break;default:if(u=i.TInt,g=!1,a.length==1&&(u==i.TInt||u==i.TFloat)&&(l=a[0].t,l._hx_index==5&&(y=l.size,f=l.t,(f==v.VInt||f==v.VFloat)&&y==j&&(g=!0))),!g){for(m=0,l=0;l<a.length;)h=a[l],++l,d=h.t,d._hx_index==5?(_=d.size,k=d.t,r.toType(k)!=u&&b.unify(h.t,u,h.p),m+=_):(b.unifyExpr(h,u),++m);m!=j&&m>1&&b.error(D.toString(e)+" requires "+j+" "+r.toString(u)+" values but has "+m,c)}}else if(u=i.TInt,g=!1,a.length==1&&(u==i.TInt||u==i.TFloat)&&(l=a[0].t,l._hx_index==5&&(y=l.size,f=l.t,(f==v.VInt||f==v.VFloat)&&y==j&&(g=!0))),!g){for(m=0,l=0;l<a.length;)h=a[l],++l,d=h.t,d._hx_index==5?(_=d.size,k=d.t,r.toType(k)!=u&&b.unify(h.t,u,h.p),m+=_):(b.unifyExpr(h,u),++m);m!=j&&m>1&&b.error(D.toString(e)+" requires "+j+" "+r.toString(u)+" values but has "+m,c)}p=i.TVec(j,v.VInt);break;case 47:if(u=i.TBool,g=!1,a.length==1&&(u==i.TInt||u==i.TFloat)&&(l=a[0].t,l._hx_index==5&&(y=l.size,f=l.t,(f==v.VInt||f==v.VFloat)&&y==2&&(g=!0))),!g){for(m=0,l=0;l<a.length;)h=a[l],++l,d=h.t,d._hx_index==5?(_=d.size,j=d.t,r.toType(j)!=u&&b.unify(h.t,u,h.p),m+=_):(b.unifyExpr(h,u),++m);m!=2&&m>1&&b.error(D.toString(e)+" requires "+2+" "+r.toString(u)+" values but has "+m,c)}p=i.TVec(2,v.VBool);break;case 48:if(u=i.TBool,g=!1,a.length==1&&(u==i.TInt||u==i.TFloat)&&(l=a[0].t,l._hx_index==5&&(y=l.size,f=l.t,(f==v.VInt||f==v.VFloat)&&y==3&&(g=!0))),!g){for(m=0,l=0;l<a.length;)h=a[l],++l,d=h.t,d._hx_index==5?(_=d.size,j=d.t,r.toType(j)!=u&&b.unify(h.t,u,h.p),m+=_):(b.unifyExpr(h,u),++m);m!=3&&m>1&&b.error(D.toString(e)+" requires "+3+" "+r.toString(u)+" values but has "+m,c)}p=i.TVec(3,v.VBool);break;case 49:if(u=i.TBool,g=!1,a.length==1&&(u==i.TInt||u==i.TFloat)&&(l=a[0].t,l._hx_index==5&&(y=l.size,f=l.t,(f==v.VInt||f==v.VFloat)&&y==4&&(g=!0))),!g){for(m=0,l=0;l<a.length;)h=a[l],++l,d=h.t,d._hx_index==5?(_=d.size,j=d.t,r.toType(j)!=u&&b.unify(h.t,u,h.p),m+=_):(b.unifyExpr(h,u),++m);m!=4&&m>1&&b.error(D.toString(e)+" requires "+4+" "+r.toString(u)+" values but has "+m,c)}p=i.TVec(4,v.VBool);break;case 50:for(l=[],d=0;d<a.length;)h=a[d],++d,l.push(h.t);switch(d=l,d.length){case 1:d[0]._hx_index==12?p=i.TMat2:this.error("Cannot apply "+D.toString(e)+" to these parameters",c);break;case 2:l=d[0],w=d[1],l._hx_index==5?l.size==2?l.t._hx_index==1?w._hx_index==5?w.size==2?w.t._hx_index==1?p=i.TMat2:this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c);break;case 4:d[0]._hx_index==3?d[1]._hx_index==3?d[2]._hx_index==3?d[3]._hx_index==3?p=i.TMat2:this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c);break;default:this.error("Cannot apply "+D.toString(e)+" to these parameters",c)}break;case 51:for(l=[],d=0;d<a.length;)h=a[d],++d,l.push(h.t);switch(d=l,d.length){case 1:switch(d[0]._hx_index){case 7:case 8:p=i.TMat3;break;default:this.error("Cannot apply "+D.toString(e)+" to these parameters",c)}break;case 3:l=d[0],w=d[1],O=d[2],l._hx_index==5?l.size==3?l.t._hx_index==1?w._hx_index==5?w.size==3?w.t._hx_index==1?O._hx_index==5?O.size==3?O.t._hx_index==1?p=i.TMat3:this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c);break;case 9:d[0]._hx_index==3?d[1]._hx_index==3?d[2]._hx_index==3?d[3]._hx_index==3?d[4]._hx_index==3?d[5]._hx_index==3?d[6]._hx_index==3?d[7]._hx_index==3?d[8]._hx_index==3?p=i.TMat3:this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c);break;default:this.error("Cannot apply "+D.toString(e)+" to these parameters",c)}break;case 52:for(l=[],d=0;d<a.length;)h=a[d],++d,l.push(h.t);switch(d=l,d.length){case 1:d[0]._hx_index==7?p=i.TMat4:this.error("Cannot apply "+D.toString(e)+" to these parameters",c);break;case 4:l=d[0],w=d[1],O=d[2],A=d[3],l._hx_index==5?l.size==4?l.t._hx_index==1?w._hx_index==5?w.size==4?w.t._hx_index==1?O._hx_index==5?O.size==4?O.t._hx_index==1?A._hx_index==5?A.size==4?A.t._hx_index==1?p=i.TMat4:this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c);break;default:this.error("Cannot apply "+D.toString(e)+" to these parameters",c)}break;case 53:for(l=[],d=0;d<a.length;)h=a[d],++d,l.push(h.t);switch(d=l,d.length){case 1:d[0]._hx_index==7?p=i.TMat3x4:this.error("Cannot apply "+D.toString(e)+" to these parameters",c);break;case 3:l=d[0],w=d[1],O=d[2],l._hx_index==5?l.size==4?l.t._hx_index==1?w._hx_index==5?w.size==4?w.t._hx_index==1?O._hx_index==5?O.size==4?O.t._hx_index==1?p=i.TMat3x4:this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c):this.error("Cannot apply "+D.toString(e)+" to these parameters",c);break;default:this.error("Cannot apply "+D.toString(e)+" to these parameters",c)}break;case 68:p=i.TVoid;break;case 79:for(l=[],d=0;d<a.length;)h=a[d],++d,l.push(h.t);d=l,d.length==3?(l=d[0],l._hx_index==11?(x=l.dim,E=l.isArray,S=l.channels,M=d[1],F=d[2],T=this.getSizeType(r.getDimSize(x,E),v.VInt),this.unify(M,T,a[1].p),this.unify(F,S==1?i.TFloat:i.TVec(S,v.VFloat),a[2].p),p=i.TVoid):this.error("Cannot apply "+D.toString(e)+" to these parameters",c)):this.error("Cannot apply "+D.toString(e)+" to these parameters",c);break;default:}if(p==null)throw t.thrown("Custom Global not supported "+o.string(e));return{e:n.TCall(s,a),t:p,p:c}},unifyCallParams:function(e,s,o,a){for(var c,l,d,u,h,m,f,p,b,j,_,w,O,x,C,E,v=1e3,y=-1e3,g=[],r=0;r<o.length;)O=o[r],++r,h=O.args.length,h<v&&(v=h),h>y&&(y=h),h==s.length&&g.push(O);switch(g.length){case 0:if(o.length==0){if(r=e.e,r._hx_index==2){for(C=r.g,r=[],l=0;l<s.length;)u=s[l],++l,r.push(this.typeExpr(u,te.Value));return this.specialGlobal(C,e,r,a)}throw t.thrown("assert")}else return this.error("Function expects "+(v==y?""+v:v+"-"+y)+" arguments",a);break;case 1:for(d=g[0],w=[],r=0,l=s.length;r<l;){c=r++,_=d.args[c].type,u=this.typeExpr(s[c],te.With(_));try{this.unifyExpr(u,_)}catch(e){throw f=t.caught(e).unwrap(),f instanceof De?(m=f,m.msg+=" for argument '"+d.args[c].name+"'",t.thrown(m)):e}w.push(u)}return o.length>1&&(e.t=i.TFun([d])),{e:n.TCall(e,w),t:d.ret,p:a};default:for(b=null,j=-1,r=0;r<g.length;){for(d=g[r],++r,p=[],l=0,E=s.length;l<E;){if(c=l++,u=this.typeExpr(s[c],te.With(d.args[c].type)),!this.tryUnify(u.t,d.args[c].type))break;p.push(u)}if(p.length>j&&(b=d,j=p.length,j==s.length))return e.t=i.TFun([d]),{e:n.TCall(e,p),t:d.ret,p:a}}for(r=0,l=s.length;r<l;){c=r++;try{m=this.typeExpr(s[c],te.Value),this.unify(m.t,b.args[c].type,m.p)}catch(e){throw f=t.caught(e).unwrap(),f instanceof De?(x=f,x.msg+=" for argument '"+b.args[c].name+"'",t.thrown(x)):e}}throw t.thrown("assert")}},toFloat:function(e){if(e.t!=i.TInt)throw t.thrown("assert");var s,a,o=e.e;o._hx_index==0?(s=o.c,s._hx_index==2?(a=s.v,e.e=n.TConst(m.CFloat(a)),e.t=i.TFloat):(e.e=n.TCall({e:n.TGlobal(l.ToFloat),t:i.TFun([]),p:e.p},[{e:e.e,t:e.t,p:e.p}]),e.t=i.TFloat)):(e.e=n.TCall({e:n.TGlobal(l.ToFloat),t:i.TFun([]),p:e.p},[{e:e.e,t:e.t,p:e.p}]),e.t=i.TFloat)},typeBinop:function(e,n,s,a){switch(e._hx_index){case 4:throw t.thrown("assert");case 5:case 6:case 7:case 8:case 9:case 10:var c,l,d,u,h,f,p,m=n.t;switch(m._hx_index){case 2:if((e==T.OpEq||e==T.OpNotEq)&&s.t!=i.TVoid)return this.unifyExpr(s,n.t),i.TBool;switch(l=n.e,u=s.e,l._hx_index){case 0:return l.c._hx_index==0?u._hx_index==1?(f=u.v,r.hasQualifier(f,I.Nullable)||this.error("Variable is not declared as nullable",n.p),i.TBool):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a);break;case 1:return u._hx_index==0?u.c._hx_index==0?(f=l.v,r.hasQualifier(f,I.Nullable)||this.error("Variable is not declared as nullable",n.p),i.TBool):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a);break;default:return this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 1:case 3:case 4:if(s.t!=i.TVoid)return this.unifyExpr(s,n.t),i.TBool;switch(l=n.e,u=s.e,l._hx_index){case 0:return l.c._hx_index==0?u._hx_index==1?(f=u.v,r.hasQualifier(f,I.Nullable)||this.error("Variable is not declared as nullable",n.p),i.TBool):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a);break;case 1:return u._hx_index==0?u.c._hx_index==0?(f=l.v,r.hasQualifier(f,I.Nullable)||this.error("Variable is not declared as nullable",n.p),i.TBool):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a);break;default:return this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 5:if(l=m.size,l=m.t,s.t!=i.TVoid)return this.unifyExpr(s,n.t),n.t;switch(m=n.e,l=s.e,m._hx_index){case 0:return m.c._hx_index==0?l._hx_index==1?(f=l.v,r.hasQualifier(f,I.Nullable)||this.error("Variable is not declared as nullable",n.p),i.TBool):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a);break;case 1:return l._hx_index==0?l.c._hx_index==0?(f=m.v,r.hasQualifier(f,I.Nullable)||this.error("Variable is not declared as nullable",n.p),i.TBool):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a);break;default:return this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;default:switch(m=n.e,l=s.e,m._hx_index){case 0:return m.c._hx_index==0?l._hx_index==1?(f=l.v,r.hasQualifier(f,I.Nullable)||this.error("Variable is not declared as nullable",n.p),i.TBool):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a);break;case 1:return l._hx_index==0?l.c._hx_index==0?(f=m.v,r.hasQualifier(f,I.Nullable)||this.error("Variable is not declared as nullable",n.p),i.TBool):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a):this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a);break;default:return this.error("Cannot compare "+r.toString(n.t)+" and "+r.toString(s.t),a)}}break;case 11:case 12:case 13:case 16:case 17:case 18:return this.unifyExpr(n,i.TInt),this.unifyExpr(s,i.TInt),i.TInt;case 14:case 15:return this.unifyExpr(n,i.TBool),this.unifyExpr(s,i.TBool),i.TBool;case 0:case 1:case 2:case 3:case 19:if(m=n.t,l=s.t,e._hx_index==1)switch(m._hx_index){case 1:switch(l._hx_index){case 1:return i.TInt;case 3:return this.toFloat(n),i.TFloat;case 5:if(u=l.size,l.t._hx_index==1)return this.toFloat(n),s.t;switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a);break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 3:switch(l._hx_index){case 1:return this.toFloat(s),i.TFloat;case 3:return i.TFloat;case 5:if(u=l.size,l.t._hx_index==1)return s.t;switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a);break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 5:switch(u=m.size,p=m.t,u){case 2:switch(p._hx_index){case 0:if(l._hx_index==5)if(l.t._hx_index==0){if(d=u,h=l.size,d==h)return i.TVec(d,v.VInt);switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 1:switch(l._hx_index){case 1:return this.toFloat(s),n.t;case 3:return n.t;case 5:if(l.t._hx_index==1){if(d=u,h=l.size,d==h)return i.TVec(d,v.VFloat);switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 12:return C.vec2;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 3:switch(p._hx_index){case 0:if(l._hx_index==5)if(l.t._hx_index==0){if(d=u,h=l.size,d==h)return i.TVec(d,v.VInt);switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 1:switch(l._hx_index){case 1:return this.toFloat(s),n.t;case 3:return n.t;case 5:if(l.t._hx_index==1){if(d=u,h=l.size,d==h)return i.TVec(d,v.VFloat);switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 6:return C.vec3;case 8:return C.vec3;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 4:switch(p._hx_index){case 0:if(l._hx_index==5)if(l.t._hx_index==0){if(d=u,h=l.size,d==h)return i.TVec(d,v.VInt);switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 1:switch(l._hx_index){case 1:return this.toFloat(s),n.t;case 3:return n.t;case 5:if(l.t._hx_index==1){if(d=u,h=l.size,d==h)return i.TVec(d,v.VFloat);switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 7:return C.vec4;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;default:switch(p._hx_index){case 0:if(l._hx_index==5)if(l.t._hx_index==0){if(d=u,h=l.size,d==h)return i.TVec(d,v.VInt);switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 1:switch(l._hx_index){case 1:return this.toFloat(s),n.t;case 3:return n.t;case 5:if(l.t._hx_index==1){if(d=u,h=l.size,d==h)return i.TVec(d,v.VFloat);switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}}break;case 7:if(l._hx_index==7)return i.TMat4;switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a);break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else switch(m._hx_index){case 1:switch(l._hx_index){case 1:return i.TInt;case 3:return this.toFloat(n),i.TFloat;case 5:if(u=l.size,l.t._hx_index==1)return this.toFloat(n),s.t;switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a);break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 3:switch(l._hx_index){case 1:return this.toFloat(s),i.TFloat;case 3:return i.TFloat;case 5:if(u=l.size,l.t._hx_index==1)return s.t;switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a);break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 5:switch(u=m.size,m.t._hx_index){case 0:if(l._hx_index==5)if(l.t._hx_index==0){if(h=l.size,d=u,d==h)return i.TVec(d,v.VInt);switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 1:switch(l._hx_index){case 1:return this.toFloat(s),n.t;case 3:return n.t;case 5:if(l.t._hx_index==1){if(h=l.size,d=u,d==h)return i.TVec(d,v.VFloat);switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}else{switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;default:switch(e._hx_index){case 0:c="add";break;case 1:c="multiply";break;case 2:c="divide";break;case 3:c="subtract";break;default:throw t.thrown("assert")}return this.error("Cannot "+c+" "+r.toString(n.t)+" and "+r.toString(s.t),a)}break;case 20:throw m=e.op,t.thrown("assert");case 21:return this.unifyExpr(n,i.TInt),this.unifyExpr(s,i.TInt),i.TArray(i.TInt,ke.SConst(0));default:return this.error("Unsupported operator "+o.string(e),a)}},__class__:C},Gi=function(){this.varMap=new le},c["hxsl.Clone"]=Gi,Gi.__name__="hxsl.Clone",Gi.shaderData=function(e){return(new Gi).shader(e)},Gi.prototype={tvar:function(e){var t=this.varMap.h[e.id];return t??(t={id:r.allocVarId(),type:e.type,name:e.name,kind:e.kind},this.varMap.h[e.id]=t,e.parent!=null&&(t.parent=this.tvar(e.parent)),e.qualifiers!=null&&(t.qualifiers=e.qualifiers.slice()),t.type=this.ttype(e.type),t)},tfun:function(e){for(var o,i=this.ttype(e.ret),a=e.kind,r=this.tvar(e.ref),n=[],t=0,s=e.args;t<s.length;)o=s[t],++t,n.push(this.tvar(o));return{ret:i,kind:a,ref:r,args:n,expr:this.texpr(e.expr)}},ttype:function(e){switch(e._hx_index){case 13:for(var t,o,a,c,l,d,r=e.vl,n=[],s=0;s<r.length;)o=r[s],++s,n.push(this.tvar(o));return i.TStruct(n);case 14:return c=e.variants,i.TFun(c);case 15:switch(l=e.t,t=e.size,d=this.ttype(l),t._hx_index){case 0:n=t.v,a=t;break;case 1:o=t.v,a=ke.SVar(this.tvar(o));break}return i.TArray(d,a);default:return e}},texpr:function(e){var t,s,i,a,c,l,o=r.map(e,b(this,this.texpr));switch(o.t=this.ttype(e.t),t=o.e,t._hx_index){case 1:s=t.v,i=n.TVar(this.tvar(s));break;case 7:s=t.v,a=t.init,i=n.TVarDecl(this.tvar(s),a);break;case 13:s=t.v,c=t.it,l=t.loop,i=n.TFor(this.tvar(s),c,l);break;default:i=o.e}return o.e=i,o},shader:function(e){for(var o,i,a,r=e.name,n=[],t=0,s=e.vars;t<s.length;)o=s[t],++t,n.push(this.tvar(o));for(i=n,n=[],t=0,s=e.funs;t<s.length;)a=s[t],++t,n.push(this.tfun(a));return{name:r,vars:i,funs:n}},__class__:Gi},Yc=function(){},c["hxsl._Dce.Exit"]=Yc,Yc.__name__="hxsl._Dce.Exit",Yc.prototype={__class__:Yc},xc=function(e){this.fields=0,this.v=e},c["hxsl._Dce.VarRel"]=xc,xc.__name__="hxsl._Dce.VarRel",xc.prototype={__class__:xc},Cc=function(e){this.used=0,this.keep=0,this.v=e,this.deps=new le,this.adeps=[]},c["hxsl._Dce.VarDeps"]=Cc,Cc.__name__="hxsl._Dce.VarDeps",Cc.prototype={__class__:Cc},kn=function(){this.vars=[],this.bits=[]},c["hxsl._Dce.WriteTo"]=kn,kn.__name__="hxsl._Dce.WriteTo",kn.prototype={push:function(e,t){this.vars.push(e),this.bits.push(t)},pop:function(){this.vars.pop(),this.bits.pop()},append:function(e,t){for(var o,i,a,r,n=0,s=this.vars;n<s.length;)if(o=s[n],i=n++,a=i,r=o,r==e){this.bits[a]|=t;return}this.push(e,t)},appendTo:function(e){for(var s,o,i,a,t=0,n=this.vars;t<n.length;)s=n[t],o=t++,i=o,a=s,e.append(a,this.bits[i])},__class__:kn},kc=function(){},c["hxsl.Dce"]=kc,kc.__name__="hxsl.Dce",kc.prototype={dce:function(e){this.used=new le,this.channelVars=[];for(var n,s,o,i,a,r,l,d,h,m,f,p,g,v,b,j,y,c=[],t=0;t<e.length;)for(a=e[t],++t,n=0,s=a.vars;n<s.length;){if(i=s[n],++n,f=this.get(i),i.kind==O.Input&&c.push(f),i.kind!=O.Output)switch(o=i.type,o._hx_index){case 11:m=o.dim,v=o.isArray,y=o.channels,h=!0;break;case 16:j=o.t,b=o.size,h=o.kind._hx_index==2;break;default:h=!1}else h=!0;h&&(f.keep=15)}for(t=0;t<e.length;)for(a=e[t],++t,n=0,s=a.funs;n<s.length;)d=s[n],++n,this.check(d.expr,new kn,new kn);l=[];do{for(He.TRACE&&be.trace("DCE LOOP",{fileName:"hxsl/Debug.hx",lineNumber:9,className:"hxsl.Dce",methodName:"dce"}),i=this.used.iterator();i.hasNext();)r=i.next(),r.keep!=0&&this.markRec(r,r.keep);for(;c.length>1&&c[c.length-1].used==0;)c.pop();for(t=0;t<c.length;)g=c[t],++t,this.markRec(g,15);for(l=[],n=0;n<e.length;)for(a=e[n],++n,s=0,o=a.funs;s<o.length;)d=o[s],++s,l.push(this.mapExpr(d.expr,!1));for(this.markAsKeep=!1,m=0;m<l.length;)p=l[m],++m,this.checkBranches(p)}while(this.markAsKeep)for(t=0;t<e.length;)for(a=e[t],++t,n=0,s=a.funs;n<s.length;)d=s[n],++n,d.expr=l.shift();for(i=this.used.iterator();i.hasNext();){if(r=i.next(),r.used!=0)continue;if(r.v.kind==O.Input)continue;for(t=0;t<e.length;)a=e[t],++t,u.remove(a.vars,r.v)}return e.slice()},get:function(e){var t=this.used.h[e.id];return t==null&&(t=new Cc(e),this.used.h[e.id]=t),t},varName:function(e,t){return t==null&&(t=15),He.varName(e,t)},markRec:function(e,t){if((e.used&t)==t)return;t&=~e.used,He.TRACE&&be.trace(this.varName(e.v,t)+" is used",{fileName:"hxsl/Debug.hx",lineNumber:9,className:"hxsl.Dce",methodName:"markRec"}),e.used|=t;for(var n,i,s=0,o=e.adeps;s<o.length;)n=o[s],++s,i=this.makeFieldsBits(15,t),(n.fields&i)!=0&&this.markRec(n.v,this.extractFieldsBits(n.fields,t))},extractFieldsBits:function(e,t){return(((t&1)==0?0:e)|((t&2)==0?0:e>>4)|((t&4)==0?0:e>>8)|((t&8)==0?0:e>>12))&15},makeFieldsBits:function(e,t){return e*((t&1)+((t&2)<<3)+((t&4)<<6)+((t&8)<<9))},link:function(e,t,n){n==null&&(n=15);for(var s,o,a,c,d,u,i=this.get(e),r=0,l=t.vars;r<l.length;){if(d=l[r],u=r++,c=u,o=d,o==null){i.keep==0&&(He.TRACE&&be.trace("Force keep "+this.varName(i.v),{fileName:"hxsl/Debug.hx",lineNumber:9,className:"hxsl.Dce",methodName:"link"}),i.keep=15,this.markAsKeep=!0);continue}s=o.deps.h[e.id],s==null&&(s=new xc(i),o.deps.h[e.id]=s,o.adeps.push(s)),a=this.makeFieldsBits(n,t.bits[c]),(s.fields&a)!=a&&(s.fields|=a,He.TRACE&&be.trace(this.varName(o.v,t.bits[c])+" depends on "+this.varName(i.v,n),{fileName:"hxsl/Debug.hx",lineNumber:9,className:"hxsl.Dce",methodName:"link"}))}},swizBits:function(e){for(var s,n=0,t=0;t<e.length;)s=e[t],++t,n|=1<<s._hx_index;return n},check:function(e,t,n){var o,Y,ot,s,a,c,l,u,f,p,g,j,_,S,T,et,O,Je,Qe,y,q,le,ce,re,ae,ie,oe,se,Me,Z,te,ne,h,v,b,A,M,D,N,Fe,P,B,G,Ne,Le,Re,Pe,He,Ie,Be,Ve,$e,m,C,z,L,H,st,nt,tt,Xe,J,Ue,We,De,ze,d,w,Te,we,_e,ye,x,je,de,ue,he,me,fe,pe,ge,ve,be,E,k,F,I,Oe,xe,Ce,Ee,ke,Ae,Se,ee,R,qe,Ye,Ge,Ze,V,$,W,U,K,X,Q,it,Ke,at=this,i=e.e;switch(i._hx_index){case 1:o=i.v,this.link(o,t);break;case 4:for(Y=i.el,ot=new kn,c=0,l=Y.length;c<l;)p=c++,this.check(Y[p],p<Y.length-1?ot:t,n);break;case 5:switch(c=i.op,l=i.e1,g=i.e2,c._hx_index){case 4:switch(f=l.e,j=l.p,j=l.t,f._hx_index){case 1:o=f.v,a=g,s=this.get(o),t.push(s,15),this.check(a,t,n),t.pop(),n.append(s,15);break;case 9:switch(j=f.e,S=f.regs,_=j.e,u=j.p,u=j.t,_._hx_index){case 1:o=_.v,T=S,a=g,s=this.get(o),H=this.swizBits(T),t.push(s,H),this.check(a,t,n),t.pop(),n.append(s,H);break;case 16:j=_.e,S=j.e,u=j.p,u=j.t,S._hx_index==1?(o=S.v,p=_.index,a=g,s=this.get(o),t.push(s,15),this.check(p,t,n),this.check(a,t,n),t.pop(),n.append(s,15)):(j=this,st=t,nt=n,r.iter(e,function(e){j.check(e,st,nt)}));break;default:S=this,tt=t,et=n,r.iter(e,function(e){S.check(e,tt,et)})}break;case 16:_=f.e,u=_.e,O=_.p,O=_.t,u._hx_index==1?(o=u.v,p=f.index,a=g,s=this.get(o),t.push(s,15),this.check(p,t,n),this.check(a,t,n),t.pop(),n.append(s,15)):(_=this,Je=t,Qe=n,r.iter(e,function(e){_.check(e,Je,Qe)}));break;case 21:u=f.e,O=f.name,f=u.e,O=u.p,O=u.t,f._hx_index==16?(u=f.e,O=u.e,y=u.p,y=u.t,O._hx_index==1?(o=O.v,p=f.index,a=g,s=this.get(o),t.push(s,15),this.check(p,t,n),this.check(a,t,n),t.pop(),n.append(s,15)):(f=this,Xe=t,J=n,r.iter(e,function(e){f.check(e,Xe,J)}))):(u=this,Ue=t,We=n,r.iter(e,function(e){u.check(e,Ue,We)}));break;default:O=this,De=t,ze=n,r.iter(e,function(e){O.check(e,De,ze)})}break;case 20:switch(y=c.op,c=l.e,y=l.p,y=l.t,c._hx_index){case 1:o=c.v,a=g,s=this.get(o),t.push(s,15),this.check(a,t,n),t.pop(),n.append(s,15);break;case 9:switch(l=c.e,y=c.regs,w=l.e,d=l.p,d=l.t,w._hx_index){case 1:o=w.v,T=y,a=g,s=this.get(o),H=this.swizBits(T),t.push(s,H),this.check(a,t,n),t.pop(),n.append(s,H);break;case 16:l=w.e,y=l.e,d=l.p,d=l.t,y._hx_index==1?(o=y.v,p=w.index,a=g,s=this.get(o),t.push(s,15),this.check(p,t,n),this.check(a,t,n),t.pop(),n.append(s,15)):(l=this,Te=t,we=n,r.iter(e,function(e){l.check(e,Te,we)}));break;default:y=this,_e=t,ye=n,r.iter(e,function(e){y.check(e,_e,ye)})}break;case 16:w=c.e,d=w.e,x=w.p,x=w.t,d._hx_index==1?(o=d.v,p=c.index,a=g,s=this.get(o),t.push(s,15),this.check(p,t,n),this.check(a,t,n),t.pop(),n.append(s,15)):(w=this,je=t,de=n,r.iter(e,function(e){w.check(e,je,de)}));break;case 21:d=c.e,x=c.name,c=d.e,x=d.p,x=d.t,c._hx_index==16?(d=c.e,x=d.e,q=d.p,q=d.t,x._hx_index==1?(o=x.v,p=c.index,a=g,s=this.get(o),t.push(s,15),this.check(p,t,n),this.check(a,t,n),t.pop(),n.append(s,15)):(c=this,le=t,ce=n,r.iter(e,function(e){c.check(e,le,ce)}))):(g=this,re=t,ae=n,r.iter(e,function(e){g.check(e,re,ae)}));break;default:d=this,ie=t,oe=n,r.iter(e,function(e){d.check(e,ie,oe)})}break;default:x=this,se=t,Me=n,r.iter(e,function(e){x.check(e,se,Me)})}break;case 7:o=i.v,Z=i.init,Z!=null?(t.push(this.get(o),15),this.check(Z,t,n),t.pop()):(q=this,te=t,ne=n,r.iter(e,function(e){q.check(e,te,ne)}));break;case 8:if(v=i.e,h=i.args,b=v.e,M=v.p,M=v.t,b._hx_index==2)switch(b.g._hx_index){case 64:h.length==3?(v=h[0],b=h[2],M=v.e,D=v.p,D=v.t,M._hx_index==1?(v=b.e,D=b.p,D=b.t,v._hx_index==0?(b=v.c,b._hx_index==2?(A=b.v,N=h[1],L=M.v,this.check(N,t,n),this.channelVars[A]==null?(this.channelVars[A]=L,this.link(L,t)):this.link(this.channelVars[A],t)):(v=this,ue=t,he=n,r.iter(e,function(e){v.check(e,ue,he)}))):(b=this,me=t,fe=n,r.iter(e,function(e){b.check(e,me,fe)}))):(M=this,pe=t,ge=n,r.iter(e,function(e){M.check(e,pe,ge)}))):(D=this,ve=t,be=n,r.iter(e,function(e){D.check(e,ve,be)}));break;case 65:h.length==4?(k=h[0],E=h[3],I=k.e,F=k.p,F=k.t,I._hx_index==1?(k=E.e,F=E.p,F=E.t,k._hx_index==0?(E=k.c,E._hx_index==2?(A=E.v,Oe=h[2],N=h[1],L=I.v,this.check(N,t,n),this.check(Oe,t,n),this.channelVars[A]==null?(this.channelVars[A]=L,this.link(L,t)):this.link(this.channelVars[A],t)):(k=this,xe=t,Ce=n,r.iter(e,function(e){k.check(e,xe,Ce)}))):(E=this,Ee=t,ke=n,r.iter(e,function(e){E.check(e,Ee,ke)}))):(I=this,Ae=t,Se=n,r.iter(e,function(e){I.check(e,Ae,Se)}))):(F=this,ee=t,Fe=n,r.iter(e,function(e){F.check(e,ee,Fe)}));break;case 79:h.length==3?(P=h[0],B=P.e,G=P.p,G=P.t,B._hx_index==1?(o=B.v,N=h[1],Ne=h[2],s=this.get(o),t.push(s,15),this.check(N,t,n),this.check(Ne,t,n),t.pop(),n.append(s,15)):(h=this,Le=t,Re=n,r.iter(e,function(e){h.check(e,Le,Re)}))):(P=this,Pe=t,He=n,r.iter(e,function(e){P.check(e,Pe,He)}));break;default:B=this,Ie=t,Be=n,r.iter(e,function(e){B.check(e,Ie,Be)})}else G=this,Ve=t,$e=n,r.iter(e,function(e){G.check(e,Ve,$e)});break;case 9:z=i.e,C=z.e,R=z.p,R=z.t,C._hx_index==1?(o=C.v,T=i.regs,this.link(o,t,this.swizBits(T))):(z=this,qe=t,Ye=n,r.iter(e,function(e){z.check(e,qe,Ye)}));break;case 10:a=i.econd,Ge=i.eif,Q=i.eelse,m=new kn,this.check(Ge,t,m),Q!=null&&this.check(Q,t,m),m.appendTo(n),t.appendTo(m),this.check(a,m,n);break;case 13:o=i.v,Ze=i.it,W=i.loop,m=new kn,this.check(W,t,m),m.appendTo(n),this.check(Ze,m,n);break;case 19:C=i.normalWhile,a=i.e,W=i.loop,m=new kn,this.check(W,t,m),m.appendTo(n),t.appendTo(m),this.check(a,m,n);break;case 22:for(C=i.target,C=i.code,V=i.args,i=0;i<V.length;)if(U=V[i],++i,U.access!=xn.Read)for(K=[[]],$=[null],$[0]=function(e,t){return function(n){var o,s=n.e;s._hx_index==1?(o=s.v,t[0].push(at.get(o))):r.iter(n,e[0])}}($,K),$[0](U.e),C=0;C<K[0].length;){for(o=K[0][C],++C,t.push(o,15),R=0;R<V.length;)X=V[R],++R,X.access!=xn.Write&&this.check(X.e,t,n);t.pop(),n.append(o,15)}else this.check(U.e,t,n);break;default:i=this,it=t,Ke=n,r.iter(e,function(e){i.check(e,it,Ke)})}},checkBranches:function(e){var n,s,o,i,t=e.e;switch(t._hx_index){case 10:o=t.eif,o=t.eelse,s=t.econd,n=new kn,n.append(null,0),this.check(s,n,new kn);break;case 19:o=t.normalWhile,s=t.e,i=t.loop,n=new kn,n.append(null,0),this.check(s,n,new kn);break;default:}r.iter(e,b(this,this.checkBranches))},mapExpr:function(e,t){var s,o,a,c,u,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,B,d=this,h=e.e;switch(h._hx_index){case 4:for(x=h.el,T=[],S=0,s=0;s<x.length;)j=x[s],++s,z=t&&S==x.length-1,o=this.mapExpr(j,z),(r.hasSideEffect(o)||z)&&T.push(o),++S;return{e:n.TBlock(T),p:e.p,t:e.t};case 5:switch(s=h.op,a=h.e1,u=h.e2,s._hx_index){case 4:switch(c=a.e,g=a.p,g=a.t,c._hx_index){case 1:return f=c.v,o=u,this.get(f).used==0?o!=null&&r.hasSideEffect(o)?this.mapExpr(o,!1):{e:n.TConst(m.CNull),t:e.t,p:e.p}:r.map(e,function(e){return d.mapExpr(e,!0)});break;case 9:return g=c.e,_=g.e,B=g.p,B=g.t,_._hx_index==1?(g=_.v,f=g,o=u,this.get(f).used==0?o!=null&&r.hasSideEffect(o)?this.mapExpr(o,!1):{e:n.TConst(m.CNull),t:e.t,p:e.p}:(f=g,w=c.regs,o=u,(this.get(f).used&this.swizBits(w))==0?r.hasSideEffect(o)?this.mapExpr(o,!1):{e:n.TConst(m.CNull),t:e.t,p:e.p}:r.map(e,function(e){return d.mapExpr(e,!0)}))):r.map(e,function(e){return d.mapExpr(e,!0)});break;case 16:return g=c.e,_=c.index,c=g.e,_=g.p,_=g.t,c._hx_index==1?(f=c.v,o=u,this.get(f).used==0?o!=null&&r.hasSideEffect(o)?this.mapExpr(o,!1):{e:n.TConst(m.CNull),t:e.t,p:e.p}:r.map(e,function(e){return d.mapExpr(e,!0)})):r.map(e,function(e){return d.mapExpr(e,!0)});break;default:return r.map(e,function(e){return d.mapExpr(e,!0)})}break;case 20:switch(c=s.op,s=a.e,c=a.p,c=a.t,s._hx_index){case 1:return f=s.v,o=u,this.get(f).used==0?o!=null&&r.hasSideEffect(o)?this.mapExpr(o,!1):{e:n.TConst(m.CNull),t:e.t,p:e.p}:r.map(e,function(e){return d.mapExpr(e,!0)});break;case 9:return a=s.e,c=a.e,g=a.p,g=a.t,c._hx_index==1?(a=c.v,f=a,o=u,this.get(f).used==0?o!=null&&r.hasSideEffect(o)?this.mapExpr(o,!1):{e:n.TConst(m.CNull),t:e.t,p:e.p}:(f=a,w=s.regs,o=u,(this.get(f).used&this.swizBits(w))==0?r.hasSideEffect(o)?this.mapExpr(o,!1):{e:n.TConst(m.CNull),t:e.t,p:e.p}:r.map(e,function(e){return d.mapExpr(e,!0)}))):r.map(e,function(e){return d.mapExpr(e,!0)});break;case 16:return a=s.e,c=s.index,s=a.e,c=a.p,c=a.t,s._hx_index==1?(f=s.v,o=u,this.get(f).used==0?o!=null&&r.hasSideEffect(o)?this.mapExpr(o,!1):{e:n.TConst(m.CNull),t:e.t,p:e.p}:r.map(e,function(e){return d.mapExpr(e,!0)})):r.map(e,function(e){return d.mapExpr(e,!0)});break;default:return r.map(e,function(e){return d.mapExpr(e,!0)})}break;default:return r.map(e,function(e){return d.mapExpr(e,!0)})}break;case 7:return f=h.v,o=h.init,this.get(f).used==0?o!=null&&r.hasSideEffect(o)?this.mapExpr(o,!1):{e:n.TConst(m.CNull),t:e.t,p:e.p}:r.map(e,function(e){return d.mapExpr(e,!0)});break;case 8:if(s=h.e,a=h.args,u=s.e,c=s.p,c=s.t,u._hx_index==2)switch(u.g._hx_index){case 64:return a.length==3?(s=a[0],s=a[2],u=s.e,c=s.p,c=s.t,u._hx_index==0?(s=u.c,s._hx_index==2?(v=s.v,C=a[1],p=this.channelVars[v],{e:n.TCall({e:n.TGlobal(l.Texture),p:e.p,t:i.TVoid},[{e:n.TVar(p),t:p.type,p:e.p},this.mapExpr(C,!0)]),t:i.TVoid,p:e.p}):r.map(e,function(e){return d.mapExpr(e,!0)})):r.map(e,function(e){return d.mapExpr(e,!0)})):r.map(e,function(e){return d.mapExpr(e,!0)});break;case 65:return a.length==4?(s=a[0],s=a[3],u=s.e,c=s.p,c=s.t,u._hx_index==0?(s=u.c,s._hx_index==2?(v=s.v,b=a[2],C=a[1],p=this.channelVars[v],{e:n.TCall({e:n.TGlobal(l.TextureLod),p:e.p,t:i.TVoid},[{e:n.TVar(p),t:p.type,p:e.p},this.mapExpr(C,!0),this.mapExpr(b,!0)]),t:i.TVoid,p:e.p}):r.map(e,function(e){return d.mapExpr(e,!0)})):r.map(e,function(e){return d.mapExpr(e,!0)})):r.map(e,function(e){return d.mapExpr(e,!0)});break;case 66:switch(a.length){case 3:return s=a[0],s=a[2],u=s.e,c=s.p,c=s.t,u._hx_index==0?(s=u.c,s._hx_index==2?(v=s.v,O=a[1],p=this.channelVars[v],{e:n.TCall({e:n.TGlobal(l.Texel),p:e.p,t:i.TVoid},[{e:n.TVar(p),t:p.type,p:e.p},this.mapExpr(O,!0)]),t:i.TVoid,p:e.p}):r.map(e,function(e){return d.mapExpr(e,!0)})):r.map(e,function(e){return d.mapExpr(e,!0)});break;case 4:return s=a[0],s=a[3],u=s.e,c=s.p,c=s.t,u._hx_index==0?(s=u.c,s._hx_index==2?(v=s.v,b=a[2],O=a[1],p=this.channelVars[v],{e:n.TCall({e:n.TGlobal(l.Texel),p:e.p,t:i.TVoid},[{e:n.TVar(p),t:p.type,p:e.p},this.mapExpr(O,!0),this.mapExpr(b,!0)]),t:i.TVoid,p:e.p}):r.map(e,function(e){return d.mapExpr(e,!0)})):r.map(e,function(e){return d.mapExpr(e,!0)});break;default:return r.map(e,function(e){return d.mapExpr(e,!0)})}break;case 67:switch(a.length){case 2:return s=a[0],s=a[1],u=s.e,c=s.p,c=s.t,u._hx_index==0?(s=u.c,s._hx_index==2?(v=s.v,p=this.channelVars[v],{e:n.TCall({e:n.TGlobal(l.TextureSize),p:e.p,t:i.TVoid},[{e:n.TVar(p),t:p.type,p:e.p}]),t:i.TVoid,p:e.p}):r.map(e,function(e){return d.mapExpr(e,!0)})):r.map(e,function(e){return d.mapExpr(e,!0)});break;case 3:return s=a[0],s=a[2],u=s.e,c=s.p,c=s.t,u._hx_index==0?(s=u.c,s._hx_index==2?(v=s.v,b=a[1],p=this.channelVars[v],{e:n.TCall({e:n.TGlobal(l.TextureSize),p:e.p,t:i.TVoid},[{e:n.TVar(p),t:p.type,p:e.p},this.mapExpr(b,!0)]),t:i.TVoid,p:e.p}):r.map(e,function(e){return d.mapExpr(e,!0)})):r.map(e,function(e){return d.mapExpr(e,!0)});break;default:return r.map(e,function(e){return d.mapExpr(e,!0)})}break;default:return r.map(e,function(e){return d.mapExpr(e,!0)})}else return r.map(e,function(e){return d.mapExpr(e,!0)});break;case 10:return j=h.econd,N=h.eif,M=h.eelse,o=this.mapExpr(j,!0),A=this.mapExpr(N,t),k=M==null?null:this.mapExpr(M,t),!t&&!r.hasSideEffect(A)&&(k==null||!r.hasSideEffect(k))?{e:n.TConst(m.CNull),t:o.t,p:o.p}:{e:n.TIf(o,A,k),p:o.p,t:o.t};case 13:return f=h.v,L=h.it,E=h.loop,D=this.mapExpr(L,!0),y=this.mapExpr(E,!1),r.hasSideEffect(y)?{e:n.TFor(f,D,y),p:e.p,t:e.t}:{e:n.TConst(m.CNull),t:e.t,p:e.p};case 19:return j=h.e,E=h.loop,R=h.normalWhile,o=this.mapExpr(j,!0),y=this.mapExpr(E,t),r.hasSideEffect(y)?{e:n.TWhile(o,y,R),p:o.p,t:o.t}:{e:n.TConst(m.CNull),t:o.t,p:o.p};case 20:return P=h.m,H=h.args,I=h.e,F=this.mapExpr(I,t),!t&&!r.hasSideEffect(F)?{e:n.TConst(m.CNull),t:e.t,p:e.p}:{e:n.TMeta(P,H,F),t:e.t,p:e.p};default:return r.map(e,function(e){return d.mapExpr(e,!0)})}},__class__:kc},He=function(){},c["hxsl.Debug"]=He,He.__name__="hxsl.Debug",He.varName=function(e,t){t==null&&(t=15);var n=e.name;return t!=15&&(n+=He.swizStr(t)),He.VAR_IDS?n+"@"+e.id:n},He.swizStr=function(e){var t=".";return(e&1)!=0&&(t+="x"),(e&2)!=0&&(t+="y"),(e&4)!=0&&(t+="z"),(e&8)!=0&&(t+="w"),t},Sc=function(){this.mapped=[],this.varMap=new Rt,this.funMap=new Rt,this.constants=new le},c["hxsl.Eval"]=Sc,Sc.__name__="hxsl.Eval",Sc.prototype={setConstant:function(e,t){this.constants.h[e.id]=n.TConst(t)},mapVar:function(e,n){var e,s,o,c,l,d,u,h,m,f,p,g,a=this.varMap.h[e.__id__];if(a!=null)return a;if(e.parent!=null&&(this.mapVar(e.parent,n),a=this.varMap.h[e.__id__],a!=null))return e==a?a:this.mapVar(a,n);switch(o=e.type,o._hx_index==17?(s=o.size,p=!0):p=!1,a={id:p?e.id:r.allocVarId(),name:e.name,type:e.type,kind:e.kind},e.parent!=null&&(a.parent=this.mapVar(e.parent,n)),e.qualifiers!=null&&(a.qualifiers=e.qualifiers.slice()),this.varMap.set(e,a),this.varMap.set(a,a),n&&this.mapped.push(e),o=a.type,o._hx_index){case 13:for(g=o.vl,s=[],l=0;l<g.length;)e=g[l],++l,s.push(this.mapVar(e,n));a.type=i.TStruct(s);break;case 15:if(s=o.size,s._hx_index==1)if(d=s.v,u=o.t,h=this.constants.h[d.id],h!=null)if(h==null)De.t("Integer value expected for array size constant "+d.name,null);else if(h._hx_index==0)if(s=h.c,s._hx_index==2){switch(e=s.v,s=a.type,s._hx_index){case 15:l=s.t,l=s.size,c=i.TArray(u,ke.SConst(e));break;case 16:l=s.t,l=s.size,m=s.kind,c=i.TBuffer(u,ke.SConst(e),m);break;default:throw t.thrown("assert")}a.type=c}else De.t("Integer value expected for array size constant "+d.name,null);else De.t("Integer value expected for array size constant "+d.name,null);else{switch(f=this.mapVar(d,n),s=a.type,s._hx_index){case 15:l=s.t,l=s.size,c=i.TArray(u,ke.SVar(f));break;case 16:l=s.t,l=s.size,m=s.kind,c=i.TBuffer(u,ke.SVar(f),m);break;default:throw t.thrown("assert")}a.type=c}break;case 16:if(s=o.size,l=o.kind,s._hx_index==1)if(d=s.v,u=o.t,h=this.constants.h[d.id],h!=null)if(h==null)De.t("Integer value expected for array size constant "+d.name,null);else if(h._hx_index==0)if(o=h.c,o._hx_index==2){switch(e=o.v,o=a.type,o._hx_index){case 15:s=o.t,s=o.size,c=i.TArray(u,ke.SConst(e));break;case 16:s=o.t,s=o.size,m=o.kind,c=i.TBuffer(u,ke.SConst(e),m);break;default:throw t.thrown("assert")}a.type=c}else De.t("Integer value expected for array size constant "+d.name,null);else De.t("Integer value expected for array size constant "+d.name,null);else{switch(f=this.mapVar(d,n),o=a.type,o._hx_index){case 15:s=o.t,s=o.size,c=i.TArray(u,ke.SVar(f));break;case 16:s=o.t,s=o.size,m=o.kind,c=i.TBuffer(u,ke.SVar(f),m);break;default:throw t.thrown("assert")}a.type=c}break;default:}return a},checkTextureRec:function(e){if(r.isTexture(e))return!0;switch(e._hx_index){case 13:for(var s,o,n=e.vl,t=0;t<n.length;)if(s=n[t],++t,this.checkTextureRec(s.type))return!0;return!1;case 15:return t=e.size,o=e.t,this.checkTextureRec(o);case 16:return t=e.t,t=e.size,t=e.kind,!0;default:}return!1},needsInline:function(e){for(var s,t=0,n=e.args;t<n.length;)if(s=n[t],++t,this.checkTextureRec(s.type))return!0;return!1},eval:function(e){for(var n,o,a,r,c,l,d,u,h,m,f,i=[],t=0,s=e.funs;t<s.length;){for(n=s[t],++t,l=n.kind,d=this.mapVar(n.ref,!1),o=[],a=0,c=n.args;a<c.length;)u=c[a],++a,o.push(this.mapVar(u,!1));r={kind:l,ref:d,args:o,ret:n.ret,expr:n.expr},n.kind==de.Helper&&this.inlineCalls||this.needsInline(r)?this.funMap.set(r.ref,n):i.push(r)}for(t=0,s=i.length;t<s;)h=t++,this.curFun=i[h],this.curFun.expr=this.evalExpr(this.curFun.expr,!1);for(m=e.name,t=[],s=0,o=e.vars;s<o.length;)f=o[s],++s,t.push(this.mapVar(f,!1));return{name:m,vars:t,funs:i}},hasReturn:function(e){return this.markReturn=!1,this.hasReturnLoop(e),this.markReturn},hasReturnLoop:function(e){var n,t=e.e;t._hx_index==12?(n=t.e,this.markReturn=!0):this.markReturn||r.iter(e,b(this,this.hasReturnLoop))},handleReturn:function(e,t){t==null&&(t=!1);var s,o,c,l,d,u,h,m,f,p,g,v,j,y,_,w,a=e.e;switch(a._hx_index){case 3:return d=a.e,f=this.handleReturn(d,t),{e:n.TParenthesis(f),t:f.t,p:e.p};case 4:h=a.el,l=0,m=h.length,s=[];_hx_loop1:for(;l<m;)if(o=h[l++],l==m)s.push(this.handleReturn(o,t));else switch(c=o.e,c._hx_index){case 10:if(c.eelse==null){if(u=c.eif,v=c.econd,t&&this.hasReturn(u)){s.push(this.handleReturn({e:n.TIf(v,u,{e:n.TBlock(h.slice(l)),t:o.t,p:o.p}),t:o.t,p:o.p}));break _hx_loop1}s.push(this.handleReturn(o))}else s.push(this.handleReturn(o));break;case 12:j=c.e,s.push(this.handleReturn(j,t));break _hx_loop1;default:s.push(this.handleReturn(o))}return y=t?s.length==0?i.TVoid:s[s.length-1].t:e.t,{e:n.TBlock(s),t:y,p:e.p};case 10:return _=a.econd,u=a.eif,p=a.eelse,p!=null&&t?(w=this.handleReturn(_),g=this.handleReturn(u,t),{e:n.TIf(w,g,this.handleReturn(p,t)),t:g.t,p:e.p}):r.map(e,b(this,this.handleReturnDef));break;case 12:return d=a.e,t||De.t("Cannot inline not final return",e.p),d==null?{e:n.TBlock([]),t:i.TVoid,p:e.p}:this.handleReturn(d,!0);default:return r.map(e,b(this,this.handleReturnDef))}},handleReturnDef:function(e){return this.handleReturn(e)},evalCall:function(e,s,a,r){switch(e._hx_index){case 28:if(s.length==1){var u,h,f,p,g,v,b,j,y,w,O,x,C,c=s[0],d=c.e,_=c.p,_=c.t;return d._hx_index==1?(b=d.v,c=b.type,c._hx_index==15?(d=c.t,d=c.size,d._hx_index==0?(b=d.v,n.TConst(m.CInt(b))):null):null):null}else return null;break;case 39:return s.length==1?(c=s[0],d=c.e,_=c.p,_=c.t,d._hx_index==0?(c=d.c,c._hx_index==2?(g=c.v,n.TConst(m.CFloat(g))):null):null):null;break;case 64:case 65:if(c=s[0].e,c._hx_index==0)if(d=c.c,d._hx_index==2)v=d.v,g=v;else throw De.t("Cannot eval complex channel "+Z.toString(s[0],!0)+" "+this.constantsToString(),r),t.thrown("assert");else throw De.t("Cannot eval complex channel "+Z.toString(s[0],!0)+" "+this.constantsToString(),r),t.thrown("assert");if(p=a[0],c=p.e,c._hx_index==1)b=c.v,C=n.TVar(this.mapVar(b,!1));else throw t.thrown("assert");if(p={e:C,t:p.t,p:p.p},c=p.t,c._hx_index==17)v=c.size,f=v;else throw t.thrown("assert");for(h=Y.createEnumIndex(Re,g&7,null),j=[p],c=1,d=s.length;c<d;)v=c++,j.push(s[v]);switch(j.push({e:n.TConst(m.CInt(g>>3)),t:i.TInt,p:r}),y={e:n.TCall({e:n.TGlobal(e),t:i.TVoid,p:r},j),t:i.TVoid,p:r},h._hx_index){case 0:return w={e:n.TConst(m.CFloat(0)),t:i.TFloat,p:r},f==1?w.e:n.TCall({e:n.TGlobal([l.Vec2,l.Vec3,l.Vec4][f-2]),t:i.TVoid,p:r},[w]);case 1:case 2:case 3:case 4:switch(f){case 1:switch(h._hx_index){case 1:u=[B.X];break;case 2:u=[B.Y];break;case 3:u=[B.Z];break;case 4:u=[B.W];break;default:throw t.thrown("Invalid channel value "+o.string(h)+" for "+f+" channels")}break;case 2:switch(h._hx_index){case 1:u=[B.X,B.Y];break;case 2:u=[B.Y,B.Z];break;case 3:u=[B.Z,B.W];break;default:throw t.thrown("Invalid channel value "+o.string(h)+" for "+f+" channels")}break;case 3:switch(h._hx_index){case 1:u=[B.X,B.Y,B.Z];break;case 2:u=[B.Y,B.Z,B.W];break;default:throw t.thrown("Invalid channel value "+o.string(h)+" for "+f+" channels")}break;default:throw t.thrown("Invalid channel value "+o.string(h)+" for "+f+" channels")}return n.TSwiz(y,u);case 5:return n.TCall({e:n.TGlobal(l.Unpack),t:i.TVoid,p:r},[y]);case 6:return n.TCall({e:n.TGlobal(l.UnpackNormal),t:i.TVoid,p:r},[y])}break;case 68:for(O=s,c=0;c<O.length;)x=O[c],++c,be.trace(Z.toString(x),{fileName:x.p.file,lineNumber:0,className:null,methodName:null});return n.TBlock([]);default:return null}},constantsToString:function(){for(var e,t=[],n=this.constants.keys();n.hasNext();)e=n.next(),t.push(e+" => "+Z.toString({e:this.constants.h[e],t:i.TVoid,p:null},!0));return t.toString()},ifBlock:function(e){if(e!=null){var s,o,i,t=e.e;t._hx_index==10?(i=t.econd,i=t.eif,i=t.eelse,o=!0):o=!1,s=!o}else s=!0;return s?e:{e:n.TBlock([e]),t:e.t,p:e.p}},evalExpr:function(e,s){s==null&&(s=!0);var a,r,c,u,p,g,b,y,_,O,C,A,me,T,ge,d,h,f,v,E,V,te,F,le,ce,re,S,ie,Oe,w,k,z,R,ae,M,N,L,B,W,Y,be,H,G,xe,Ce,ke,Ae,Se,he,se,ue,x,I,U,K,q,X,Q,J,ee,je,ye,_e,we,oe,ve,$,Ee,pe,fe,ne,P=this,D=e.t,j=e.e;switch(j._hx_index){case 0:a=j.c,r=e.e;break;case 1:y=j.v,O=this.constants.h[y.id],O!=null?r=O:(C=this.mapVar(y,!1),D=C.type,r=n.TVar(C));break;case 2:a=j.g,r=e.e;break;case 3:b=j.e,_=this.evalExpr(b,s),a=_.e,a._hx_index==0?(c=a.c,r=_.e):r=n.TParenthesis(_);break;case 4:for(A=j.el,me=this.mapped.length,T=[],ge=A.length-1,a=0,c=A.length;a<c;)switch(E=a++,G=s&&E==ge,b=this.evalExpr(A[E],G),f=b.e,f._hx_index){case 0:v=f.c,G&&T.push(b);break;case 1:W=f.v,G&&T.push(b);break;default:T.push(b)}for(;this.mapped.length>me;)y=this.mapped.pop(),C=this.varMap.h[y.__id__],C!=null&&(this.varMap.remove(y),this.varMap.remove(C));r=T.length==1&&this.curFun.kind!=de.Init?T[0].e:n.TBlock(T);break;case 5:switch(h=j.op,b=j.e1,_=j.e2,d=this.evalExpr(b),u=this.evalExpr(_),h._hx_index){case 0:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 2:c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p+g|0))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 3:c._hx_index==0?(a=c.c,a._hx_index==3?(g=a.v,p=f.v,r=n.TConst(m.CFloat(p+g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 1:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 2:c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p*g|0))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 3:c._hx_index==0?(a=c.c,a._hx_index==3?(g=a.v,p=f.v,r=n.TConst(m.CFloat(p*g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 2:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 2:c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p/g|0))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 3:c._hx_index==0?(a=c.c,a._hx_index==3?(g=a.v,p=f.v,r=n.TConst(m.CFloat(p/g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 3:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 2:c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p-g|0))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 3:c._hx_index==0?(a=c.c,a._hx_index==3?(g=a.v,p=f.v,r=n.TConst(m.CFloat(p-g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 4:case 21:r=n.TBinop(h,d,u);break;case 5:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 0:r=c._hx_index==0?c.c._hx_index==0?n.TConst(m.CBool(!0)):n.TConst(m.CBool(!1)):n.TBinop(h,d,u);break;case 1:if(a=f.b,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 1:g=v.b,p=a,r=n.TConst(m.CBool((p==g?0:1)==0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 2:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 2:g=v.v,p=a,r=n.TConst(m.CBool(p-g==0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 3:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 3:g=v.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)==0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 4:if(a=f.v,c._hx_index==0)switch(f=c.c,f._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 4:g=f.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)==0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break}else r=n.TBinop(h,d,u);break;case 6:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 0:r=c._hx_index==0?c.c._hx_index==0?n.TConst(m.CBool(!1)):n.TConst(m.CBool(!0)):n.TBinop(h,d,u);break;case 1:if(a=f.b,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 1:g=v.b,p=a,r=n.TConst(m.CBool((p==g?0:1)!=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 2:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 2:g=v.v,p=a,r=n.TConst(m.CBool(p-g!=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 3:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 3:g=v.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)!=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 4:if(a=f.v,c._hx_index==0)switch(f=c.c,f._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 4:g=f.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)!=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break}else r=n.TBinop(h,d,u);break;case 7:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 0:r=c._hx_index==0?c.c._hx_index==0?n.TConst(m.CBool(!1)):n.TConst(m.CBool(!1)):n.TBinop(h,d,u);break;case 1:if(a=f.b,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 1:g=v.b,p=a,r=n.TConst(m.CBool((p==g?0:1)>0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 2:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 2:g=v.v,p=a,r=n.TConst(m.CBool(p-g>0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 3:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 3:g=v.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)>0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 4:if(a=f.v,c._hx_index==0)switch(f=c.c,f._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 4:g=f.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)>0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break}else r=n.TBinop(h,d,u);break;case 8:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 0:r=c._hx_index==0?c.c._hx_index==0?n.TConst(m.CBool(!0)):n.TConst(m.CBool(!1)):n.TBinop(h,d,u);break;case 1:if(a=f.b,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 1:g=v.b,p=a,r=n.TConst(m.CBool((p==g?0:1)>=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 2:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 2:g=v.v,p=a,r=n.TConst(m.CBool(p-g>=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 3:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 3:g=v.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)>=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 4:if(a=f.v,c._hx_index==0)switch(f=c.c,f._hx_index){case 0:r=n.TConst(m.CBool(!0));break;case 4:g=f.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)>=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break}else r=n.TBinop(h,d,u);break;case 9:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 0:r=c._hx_index==0?c.c._hx_index==0?n.TConst(m.CBool(!1)):n.TConst(m.CBool(!0)):n.TBinop(h,d,u);break;case 1:if(a=f.b,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 1:g=v.b,p=a,r=n.TConst(m.CBool((p==g?0:1)<0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 2:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 2:g=v.v,p=a,r=n.TConst(m.CBool(p-g<0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 3:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 3:g=v.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)<0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 4:if(a=f.v,c._hx_index==0)switch(f=c.c,f._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 4:g=f.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)<0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break}else r=n.TBinop(h,d,u);break;case 10:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 0:r=c._hx_index==0?c.c._hx_index==0?n.TConst(m.CBool(!0)):n.TConst(m.CBool(!0)):n.TBinop(h,d,u);break;case 1:if(a=f.b,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 1:g=v.b,p=a,r=n.TConst(m.CBool((p==g?0:1)<=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 2:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 2:g=v.v,p=a,r=n.TConst(m.CBool(p-g<=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 3:if(a=f.v,c._hx_index==0)switch(v=c.c,v._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 3:g=v.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)<=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 4:if(a=f.v,c._hx_index==0)switch(f=c.c,f._hx_index){case 0:r=n.TConst(m.CBool(!1));break;case 4:g=f.v,p=a,r=n.TConst(m.CBool((p>g?1:p==g?0:-1)<=0));break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break}else r=n.TBinop(h,d,u);break;case 11:a=d.e,c=u.e,a._hx_index==0?(f=a.c,f._hx_index==2?c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p&g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 12:a=d.e,c=u.e,a._hx_index==0?(f=a.c,f._hx_index==2?c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p|g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 13:a=d.e,c=u.e,a._hx_index==0?(f=a.c,f._hx_index==2?c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p^g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 14:a=d.e,c=u.e,a._hx_index==0?(f=a.c,f._hx_index==1?(a=f.b,c._hx_index==0?(f=c.c,f._hx_index==1?(g=f.b,p=a,r=n.TConst(m.CBool(p&&g))):(p=a,r=p==!1?n.TConst(m.CBool(p)):u.e)):(p=a,r=p==!1?n.TConst(m.CBool(p)):u.e)):c._hx_index==0?(a=c.c,a._hx_index==1?(p=a.b,r=p==!1?n.TConst(m.CBool(p)):d.e):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u)):c._hx_index==0?(a=c.c,a._hx_index==1?(p=a.b,r=p==!1?n.TConst(m.CBool(p)):d.e):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 15:a=d.e,c=u.e,a._hx_index==0?(f=a.c,f._hx_index==1?(a=f.b,c._hx_index==0?(f=c.c,f._hx_index==1?(g=f.b,p=a,r=n.TConst(m.CBool(p||g))):(p=a,r=p==!0?n.TConst(m.CBool(p)):u.e)):(p=a,r=p==!0?n.TConst(m.CBool(p)):u.e)):c._hx_index==0?(a=c.c,a._hx_index==1?(p=a.b,r=p==!0?n.TConst(m.CBool(p)):d.e):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u)):c._hx_index==0?(a=c.c,a._hx_index==1?(p=a.b,r=p==!0?n.TConst(m.CBool(p)):d.e):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 16:a=d.e,c=u.e,a._hx_index==0?(f=a.c,f._hx_index==2?c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p<<g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 17:a=d.e,c=u.e,a._hx_index==0?(f=a.c,f._hx_index==2?c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p>>g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 18:a=d.e,c=u.e,a._hx_index==0?(f=a.c,f._hx_index==2?c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p>>>g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 19:if(a=d.e,c=u.e,a._hx_index==0)switch(f=a.c,f._hx_index){case 2:c._hx_index==0?(a=c.c,a._hx_index==2?(g=a.v,p=f.v,r=n.TConst(m.CInt(p%g|0))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;case 3:c._hx_index==0?(a=c.c,a._hx_index==3?(g=a.v,p=f.v,r=n.TConst(m.CFloat(p%g))):r=n.TBinop(h,d,u)):r=n.TBinop(h,d,u);break;default:r=n.TBinop(h,d,u)}else r=n.TBinop(h,d,u);break;case 20:a=h.op,r=n.TBinop(h,d,u);break;default:throw t.thrown("assert")}break;case 6:if(h=j.op,b=j.e1,_=this.evalExpr(b),a=_.e,a._hx_index==0)switch(O=a.c,h._hx_index){case 2:O._hx_index==1?(g=O.b,r=n.TConst(m.CBool(!g))):r=n.TUnop(h,_);break;case 3:switch(O._hx_index){case 2:E=O.v,r=n.TConst(m.CInt(-E));break;case 3:V=O.v,r=n.TConst(m.CFloat(-V));break;default:r=n.TUnop(h,_)}break;default:r=n.TUnop(h,_)}else r=n.TUnop(h,_);break;case 7:y=j.v,te=j.init,r=n.TVarDecl(this.mapVar(y,!0),te==null?null:this.evalExpr(te));break;case 8:for(O=j.e,Y=j.args,z=this.evalExpr(O),a=[],c=0;c<Y.length;)p=Y[c],++c,a.push(this.evalExpr(p));switch(F=a,a=z.e,a._hx_index){case 1:if(y=a.v,this.funMap.h.__keys__[y.__id__]!=null){for(V=this.funMap.h[y.__id__],B=[],N=[],c=0,f=V.args.length;c<f;)switch(E=c++,y=[V.args[E]],b=F[E],v=b.e,v._hx_index){case 0:W=v.c,be=[this.constants.h[y[0].id]],N.push(function(e,t){return function(){e[0]==null?P.constants.remove(t[0].id):P.constants.h[t[0].id]=e[0]}}(be,y)),this.constants.h[y[0].id]=b.e;break;case 1:switch(H=v.v,xe=H.id,Ce=H.name,ke=H.parent,Ae=H.qualifiers,Se=H.type,H.kind._hx_index){case 0:case 1:case 2:he=[this.constants.h[y[0].id]],N.push(function(e,t){return function(){e[0]==null?P.constants.remove(t[0].id):P.constants.h[t[0].id]=e[0]}}(he,y)),this.constants.h[y[0].id]=b.e;break;default:Q=[this.varMap.h[y[0].__id__]],Q[0]==null?N.push(function(e){return function(){P.varMap.remove(e[0])}}(y)):(this.varMap.remove(y[0]),N.push(function(e,t){return function(){P.varMap.set(t[0],e[0])}}(Q,y))),C=this.mapVar(y[0],!1),B.push({e:n.TVarDecl(C,b),t:i.TVoid,p:b.p})}break;default:J=[this.varMap.h[y[0].__id__]],J[0]==null?N.push(function(e){return function(){P.varMap.remove(e[0])}}(y)):(this.varMap.remove(y[0]),N.push(function(e,t){return function(){P.varMap.set(t[0],e[0])}}(J,y))),le=this.mapVar(y[0],!1),B.push({e:n.TVarDecl(le,b),t:i.TVoid,p:b.p})}for(b=this.handleReturn(this.evalExpr(V.expr,!1),!0),c=0;c<N.length;)ce=N[c],++c,ce();if(c=b.e,c._hx_index==4)for(A=c.el,c=0;c<A.length;)_=A[c],++c,B.push(_);else B.push(b);r=n.TBlock(B)}else r=n.TCall(z,F);break;case 2:re=a.g,S=this.evalCall(re,F,Y,e.p),r=S??n.TCall(z,F);break;default:r=De.t("Cannot eval non-static call expresssion '"+(new Z).exprString(z)+"'",z.p)}break;case 9:b=j.e,ie=j.regs,r=n.TSwiz(this.evalExpr(b),ie.slice());break;case 10:Oe=j.econd,k=j.eif,w=j.eelse,R=this.evalExpr(Oe),a=R.e,a._hx_index==0?(c=a.c,c._hx_index==1?(g=c.b,r=g?this.evalExpr(k,s).e:w==null?n.TConst(m.CNull):this.evalExpr(w,s).e):s&&w!=null&&this.eliminateConditionals?r=n.TCall({e:n.TGlobal(l.Mix),t:e.t,p:e.p},[this.evalExpr(w,!0),this.evalExpr(k,!0),{e:n.TCall({e:n.TGlobal(l.ToFloat),t:i.TFun([]),p:R.p},[R]),t:i.TFloat,p:e.p}]):(k=this.evalExpr(k,s),w!=null&&(w=this.evalExpr(w,s),a=w.e,a._hx_index==0&&a.c._hx_index==0&&(w=null)),k=this.ifBlock(k),w=this.ifBlock(w),r=n.TIf(R,k,w))):s&&w!=null&&this.eliminateConditionals?r=n.TCall({e:n.TGlobal(l.Mix),t:e.t,p:e.p},[this.evalExpr(w,!0),this.evalExpr(k,!0),{e:n.TCall({e:n.TGlobal(l.ToFloat),t:i.TFun([]),p:R.p},[R]),t:i.TFloat,p:e.p}]):(k=this.evalExpr(k,s),w!=null&&(w=this.evalExpr(w,s),a=w.e,a._hx_index==0&&a.c._hx_index==0&&(w=null)),k=this.ifBlock(k),w=this.ifBlock(w),r=n.TIf(R,k,w));break;case 11:r=n.TDiscard;break;case 12:b=j.e,r=n.TReturn(b==null?null:this.evalExpr(b));break;case 13:if(S=j.v,ae=j.it,M=j.loop,C=this.mapVar(S,!0),L=this.evalExpr(ae),a=L.e,a._hx_index==5)if(c=a.e1,f=a.e2,a.op._hx_index==21)if(a=c.e,v=c.p,v=c.t,a._hx_index==0)if(c=a.c,c._hx_index==2)if(a=f.e,v=f.p,v=f.t,a._hx_index==0)if(f=a.c,f._hx_index==2)if(se=f.v,ue=c.v,this.unrollLoops){for(T=[],a=ue,c=se;a<c;)E=a++,this.constants.h[S.id]=n.TConst(m.CInt(E)),T.push(this.evalExpr(M,!1));this.constants.remove(S.id),b=n.TBlock(T)}else b=n.TFor(C,L,this.ifBlock(this.evalExpr(M,!1)));else b=n.TFor(C,L,this.ifBlock(this.evalExpr(M,!1)));else b=n.TFor(C,L,this.ifBlock(this.evalExpr(M,!1)));else b=n.TFor(C,L,this.ifBlock(this.evalExpr(M,!1)));else b=n.TFor(C,L,this.ifBlock(this.evalExpr(M,!1)));else b=n.TFor(C,L,this.ifBlock(this.evalExpr(M,!1)));else b=n.TFor(C,L,this.ifBlock(this.evalExpr(M,!1)));this.varMap.remove(S),r=b;break;case 14:r=n.TContinue;break;case 15:r=n.TBreak;break;case 16:if(b=j.e,_=j.index,d=this.evalExpr(b),u=this.evalExpr(_),a=d.e,c=u.e,a._hx_index==17)if(c._hx_index==0)if(f=c.c,f._hx_index==2)if(E=f.v,A=a.el,E>=0&&E<A.length)r=A[E].e;else{switch(a=d.t,a._hx_index){case 15:c=a.size,x=a.t,D=x;break;case 16:c=a.size,c=a.kind,x=a.t,D=x;break;default:}r=n.TArray(d,u)}else{switch(a=d.t,a._hx_index){case 15:c=a.size,x=a.t,D=x;break;case 16:c=a.size,c=a.kind,x=a.t,D=x;break;default:}r=n.TArray(d,u)}else{switch(a=d.t,a._hx_index){case 15:c=a.size,x=a.t,D=x;break;case 16:c=a.size,c=a.kind,x=a.t,D=x;break;default:}r=n.TArray(d,u)}else{switch(a=d.t,a._hx_index){case 15:c=a.size,x=a.t,D=x;break;case 16:c=a.size,c=a.kind,x=a.t,D=x;break;default:}r=n.TArray(d,u)}break;case 17:for(A=j.el,a=[],c=0;c<A.length;)b=A[c],++c,a.push(this.evalExpr(b));r=n.TArrayDecl(a);break;case 18:for(b=j.e,I=j.cases,X=j.def,_=this.evalExpr(b),a=[],c=0;c<I.length;){for(O=I[c],++c,f=[],v=0,W=O.values;v<W.length;)S=W[v],++v,f.push(this.evalExpr(S));a.push({values:f,expr:this.evalExpr(O.expr,s)})}if(I=a,U=X==null?null:this.evalExpr(X,s),K=!1,a=_.e,a._hx_index==0)if(O=a.c,O._hx_index==2)for(ee=O.v,a=0;a<I.length;)for(z=I[a],++a,c=0,f=z.values;c<f.length;)if(S=f[c],++c,v=S.e,v._hx_index==0)switch(q=v.c,q._hx_index){case 2:if(je=q.v,je==ee)return z.expr;break;case 3:if(ye=q.v,ye==ee)return z.expr;break;default:}else K=!0;else throw t.thrown("Unsupported switch constant "+o.string(O));else K=!0;r=K?n.TSwitch(_,I,U):U==null?n.TBlock([]):U.e;break;case 19:_e=j.e,M=j.loop,we=j.normalWhile,oe=this.evalExpr(_e),ve=this.evalExpr(M,!1),r=n.TWhile(oe,this.ifBlock(ve),we);break;case 20:$=j.m,F=j.args,b=j.e,$=="unroll"?(Ee=this.unrollLoops,this.unrollLoops=!0,_=this.evalExpr(b,s),this.unrollLoops=!1):_=this.evalExpr(b,s),r=n.TMeta($,F,_);break;case 21:b=j.e,$=j.name,r=n.TField(this.evalExpr(b),$);break;case 22:for(pe=j.target,fe=j.code,F=j.args,j=[],a=0;a<F.length;)ne=F[a],++a,j.push({e:this.evalExpr(ne.e),access:ne.access});r=n.TSyntax(pe,fe,j);break}return{e:r,t:D,p:e.p}},__class__:Sc},is=function(e,t,n,s){this.g=e,this.t=t,this.pos=n,this.size=s},c["hxsl._Flatten.Alloc"]=is,is.__name__="hxsl._Flatten.Alloc",is.prototype={__class__:is},yo=_["hxsl.ARead"]={__ename__:!0,__constructs__:null,AIndex:(a=function(e){return{_hx_index:0,a:e,__enum__:"hxsl.ARead",toString:s}},a._hx_name="AIndex",a.__params__=["a"],a),AOffset:(a=function(e,t,n){return{_hx_index:1,a:e,stride:t,delta:n,__enum__:"hxsl.ARead",toString:s}},a._hx_name="AOffset",a.__params__=["a","stride","delta"],a)},yo.__constructs__=[yo.AIndex,yo.AOffset],yo.__empty_constructs__=[],ft=function(){},c["hxsl.Flatten"]=ft,ft.__name__="hxsl.Flatten",ft.prototype={flatten:function(e,n){this.globals=[],this.params=[],this.outVars=[],this.textureFormats=[],this.varMap=new Rt,this.allocData=new Rt;for(var s,r,c,l,d,h,m,f,p,o=0,a=e.vars;o<a.length;)m=a[o],++o,this.gatherVar(m);switch(n._hx_index){case 0:r="vertex";break;case 1:r="fragment";break;case 4:r="compute";break;default:throw t.thrown("assert")}for(this.pack(r+"Globals",O.Global,this.globals,v.VFloat),this.pack(r+"Params",O.Param,this.params,v.VFloat),l=this.globals.concat(this.params),this.textureFormats.sort(function(e,t){return e.rw!=t.rw?e.rw-t.rw:e.arr!=t.arr?e.arr?1:-1:e.dim._hx_index-t.dim._hx_index}),o=0,a=this.textureFormats;o<a.length;)s=a[o],++o,s.dim==Ke.T2D?c="":(d=s.dim,c=u.substr(_[d.__enum__].__constructs__[d._hx_index]._hx_name,1,null)),s.rw>0&&(c="RW"+c+s.rw),s.arr&&(c+="Array"),this.packTextures(r+"Textures"+c,l,s.rw==0?i.TSampler(s.dim,s.arr):i.TRWTexture(s.dim,s.arr,s.rw));for(this.packBuffers("buffers",l,Qe.Uniform),this.packBuffers("storagebuffers",l,Qe.Storage),this.packBuffers("rwbuffers",l,Qe.RW),o=[],a=0,h=e.funs;a<h.length;)f=h[a],++a,o.push(this.mapFun(f,b(this,this.mapExpr)));return p=o,{name:e.name,vars:this.outVars,funs:p}},mapFun:function(e,t){return{kind:e.kind,ret:e.ret,args:e.args,ref:e.ref,expr:t(e.expr)}},mkOp:function(e,t,s,o,a){var r,l,c=e.e;return c._hx_index==0&&(r=c.c,r._hx_index==2)?(l=r.v,{e:n.TConst(m.CInt(s(l,t))),t:i.TInt,p:a}):{e:n.TBinop(o,e,{e:n.TConst(m.CInt(t)),t:i.TInt,p:a}),t:i.TInt,p:a}},mkAdd:function(e,t,n){return t==0?e:this.mkOp(e,t,function(e,t){return e+t},T.OpAdd,n)},mkMult:function(e,t,n){return t==1?e:this.mkOp(e,t,function(e,t){return e*t},T.OpMult,n)},mapExpr:function(e){var s,o,a,c,d,u,h,f,p,g,y,_,w,x,C,E,k,A,S,M,F,z,D,N,L,R,P,H,I,B,V,O=this,j=e.e;switch(j._hx_index){case 1:g=j.v,w=this.varMap.h[g.__id__],w!=null&&(e=this.access(w,g.type,e.p,yo.AIndex(w)));break;case 5:if(j.op._hx_index==4)if(o=j.e1,f=j.e2,e.t._hx_index==7?(c=o.e,c._hx_index==21?(p=c.e,p=c.name,y=!0):y=!1):y=!1,y)if(c=o.e,p=o.p,c._hx_index==21)if(o.t._hx_index==7){if(P=c.name,L=c.e,s=-1,c=L.t,c._hx_index==13)for(N=c.vl,M=0,c=0;c<N.length;){if(g=N[c],++c,g.name==P){s=M;break}M+=r.size(g.type)}if(s<0)throw t.thrown("assert");d=s,_=this.mapExpr(L),u=d>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(d&3)==0?o=a:(h=ft.SWIZ.slice(d&3,(d&3)+4),o={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),y={e:n.TBinop(T.OpAssign,o,{e:n.TArray(f,{e:n.TConst(m.CInt(0)),t:i.TInt,p:null}),t:i.TVec(4,v.VFloat),p:null}),t:e.t,p:e.p},s=d+4,u=s>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(s&3)==0?o=a:(h=ft.SWIZ.slice(s&3,(s&3)+4),o={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),k={e:n.TBinop(T.OpAssign,o,{e:n.TArray(f,{e:n.TConst(m.CInt(1)),t:i.TInt,p:null}),t:i.TVec(4,v.VFloat),p:null}),t:e.t,p:e.p},s=d+8,u=s>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(s&3)==0?o=a:(h=ft.SWIZ.slice(s&3,(s&3)+4),o={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),F={e:n.TBinop(T.OpAssign,o,{e:n.TArray(f,{e:n.TConst(m.CInt(2)),t:i.TInt,p:null}),t:i.TVec(4,v.VFloat),p:null}),t:e.t,p:e.p},s=d+12,u=s>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(s&3)==0?o=a:(h=ft.SWIZ.slice(s&3,(s&3)+4),o={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),e={e:n.TBlock([y,k,F,{e:n.TBinop(T.OpAssign,o,{e:n.TArray(f,{e:n.TConst(m.CInt(3)),t:i.TInt,p:null}),t:i.TVec(4,v.VFloat),p:null}),t:e.t,p:e.p}]),t:e.t,p:e.p}}else throw t.thrown("assert");else throw t.thrown("assert");else e=r.map(e,b(this,this.mapExpr));else e=r.map(e,b(this,this.mapExpr));break;case 7:g=j.v,V=j.init,c=g.type,c._hx_index==13?(p=c.vl,o=!0):o=!1,o?(C=Math.ceil(r.size(g.type)/4),I={id:r.allocVarId(),name:g.name,type:i.TArray(i.TVec(4,v.VFloat),ke.SConst(C)),kind:g.kind,qualifiers:g.qualifiers},w=new is(I,v.VFloat,0,0),w.v=g,this.varMap.set(g,w),e={e:n.TVarDecl(I,V==null?null:this.mapExpr(V)),t:i.TVoid,p:e.p}):e=r.map(e,b(this,this.mapExpr));break;case 16:if(c=j.e,p=c.e,z=c.t,p._hx_index==1)if(g=p.v,D=c.p,E=j.index,w=this.varMap.h[g.__id__],w!=null?(c=g.type,c._hx_index==16?(p=c.t,p=c.size,p=c.kind,f=!0):f=!1,f?o=!1:(c=E.e,c._hx_index==0?(p=c.c,p._hx_index==2?(c=p.v,o=!0):o=!1):o=!1)):o=!0,o)e=r.map(e,b(this,this.mapExpr));else switch(c=g.type,c._hx_index){case 5:switch(p=c.size,c.t._hx_index){case 0:case 1:e=r.map(e,b(this,this.mapExpr));break;default:throw t.thrown("assert")}break;case 15:if(p=c.t,z=c.size,A=p,r.isTexture(A))E=this.toInt(this.mapExpr(E)),e=this.access(w,A,D,yo.AOffset(w,1,E));else{if(A=p,x=this.varSize4Bytes(A,w.t),x!=0?(p=g.type,p._hx_index==15?(z=p.t,z=p.size,f=!0):f=!1,o=f&&(x&3)!=0):o=!0,o)throw t.thrown(new De("Dynamic access to an Array which size is not 4 components-aligned is not allowed",e.p));x=x+3>>2,E=this.toInt(this.mapExpr(E)),e=this.access(w,A,D,yo.AOffset(w,x,this.mkMult(E,x,D)))}break;case 16:switch(p=c.t,z=c.size,z=c.kind,p._hx_index){case 1:case 3:e=r.map(e,b(this,this.mapExpr));break;default:if(A=p,x=this.varSize4Bytes(A,w.t),x!=0?(c=g.type,c._hx_index==15?(p=c.t,p=c.size,f=!0):f=!1,o=f&&(x&3)!=0):o=!0,o)throw t.thrown(new De("Dynamic access to an Array which size is not 4 components-aligned is not allowed",e.p));x=x+3>>2,E=this.toInt(this.mapExpr(E)),e=this.access(w,A,D,yo.AOffset(w,x,this.mkMult(E,x,D)))}break;default:throw t.thrown("assert")}else e=r.map(e,b(this,this.mapExpr));break;case 21:if(L=j.e,P=j.name,s=-1,j=L.t,j._hx_index==13)for(N=j.vl,M=0,j=0;j<N.length;){if(g=N[j],++j,g.name==P){s=M;break}M+=r.size(g.type)}if(s<0)throw t.thrown("assert");switch(d=s,_=this.mapExpr(L),j=e.t,j._hx_index){case 3:u=d>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),h=ft.SWIZ.slice(d&3,(d&3)+1),e={e:n.TSwiz(a,h),t:i.TFloat,p:e.p};break;case 5:if(j.t._hx_index==1)if(C=j.size,u=d>>2,B=d+C-1>>2,u==B)u=d>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),C==4&&(d&3)==0?e=a:(h=ft.SWIZ.slice(d&3,(d&3)+C),e={e:n.TSwiz(a,h),t:C==1?i.TFloat:i.TVec(C,v.VFloat),p:e.p});else{switch(S=(B<<2)-d,C){case 2:H=l.Vec2;break;case 3:H=l.Vec3;break;case 4:H=l.Vec4;break;default:throw t.thrown("assert")}o={e:n.TGlobal(H),p:e.p,t:i.TVoid},u=d>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),S==4&&(d&3)==0?f=a:(h=ft.SWIZ.slice(d&3,(d&3)+S),f={e:n.TSwiz(a,h),t:S==1?i.TFloat:i.TVec(S,v.VFloat),p:e.p}),s=d+S,R=C-S,u=s>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),R==4&&(s&3)==0?y=a:(h=ft.SWIZ.slice(s&3,(s&3)+R),y={e:n.TSwiz(a,h),t:R==1?i.TFloat:i.TVec(R,v.VFloat),p:e.p}),e={e:n.TCall(o,[f,y]),t:e.t,p:e.p}}else throw t.thrown("Unsupported type "+r.toString(e.t));break;case 7:o={e:n.TGlobal(l.Mat4),p:e.p,t:i.TVoid},u=d>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(d&3)==0?f=a:(h=ft.SWIZ.slice(d&3,(d&3)+4),f={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),s=d+4,u=s>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(s&3)==0?y=a:(h=ft.SWIZ.slice(s&3,(s&3)+4),y={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),s=d+8,u=s>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(s&3)==0?k=a:(h=ft.SWIZ.slice(s&3,(s&3)+4),k={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),s=d+12,u=s>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(s&3)==0?F=a:(h=ft.SWIZ.slice(s&3,(s&3)+4),F={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),e={e:n.TCall(o,[f,y,k,F]),t:e.t,p:e.p};break;case 8:o={e:n.TGlobal(l.Mat3x4),p:e.p,t:i.TVoid},u=d>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(d&3)==0?f=a:(h=ft.SWIZ.slice(d&3,(d&3)+4),f={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),s=d+4,u=s>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(s&3)==0?y=a:(h=ft.SWIZ.slice(s&3,(s&3)+4),y={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),s=d+8,u=s>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),(s&3)==0?k=a:(h=ft.SWIZ.slice(s&3,(s&3)+4),k={e:n.TSwiz(a,h),t:i.TVec(4,v.VFloat),p:e.p}),e={e:n.TCall(o,[f,y,k]),t:e.t,p:e.p};break;case 9:C=j.size,o={e:n.TGlobal(l.UnpackSnorm4x8),p:e.p,t:i.TVec(C,v.VFloat)},u=d>>2,a=O.optimize({e:n.TArray(_,{e:n.TConst(m.CInt(u)),p:e.p,t:i.TInt}),p:e.p,t:i.TVec(4,v.VFloat)}),h=ft.SWIZ.slice(d&3,(d&3)+1),e={e:n.TCall(o,[this.floatBitsToUint({e:n.TSwiz(a,h),t:i.TFloat,p:e.p})]),t:e.t,p:e.p};break;default:throw t.thrown("Unsupported type "+r.toString(e.t))}break;default:e=r.map(e,b(this,this.mapExpr))}return this.optimize(e)},mkInt:function(e,t){return{e:n.TConst(m.CInt(e)),t:i.TInt,p:t}},readIndex:function(e,t,s){var o=e.t==null?e.pos:e.pos>>2;return{e:n.TArray({e:n.TVar(e.g),t:e.g.type,p:s},{e:n.TConst(m.CInt(o+t)),t:i.TInt,p:s}),t:i.TVec(4,e.t),p:s}},readOffset:function(e,t,s,o,a){var c,l,d,r=e.g.type;return r._hx_index==16?(l=r.t,l=r.size,l=r.kind,c=o):c=(e.t==null?e.pos:e.pos>>2)+o,d=this.mkAdd(s,c,a),{e:n.TArray({e:n.TVar(e.g),t:e.g.type,p:a},d),t:i.TVec(4,e.t),p:a}},access:function(e,t,s,o){var a,c,d,u,h,f,p,g,b,j,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,y=this;switch(t._hx_index){case 6:return w=this.access(e,i.TMat3x4,s,o),{e:n.TCall({e:n.TGlobal(l.Mat3),t:i.TFun([]),p:s},[w]),t:i.TMat3,p:s};case 7:switch(w={e:n.TGlobal(l.Mat4),t:i.TFun([]),p:s},o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,C={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=0):d=a.t==null?a.pos:a.pos>>2,g=y.mkAdd(p,d,s),C={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}switch(o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,k={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f+1)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=1):d=(a.t==null?a.pos:a.pos>>2)+1,g=y.mkAdd(p,d,s),k={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}switch(o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,E={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f+2)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=2):d=(a.t==null?a.pos:a.pos>>2)+2,g=y.mkAdd(p,d,s),E={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}switch(o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,D={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f+3)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=3):d=(a.t==null?a.pos:a.pos>>2)+3,g=y.mkAdd(p,d,s),D={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}return{e:n.TCall(w,[C,k,E,D]),t:i.TMat4,p:s};case 8:switch(w={e:n.TGlobal(l.Mat3x4),t:i.TFun([]),p:s},o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,C={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=0):d=a.t==null?a.pos:a.pos>>2,g=y.mkAdd(p,d,s),C={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}switch(o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,k={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f+1)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=1):d=(a.t==null?a.pos:a.pos>>2)+1,g=y.mkAdd(p,d,s),k={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}switch(o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,E={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f+2)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=2):d=(a.t==null?a.pos:a.pos>>2)+2,g=y.mkAdd(p,d,s),E={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}return{e:n.TCall(w,[C,k,E]),t:i.TMat3x4,p:s};case 13:for(z=t.vl,b=0,c=0;c<z.length;)N=z[c],++c,b+=this.varSize(N.type,e.t);for(j=Math.ceil(b/4),c=[],u=0,M=j;u<M;){switch(_=u++,o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,w={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f+_)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:x=o.a,L=o.stride,p=o.delta,S=x.g.type,S._hx_index==16?(R=S.t,P=S.size,H=S.kind,d=_):d=(x.t==null?x.pos:x.pos>>2)+_,g=y.mkAdd(p,d,s),w={e:n.TArray({e:n.TVar(x.g),t:x.g.type,p:s},g),t:i.TVec(4,x.t),p:s};break}c.push(w)}return F=c,{e:n.TArrayDecl(F),t:i.TArray(i.TVec(4,v.VFloat),ke.SConst(j)),p:s};case 15:if(c=t.size,c._hx_index==0){for(T=c.v,O=t.t,j=e.size/T|0,c=[],u=0,M=T;u<M;)_=u++,a=new is(e.g,e.t,e.pos+j*_,j),c.push(this.access(a,O,s,yo.AIndex(a)));return F=c,{e:n.TArrayDecl(F),t:O,p:s}}if(O=t,r.isTexture(O)){switch(o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,h={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=0):d=a.t==null?a.pos:a.pos>>2,g=y.mkAdd(p,d,s),h={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}return h.t=O,h}if(b=this.varSize(t,e.t),b>4)return De.t("Access not supported for "+r.toString(t),null);switch(o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,h={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=0):d=a.t==null?a.pos:a.pos>>2,g=y.mkAdd(p,d,s),h={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}if(b==4){if(e.pos==-1)return{e:n.TCall({e:n.TGlobal(l.Vec4),t:i.TFun([]),p:s},[{e:n.TConst(m.CFloat(0)),t:i.TFloat,p:s}]),t:i.TVec(4,v.VFloat),p:s}}else{for(A=[],c=0,u=b;c<u;)_=c++,A.push(r.SWIZ[_+(e.pos&3)]);h={e:n.TSwiz(h,A),t,p:s}}switch(t._hx_index){case 1:h.t=i.TFloat,h=this.toInt(h);break;case 5:t.t._hx_index==0&&(b=t.size,h.t=i.TVec(b,v.VFloat),h={e:n.TCall({e:n.TGlobal([l.IVec2,l.IVec3,l.IVec4][b-2]),t:i.TFun([]),p:s},[h]),t,p:s});break;default:}return h;break;case 16:return c=t.t,c=t.size,c=t.kind,{e:n.TVar(e.g),t,p:s};default:if(O=t,r.isTexture(O)){switch(o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,h={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=0):d=a.t==null?a.pos:a.pos>>2,g=y.mkAdd(p,d,s),h={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}return h.t=O,h}if(b=this.varSize(t,e.t),b>4)return De.t("Access not supported for "+r.toString(t),null);switch(o._hx_index){case 0:a=o.a,f=a.t==null?a.pos:a.pos>>2,h={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},{e:n.TConst(m.CInt(f)),t:i.TInt,p:s}),t:i.TVec(4,a.t),p:s};break;case 1:a=o.a,j=o.stride,p=o.delta,c=a.g.type,c._hx_index==16?(u=c.t,u=c.size,u=c.kind,d=0):d=a.t==null?a.pos:a.pos>>2,g=y.mkAdd(p,d,s),h={e:n.TArray({e:n.TVar(a.g),t:a.g.type,p:s},g),t:i.TVec(4,a.t),p:s};break}if(b==4){if(e.pos==-1)return{e:n.TCall({e:n.TGlobal(l.Vec4),t:i.TFun([]),p:s},[{e:n.TConst(m.CFloat(0)),t:i.TFloat,p:s}]),t:i.TVec(4,v.VFloat),p:s}}else{for(A=[],c=0,u=b;c<u;)_=c++,A.push(r.SWIZ[_+(e.pos&3)]);h={e:n.TSwiz(h,A),t,p:s}}switch(t._hx_index){case 1:h.t=i.TFloat,h=this.toInt(h);break;case 5:t.t._hx_index==0&&(b=t.size,h.t=i.TVec(b,v.VFloat),h={e:n.TCall({e:n.TGlobal([l.IVec2,l.IVec3,l.IVec4][b-2]),t:i.TFun([]),p:s},[h]),t,p:s});break;default:}return h}},floatBitsToUint:function(e){return{e:n.TCall({e:n.TGlobal(l.FloatBitsToUint),t:i.TFun([]),p:e.p},[e]),t:i.TInt,p:e.p}},toInt:function(e){return e.t==i.TInt?e:{e:n.TCall({e:n.TGlobal(l.ToInt),t:i.TFun([]),p:e.p},[e]),t:i.TInt,p:e.p}},optimize:function(e){var s,o,i,r,c,l,d,u,h,m,f,p,a=e.e;switch(a._hx_index){case 8:if(s=a.e,o=a.args,i=s.e,u=s.p,u=s.t,i._hx_index==2&&i.g._hx_index==53&&o.length==1&&(s=o[0],o=s.e,i=s.p,i=s.t,o._hx_index==8&&(s=o.e,i=s.e,u=s.p,u=s.t,i._hx_index==2&&i.g._hx_index==52))){for(c=o.args,l=0,d=0;d<4;)m=c[c.length-1-l].t,d+=this.varSize(m,v.VFloat),++l;if(d==4){for(s=0,o=l;s<o;)r=s++,c.pop();if(s=e.e,s._hx_index==8)o=s.args,p=s.e,f=p;else throw t.thrown("assert");return{e:n.TCall(f,c),t:e.t,p:e.p}}}break;case 16:if(s=a.e,o=a.index,a=s.e,i=s.p,i=s.t,a._hx_index==17&&(s=o.e,i=o.p,i=o.t,s._hx_index==0&&(o=s.c,o._hx_index==2))){if(r=o.v,h=a.el,r>=0&&r<h.length)return h[r];De.t("Reading outside array bounds",e.p)}break;default:}return e},packTextures:function(e,t,n){for(var e,o,a,l,h,m,p,g,v,b,j,y,_,w,x,f=[],s={id:r.allocVarId(),name:e,type:n,kind:O.Param},d=0,u=[],c=0;c<t.length;){if(o=t[c],++c,h=1,!Y.enumEq(o.type,n))switch(a=o.type,a._hx_index){case 15:if(j=a.size,j._hx_index==0)if(y=j.v,_=a.t,Y.enumEq(_,n))h=y;else continue;else continue;break;case 17:if(x=a.size,n._hx_index!=10||n.dim._hx_index!=1||n.isArray!=!1)continue;break;default:continue}if(m=new is(s,null,d,h),m.v=o,o.qualifiers!=null)for(p=0,g=o.qualifiers;p<g.length;)if(v=g[p],++p,v._hx_index==12)for(e=v.name,b=0,w=h;b<w;)l=b++,u[d+l]=e;this.varMap.set(o,m),f.push(m),d+=h}if(s.type=i.TArray(n,ke.SConst(d)),u.length>0){for(c=0,a=d;c<a;)l=c++,u[l]==null&&(u[l]="");s.qualifiers==null&&(s.qualifiers=[]),s.qualifiers.push(I.Sampler(u.join(",")))}return f.length>0&&(this.outVars.push(s),this.allocData.set(s,f)),f},packBuffers:function(e,t,n){for(var s,o,a,l,d,u,h,f,p,g,b,c=[],j={id:r.allocVarId(),name:e,type:i.TVoid,kind:O.Param},m=0;m<t.length;)if(s=t[m],++m,a=s.type,a._hx_index==16&&(u=a.size,u._hx_index==0&&(d=u.v,h=a.t,l=a.kind,n==l))){switch(f=Math.ceil(r.size(h)/4),h._hx_index){case 1:case 3:switch(n._hx_index){case 1:case 2:case 4:case 5:g=!0;break;default:g=!1}p=g?s.type:i.TBuffer(i.TVec(4,v.VFloat),ke.SConst(d*f),l);break;default:p=i.TBuffer(i.TVec(4,v.VFloat),ke.SConst(d*f),l)}b={id:r.allocVarId(),name:s.name,type:p,kind:O.Param},o=new is(b,null,c.length,1),o.t=v.VFloat,o.v=s,c.push(o),this.varMap.set(s,o),this.outVars.push(b)}j.type=i.TArray(i.TBuffer(i.TVoid,ke.SConst(0),n),ke.SConst(c.length)),this.allocData.set(j,c)},pack:function(e,t,n,s){for(var o,a,c,h,m,f,p,g,v,b,j,y,w,O,x,C,E,k,A,S,d=[],u=0,l={id:r.allocVarId(),name:e,type:i.TVec(0,s),kind:t},_=0;_<n.length;){if(a=n[_],++_,r.isTexture(a.type)?p=!0:(m=a.type,m._hx_index==16?(S=m.t,A=m.size,k=m.kind,p=!0):p=!1),p)continue;if(g=a.type,g._hx_index==15&&(E=g.size,w=g.t,r.isTexture(w)))continue;if(c=this.varSize(a.type,s),c==0){y=new is(l,s,-1,c),y.v=a,this.varMap.set(a,y);continue}for(o=null,v=0;v<d.length;)h=d[v],++v,h.v==null&&h.size>=c&&(o==null||o.size>h.size)&&(o=h);o!=null?(j=o.size-c,j>0&&(O=d.indexOf(o),x=new is(l,s,o.pos+c,j),d.splice(O+1,0,x),o.size=c),o.v=a,this.varMap.set(a,o)):(f=new is(l,s,u,c),u+=c,f.v=a,this.varMap.set(a,f),d.push(f),b=(4-c%4)%4,b>0&&(C=new is(l,s,u,b),u+=b,d.push(C)))}return l.type=i.TArray(i.TVec(4,s),ke.SConst(u>>2)),u>0&&(this.outVars.push(l),this.allocData.set(l,d)),l},varSize:function(e,n){switch(e._hx_index){case 1:case 3:if(n==v.VFloat)return 1;throw t.thrown(r.toString(e)+" size unknown for type "+o.string(n));break;case 5:var s,a,c,d,u,i=e.size,l=e.t;if(n==l)return i;throw t.thrown(r.toString(e)+" size unknown for type "+o.string(n));break;case 7:if(n==v.VFloat)return 16;throw t.thrown(r.toString(e)+" size unknown for type "+o.string(n));break;case 6:case 8:if(n==v.VFloat)return 12;throw t.thrown(r.toString(e)+" size unknown for type "+o.string(n));break;case 9:return i=e.size,i;case 13:for(a=e.vl,c=0,s=0;s<a.length;)d=a[s],++s,c+=this.varSize(d.type,n);return c;case 15:if(s=e.size,s._hx_index==0)return i=s.v,u=e.t,this.varSize(u,n)*i;throw t.thrown(r.toString(e)+" size unknown for type "+o.string(n));break;default:throw t.thrown(r.toString(e)+" size unknown for type "+o.string(n))}},varSize4Bytes:function(e,n){switch(e._hx_index){case 9:if(e.size==4)return 1;throw t.thrown(r.toString(e)+" 4 bytes size unknown for type"+o.string(n));break;case 13:for(var c,l,d,a=e.vl,i=0,s=0;s<a.length;)c=a[s],++s,i+=this.varSize4Bytes(c.type,n);return i;case 15:return s=e.size,s._hx_index==0?(l=s.v,d=e.t,this.varSize4Bytes(d,n)*l):this.varSize(e,n);break;default:return this.varSize(e,n)}},addTextureFormat:function(e,t,n){n==null&&(n=0);for(var s,o=0,i=this.textureFormats;o<i.length;)if(s=i[o],++o,s.dim==e&&s.arr==t&&s.rw==n)return;this.textureFormats.push({dim:e,arr:t,rw:n})},gatherVar:function(e){var t,s,o,i,a,c,l,d,u,n=e.type;switch(n._hx_index){case 10:s=n.dim,o=n.isArray,t=e.type,t._hx_index==11?(l=t.dim,l=t.isArray,c=t.channels,i=c):i=0,this.addTextureFormat(s,o,i);break;case 11:t=n.channels,s=n.dim,o=n.isArray,t=e.type,t._hx_index==11?(l=t.dim,l=t.isArray,c=t.channels,i=c):i=0,this.addTextureFormat(s,o,i);break;case 13:for(d=n.vl,t=0;t<d.length;)u=d[t],++t,this.gatherVar(u);return;case 15:switch(t=n.size,a=n.t,a._hx_index){case 10:s=a.dim,o=a.isArray,this.addTextureFormat(s,o,0);break;case 11:s=a.dim,o=a.isArray,c=a.channels,this.addTextureFormat(s,o,c);break;default:}break;case 17:t=n.size,this.addTextureFormat(Ke.T2D,!1);break;default:}switch(e.kind._hx_index){case 0:r.hasQualifier(e,I.PerObject)?this.params.push(e):this.globals.push(e);break;case 2:this.params.push(e);break;default:this.outVars.push(e)}},__class__:ft},Kc={},Kc._new=function(e){return ie.allocID(e)},Kc.toInt=function(e){return e},Kc.set=function(e,t,n){t.map.h[e]=n},Kc.get=function(e,t){return t.map.h[e]},ie=function(){this.channels=[],this.map=new le},c["hxsl.Globals"]=ie,ie.__name__="hxsl.Globals",ie.allocID=function(e){ie.MAP==null&&(ie.MAP=new fe,ie.ALL=[]);var t=ie.MAP.h[e];return t==null&&(t=ie.ALL.length,ie.ALL.push(e),ie.MAP.h[e]=t),t},ie.getIDName=function(e){return ie.ALL[e]},ie.prototype={set:function(e,t){var n=this.map,s=ie.allocID(e);n.h[s]=t},get:function(e){var t=this.map,n=ie.allocID(e);return t.h[n]},fastSet:function(e,t){this.map.h[e]=t},fastGet:function(e){return this.map.h[e]},resetChannels:function(){this.maxChannels=0},allocChannelID:function(e){for(var n,s=0,o=this.maxChannels;s<o;)if(n=s++,this.channels[n]==e)return n;if(this.maxChannels==1<<r.MAX_CHANNELS_BITS)throw t.thrown("Too many unique channels");return n=this.maxChannels++,this.channels[n]=e,n},__class__:ie},H=function(){},c["js.Boot"]=H,H.__name__="js.Boot",H.getClass=function(e){if(e==null)return null;if(e instanceof Array)return Array;var t,n=e.__class__;return n??(t=H.__nativeClassName(e),t!=null?H.__resolveNativeClass(t):null)},H.__string_rec=function(e,t){if(e==null)return"null";if(t.length>=5)return"<...>";var n,s,o,i,r,c,l,d,u,h,m,a=typeof e;switch(a=="function"&&(e.__name__||e.__ename__)&&(a="object"),a){case"function":return"<function>";case"object":if(e.__enum__)return u=_[e.__enum__],o=u.__constructs__[e._hx_index],r=o._hx_name,o.__params__?(t=t+"	",r+"("+function(){var s,i,a,c,r=[];for(s=0,i=o.__params__;!0;){if(!(s<i.length))break;c=i[s],s=s+1,r.push(H.__string_rec(e[c],t))}return a=r,a}(this).join(",")+")"):r;if(e instanceof Array){for(n="[",t+="	",c=0,h=e.length;c<h;)l=c++,n+=(l>0?",":"")+H.__string_rec(e[l],t);return n+="]",n}try{i=e.toString}catch{return"???"}if(i!=null&&i!=Object.toString&&typeof i=="function"&&(d=e.toString(),d!="[object Object]"))return d;n=`{
`,t+="	",m=e.hasOwnProperty!=null,s=null;for(s in e){if(m&&!e.hasOwnProperty(s))continue;if(s=="prototype"||s=="__class__"||s=="__super__"||s=="__interfaces__"||s=="__properties__")continue;n.length!=2&&(n+=`, 
`),n+=t+s+" : "+H.__string_rec(e[s],t)}return t=t.substring(1),n+=`
`+t+"}",n;case"string":return e;default:return String(e)}},H.__interfLoop=function(e,t){if(e==null)return!1;if(e==t)return!0;var s,o,i,a,n=e.__interfaces__;if(n!=null)for(s=0,i=n.length;s<i;)if(a=s++,o=n[a],o==t||H.__interfLoop(o,t))return!0;return H.__interfLoop(e.__super__,t)},H.__instanceof=function(e,t){if(t==null)return!1;switch(t){case Array:return e instanceof Array;case ul:return typeof e=="boolean";case ll:return e!=null;case dl:return typeof e=="number";case St:return typeof e=="number"&&(e|0)===e;break;case String:return typeof e=="string";default:if(e!=null){if(typeof t=="function"){if(H.__downcastCheck(e,t))return!0}else if(typeof t=="object"&&H.__isNativeObj(t)&&e instanceof t)return!0}else return!1;return!!(t==hl&&e.__name__!=null)||!!(t==ml&&e.__ename__!=null)||e.__enum__!=null&&_[e.__enum__]==t}},H.__downcastCheck=function(e,t){return e instanceof t||!!t.__isInterface__&&H.__interfLoop(H.getClass(e),t)},H.__cast=function(e,n){if(e==null||H.__instanceof(e,n))return e;throw t.thrown("Cannot cast "+o.string(e)+" to "+o.string(n))},H.__nativeClassName=function(e){var t=H.__toStr.call(e).slice(8,-1);return t=="Object"||t=="Function"||t=="Math"||t=="JSON"?null:t},H.__isNativeObj=function(e){return H.__nativeClassName(e)!=null},H.__resolveNativeClass=function(t){return e[t]},_t=function(){this.computeLayout=[1,1,1],this.outIndex=0,this.uniformBuffer=0,this.exprIds=0,this.varNames=new le,this.allNames=new fe},c["hxsl.GlslOut"]=_t,_t.__name__="hxsl.GlslOut",_t.compile=function(e){var t=new _t;return t.glES=1,t.version=100,t.run(e)},_t.prototype={get_isES:function(){return this.glES!=null},get_isES2:function(){return this.glES!=null&&this.glES<=2},add:function(e){this.buf.b+=o.string(e)},ident:function(e){var t=this.varName(e);this.buf.b+=o.string(t)},decl:function(e){for(var s,t=0,n=this.decls;t<n.length;)if(s=n[t],++t,s==e)return;u.cca(e,0)==35?this.decls.unshift(e):this.decls.push(e)},getSamplerType:function(e,t){var n="sampler"+u.substr(_[e.__enum__].__constructs__[e._hx_index]._hx_name,1,null);return t&&(n+="Array"),n},addType:function(e){switch(e._hx_index){case 0:this.buf.b+=o.string("void");break;case 1:this.buf.b+=o.string("int");break;case 2:this.buf.b+=o.string("bool");break;case 3:this.buf.b+=o.string("float");break;case 4:this.buf.b+=o.string("string");break;case 5:var n,s,i,r,c,l,d,m,f,p,a=e.size,h=e.t;switch(h._hx_index){case 0:this.buf.b+=o.string("i");break;case 1:break;case 2:this.buf.b+=o.string("b");break}this.buf.b+=o.string("vec"),this.buf.b+=o.string(a);break;case 6:this.buf.b+=o.string("mat3");break;case 7:this.buf.b+=o.string("mat4");break;case 8:this.decl(_t.MAT34),this.buf.b+=o.string("_mat3x4");break;case 9:c=e.size,this.buf.b+=o.string("vec"),this.buf.b+=o.string(c);break;case 10:i=e.dim,r=e.isArray,l=this.getSamplerType(i,r),this.buf.b+=o.string(l),this.glES!=null&&(r||i==Ke.T3D)&&this.decl("precision lowp "+l+";");break;case 11:i=e.dim,r=e.isArray,p=e.channels,this.buf.b+=o.string("image"+u.substr(_[i.__enum__].__constructs__[i._hx_index]._hx_name,1,null)+(r?"Array":""));break;case 12:this.buf.b+=o.string("mat2");break;case 13:for(d=e.vl,this.buf.b+=o.string("struct { "),n=0;n<d.length;)s=d[n],++n,this.addVar(s),this.buf.b+=o.string(";");this.buf.b+=o.string(" }");break;case 14:n=e.variants,this.buf.b+=o.string("function");break;case 15:switch(m=e.t,a=e.size,this.addType(m),this.buf.b+=o.string("["),a._hx_index){case 0:switch(n=a.v,n){case 0:break;case 1:this.intelDriverFix?this.buf.b+=o.string(2):(s=n,this.buf.b+=o.string(s));break;default:s=n,this.buf.b+=o.string(s)}break;case 1:s=a.v,f=this.varName(s),this.buf.b+=o.string(f);break}this.buf.b+=o.string("]");break;case 16:throw n=e.t,n=e.size,n=e.kind,t.thrown("assert");case 17:c=e.size,this.buf.b+=o.string("channel"+c);break}},addVar:function(e){var t,s,a,r,c,l,d,u,n=e.type;switch(n._hx_index){case 15:switch(s=n.t,t=n.size,d=e.type,e.type=s,this.addVar(e),e.type=d,this.buf.b+=o.string("["),t._hx_index){case 0:switch(a=t.v,a){case 0:break;case 1:this.intelDriverFix?this.buf.b+=o.string(2):(r=a,this.buf.b+=o.string(r));break;default:r=a,this.buf.b+=o.string(r)}break;case 1:c=t.v,u=this.varName(c),this.buf.b+=o.string(u);break}this.buf.b+=o.string("]");break;case 16:switch(s=n.t,t=n.size,l=n.kind,l._hx_index){case 0:case 3:break;case 1:case 4:this.buf.b+=o.string("storage_");break;case 2:case 5:this.buf.b+=o.string("rw_");break}this.buf.b+=o.string((this.isVertex?"vertex_":"")+"uniform_buffer"+this.uniformBuffer++),this.buf.b+=o.string(" { "),e.type=i.TArray(s,t),this.addVar(e),e.type=i.TBuffer(s,t,l),this.buf.b+=o.string("; }");break;default:this.addType(e.type),this.buf.b+=o.string(" "),c=this.varName(e),this.buf.b+=o.string(c)}},addValue:function(e,t){var a,r,c,l,d,u,h,m,f,p,g,s=e.e;switch(s._hx_index){case 4:l=s.el,r="_val"+this.exprIds++,d=this.buf,this.buf=new Yt,this.addType(e.t),this.buf.b+=o.string(" "),this.buf.b+=o.string(r),this.buf.b+=o.string("(void)"),a=l.slice(),c=a[a.length-1],a[a.length-1]={e:n.TReturn(c),t:e.t,p:c.p},u={t:i.TVoid,e:n.TBlock(a),p:e.p},this.addExpr(u,""),this.exprValues.push(this.buf.b),this.buf=d,this.buf.b+=o.string(r),this.buf.b+=o.string("()");break;case 10:h=s.econd,m=s.eif,f=s.eelse,this.buf.b+=o.string("( "),this.addValue(h,t),this.buf.b+=o.string(" ) ? "),this.addValue(m,t),this.buf.b+=o.string(" : "),this.addValue(f,t);break;case 20:p=s.m,p=s.args,g=s.e,this.addValue(g,t);break;default:this.addExpr(e,t)}},addBlock:function(e,t){this.addExpr(e,t)},getFunName:function(e,n,s){switch(e._hx_index){case 20:if(s==i.TInt&&this.glES!=null)return this.decl("int _imod( int x, int y ) { return int(mod(float(x),float(y))); }"),"_imod";break;case 25:this.decl("float invLerp(float v, float a, float b) { return clamp((v - a) / (b - a), 0.0, 1.0); }");break;case 34:var c,l,d,h,m,f,a=n[0].t;switch(a._hx_index){case 10:switch(c=a.isArray,a.dim._hx_index){case 1:if(this.glES!=null&&this.glES<=2)return"texture2D";break;case 3:if(this.glES!=null&&this.glES<=2)return"textureCube";break;default:}break;case 17:if(c=a.size,this.glES!=null&&this.glES<=2)return"texture2D";break;default:}break;case 35:switch(a=n[0].t,a._hx_index){case 10:switch(c=a.isArray,a.dim._hx_index){case 1:if(this.glES!=null&&this.glES<=2)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"texture2DLodEXT";break;case 3:if(this.glES!=null&&this.glES<=2)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"textureCubeLodEXT";break;default:}break;case 17:if(c=a.size,this.glES!=null&&this.glES<=2)return this.decl("#extension GL_EXT_shader_texture_lod : enable"),"texture2DLodEXT";break;default:}break;case 36:return"texelFetch";case 37:switch(d="",a=n[0].t,a._hx_index){case 10:l=a.dim,h=a.isArray,m=r.getDimSize(l,h),d=h?"Array":"",f="sampler"+u.substr(_[l.__enum__].__constructs__[l._hx_index]._hx_name,1,null)+d,this.decl("vec"+m+" _texture"+d+"Size("+f+" sampler, int lod) { return vec"+m+"(textureSize(sampler, lod)); }");break;case 11:return c=a.channels,l=a.dim,h=a.isArray,m=r.getDimSize(l,h),"vec"+m+"(imageSize";case 17:c=a.size,this.decl("vec2 _textureSize(sampler2D sampler, int lod) { return vec2(textureSize(sampler, lod)); }");break;default:}return"_texture"+d+"Size";case 51:if(n[0].t==i.TMat3x4)return this.decl(_t.MAT34),this.decl("mat3 _mat3( _mat3x4 v ) { return mat3(v.a.xyz,v.b.xyz,v.c.xyz); }"),"_mat3";break;case 53:if(this.decl(_t.MAT34),n.length==1)return this.decl("_mat3x4 mat_to_34( mat4 m ) { return _mat3x4(m[0],m[1],m[2]); }"),"mat_to_34";break;case 55:this.decl("vec4 pack( float v ) { vec4 color = fract(v * vec4(1, 255, 255.*255., 255.*255.*255.)); return color - color.yzww * vec4(1. / 255., 1. / 255., 1. / 255., 0.); }");break;case 56:this.decl("float unpack( vec4 color ) { return dot(color,vec4(1., 1. / 255., 1. / (255. * 255.), 1. / (255. * 255. * 255.))); }");break;case 57:this.decl("vec4 packNormal( vec3 v ) { return vec4((v + vec3(1.)) * vec3(0.5),1.); }");break;case 58:this.decl("vec3 unpackNormal( vec4 v ) { return normalize((v.xyz - vec3(0.5)) * vec3(2.)); }");break;case 59:this.decl("vec2 screenToUv( vec2 v ) { return v * vec2(0.5,-0.5) + vec2(0.5,0.5); }");break;case 60:this.decl("vec2 uvToScreen( vec2 v ) { return v * vec2(2.,-2.) + vec2(-1., 1.); }");break;case 61:case 62:case 63:if(this.isVertex)throw t.thrown("Can't use "+o.string(e)+" in vertex shader");this.version<300&&this.decl("#extension GL_OES_standard_derivatives:enable");break;case 74:this.version<330&&this.decl("#extension GL_ARB_shader_bit_encoding :enable"),this.decl("int _floatBitsToUint( float v) { return int(floatBitsToUint(v)); }"),this.decl("ivec2 _floatBitsToUint( vec2 v ) { return ivec2(floatBitsToUint(v)); }"),this.decl("ivec3 _floatBitsToUint( vec3 v ) { return ivec3(floatBitsToUint(v)); }"),this.decl("ivec4 _floatBitsToUint( vec4 v ) { return ivec4(floatBitsToUint(v)); }");break;case 73:case 75:this.version<330&&this.decl("#extension GL_ARB_shader_bit_encoding :enable");break;case 76:this.version<330&&this.decl("#extension GL_ARB_shader_bit_encoding :enable"),this.decl("float _uintBitsToFloat( int v ) { return uintBitsToFloat(uint(v)); }"),this.decl("vec2 _uintBitsToFloat( ivec2 v ) { return uintBitsToFloat(uvec2(v)); }"),this.decl("vec3 _uintBitsToFloat( ivec3 v ) { return uintBitsToFloat(uvec3(v)); }"),this.decl("vec4 _uintBitsToFloat( ivec4 v ) { return uintBitsToFloat(uvec4(v)); }");break;default:}return _t.GLOBALS[e._hx_index]},addExpr:function(e,s){var e,a,r,c,d,h,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,H,I,V,$,W,U,K,q,Y,G,X,Q,J,ee,m=e.e;switch(m._hx_index){case 0:switch(x=m.c,x._hx_index){case 0:this.buf.b+=o.string("null");break;case 1:J=x.b,this.buf.b+=o.string(J);break;case 2:a=x.v,this.buf.b+=o.string(a);break;case 3:Q=x.v,M=""+Q,this.buf.b+=o.string(M),M.indexOf(".")==-1&&M.indexOf("e")==-1&&(this.buf.b+=o.string("."));break;case 4:a=x.v,this.buf.b+=o.string('"'+a+'"');break}break;case 1:a=m.v,y=this.varName(a),this.buf.b+=o.string(y);break;case 2:j=m.g,this.buf.b+=o.string(_t.GLOBALS[j._hx_index]);break;case 3:c=m.e,this.buf.b+=o.string("("),this.addValue(c,s),this.buf.b+=o.string(")");break;case 4:for(O=m.el,this.buf.b+=o.string(`{
`),P=s+"	",r=0;r<O.length;)c=O[r],++r,this.buf.b+=o.string(P),this.addExpr(c,P),this.newLine(c);this.buf.b+=o.string(s),this.buf.b+=o.string("}");break;case 5:switch(h=m.op,c=m.e1,p=m.e2,r=c.t,f=p.t,h._hx_index){case 1:r._hx_index==5?r.size==3?r.t._hx_index==1?f._hx_index==8?(this.decl(_t.MAT34),this.decl("vec3 m3x4mult( vec3 v, _mat3x4 m) { vec4 ve = vec4(v,1.0); return vec3(dot(m.a,ve),dot(m.b,ve),dot(m.c,ve)); }"),h._hx_index==20?(d=h.op,v=!0):v=!1,v&&(this.addValue(c,s),this.buf.b+=o.string(" = ")),this.buf.b+=o.string("m3x4mult("),this.addValue(c,s),this.buf.b+=o.string(","),this.addValue(p,s),this.buf.b+=o.string(")")):(this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s)):(this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s)):(this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s)):(this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s));break;case 5:if(r._hx_index==5)if(d=r.t,f._hx_index==5){switch(d=f.size,d=f.t,_=r.size,this.buf.b+=o.string("vec"+_+"("),h._hx_index){case 5:a="equal";break;case 6:a="notEqual";break;case 7:a="greaterThan";break;case 8:a="greaterThanEqual";break;case 9:a="lessThan";break;case 10:a="lessThanEqual";break;default:throw t.thrown("assert")}this.buf.b+=o.string(a),this.buf.b+=o.string("("),this.addValue(c,s),this.buf.b+=o.string(","),this.addValue(p,s),this.buf.b+=o.string("))")}else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);break;case 6:if(r._hx_index==5)if(d=r.t,f._hx_index==5){switch(d=f.size,d=f.t,_=r.size,this.buf.b+=o.string("vec"+_+"("),h._hx_index){case 5:a="equal";break;case 6:a="notEqual";break;case 7:a="greaterThan";break;case 8:a="greaterThanEqual";break;case 9:a="lessThan";break;case 10:a="lessThanEqual";break;default:throw t.thrown("assert")}this.buf.b+=o.string(a),this.buf.b+=o.string("("),this.addValue(c,s),this.buf.b+=o.string(","),this.addValue(p,s),this.buf.b+=o.string("))")}else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);break;case 7:if(r._hx_index==5)if(d=r.t,f._hx_index==5){switch(d=f.size,d=f.t,_=r.size,this.buf.b+=o.string("vec"+_+"("),h._hx_index){case 5:a="equal";break;case 6:a="notEqual";break;case 7:a="greaterThan";break;case 8:a="greaterThanEqual";break;case 9:a="lessThan";break;case 10:a="lessThanEqual";break;default:throw t.thrown("assert")}this.buf.b+=o.string(a),this.buf.b+=o.string("("),this.addValue(c,s),this.buf.b+=o.string(","),this.addValue(p,s),this.buf.b+=o.string("))")}else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);break;case 8:if(r._hx_index==5)if(d=r.t,f._hx_index==5){switch(d=f.size,d=f.t,_=r.size,this.buf.b+=o.string("vec"+_+"("),h._hx_index){case 5:a="equal";break;case 6:a="notEqual";break;case 7:a="greaterThan";break;case 8:a="greaterThanEqual";break;case 9:a="lessThan";break;case 10:a="lessThanEqual";break;default:throw t.thrown("assert")}this.buf.b+=o.string(a),this.buf.b+=o.string("("),this.addValue(c,s),this.buf.b+=o.string(","),this.addValue(p,s),this.buf.b+=o.string("))")}else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);break;case 9:if(r._hx_index==5)if(d=r.t,f._hx_index==5){switch(d=f.size,d=f.t,_=r.size,this.buf.b+=o.string("vec"+_+"("),h._hx_index){case 5:a="equal";break;case 6:a="notEqual";break;case 7:a="greaterThan";break;case 8:a="greaterThanEqual";break;case 9:a="lessThan";break;case 10:a="lessThanEqual";break;default:throw t.thrown("assert")}this.buf.b+=o.string(a),this.buf.b+=o.string("("),this.addValue(c,s),this.buf.b+=o.string(","),this.addValue(p,s),this.buf.b+=o.string("))")}else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);break;case 10:if(r._hx_index==5)if(d=r.t,f._hx_index==5){switch(d=f.size,d=f.t,_=r.size,this.buf.b+=o.string("vec"+_+"("),h._hx_index){case 5:a="equal";break;case 6:a="notEqual";break;case 7:a="greaterThan";break;case 8:a="greaterThanEqual";break;case 9:a="lessThan";break;case 10:a="lessThanEqual";break;default:throw t.thrown("assert")}this.buf.b+=o.string(a),this.buf.b+=o.string("("),this.addValue(c,s),this.buf.b+=o.string(","),this.addValue(p,s),this.buf.b+=o.string("))")}else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);else this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s);break;case 18:this.decl("int _ushr( int i, int j ) { return int(uint(i) >> uint(j)); }"),this.buf.b+=o.string("_ushr("),this.addValue(c,s),this.buf.b+=o.string(","),this.addValue(p,s),this.buf.b+=o.string(")");break;case 19:e.t!=i.TInt?(h._hx_index==20?(d=h.op,v=!0):v=!1,v&&(this.addValue(c,s),this.buf.b+=o.string(" = ")),this.addExpr({e:n.TCall({e:n.TGlobal(l.Mod),t:i.TFun([]),p:e.p},[c,p]),t:e.t,p:e.p},s)):(this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s));break;case 20:switch(h.op._hx_index){case 1:r._hx_index==5?r.size==3?r.t._hx_index==1?f._hx_index==8?(this.decl(_t.MAT34),this.decl("vec3 m3x4mult( vec3 v, _mat3x4 m) { vec4 ve = vec4(v,1.0); return vec3(dot(m.a,ve),dot(m.b,ve),dot(m.c,ve)); }"),h._hx_index==20?(r=h.op,v=!0):v=!1,v&&(this.addValue(c,s),this.buf.b+=o.string(" = ")),this.buf.b+=o.string("m3x4mult("),this.addValue(c,s),this.buf.b+=o.string(","),this.addValue(p,s),this.buf.b+=o.string(")")):(this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s)):(this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s)):(this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s)):(this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s));break;case 19:e.t!=i.TInt?(h._hx_index==20?(r=h.op,v=!0):v=!1,v&&(this.addValue(c,s),this.buf.b+=o.string(" = ")),this.addExpr({e:n.TCall({e:n.TGlobal(l.Mod),t:i.TFun([]),p:e.p},[c,p]),t:e.t,p:e.p},s)):(this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s));break;default:this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s)}break;default:this.addValue(c,s),this.buf.b+=o.string(" "),a=Z.opStr(h),this.buf.b+=o.string(a),this.buf.b+=o.string(" "),this.addValue(p,s)}break;case 6:switch(h=m.op,c=m.e1,h._hx_index){case 0:a="++";break;case 1:a="--";break;case 2:a="!";break;case 3:a="-";break;case 4:a="~";break;default:throw t.thrown("assert")}this.buf.b+=o.string(a),this.addValue(c,s);break;case 7:a=m.v,H=m.init,this.locals.h[a.id]=a,H!=null?(y=this.varName(a),this.buf.b+=o.string(y),this.buf.b+=o.string(" = "),this.addValue(H,s)):this.buf.b+=o.string("/*var*/");break;case 8:if(r=m.e,f=m.args,d=r.e,w=r.p,w=r.t,d._hx_index==2)switch(w=d.g,w._hx_index){case 36:j=w,g=f,a=this.getFunName(j,g,e.t),this.buf.b+=o.string(a),this.buf.b+=o.string("("),this.addValue(g[0],s),this.buf.b+=o.string(", "),this.addValue(g[1],s),g.length!=2?(this.buf.b+=o.string(", "),this.addValue(g[2],s),this.buf.b+=o.string(")")):this.buf.b+=o.string(", 0)");break;case 37:j=w,g=f,a=this.getFunName(j,g,e.t),this.buf.b+=o.string(a),this.buf.b+=o.string("("),this.addValue(g[0],s),g.length!=1?(this.buf.b+=o.string(", "),this.addValue(g[1],s),this.buf.b+=o.string(")")):(d=g[0].t,d._hx_index==11?(w=d.dim,w=d.isArray,w=d.channels,v=!0):v=!1,v?this.buf.b+=o.string("))"):this.buf.b+=o.string(", 0)"));break;case 54:if(f.length==1)c=f[0],this.buf.b+=o.string("clamp("),this.addValue(c,s),this.buf.b+=o.string(", 0., 1.)");else{for(a=r,g=f,d=a.e,d._hx_index==2?(j=d.g,y=this.getFunName(j,g,e.t),this.buf.b+=o.string(y)):this.addValue(a,s),this.buf.b+=o.string("("),b=!0,d=0;d<g.length;)c=g[d],++d,b?b=!1:this.buf.b+=o.string(", "),this.addValue(c,s);this.buf.b+=o.string(")")}break;case 78:break;case 79:if(f.length==3){if(N=f[0],V=f[1],W=f[2],d=N.t,d._hx_index==11)w=d.dim,w=d.isArray,U=d.channels,S=U;else throw t.thrown("assert");this.buf.b+=o.string("imageStore("),this.addValue(N,s),this.buf.b+=o.string(","),this.addValue(V,s),this.buf.b+=o.string(","),S!=4&&(this.buf.b+=o.string("(")),this.addValue(W,s),S!=4&&(this.buf.b+=o.string(")"+(S==1?".xxxx":S==2?".xyyy":".xyzz"))),this.buf.b+=o.string(")")}else{for(a=r,g=f,d=a.e,d._hx_index==2?(j=d.g,y=this.getFunName(j,g,e.t),this.buf.b+=o.string(y)):this.addValue(a,s),this.buf.b+=o.string("("),b=!0,d=0;d<g.length;)c=g[d],++d,b?b=!1:this.buf.b+=o.string(", "),this.addValue(c,s);this.buf.b+=o.string(")")}break;case 84:g=f,this.buf.b+=o.string("atomicAdd("),this.addValue(g[0],s),this.buf.b+=o.string("["),this.addValue(g[1],s),this.buf.b+=o.string("],"),this.addValue(g[2],s),this.buf.b+=o.string(")");break;default:for(a=r,g=f,d=a.e,d._hx_index==2?(j=d.g,y=this.getFunName(j,g,e.t),this.buf.b+=o.string(y)):this.addValue(a,s),this.buf.b+=o.string("("),b=!0,d=0;d<g.length;)c=g[d],++d,b?b=!1:this.buf.b+=o.string(", "),this.addValue(c,s);this.buf.b+=o.string(")")}else{for(a=r,g=f,r=a.e,r._hx_index==2?(j=r.g,y=this.getFunName(j,g,e.t),this.buf.b+=o.string(y)):this.addValue(a,s),this.buf.b+=o.string("("),b=!0,r=0;r<g.length;)c=g[r],++r,b?b=!1:this.buf.b+=o.string(", "),this.addValue(c,s);this.buf.b+=o.string(")")}break;case 9:if(c=m.e,C=m.regs,c.t._hx_index==3){for(r=0;r<C.length;)if(D=C[r],++r,D!=B.X)throw t.thrown("assert");switch(C.length){case 1:this.addValue(c,s);break;case 2:this.decl("vec2 _vec2( float v ) { return vec2(v,v); }"),this.buf.b+=o.string("_vec2("),this.addValue(c,s),this.buf.b+=o.string(")");break;case 3:this.decl("vec3 _vec3( float v ) { return vec3(v,v,v); }"),this.buf.b+=o.string("_vec3("),this.addValue(c,s),this.buf.b+=o.string(")");break;case 4:this.decl("vec4 _vec4( float v ) { return vec4(v,v,v,v); }"),this.buf.b+=o.string("_vec4("),this.addValue(c,s),this.buf.b+=o.string(")");break;default:throw t.thrown("assert")}}else for(this.addValue(c,s),this.buf.b+=o.string("."),r=0;r<C.length;){switch(D=C[r],++r,R=this.buf,X=R.b,D._hx_index){case 0:v="x";break;case 1:v="y";break;case 2:v="z";break;case 3:v="w";break}R.b=X+o.string(v)}break;case 10:G=m.econd,I=m.eif,L=m.eelse,this.buf.b+=o.string("if( "),this.addValue(G,s),this.buf.b+=o.string(") "),this.addExpr(I,s),L!=null&&(this.isBlock(I)||(this.buf.b+=o.string(";")),this.buf.b+=o.string(" else "),this.addExpr(L,s));break;case 11:this.buf.b+=o.string("discard");break;case 12:c=m.e,c==null?this.buf.b+=o.string("return"):(this.buf.b+=o.string("return "),this.addValue(c,s));break;case 13:if(a=m.v,$=m.it,E=m.loop,this.locals.h[a.id]=a,r=$.e,r._hx_index==5)if(r.op._hx_index==21)c=r.e1,p=r.e2,this.buf.b+=o.string("for("),this.buf.b+=o.string(a.name+"="),this.addValue(c,s),this.buf.b+=o.string(";"+a.name+"<"),this.addValue(p,s),this.buf.b+=o.string(";"+a.name+"++) "),this.addBlock(E,s);else throw t.thrown("assert");else throw t.thrown("assert");break;case 14:this.buf.b+=o.string("continue");break;case 15:this.buf.b+=o.string("break");break;case 16:c=m.e,A=m.index,this.addValue(c,s),this.buf.b+=o.string("["),this.addValue(A,s),this.buf.b+=o.string("]");break;case 17:if(O=m.el,r=e.t,r._hx_index==15)f=r.size,K=r.t,this.addType(K);else throw t.thrown("assert");for(this.buf.b+=o.string("["+O.length+"]"),this.buf.b+=o.string("("),b=!0,r=0;r<O.length;)e=O[r],++r,b?b=!1:this.buf.b+=o.string(", "),this.addValue(e,s);this.buf.b+=o.string(")");break;case 18:r=m.e,r=m.cases,r=m.def,this.buf.b+=o.string("switch(...)");break;case 19:r=m.e,f=m.loop,m.normalWhile==!1?(E=f,e=r,ee=s,s+="	",this.buf.b+=o.string("do "),this.addBlock(E,s),this.buf.b+=o.string(" while( "),this.addValue(e,s),this.buf.b+=o.string(" )")):(E=f,e=r,this.buf.b+=o.string("while( "),this.addValue(e,s),this.buf.b+=o.string(" ) "),this.addBlock(E,s));break;case 20:r=m.m,r=m.args,e=m.e,this.addExpr(e,s);break;case 21:q=m.e,Y=m.name,this.addExpr(q,s),this.buf.b+=o.string("."),this.buf.b+=o.string(Y);break;case 22:switch(r=m.code,f=m.args,m.target){case"code":case"glsl":for(F=r,g=f,k=0,T=new Ss("{(\\d+)}","g");T.matchSub(F,k);)z=T.matchedPos(),this.buf.b+=o.string(F.substring(k,z.pos)),A=o.parseInt(T.matched(1)),A<g.length&&this.addValue(g[A].e,s),k=z.pos+z.len;this.buf.b+=o.string(u.substr(F,k,null));break;default:}break}},varName:function(e){if(e.kind==O.Output){if(this.isVertex)return"gl_Position";if(this.glES!=null&&this.glES<=2)return this.outIndexes==null?"gl_FragColor":"gl_FragData["+this.outIndexes.h[e.id]+"]"}var n,t=this.varNames.h[e.id];if(t!=null)return t;if(t=e.name,e.kind==O.Var&&(t+="_varying"),Object.prototype.hasOwnProperty.call(_t.KWDS.h,t)&&(t="_"+t),Object.prototype.hasOwnProperty.call(this.allNames.h,t)){for(n=2,t+="_";Object.prototype.hasOwnProperty.call(this.allNames.h,t+n);)++n;t+=n}return this.varNames.h[e.id]=t,this.allNames.h[t]=e.id,t},newLine:function(e){this.isBlock(e)?this.buf.b+=o.string(`
`):this.buf.b+=o.string(`;
`)},isBlock:function(e){var n,s,t=e.e;switch(t._hx_index){case 4:return n=t.el,!0;case 13:return n=t.v,n=t.it,s=t.loop,this.isBlock(s);case 19:return n=t.e,t.normalWhile==!0&&(s=t.loop,this.isBlock(s));break;default:return!1}},initVar:function(e){switch(e.kind._hx_index){case 0:case 2:var n,i,a,c,l,d,h,s=e.type;switch(s._hx_index){case 15:n=s.t,i=s.size,n._hx_index==11?(i=n.dim,i=n.isArray,c=n.channels,l=u.substr("rgba",0,c),this.buf.b+=o.string("layout("+l+"32f) uniform ")):this.buf.b+=o.string("uniform ");break;case 16:switch(n=s.t,n=s.size,n=s.kind,n._hx_index){case 1:case 4:if(this.version<430)throw t.thrown("SSBO are available since version 4.3");this.buf.b+=o.string("layout(std430) readonly buffer ");break;case 2:case 5:if(this.version<430)throw t.thrown("SSBO are available since version 4.3");this.buf.b+=o.string("layout(std430) buffer ");break;default:switch(d=n,this.buf.b+=o.string("layout(std140) "),d._hx_index){case 0:case 3:this.buf.b+=o.string("uniform ");break;default:throw t.thrown("assert")}}break;default:this.buf.b+=o.string("uniform ")}break;case 1:this.buf.b+=o.string(this.glES!=null&&this.glES<=2?"attribute ":"in ");break;case 3:r.hasQualifier(e,I.Flat)&&(this.buf.b+=o.string("flat ")),this.buf.b+=o.string(this.glES!=null&&this.glES<=2?"varying ":this.isVertex?"out ":"in ");break;case 4:break;case 5:if(this.glES!=null&&this.glES<=2){this.outIndexes.h[e.id]=this.outIndex++;return}if(this.isVertex)return;this.glES!=null&&(this.buf.b+=o.string("layout(location="+this.outIndex+++") ")),this.buf.b+=o.string("out ");break;case 6:return}if(e.qualifiers!=null)for(s=0,n=e.qualifiers;s<n.length;)if(a=n[s],++s,a._hx_index==6)switch(h=a.p,h._hx_index){case 0:this.buf.b+=o.string("lowp ");break;case 1:this.buf.b+=o.string("mediump ");break;case 2:this.buf.b+=o.string("highp ");break}this.addVar(e),this.buf.b+=o.string(`;
`)},initVars:function(e){this.outIndex=0,this.uniformBuffer=0,this.outIndexes=new le;for(var s,t=0,n=e.vars;t<n.length;)s=n[t],++t,this.initVar(s);this.buf.b+=o.string(`
`),this.outIndex<2?this.outIndexes=null:!this.isVertex&&this.glES!=null&&this.glES<=2&&this.decl("#extension GL_EXT_draw_buffers : enable")},collectGlobals:function(e,t){var n,o,i,a,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,R,P,s=t.e;switch(s._hx_index){case 2:_=s.g,e.set(_,!0);break;case 8:if(c=s.e,n=s.args,s=c.e,o=c.p,o=c.t,s._hx_index==2)if(s.g._hx_index==78)switch(n.length){case 1:s=n[0],c=s.e,o=s.p,o=s.t,c._hx_index==0?(s=c.c,s._hx_index==2?(m=s.v,this.computeLayout=[m,1,1]):(s=this,j=e,r.iter(t,function(e){s.collectGlobals(j,e)}))):(c=this,x=e,r.iter(t,function(e){c.collectGlobals(x,e)}));break;case 2:o=n[0],i=n[1],u=o.e,f=o.p,f=o.t,u._hx_index==0?(o=u.c,o._hx_index==2?(u=i.e,f=i.p,f=i.t,u._hx_index==0?(i=u.c,i._hx_index==2?(p=i.v,m=o.v,this.computeLayout=[m,p,1]):(o=this,w=e,r.iter(t,function(e){o.collectGlobals(w,e)}))):(i=this,y=e,r.iter(t,function(e){i.collectGlobals(y,e)}))):(u=this,k=e,r.iter(t,function(e){u.collectGlobals(k,e)}))):(f=this,b=e,r.iter(t,function(e){f.collectGlobals(b,e)}));break;case 3:d=n[0],l=n[1],a=n[2],n=d.e,h=d.p,h=d.t,n._hx_index==0?(d=n.c,d._hx_index==2?(n=l.e,h=l.p,h=l.t,n._hx_index==0?(l=n.c,l._hx_index==2?(n=a.e,h=a.p,h=a.t,n._hx_index==0?(a=n.c,a._hx_index==2?(O=a.v,m=d.v,p=l.v,this.computeLayout=[m,p,O]):(n=this,g=e,r.iter(t,function(e){n.collectGlobals(g,e)}))):(d=this,C=e,r.iter(t,function(e){d.collectGlobals(C,e)}))):(l=this,E=e,r.iter(t,function(e){l.collectGlobals(E,e)}))):(a=this,v=e,r.iter(t,function(e){a.collectGlobals(v,e)}))):(h=this,A=e,r.iter(t,function(e){h.collectGlobals(A,e)}))):(S=this,M=e,r.iter(t,function(e){S.collectGlobals(M,e)}));break;default:F=this,T=e,r.iter(t,function(e){F.collectGlobals(T,e)})}else z=this,D=e,r.iter(t,function(e){z.collectGlobals(D,e)});else N=this,L=e,r.iter(t,function(e){N.collectGlobals(L,e)});break;default:R=this,P=e,r.iter(t,function(e){R.collectGlobals(P,e)})}},run:function(e){for(var s,a,r,c,l,d,u=new vo,n=0,i=e.funs;n<i.length;)s=i[n],++n,this.collectGlobals(u,s.expr);if(this.locals=new le,this.decls=[],this.buf=new Yt,this.exprValues=[],e.funs.length!=1)throw t.thrown("assert");if(s=e.funs[0],this.isVertex=s.kind==de.Vertex,this.isCompute=s.kind==de.Main,this.isCompute||(this.isVertex?this.decl("precision highp float;"):this.decl("precision mediump float;")),this.initVars(e),this.isCompute&&this.decl("layout(local_size_x = "+this.computeLayout[0]+", local_size_y = "+this.computeLayout[1]+", local_size_z = "+this.computeLayout[2]+") in;"),l=this.buf,this.buf=new Yt,this.buf.b+=o.string(`void main(void) {
`),n=s.expr.e,n._hx_index==4)for(c=n.el,n=0;n<c.length;)a=c[n],++n,this.buf.b+=o.string("	"),this.addExpr(a,"	"),this.newLine(a);else this.addExpr(s.expr,"");for(this.isVertex&&(this.buf.b+=o.string(`	gl_Position.z += gl_Position.z - gl_Position.w;
`)),this.buf.b+=o.string("}"),this.exprValues.push(this.buf.b),this.buf=l,r=ha.array(this.locals),r.sort(function(e,t){return q.compare(e.name,t.name)}),n=0;n<r.length;)d=r[n],++n,this.addVar(d),this.buf.b+=o.string(`;
`);for(this.buf.b+=o.string(`
`),n=0,i=this.exprValues;n<i.length;)a=i[n],++n,this.buf.b+=o.string(a),this.buf.b+=o.string(`

`);return this.glES!=null?this.decl("#version "+(this.version<100?100:this.version)+(this.version>150?" es":"")):this.isCompute||this.version>=430?this.decl("#version 430"):this.version!=null?this.decl("#version "+(this.version>150?150:this.version)):this.decl("#version 130"),this.decls.push(this.buf.b),this.buf=null,this.decls.join(`
`)},__class__:_t},Rc=function(){},c["hxsl._Linker.AllocatedVar"]=Rc,Rc.__name__="hxsl._Linker.AllocatedVar",Rc.prototype={__class__:Rc},ni=function(e,t){this.name=e,this.uid=ni.UID++,this.vertex=t,this.processed=new le,this.usedFunctions=[],this.readMap=new le,this.readVars=[],this.writeMap=new le,this.writeVars=[]},c["hxsl._Linker.ShaderInfos"]=ni,ni.__name__="hxsl._Linker.ShaderInfos",ni.prototype={__class__:ni},Hc=function(e){this.debugDepth=0,this.mode=e},c["hxsl.Linker"]=Hc,Hc.__name__="hxsl.Linker",Hc.prototype={error:function(e,t){return De.t(e,t)},mergeVar:function(e,n,s,i,a){switch(n.kind._hx_index){case 2:if(a==null||!r.hasBorrowQualifier(s,a))throw t.thrown("assert");break;case 0:case 1:case 3:case 4:case 5:break;case 6:throw t.thrown("assert")}n.kind!=s.kind&&n.kind!=O.Local&&s.kind!=O.Local&&this.error("'"+e+"' kind does not match : "+o.string(n.kind)+" should be "+o.string(s.kind),i);var d,u,h,m,f,c=n.type,l=s.type;if(c._hx_index==13)if(l._hx_index==13)for(u=l.vl,m=c.vl,c=0;c<m.length;){for(h=m[c],++c,d=null,l=0;l<u.length;)if(f=u[l],++l,h.name==f.name){d=f;break}d==null?u.push(this.allocVar(h,i,a).v):this.mergeVar(e+"."+d.name,h,d,i,a)}else Y.enumEq(n.type,s.type)||this.error("'"+e+"' type does not match : "+r.toString(n.type)+" should be "+r.toString(s.type),i);else Y.enumEq(n.type,s.type)||this.error("'"+e+"' type does not match : "+r.toString(n.type)+" should be "+r.toString(s.type),i)},allocVar:function(e,t,n,s,o){var e,a,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,C,x=this;if(e.parent!=null&&o==null)for(o=this.allocVar(e.parent,t,n),m=o.v,s=m.name,m=m.parent;m!=null;)s=m.name+"."+s,m=m.parent;if(p=s==null?e.name:s+"."+e.name,e.qualifiers!=null)for(c=0,d=e.qualifiers;c<d.length;)y=d[c],++c,y._hx_index==4&&(C=y.n,p=C);if(h=p.toLowerCase(),a=this.varMap.h[h],b=e.name,a!=null){for(c=0,d=a.merged;c<d.length;)if(g=d[c],++c,g==e)return a;if(v=r.hasBorrowQualifier(a.v,n),e.kind==O.Param&&!v&&!r.hasQualifier(e,I.Shared)&&!x.isBatchShader||e.kind==O.Function||(e.kind==O.Var||e.kind==O.Local)&&r.hasQualifier(e,I.Private)?j=!0:(f=a.v,v=r.hasBorrowQualifier(e,a.rootShaderName),j=f.kind==O.Param&&!v&&!r.hasQualifier(f,I.Shared)&&!x.isBatchShader||f.kind==O.Function||(f.kind==O.Var||f.kind==O.Local)&&r.hasQualifier(f,I.Private)),j||e.kind==O.Param&&a.v.kind==O.Param){for(u=2;!0;){if(l=this.varMap.h[h+u],l==null)break;for(c=0,d=l.merged;c<d.length;)if(g=d[c],++c,g==e)return l;++u}e.kind==O.Input?(_=this.varMap,Object.prototype.hasOwnProperty.call(_.h,h)&&delete _.h[h],this.varMap.h[h+u]=a,a.v.name+=u,a.path+=u):(b+=u,p+=u,h+=u)}else return a.merged.push(e),this.mergeVar(p,e,a.v,t,a.rootShaderName),this.varIdMap.h[e.id]=a.id,a}if(a={id:r.allocVarId(),name:b,type:e.type,kind:e.kind,qualifiers:e.qualifiers,parent:o==null?null:o.v},l=new Rc,l.v=a,l.merged=[e],l.path=p,l.id=a.id,l.parent=o,l.instanceIndex=this.curInstance,l.rootShaderName=n,this.allVars.push(l),this.varMap.h[h]=l,c=a.type,c._hx_index==13){for(w=c.vl,c=[],d=0;d<w.length;)e=w[d],++d,c.push(this.allocVar(e,t,n,p,l).v);a.type=i.TStruct(c)}return l},mapExprVar:function(e){var t,s,o,i,a,l,d,u,h,m,f,p,g,v,j,y,_,w,x,c=e.e;switch(c._hx_index){case 1:if(a=c.v,!this.locals.h.hasOwnProperty(a.id)){if(t=this.allocVar(a,e.p),this.curShader!=null&&!this.curShader.writeMap.h.hasOwnProperty(t.id)){if(He.TRACE){for(s=this.curShader.name+" read "+t.path,i=0,o=this.debugDepth;i<o;)p=i++,s="    "+s;be.trace(s,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"mapExprVar"})}if(this.curShader.readMap.h.hasOwnProperty(t.id)||(this.curShader.readMap.h[t.id]=t,this.curShader.readVars.push(t)),this.curShader.vertex==null&&t.v.kind==O.Var){if(He.TRACE){for(s="Force "+this.curShader.name+" into fragment (use varying)",i=0,o=this.debugDepth;i<o;)p=i++,s="    "+s;be.trace(s,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"mapExprVar"})}this.curShader.vertex=!1}}return{e:n.TVar(t.v),t:t.v.type,p:e.p}}break;case 5:switch(f=c.op,u=c.e1,m=c.e2,i=u.e,f._hx_index){case 4:switch(i._hx_index){case 1:if(o=i.v,a=o,!this.locals.h.hasOwnProperty(a.id)){if(h=this.mapExprVar(m),t=this.allocVar(a,u.p),this.curShader!=null&&!this.curShader.writeMap.h.hasOwnProperty(t.id)){if(He.TRACE){for(s=this.curShader.name+" write "+t.path,l=0,v=this.debugDepth;l<v;)p=l++,s="    "+s;be.trace(s,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"mapExprVar"})}this.curShader.writeMap.h[t.id]=t,this.curShader.writeVars.push(t)}return{e:n.TBinop(f,{e:n.TVar(t.v),t:t.v.type,p:e.p},h),t:e.t,p:e.p}}if(a=o,!this.locals.h.hasOwnProperty(a.id)){if(d=this.mapExprVar(u),h=this.mapExprVar(m),t=this.allocVar(a,d.p),this.curShader!=null&&!this.curShader.writeMap.h.hasOwnProperty(t.id)){if(He.TRACE){for(s=this.curShader.name+" write "+t.path,o=0,l=this.debugDepth;o<l;)p=o++,s="    "+s;be.trace(s,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"mapExprVar"})}this.curShader.writeMap.h[t.id]=t,this.curShader.writeVars.push(t)}return{e:n.TBinop(f,d,h),t:e.t,p:e.p}}break;case 9:if(o=i.e,l=i.regs,l=o.e,v=o.p,v=o.t,l._hx_index==1&&(a=l.v,!this.locals.h.hasOwnProperty(a.id))){if(d=this.mapExprVar(u),h=this.mapExprVar(m),t=this.allocVar(a,d.p),this.curShader!=null&&!this.curShader.writeMap.h.hasOwnProperty(t.id)){if(He.TRACE){for(s=this.curShader.name+" write "+t.path,o=0,l=this.debugDepth;o<l;)p=o++,s="    "+s;be.trace(s,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"mapExprVar"})}this.curShader.writeMap.h[t.id]=t,this.curShader.writeVars.push(t)}return{e:n.TBinop(f,d,h),t:e.t,p:e.p}}break;default:}break;case 20:switch(o=f.op,i._hx_index){case 1:if(a=i.v,!this.locals.h.hasOwnProperty(a.id)){if(d=this.mapExprVar(u),h=this.mapExprVar(m),t=this.allocVar(a,d.p),this.curShader!=null&&!this.curShader.writeMap.h.hasOwnProperty(t.id)){if(He.TRACE){for(s=this.curShader.name+" write "+t.path,o=0,l=this.debugDepth;o<l;)p=o++,s="    "+s;be.trace(s,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"mapExprVar"})}this.curShader.writeMap.h[t.id]=t,this.curShader.writeVars.push(t)}return{e:n.TBinop(f,d,h),t:e.t,p:e.p}}break;case 9:if(o=i.e,l=i.regs,i=o.e,l=o.p,l=o.t,i._hx_index==1&&(a=i.v,!this.locals.h.hasOwnProperty(a.id))){if(d=this.mapExprVar(u),h=this.mapExprVar(m),t=this.allocVar(a,d.p),this.curShader!=null&&!this.curShader.writeMap.h.hasOwnProperty(t.id)){if(He.TRACE){for(s=this.curShader.name+" write "+t.path,i=0,o=this.debugDepth;i<o;)p=i++,s="    "+s;be.trace(s,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"mapExprVar"})}this.curShader.writeMap.h[t.id]=t,this.curShader.writeVars.push(t)}return{e:n.TBinop(f,d,h),t:e.t,p:e.p}}break;default:}break;default:}break;case 7:i=c.init,a=c.v,this.locals.h[a.id]=!0;break;case 11:this.curShader!=null&&(this.curShader.vertex=!1,this.curShader.hasDiscard=!0);break;case 13:i=c.it,i=c.loop,a=c.v,this.locals.h[a.id]=!0;break;case 22:for(w=c.target,x=c.code,y=c.args,_=[],c=0;c<y.length;){switch(g=y[c],++c,g.access._hx_index){case 0:u=this.mapExprVar(g.e);break;case 1:m=this.curShader!=null?this.mapSyntaxWrite(g.e):g.e,u=this.mapExprVar(m);break;case 2:j=this.mapExprVar(g.e),this.curShader!=null&&(j=this.mapSyntaxWrite(j)),u=j;break}_.push({e:u,access:g.access})}return this.curShader!=null&&(this.curShader.hasSyntax=!0),{e:n.TSyntax(w,x,_),t:e.t,p:e.p};default:}return r.map(e,b(this,this.mapExprVar))},mapSyntaxWrite:function(e){var t,o,i,a,c,s=e.e;if(s._hx_index==1){if(i=s.v,t=this.allocVar(i,e.p),!this.curShader.writeMap.h.hasOwnProperty(t.id)){if(He.TRACE){for(o=this.curShader.name+" syntax write "+t.path,s=0,a=this.debugDepth;s<a;)c=s++,o="    "+o;be.trace(o,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"mapSyntaxWrite"})}this.curShader.writeMap.h[t.id]=t,this.curShader.writeVars.push(t)}return{e:n.TVar(t.v),t:t.v.type,p:e.p}}return r.map(e,b(this,this.mapSyntaxWrite))},addShader:function(e,t,n,s){var i,a,r,c,o=new ni(e,t);if(this.curShader=o,o.priority=s,o.body=this.mapExprVar(n),this.shaders.push(o),this.curShader=null,He.TRACE){for(i="Adding shader "+e+" with priority "+s,a=0,r=this.debugDepth;a<r;)c=a++,i="    "+i;be.trace(i,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"addShader"})}return o},sortByPriorityDesc:function(e,t){return e.priority==t.priority?e.uid-t.uid:t.priority-e.priority},buildDependency:function(e,t,n){for(var s,o,a,l,d,r=!n,i=0,c=this.shaders;i<c.length;){if(s=c[i],++i,s==e){r=!0;continue}if(!r)continue;if(!s.writeMap.h.hasOwnProperty(t.id))continue;if(e.vertex){if(s.vertex==!1)continue;s.vertex==null&&(s.vertex=!0)}if(He.TRACE){for(o=e.name+" => "+s.name+" ("+t.path+")",a=0,l=this.debugDepth;a<l;)d=a++,o="    "+o;be.trace(o,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"buildDependency"})}if(e.deps.set(s,!0),this.debugDepth++,this.initDependencies(s),this.debugDepth--,!s.readMap.h.hasOwnProperty(t.id))return}t.v.kind==O.Var&&this.error("Variable "+t.path+" required by "+e.name+" is missing initializer",null)},initDependencies:function(e){if(e.deps!=null)return;e.deps=new Rt;for(var n,t=0,s=e.readVars;t<s.length;)n=s[t],++t,this.buildDependency(e,n,e.writeMap.h.hasOwnProperty(n.id))},collect:function(e,t,n){if(e.onStack&&this.error("Loop in shader dependencies ("+e.name+")",null),e.marked==n)return;e.marked=n,e.onStack=!0;for(var o,a,r,c,l,s=[],i=e.deps.keys();i.hasNext();)c=i.next(),s.push(c);for(a=s,a.sort(b(this,this.sortByPriorityDesc)),s=0;s<a.length;)i=a[s],++s,this.collect(i,t,n);if(e.vertex==null){if(He.TRACE){for(o="MARK "+e.name+" "+(n?"vertex":"fragment"),s=0,r=this.debugDepth;s<r;)l=s++,o="    "+o;be.trace(o,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"collect"})}e.vertex=n}if(e.vertex==n){if(He.TRACE){for(o="COLLECT "+e.name+" "+(n?"vertex":"fragment"),s=0,r=this.debugDepth;s<r;)l=s++,o="    "+o;be.trace(o,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"collect"})}t.push(e)}e.onStack=!1},link:function(e){if(He.TRACE){for(var v,A,S,P,se,ne,o,c,l,d,u,h,f,p,g,j,y,w,x,C,E,F,T,z,R,H,V,te,ee,B,oe,k,D,N,L,$,W,U,K,q,Y,G,X,Q,Z,J,m="---------------------- LINKING -----------------------",s=0,a=this.debugDepth;s<a;)v=s++,m="    "+m;be.trace(m,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"link"})}for(this.varMap=new fe,this.varIdMap=new le,this.allVars=[],this.shaders=[],this.locals=new le,S=[],s=[],A=0,P=e;A<P.length;)se=P[A],ne=A++,v=ne,o=se,e.indexOf(o)<v?(V=Gi.shaderData(o),S.push({origin:o,cloned:V}),s.push(V)):s.push(o);for(e=s,this.curInstance=0,f=[],s=0;s<e.length;){for(o=e[s],++s,this.isBatchShader=this.mode==Ft.Batch&&M.startsWith(o.name,"batchShader_"),a=0,d=o.vars;a<d.length;)l=d[a],++a,g=this.allocVar(l,null,o.name),this.isBatchShader&&g.v.kind==O.Param&&!M.startsWith(g.path,"Batch_")&&(g.v.kind=O.Local,g.v.qualifiers==null&&(g.v.qualifiers=[]),g.v.qualifiers.push(I.Flat)),l.kind==O.Output&&f.push(l);for(h=0,u=o.funs;h<u.length;)c=u[h],++h,E=this.allocVar(c.ref,c.expr.p),E.kind=c.kind;this.curInstance++}for(z=0,te=[-3e3],ee=[-2e3],Z=[-1e3],U=[-2500],W=-1500,X=-500,s=0;s<e.length;){for(o=e[s],++s,a=0,d=o.funs;a<d.length;){if(c=d[a],++a,l=this.allocVar(c.ref,c.expr.p),l.kind==null)throw t.thrown("assert");switch(l.kind._hx_index){case 0:case 1:if(this.mode==Ft.Compute)throw R=l.kind,t.thrown("Unexpected "+_[R.__enum__].__constructs__[R._hx_index]._hx_name.toLowerCase()+"() function in compute shader");G=l.kind==de.Vertex?W:X,this.addShader(o.name+"."+(l.kind==de.Vertex?"vertex":"fragment"),l.kind==de.Vertex,c.expr,z+G);break;case 2:switch(c.ref.name){case"__init__fragment":x=Z,w=!1;break;case"__init__main":x=U,w=!1;break;case"__init__vertex":x=ee,w=!0;break;default:x=te,w=null}if(h=c.expr.e,h._hx_index==4)for(H=h.el,Y=0,u=0;u<H.length;)q=H[u],++u,this.addShader(o.name+"."+c.ref.name+Y++,w,q,x[0]++);else this.addShader(o.name+"."+c.ref.name,w,c.expr,x[0]++);break;case 3:throw t.thrown("Unexpected helper function in linker "+l.v.name);case 4:if(this.mode!=Ft.Compute)throw t.thrown("Unexpected main() outside compute shader");this.addShader(o.name,!0,c.expr,z).isCompute=!0;break}}++z}for(this.shaders.sort(b(this,this.sortByPriorityDesc)),Q=0,s=0,a=this.shaders;s<a.length;)o=a[s],++s,o.uid=Q++;for(y=new ni("<entry>",!1),y.deps=new Rt,s=0;s<f.length;)l=f[s],++s,this.buildDependency(y,this.allocVar(l,null),!1);for(s=0,a=this.shaders;s<a.length;)o=a[s],++s,(o.hasDiscard||o.isCompute||o.hasSyntax)&&(this.initDependencies(o),y.deps.set(o,!0));for(s=0,a=this.shaders;s<a.length;){if(o=a[s],++s,o.vertex!=null)continue;for($=!0,d=0,h=o.readVars;d<h.length;)if(K=h[d],++d,K.v.kind!=O.Param){$=!1;break}if($){if(He.TRACE){for(m="Force "+o.name+" into fragment since it only reads params",u=0,j=this.debugDepth;u<j;)v=u++,m="    "+m;be.trace(m,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"link"})}o.vertex=!1}}for(s=0,a=this.shaders;s<a.length;){if(o=a[s],++s,o.deps==null)continue;if(o.vertex==null)for(p=o.deps.keys();p.hasNext();)if(C=p.next(),C.vertex==!1){if(He.TRACE){for(m=o.name+" marked as fragment because of "+C.name,d=0,h=this.debugDepth;d<h;)v=d++,m="    "+m;be.trace(m,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"link"})}o.vertex=!1;break}if(o.vertex)for(B=o.deps.keys();B.hasNext();)if(T=B.next(),T.vertex==null){if(He.TRACE){for(F=T.name+" marked as vertex because of "+o.name,u=0,j=this.debugDepth;u<j;)oe=u++,F="    "+F;be.trace(F,{fileName:"hxsl/Debug.hx",lineNumber:31,className:"hxsl.Linker",methodName:"link"})}T.vertex=!0}}if(l=[],c=[],this.collect(y,l,!0),this.collect(y,c,!1),c.pop()!=y)throw t.thrown("assert");for(s=0,a=this.shaders;s<a.length;)o=a[s],++s,o.marked=null;for(s=0,a=l.concat(c);s<a.length;){for(o=a[s],++s,p=o.deps.keys();p.hasNext();)C=p.next(),C.marked==null&&this.error(C.name+" needed by "+o.name+" is unreachable",null);o.marked=!0}for(f=[],L={},k=null,k=function(e){if(L.hasOwnProperty(e.id))return;L[e.id]=!0,e.v.parent!=null?k(e.parent):f.push(e.v)},s=0,a=l.concat(c);s<a.length;){for(o=a[s],++s,d=0,h=o.readVars;d<h.length;)E=h[d],++d,k(E);for(u=0,j=o.writeVars;u<j.length;)g=j[u],++u,k(g)}for(N=null,N=function(e){var n,s,o,t=e.type;if(t._hx_index==13&&(s=t.vl,e.kind!=O.Input)){for(o=[],t=0;t<s.length;)n=s[t],++t,L.hasOwnProperty(n.id)&&(N(n),o.push(n));e.type=i.TStruct(o)}},s=0;s<f.length;)E=f[s],++s,N(E);for(D=function(e,t,s){var o,a,c,l,d,u,m,p,h={id:r.allocVarId(),name:t,type:i.TFun([{ret:i.TVoid,args:[]}]),kind:O.Function};for(f.push(h),o=[],a=0;a<s.length;)if(l=s[a],++a,d=l.body.e,d._hx_index==4)for(u=d.el,c=0;c<u.length;)m=u[c],++c,o.push(m);else o.push(l.body);return p={e:n.TBlock(o),t:i.TVoid,p:o.length==0?null:o[0].p},{kind:e,ref:h,ret:i.TVoid,args:[],expr:p}},J=this.mode==Ft.Compute?[D(de.Main,"main",l)]:[D(de.Vertex,"vertex",l),D(de.Fragment,"fragment",c)],s=0;s<S.length;)for(p=S[s],++s,a=0,d=p.cloned.vars.length;a<d;)v=a++,this.allocVar(p.cloned.vars[v],null).merged.unshift(p.origin.vars[v]);return{name:"out",vars:f,funs:J}},__class__:Hc},vt=_["hxsl.Output"]={__ename__:!0,__constructs__:null,Const:(a=function(e){return{_hx_index:0,v:e,__enum__:"hxsl.Output",toString:s}},a._hx_name="Const",a.__params__=["v"],a),Value:(a=function(e,t){return{_hx_index:1,v:e,size:t,__enum__:"hxsl.Output",toString:s}},a._hx_name="Value",a.__params__=["v","size"],a),PackNormal:(a=function(e){return{_hx_index:2,v:e,__enum__:"hxsl.Output",toString:s}},a._hx_name="PackNormal",a.__params__=["v"],a),PackFloat:(a=function(e){return{_hx_index:3,v:e,__enum__:"hxsl.Output",toString:s}},a._hx_name="PackFloat",a.__params__=["v"],a),Vec2:(a=function(e){return{_hx_index:4,a:e,__enum__:"hxsl.Output",toString:s}},a._hx_name="Vec2",a.__params__=["a"],a),Vec3:(a=function(e){return{_hx_index:5,a:e,__enum__:"hxsl.Output",toString:s}},a._hx_name="Vec3",a.__params__=["a"],a),Vec4:(a=function(e){return{_hx_index:6,a:e,__enum__:"hxsl.Output",toString:s}},a._hx_name="Vec4",a.__params__=["a"],a),Swiz:(a=function(e,t){return{_hx_index:7,a:e,swiz:t,__enum__:"hxsl.Output",toString:s}},a._hx_name="Swiz",a.__params__=["a","swiz"],a)},vt.__constructs__=[vt.Const,vt.Value,vt.PackNormal,vt.PackFloat,vt.Vec2,vt.Vec3,vt.Vec4,vt.Swiz],vt.__empty_constructs__=[],Z=function(e){e==null&&(e=!1),this.varId=e},c["hxsl.Printer"]=Z,Z.__name__="hxsl.Printer",Z.opStr=function(e){switch(e._hx_index){case 0:return"+";case 1:return"*";case 2:return"/";case 3:return"-";case 4:return"=";case 5:return"==";case 6:return"!=";case 7:return">";case 8:return">=";case 9:return"<";case 10:return"<=";case 11:return"&";case 12:return"|";case 13:return"^";case 14:return"&&";case 15:return"||";case 16:return"<<";case 17:return">>";case 18:return">>>";case 19:return"%";case 20:var t=e.op;return Z.opStr(t)+"=";case 21:return"...";case 22:return"=>";default:return"??"+o.string(e)}},Z.toString=function(e,t){return t==null&&(t=!1),new Z(t).exprString(e)},Z.shaderToString=function(e,t){return t==null&&(t=!1),new Z(t).shaderString(e)},Z.check=function(e,n){try{for(var e,i,d,u,m,f,p,g,v,b,h=new le,l=[],o=null,o=function(e,n){if(n){if(h.h.hasOwnProperty(e.id))throw t.thrown("Duplicate var "+e.id);h.h[e.id]=e,l.push(e)}else h.remove(e.id);var e,i,s=e.type;if(s._hx_index==13)for(i=s.vl,s=0;s<i.length;)e=i[s],++s,o(e,n)},a=null,a=function(e){var n,i,c,d,u,m,f,p,s=e.e;switch(s._hx_index){case 1:if(n=s.v,!h.h.hasOwnProperty(n.id))throw t.thrown("Unbound var "+n.name+"@"+n.id);break;case 4:for(c=s.el,u=l,l=[],i=0;i<c.length;)m=c[i],++i,a(m);for(i=0;i<l.length;)n=l[i],++i,o(n,!1);l=u;break;case 7:n=s.v,d=s.init,d!=null&&a(d),o(n,!0);break;case 13:n=s.v,f=s.it,p=s.loop,a(f),o(n,!0),a(p),o(n,!1);break;default:r.iter(e,a)}},c=0,s=e.vars;c<s.length;)d=s[c],++c,o(d,!0);for(c=0,s=e.funs;c<s.length;){for(u=s[c],++c,i=0,f=u.args;i<f.length;)d=f[i],++i,o(d,!0);for(a(u.expr),m=0,p=u.args;m<p.length;)v=p[m],++m,o(v,!1)}}catch(o){if(s=t.caught(o).unwrap(),typeof s=="string"){if(b=s,g=b+`
    in
`+Z.shaderToString(e,!0),n!=null){for(s=[],i=0;i<n.length;)e=n[i],++i,s.push(Z.shaderToString(e,!0));g+=`
    from

`+s.join(`

`)}throw t.thrown(g)}throw o}},Z.prototype={add:function(e){this.buffer.b+=o.string(e)},shaderString:function(e){this.buffer=new Yt;for(var s,i,t=0,n=e.vars;t<n.length;)s=n[t],++t,this.addVar(s,null),this.buffer.b+=o.string(`;
`);for(e.vars.length>0&&(this.buffer.b+=o.string(`
`)),t=0,n=e.funs;t<n.length;)i=n[t],++t,this.addFun(i),this.buffer.b+=o.string(`

`);return this.buffer.b},varString:function(e){return this.buffer=new Yt,this.addVar(e,null),this.buffer.b},funString:function(e){return this.buffer=new Yt,this.addFun(e),this.buffer.b},exprString:function(e){return this.buffer=new Yt,this.addExpr(e,""),this.buffer.b},addVar:function(e,t,n,s){if(n==null&&(n=""),e.qualifiers!=null)for(var i,a,l,d,u,h,m,p,g,v,b,j,y,c=0,f=e.qualifiers;c<f.length;){switch(a=f[c],++c,a._hx_index){case 0:d=a.max,i="const"+(d==null?"":"("+d+")");break;case 1:i="private";break;case 2:i="nullable";break;case 3:i="perObject";break;case 4:m=a.n,i="name('"+m+"')";break;case 5:i="shared";break;case 6:l=a.p,i=_[l.__enum__].__constructs__[l._hx_index]._hx_name.toLowerCase()+"p";break;case 7:p=a.min,g=a.max,i="range("+p+","+g+")";break;case 8:i="ignore";break;case 9:v=a.v,i="perInstance("+v+")";break;case 10:b=a.s,i='doc("'+M.replace(b,'"','\\"')+'")';break;case 11:j=a.source,i="borrow("+j+")";break;case 12:y=a.name,i="sampler("+y+")";break;case 13:i="final";break;case 14:i="flat";break}this.buffer.b+=o.string("@"+i+" ")}if(e.kind!=t)switch(e.kind._hx_index){case 0:this.buffer.b+=o.string("@global ");break;case 1:this.buffer.b+=o.string("@input ");break;case 2:this.buffer.b+=o.string("@param ");break;case 3:this.buffer.b+=o.string("@varying ");break;case 4:this.buffer.b+=o.string("@local ");break;case 5:this.buffer.b+=o.string("@output ");break;case 6:this.buffer.b+=o.string("@function ");break}if(this.buffer.b+=o.string("var "),e.parent==s?this.buffer.b+=o.string(e.name+(this.varId?"@"+e.id:"")):this.addVarName(e),this.buffer.b+=o.string(" : "),c=e.type,c._hx_index==13){for(u=c.vl,this.buffer.b+=o.string("{"),h=!0,c=0;c<u.length;)i=u[c],++c,h?h=!1:this.buffer.b+=o.string(", "),this.addVar(i,i.kind,n,i);this.buffer.b+=o.string("}")}else i=r.toString(e.type),this.buffer.b+=o.string(i)},addFun:function(e){this.buffer.b+=o.string("function "+e.ref.name+"(");for(var i,a,n=!0,t=0,s=e.args;t<s.length;)i=s[t],++t,n?(this.buffer.b+=o.string(" "),n=!1):this.buffer.b+=o.string(", "),this.addVar(i,O.Local);e.args.length>0&&(this.buffer.b+=o.string(" ")),a=") : "+r.toString(e.ret)+" ",this.buffer.b+=o.string(a),this.addExpr(e.expr,"")},addVarName:function(e){e.parent!=null&&(this.addVarName(e.parent),this.buffer.b+=o.string(".")),this.buffer.b+=o.string(e.name),this.varId&&(this.buffer.b+=o.string("@"+e.id))},addConst:function(e){var t,s,i,a,r,n=this.buffer,c=n.b;switch(e._hx_index){case 0:t="null";break;case 1:s=e.b,t=s;break;case 2:i=e.v,t=i;break;case 3:a=e.v,t=a;break;case 4:r=e.v,t='"'+r+'"';break}n.b=c+o.string(t)},addExpr:function(e,n){var e,i,a,r,c,l,d,h,f,p,g,v,b,j,y,_,w,x,C,E,k,A,S,M,F,T,z,N,L,s=e.e;switch(s._hx_index){case 0:l=s.c,this.addConst(l);break;case 1:a=s.v,this.addVarName(a);break;case 2:F=s.g,a=D.toString(F),this.buffer.b+=o.string(a);break;case 3:e=s.e,this.buffer.b+=o.string("("),this.addExpr(e,n),this.buffer.b+=o.string(")");break;case 4:for(c=s.el,this.buffer.b+=o.string("{"),n+="	",i=0;i<c.length;)e=c[i],++i,this.buffer.b+=o.string(`
`+n),this.addExpr(e,n),this.buffer.b+=o.string(";");n=u.substr(n,1,null),c.length>0&&(this.buffer.b+=o.string(`
`+n)),this.buffer.b+=o.string("}");break;case 5:b=s.op,g=s.e1,v=s.e2,this.addExpr(g,n),a=" "+Z.opStr(b)+" ",this.buffer.b+=o.string(a),this.addExpr(v,n);break;case 6:switch(b=s.op,e=s.e1,b._hx_index){case 0:a="++";break;case 1:a="--";break;case 2:a="!";break;case 3:a="-";break;case 4:a="~";break;default:throw t.thrown("assert")}this.buffer.b+=o.string(a),this.addExpr(e,n);break;case 7:a=s.v,x=s.init,this.addVar(a,O.Local,n),x!=null&&(this.buffer.b+=o.string(" = "),this.addExpr(x,n));break;case 8:for(e=s.e,c=s.args,this.addExpr(e,n),this.buffer.b+=o.string("("),r=!0,i=0;i<c.length;)e=c[i],++i,r?r=!1:this.buffer.b+=o.string(", "),this.addExpr(e,n);this.buffer.b+=o.string(")");break;case 9:for(e=s.e,E=s.regs,this.addExpr(e,n),this.buffer.b+=o.string("."),i=0;i<E.length;)A=E[i],++i,this.buffer.b+=o.string(Z.SWIZ[A._hx_index]);break;case 10:k=s.econd,S=s.eif,_=s.eelse,this.buffer.b+=o.string("if( "),this.addExpr(k,n),this.buffer.b+=o.string(" ) "),this.addExpr(S,n),_!=null&&(this.buffer.b+=o.string(" else "),this.addExpr(_,n));break;case 11:this.buffer.b+=o.string("discard");break;case 12:e=s.e,this.buffer.b+=o.string("return"),e!=null&&(this.buffer.b+=o.string(" "),this.addExpr(e,n));break;case 13:a=s.v,L=s.it,p=s.loop,this.buffer.b+=o.string("for( "),this.addVarName(a),this.buffer.b+=o.string(" in "),this.addExpr(L,n),this.buffer.b+=o.string(" ) "),this.addExpr(p,n);break;case 14:this.buffer.b+=o.string("continue");break;case 15:this.buffer.b+=o.string("break");break;case 16:g=s.e,v=s.index,this.addExpr(g,n),this.buffer.b+=o.string("["),this.addExpr(v,n),this.buffer.b+=o.string("]");break;case 17:for(c=s.el,this.buffer.b+=o.string("["),r=!0,i=0;i<c.length;)e=c[i],++i,r?r=!1:this.buffer.b+=o.string(", "),this.addExpr(e,n);this.buffer.b+=o.string("]");break;case 18:for(e=s.e,C=s.cases,j=s.def,this.buffer.b+=o.string("switch( "),this.addExpr(e,n),this.buffer.b+=o.string(") {"),f=n,i=0;i<C.length;){for(l=C[i],++i,this.buffer.b+=o.string(`
`+n),this.buffer.b+=o.string("case "),r=!0,h=0,y=l.values;h<y.length;)a=y[h],++h,r?r=!1:this.buffer.b+=o.string(", "),this.addExpr(a,n);n+="	",this.buffer.b+=o.string(`:
`+n),this.addExpr(l.expr,n),n=f}j!=null&&(this.buffer.b+=o.string(`
`+n),n+="	",this.buffer.b+=o.string(`default:
`+n),this.addExpr(j,n),n=f),this.buffer.b+=o.string(`
`+n+"}");break;case 19:i=s.e,h=s.loop,s.normalWhile==!1?(p=h,e=i,f=n,n+="	",this.buffer.b+=o.string(`do {
`+n),this.addExpr(p,n),n=f,this.buffer.b+=o.string(`
`+n+"} while( "),this.addExpr(e,n),this.buffer.b+=o.string(" )")):(p=h,e=i,this.buffer.b+=o.string("while( "),this.addExpr(e,n),f=n,n+="	",this.buffer.b+=o.string(` ) {
`+n),this.addExpr(p,n),n=f,this.buffer.b+=o.string(`
`+n+"}"));break;case 20:if(M=s.m,d=s.args,e=s.e,this.buffer.b+=o.string("@"),this.buffer.b+=o.string(M),d.length>0){for(this.buffer.b+=o.string("("),r=!0,i=0;i<d.length;)l=d[i],++i,r?r=!1:this.buffer.b+=o.string(", "),this.addConst(l);this.buffer.b+=o.string(")")}this.buffer.b+=o.string(" "),this.addExpr(e,n);break;case 21:e=s.e,T=s.name,this.addExpr(e,n),this.buffer.b+=o.string("."),this.buffer.b+=o.string(T);break;case 22:for(z=s.target,N=s.code,d=s.args,this.buffer.b+=o.string("Syntax."),this.buffer.b+=o.string(z),this.buffer.b+=o.string("("),this.addConst(m.CString(N)),s=0;s<d.length;){switch(w=d[s],++s,w.access._hx_index){case 0:this.buffer.b+=o.string(", @r ");break;case 1:this.buffer.b+=o.string(", @w ");break;case 2:this.buffer.b+=o.string(", @rw ");break}this.addExpr(w.e,n)}this.buffer.b+=o.string(")");break}},__class__:Z},Ft=_["hxsl.LinkMode"]={__ename__:!0,__constructs__:null,Default:{_hx_name:"Default",_hx_index:0,__enum__:"hxsl.LinkMode",toString:s},Batch:{_hx_name:"Batch",_hx_index:1,__enum__:"hxsl.LinkMode",toString:s},Compute:{_hx_name:"Compute",_hx_index:2,__enum__:"hxsl.LinkMode",toString:s}},Ft.__constructs__=[Ft.Default,Ft.Batch,Ft.Compute],Ft.__empty_constructs__=[Ft.Default,Ft.Batch,Ft.Compute],ei=function(e,t,n,s,o){this.name=e,this.pos=t,this.instance=n,this.index=s,this.type=o},c["hxsl.AllocParam"]=ei,ei.__name__="hxsl.AllocParam",ei.prototype={clone:function(e){e==null&&(e=!1);var t=new ei(this.name,this.pos,this.instance,this.index,this.type);return this.perObjectGlobal!=null&&(t.perObjectGlobal=this.perObjectGlobal.clone(e)),this.next!=null&&(t.next=this.next.clone(e)),t},__class__:ei},Zi=function(e,t,n){this.pos=e,this.path=t,this.gid=ie.allocID(t),this.type=n},c["hxsl.AllocGlobal"]=Zi,Zi.__name__="hxsl.AllocGlobal",Zi.prototype={clone:function(e){e==null&&(e=!1);var t=new Zi(this.pos,this.path,this.type);return this.next!=null&&(t.next=this.next.clone(e)),e&&(t.gid=0),t},__class__:Zi},mc=function(){},c["hxsl.RuntimeShaderData"]=mc,mc.__name__="hxsl.RuntimeShaderData",mc.prototype={__class__:mc},hc=function(e,t){this.shader=e,this.bits=t},c["hxsl.ShaderInstanceDesc"]=hc,hc.__name__="hxsl.ShaderInstanceDesc",hc.prototype={__class__:hc},ta=function(){this.id=ta.UID++},c["hxsl.RuntimeShader"]=ta,ta.__name__="hxsl.RuntimeShader",ta.prototype={get_compute:function(){return this.vertex},set_compute:function(e){return this.vertex=e},hasGlobal:function(e){return this.globals.h.hasOwnProperty(e)},getShaders:function(){return this.mode==Ft.Compute?[this.vertex]:[this.vertex,this.fragment]},__class__:ta},pe=function(){this.tid=1,this.uid=1},c["hxsl.Serializer"]=pe,pe.__name__="hxsl.Serializer",pe.run=function(e){return(new pe).serialize(e)},pe.prototype={writeArr:function(e,t){this.writeVarInt(e.length);for(var s,n=0;n<e.length;)s=e[n],++n,t(s)},readArr:function(e){for(var o,t=[],n=0,s=this.readVarInt();n<s;)o=n++,t.push(e());return t},readVarInt:function(){var e=this.input.readByte();return e<128?e:e==255?this.input.readInt32():(e&127)<<8|this.input.readByte()},writeVarInt:function(e){if(e<128)this.out.addByte(e);else{var t=e>>8;t>=127?(this.out.addByte(255),this.out.addInt32(t)):(this.out.addByte(t|128),this.out.addByte(e&255))}},writeID:function(e){var t=this.idMap.h[e];t==null&&(t=this.uid++,this.idMap.h[e]=t),this.writeVarInt(t)},readID:function(){return this.readVarInt()},writeTID:function(e){var t=this.typeIdMap.get(e);return t!=null?(this.writeVarInt(t),!1):(t=this.tid++,this.typeIdMap.set(e,t),this.writeVarInt(t),!0)},writeType:function(e){switch(this.out.addByte(e._hx_index),e._hx_index){case 5:var n,o,i,a,r,c,l,d,u,h,m,t=e.size,s=e.t;this.out.addByte(t|s._hx_index<<3);break;case 0:case 1:case 2:case 3:case 4:case 6:case 7:case 8:case 12:break;case 9:t=e.size,this.out.addInt32(t);break;case 10:i=e.dim,a=e.isArray,this.out.addByte(i._hx_index<<1|(a?1:0));break;case 11:i=e.dim,a=e.isArray,u=e.channels,this.out.addByte(i._hx_index<<3|(a?1:0)|u-1<<1);break;case 13:if(r=e.vl,this.writeTID(e))for(d=b(this,this.writeVar),this.writeVarInt(r.length),o=0;o<r.length;)n=r[o],++o,d(n);break;case 14:m=e.variants;break;case 15:switch(s=e.t,t=e.size,this.writeType(s),t._hx_index){case 0:n=t.v,this.out.addByte(0),this.writeVarInt(n);break;case 1:n=t.v,this.writeVar(n);break}break;case 16:if(o=e.t,c=e.size,l=e.kind,l._hx_index==0)switch(t=c,s=o,this.writeType(s),t._hx_index){case 0:n=t.v,this.out.addByte(0),this.writeVarInt(n);break;case 1:n=t.v,this.writeVar(n);break}else switch(h=l,t=c,s=o,this.out.addByte(h._hx_index+128),this.writeType(s),t._hx_index){case 0:n=t.v,this.out.addByte(0),this.writeVarInt(n);break;case 1:n=t.v,this.writeVar(n);break}break;case 17:t=e.size,this.out.addByte(t);break}},readType:function(){switch(this.input.readByte()){case 0:return i.TVoid;case 1:return i.TInt;case 2:return i.TBool;case 3:return i.TFloat;case 4:return i.TString;case 5:var n,s,o,r,c,l,d,u,h,m,f,p,a=this.input.readByte(),e=pe.TVECS.h[a];return e==null&&(e=i.TVec(a&7,Y.createEnumIndex(v,a>>3,null)),pe.TVECS.h[a]=e),e;case 6:return i.TMat3;case 7:return i.TMat4;case 8:return i.TMat3x4;case 9:return i.TBytes(this.input.readInt32());case 10:return this.version==0?i.TSampler(Ke.T2D,!1):(s=this.input.readByte(),o=pe.TDIMS[s>>1],i.TSampler(o,(s&1)!=0));break;case 11:return this.version==0?i.TSampler(Ke.T2D,!0):(s=this.input.readByte(),o=pe.TDIMS[s>>3],i.TRWTexture(o,(s&1)!=0,(s>>1&3)+1));break;case 12:return this.version==0?i.TSampler(Ke.TCube,!1):i.TMat2;break;case 13:if(c=this.readVarInt(),n=this.types[c],n!=null)return n;for(m=b(this,this.readVar),l=[],d=0,f=this.readVarInt();d<f;)p=d++,l.push(m());return n=i.TStruct(l),this.types[c]=n,n;case 14:return i.TFun(null);case 15:return n=this.readType(),e=this.readVar(),i.TArray(n,e==null?ke.SConst(this.readVarInt()):ke.SVar(e));case 16:return r=this.input.readByte(),h=Qe.Uniform,(r&128)==0?(u=this.input,u.set_position(u.pos-1)):h=Y.createEnumIndex(Qe,r&127,null),n=this.readType(),e=this.readVar(),i.TBuffer(n,e==null?ke.SConst(this.readVarInt()):ke.SVar(e),h);case 17:return i.TChannel(this.input.readByte());case 18:if(this.version==0)return i.TMat2;throw t.thrown("assert");break;default:throw t.thrown("assert")}},writeString:function(e){var t=A.ofString(e);this.writeVarInt(t.length),this.out.add(t)},readString:function(){var e=this.readVarInt(),t=this.input.read(e).getString(0,e);return t},writeVar:function(e){if(e==null){this.out.addByte(0);return}if(this.writeID(e.id),this.varMap.h.hasOwnProperty(e.id))return;if(this.varMap.h[e.id]=e,this.writeString(e.name),this.writeType(e.type),this.out.addByte(e.kind._hx_index),this.writeVar(e.parent),e.qualifiers==null)this.out.addByte(0);else{this.out.addByte(e.qualifiers.length);for(var e,t,s,i,a,r,c,l,d,u,n=0,o=e.qualifiers;n<o.length;)switch(t=o[n],++n,this.out.addByte(t._hx_index),t._hx_index){case 0:s=t.max,this.out.addInt32(s??0);break;case 4:i=t.n,this.writeString(i);break;case 6:a=t.p,this.out.addByte(a._hx_index);break;case 7:r=t.min,c=t.max,this.out.addDouble(r),this.out.addDouble(c);break;case 9:e=t.v,this.out.addInt32(e);break;case 10:l=t.s,this.writeString(l);break;case 11:d=t.source,this.writeString(d);break;case 12:u=t.name,this.writeString(u);break;case 1:case 2:case 3:case 5:case 8:case 13:case 14:break}}},writeFun:function(e){this.out.addByte(e.kind._hx_index),this.writeVar(e.ref);var t,s,n=e.args,o=b(this,this.writeVar);for(this.writeVarInt(n.length),t=0;t<n.length;)s=n[t],++t,o(s);this.writeType(e.ret),this.writeExpr(e.expr)},writeConst:function(e){switch(this.out.addByte(e._hx_index),e._hx_index){case 0:break;case 1:var t,n=e.b;this.out.addByte(n?1:0);break;case 2:t=e.v,this.out.addInt32(t);break;case 3:t=e.v,this.out.addDouble(t);break;case 4:t=e.v,this.writeString(t);break}},writeExpr:function(e){var n,s,o,i,a,r,c,d,u,h,m,f,p,g,v,j,y,_,w,O,x,C,E,k,A,S,M,F,T,z,D,N,L,l=this;if(e==null){this.out.addByte(0);return}switch(this.out.addByte(e.e._hx_index+1),n=e.e,n._hx_index){case 0:j=n.c,this.writeConst(j);break;case 1:i=n.v,this.writeVar(i);break;case 2:C=n.g,this.out.addByte(C._hx_index);break;case 3:o=n.e,this.writeExpr(o);break;case 4:for(c=n.el,r=b(this,this.writeExpr),this.writeVarInt(c.length),s=0;s<c.length;)i=c[s],++s,r(i);break;case 5:d=n.op,o=n.e1,y=n.e2,d._hx_index==20?(A=d.op,this.out.addByte(A._hx_index|128)):this.out.addByte(d._hx_index),this.writeExpr(o),this.writeExpr(y);break;case 6:d=n.op,o=n.e1,this.out.addByte(d._hx_index),this.writeExpr(o);break;case 7:i=n.v,M=n.init,this.writeVar(i),this.writeExpr(M);break;case 8:for(o=n.e,a=n.args,this.writeExpr(o),r=b(this,this.writeExpr),this.writeVarInt(a.length),s=0;s<a.length;)i=a[s],++s,r(i);break;case 9:if(o=n.e,u=n.regs,this.writeExpr(o),u.length==0)throw t.thrown("assert");for(m=u.length-1,v=2,s=0;s<u.length;)k=u[s],++s,m|=k._hx_index<<v,v+=2;this.out.addByte(m&255),this.out.addByte(m>>8);break;case 10:_=n.econd,w=n.eif,O=n.eelse,this.writeExpr(_),this.writeExpr(w),this.writeExpr(O);break;case 11:break;case 12:o=n.e,this.writeExpr(o);break;case 13:i=n.v,x=n.it,g=n.loop,this.writeVar(i),this.writeExpr(x),this.writeExpr(g);break;case 14:break;case 15:break;case 16:o=n.e,E=n.index,this.writeExpr(o),this.writeExpr(E);break;case 17:for(c=n.el,r=b(this,this.writeExpr),this.writeVarInt(c.length),s=0;s<c.length;)i=c[s],++s,r(i);break;case 18:for(o=n.e,h=n.cases,S=n.def,this.writeExpr(o),this.writeVarInt(h.length),s=0;s<h.length;){for(i=h[s],++s,p=i.values,r=b(l,l.writeExpr),l.writeVarInt(p.length),f=0;f<p.length;)F=p[f],++f,r(F);l.writeExpr(i.expr)}this.writeExpr(S);break;case 19:o=n.e,g=n.loop,T=n.normalWhile,this.writeExpr(o),this.writeExpr(g),this.out.addByte(T?1:0);break;case 20:for(z=n.m,a=n.args,o=n.e,this.writeString(z),r=b(this,this.writeConst),this.writeVarInt(a.length),s=0;s<a.length;)i=a[s],++s,r(i);this.writeExpr(o);break;case 21:o=n.e,D=n.name,this.writeExpr(o),this.writeString(D);break;case 22:for(N=n.target,L=n.code,a=n.args,this.writeString(N),this.writeString(L),this.writeVarInt(a.length),n=0;n<a.length;)i=a[n],++n,l.writeExpr(i.e),l.out.addByte(i.access._hx_index);break}this.writeType(e.t)},readConst:function(){switch(this.input.readByte()){case 0:return m.CNull;case 1:return m.CBool(this.input.readByte()!=0);case 2:return m.CInt(this.input.readInt32());case 3:return m.CFloat(this.input.readDouble());case 4:return m.CString(this.readString());default:throw t.thrown("assert")}},readExpr:function(){var e,s,o,i,a,r,c,d,u,h,m,f,g,v,j,l=this,p=this.input.readByte();if(p--==0)return null;switch(p){case 0:e=n.TConst(this.readConst());break;case 1:e=n.TVar(this.readVar());break;case 2:e=n.TGlobal(pe.TGLOBALS[this.input.readByte()]);break;case 3:e=n.TParenthesis(this.readExpr());break;case 4:for(a=b(this,this.readExpr),s=[],o=0,i=this.readVarInt();o<i;)c=o++,s.push(a());e=n.TBlock(s);break;case 5:h=this.input.readByte(),e=n.TBinop(h>=128?T.OpAssignOp(pe.BOPS[h&127]):pe.BOPS[h],this.readExpr(),this.readExpr());break;case 6:e=n.TUnop(pe.UNOPS[this.input.readByte()],this.readExpr());break;case 7:e=n.TVarDecl(this.readVar(),this.readExpr());break;case 8:for(r=this.readExpr(),a=b(this,this.readExpr),s=[],o=0,i=this.readVarInt();o<i;)c=o++,s.push(a());e=n.TCall(r,s);break;case 9:if(r=this.readExpr(),d=this.input.readUInt16(),u=pe.TSWIZ.h[d],u==null){for(s=[],o=0,i=(d&3)+1;o<i;)c=o++,s.push(pe.REGS[d>>c*2+2&3]);u=s,pe.TSWIZ.h[d]=u}e=n.TSwiz(r,u);break;case 10:e=n.TIf(this.readExpr(),this.readExpr(),this.readExpr());break;case 11:e=n.TDiscard;break;case 12:e=n.TReturn(this.readExpr());break;case 13:e=n.TFor(this.readVar(),this.readExpr(),this.readExpr());break;case 14:e=n.TContinue;break;case 15:e=n.TBreak;break;case 16:e=n.TArray(this.readExpr(),this.readExpr());break;case 17:for(a=b(this,this.readExpr),s=[],o=0,i=this.readVarInt();o<i;)c=o++,s.push(a());e=n.TArrayDecl(s);break;case 18:for(r=this.readExpr(),s=[],o=0,i=this.readVarInt();o<i;){for(c=o++,a=b(l,l.readExpr),m=[],f=0,g=l.readVarInt();f<g;)j=f++,m.push(a());s.push({values:m,expr:l.readExpr()})}e=n.TSwitch(r,s,this.readExpr());break;case 19:e=n.TWhile(this.readExpr(),this.readExpr(),this.input.readByte()!=0);break;case 20:for(r=this.readString(),a=b(this,this.readConst),s=[],o=0,i=this.readVarInt();o<i;)c=o++,s.push(a());e=n.TMeta(r,s,this.readExpr());break;case 21:e=n.TField(this.readExpr(),this.readString());break;case 22:for(r=this.readString(),v=this.readString(),s=[],o=0,i=this.readVarInt();o<i;)c=o++,s.push({e:l.readExpr(),access:Y.createEnumIndex(xn,l.input.readByte(),null),read:!1,write:!1});e=n.TSyntax(r,v,s);break;default:throw t.thrown("assert")}return{e,t:this.readType(),p:null}},readVar:function(){var e,n,o,i,a,c,l,d,s=this.readVarInt();if(s==0)return null;if(n=this.varMap.h[s],n!=null)return n;if(n={id:r.allocVarId(),name:this.readString(),type:null,kind:null},this.varMap.h[s]=n,n.type=this.readType(),n.kind=pe.VKINDS[this.input.readByte()],n.parent=this.readVar(),o=this.input.readByte(),o>0)for(n.qualifiers=[],i=0,c=o;i<c;){switch(d=i++,l=this.input.readByte(),l){case 0:a=this.input.readInt32(),e=I.Const(a==0?null:a);break;case 1:e=I.Private;break;case 2:e=I.Nullable;break;case 3:e=I.PerObject;break;case 4:e=I.Name(this.readString());break;case 5:e=I.Shared;break;case 6:e=I.Precision(pe.PRECS[this.input.readByte()]);break;case 7:e=I.Range(this.input.readDouble(),this.input.readDouble());break;case 8:e=I.Ignore;break;case 9:e=I.PerInstance(this.input.readInt32());break;case 10:e=I.Doc(this.readString());break;case 11:e=I.Borrow(this.readString());break;case 12:e=I.Sampler(this.readString());break;case 13:e=I.Final;break;case 14:e=I.Flat;break;default:throw t.thrown("assert")}n.qualifiers.push(e)}return n},readFun:function(){for(var a,n=pe.FKIND[this.input.readByte()],s=this.readVar(),o=b(this,this.readVar),e=[],t=0,i=this.readVarInt();t<i;)a=t++,e.push(o());return{kind:n,ref:s,args:e,ret:this.readType(),expr:this.readExpr()}},unserialize:function(e){if(this.input=new Nt(Nn.decode(e,!1)),this.input.readByte()!=(pe.SIGN&255)||this.input.readByte()!=(pe.SIGN>>8&255))throw t.thrown("Invalid HXSL data");if(this.version=this.input.readByte()-139,this.version<0||this.version>1)throw t.thrown("Invalid HXSL data");this.varMap=new le,this.types=[];for(var a,r,c=this.readString(),o=b(this,this.readVar),n=[],s=0,i=this.readVarInt();s<i;)a=s++,n.push(o());for(r=n,o=b(this,this.readFun),n=[],s=0,i=this.readVarInt();s<i;)a=s++,n.push(o());return{name:c,vars:r,funs:n}},serialize:function(e){this.varMap=new le,this.idMap=new le,this.typeIdMap=new vo,this.out=new Kn,this.out.addByte(pe.SIGN&255),this.out.addByte(pe.SIGN>>8&255),this.out.addByte(pe.SIGN>>16&255),this.writeString(e.name);var t,s,n=e.vars,o=b(this,this.writeVar);for(this.writeVarInt(n.length),t=0;t<n.length;)s=n[t],++t,o(s);for(n=e.funs,o=b(this,this.writeFun),this.writeVarInt(n.length),t=0;t<n.length;)s=n[t],++t,o(s);return Nn.encode(this.out.getBytes(),!1)},__class__:pe},Ge=function(e,t){this.s=e,this.next=t},c["hxsl.ShaderList"]=Ge,Ge.__name__="hxsl.ShaderList",Ge.addSort=function(e,t){for(var o,s=null,n=t;n!=null&&n.s.priority<e.priority;)s=n,n=n.next;return s==null?(o=new Ge(e,t),Ge.checkSize(o),o):(s.next=new Ge(e,s.next),Ge.checkSize(t),t)},Ge.checkSize=function(e){if(Ge.MAX_LIST_SIZE<=0)return;for(var n=e,s=0;n!=null;){if(!Ge.ALLOW_DUPLICATES&&n.next!=null&&n.next.s==n.s)throw t.thrown("Duplicate shader "+o.string(n.s));++s,n=n.next}if(s>Ge.MAX_LIST_SIZE)throw t.thrown("Too many shaders")},Ge.prototype={clone:function(){return new Ge(this.s.clone(),this.next==null?null:this.next.clone())},iterator:function(){return new Go(this,null)},iterateTo:function(e){return new Go(this,e)},__class__:Ge},Go=function(e,t){this.l=e,this.last=t},c["hxsl._ShaderList.ShaderIterator"]=Go,Go.__name__="hxsl._ShaderList.ShaderIterator",Go.prototype={hasNext:function(){return this.l!=this.last},next:function(){var e=this.l.s;return this.l=this.l.next,e},__class__:Go},ia=function(e){this.id=++ia.UID,this.shader=e,this.params=new le},c["hxsl.ShaderInstance"]=ia,ia.__name__="hxsl.ShaderInstance",ia.prototype={__class__:ia},qr=function(e,t){this.v=e,this.globalId=t},c["hxsl.ShaderGlobal"]=qr,qr.__name__="hxsl.ShaderGlobal",qr.prototype={__class__:qr},qo=function(e,t,n){this.v=e,this.pos=t,this.bits=n},c["hxsl.ShaderConst"]=qo,qo.__name__="hxsl.ShaderConst",qo.prototype={__class__:qo},st=function(e,t){if(this.instanceCache=new le,this.consts=null,this.globals=[],e=="")return;this.module=t,this.data=(new pe).unserialize(e);for(var o,n=0,s=this.data.vars;n<s.length;)o=s[n],++n,this.initVarId(o);this.data=st.compactMem(this.data),this.initialize(),this.initLiveReload()},c["hxsl.SharedShader"]=st,st.__name__="hxsl.SharedShader",st.mergeVars=function(e,t){if(e.length!=t.length)return!1;for(var e,n,s,i,a,r,l,d,u,o=0,c=e;o<c.length;){if(l=c[o],d=o++,u=d,n=l,s=t[u],n.name!=s.name)return!1;if(s.id=n.id,i=n.type,a=s.type,i._hx_index==13&&a._hx_index==13){if(r=a.vl,e=i.vl,e.length!=r.length)return!1;if(!st.mergeVars(e,r))return!1}}return!0},st.loadShader=function(e){var s=e.getText();throw t.thrown("Shader live reload requires --library hscript")},st.compactMem=function(e){return e},st.prototype={initialize:function(){for(var n,e=0,t=this.data.vars;e<t.length;)n=t[e],++e,this.browseVar(n)},getInstance:function(e){var t=this.instanceCache.h[e];return t??this.makeInstance(e)},makeBufferType:function(e,n,s){var e,o,a,c,l,d,h,m,f,p,g,b,j,y,_,O,x,C,E,k,w=e.name;if(n._hx_index==13){for(x=n.vl,l=[],_=0,C=s.inputs;_<C.length;)c=C[_++],l.push(c);for(f=l,p=[],h=0;h<f.length;){switch(c=f[h++],w=c.name,c.type){case 1:a=i.TFloat;break;case 2:a=i.TVec(2,v.VFloat);break;case 3:a=i.TVec(3,v.VFloat);break;case 4:a=i.TVec(4,v.VFloat);break;case 9:a=i.TBytes(4);break;case 16:a=i.TMat4;break}if(M.endsWith(c.name,"__m0")){for(y=c.type,g=y==H.__cast(9,St)?1:y,d=2;f[h+d-1]!=null&&M.endsWith(f[h+d-1].name,"__m"+d);)++d;switch(d){case 2:if(g==2)a=i.TMat2;else throw t.thrown("Unsupported matrix format");break;case 3:switch(g){case 3:a=i.TMat3;break;case 4:a=i.TMat3x4;break;default:throw t.thrown("Unsupported matrix format")}break;case 4:if(g==4)a=i.TMat4;else throw t.thrown("Unsupported matrix format");break;default:throw t.thrown("Unsupported matrix format")}w=u.substr(c.name,0,-4),h+=d-1}p.push({id:r.allocVarId(),name:w,type:a,kind:e.kind,parent:e})}for(l=0;l<x.length;){for(e=x[l],++l,O=!1,b=0;b<p.length;)if(o=p[b],++b,e.name==o.name){switch(j=e.type,m=o.type,j._hx_index){case 3:if(m._hx_index!=3&&!Y.enumEq(e.type,o.type))throw t.thrown("Buffer "+this.data.name+"."+e.name+":"+r.toString(e.type)+" should be "+r.toString(o.type));break;case 5:if(j.t._hx_index==1){if(m._hx_index==5){if(m.t._hx_index==1){if(E=m.size,k=j.size,k>E&&!Y.enumEq(e.type,o.type))throw t.thrown("Buffer "+this.data.name+"."+e.name+":"+r.toString(e.type)+" should be "+r.toString(o.type))}else if(!Y.enumEq(e.type,o.type))throw t.thrown("Buffer "+this.data.name+"."+e.name+":"+r.toString(e.type)+" should be "+r.toString(o.type))}else if(!Y.enumEq(e.type,o.type))throw t.thrown("Buffer "+this.data.name+"."+e.name+":"+r.toString(e.type)+" should be "+r.toString(o.type))}else if(!Y.enumEq(e.type,o.type))throw t.thrown("Buffer "+this.data.name+"."+e.name+":"+r.toString(e.type)+" should be "+r.toString(o.type));break;default:if(!Y.enumEq(e.type,o.type))throw t.thrown("Buffer "+this.data.name+"."+e.name+":"+r.toString(e.type)+" should be "+r.toString(o.type))}O=!0;break}if(!O)throw t.thrown("Buffer is missing "+this.data.name+"."+e.name+":"+r.toString(e.type))}return i.TStruct(p)}throw t.thrown("assert")},makeInstance:function(e){for(var s,o,r,c,l,d,u,h,f,p,v,b,j,_,w,a=new Sc,n=this.consts,g=[];n!=null;){switch(s=n.v.type,s._hx_index){case 1:a.setConstant(n.v,m.CInt(e>>>n.pos&(1<<n.bits)-1));break;case 2:a.setConstant(n.v,m.CBool((e>>>n.pos&1)!=0));break;case 16:switch(l=s.t,_=s.size,d=s.kind,v=e>>>n.pos&(1<<n.bits)-1,b=y.fromID(v),o={id:n.v.id,name:n.v.name,kind:n.v.kind,type:null},j=this.makeBufferType(o,l,b),d._hx_index){case 3:u=Qe.Uniform;break;case 4:u=Qe.Storage;break;case 5:u=Qe.RW;break;default:throw t.thrown("assert")}o.type=i.TBuffer(j,_,u),a.varMap.set(n.v,o),g.push(o);break;case 17:r=s.size,a.setConstant(n.v,m.CInt(e>>>n.pos&(1<<n.bits)-1));break;default:throw t.thrown("assert")}n=n.next}for(s=0;s<g.length;)o=g[s],++s,r=o.type,r._hx_index==16&&(f=r.size,f._hx_index==1&&(w=f.v,l=r.t,d=r.kind,n=a.constants.h[w.id],n!=null&&n!=null&&n._hx_index==0&&(p=n.c,p._hx_index==2&&(c=p.v,o.type=i.TBuffer(l,ke.SConst(c),d)))));for(a.inlineCalls=!0,a.unrollLoops=st.UNROLL_LOOPS,h=a.eval(this.data),h=st.compactMem(h),c=new ia(h),this.paramsCount=0,s=0,r=this.data.vars;s<r.length;)o=r[s],++s,this.addParam(a,c,o);return this.instanceCache.h[e]=c,c},addSelfParam:function(e,t){var s,o,n=t.type;if(n._hx_index==13)for(s=n.vl,n=0;n<s.length;)o=s[n],++n,this.addSelfParam(e,o);else t.kind==O.Param&&(e.params.h[t.id]=this.paramsCount,this.paramsCount++)},addParam:function(e,t,n){var o,i,s=n.type;if(s._hx_index==13)for(o=s.vl,s=0;s<o.length;)i=o[s],++s,this.addParam(e,t,i);else n.kind==O.Param&&(t.params.h[e.varMap.h[n.__id__].id]=this.paramsCount,this.paramsCount++)},initVarId:function(e){e.id=r.allocVarId();var e,n,t=e.type;if(t._hx_index==13)for(n=t.vl,t=0;t<n.length;)e=n[t],++t,this.initVarId(e)},browseVar:function(e,t){t==null?t=r.getName(e):t+="."+e.name;var s,o,i,a,c,l,n=e.type;if(n._hx_index==13)for(i=n.vl,n=0;n<i.length;)c=i[n],++n,this.browseVar(c,t);else{if(s=0,e.kind==O.Global&&(s=ie.allocID(t),this.globals.push(new qr(e,s))),!r.isConst(e))return;a=r.getConstBits(e),a>0&&(l=this.consts==null?0:this.consts.pos+this.consts.bits,o=new qo(e,l,a),o.globalId=s,o.next=this.consts,this.consts=o)}},initLiveReload:function(){if(this.module==null)return;if(!bo.isActive())return;st.SHADER_RESOLVE.h[this.data.name]=this;var e=this.module.split(".").join("/")+".hx";this.file=bo.resolve(e),this.file!=null&&this.file.watch(b(this,this.onFileReload))},onFileReload:function(){for(var e,t=st.SHADER_RESOLVE.h,o=t,n=Object.keys(t),i=n.length,s=0;s<i;)e=o[n[s++]],e.file==this.file&&e.reloadShader()},reloadShader:function(){try{var e,n,s,i,a,o=st.loadShader(this.file,this.data.name);if(o==null)return;n=new C,n.loadShader=function(e){var n=st.SHADER_RESOLVE.h[e];if(n==null)throw t.thrown("Could not resolve shader "+e);if(n.file==null)throw t.thrown("Shader "+e+" can't be live reload because of missing live path");return st.loadShader(n.file,n.data.name)},i=n.check(this.data.name,o),this.applyChanges(i)}catch(n){if(s=t.caught(n).unwrap(),s instanceof De){e=s,a=u.substr(this.file.getText(),0,e.pos.min).split(`
`).length,be.trace(e.msg,{methodName:null,className:null,fileName:e.pos.file,lineNumber:a});return}throw n}},applyChanges:function(e){return!!st.mergeVars(this.data.vars,e.vars)&&(this.data=st.compactMem(e),this.instanceCache=new le,!0)},__class__:st},Uo=function(e){this.v=e,this.read=0,this.write=0},c["hxsl._Splitter.VarProps"]=Uo,Uo.__name__="hxsl._Splitter.VarProps",Uo.prototype={__class__:Uo},jr=function(){},c["hxsl.Splitter"]=jr,jr.__name__="hxsl.Splitter",jr.prototype={split:function(e,s){var o,a,c,l,d,u,h,m,f,p,g,v,b,j,y,_,w,x,C,E,k,A,S,M,F,D,N,L,z=this;for(this.isBatchShader=s,d=null,u=new le,x=[],l=null,f=new le,E=[],A=!1,this.varNames=new fe,this.varMap=new Rt,o=0,c=e.funs;o<c.length;)switch(v=c[o],++o,v.kind._hx_index){case 1:this.vars=f,this.avars=E,l=v,this.checkExpr(v.expr);break;case 0:case 4:this.vars=u,this.avars=x,d=v,this.checkExpr(v.expr),v.kind==de.Main&&(A=!0);break;default:throw t.thrown("assert")}for(w=[],M=x.length,o=0,c=M;o<c;){if(y=o++,b=[x[y]],p=[b[0].v],b[0].local)continue;switch(p[0].kind._hx_index){case 3:case 4:S=f.h[b[0].origin.id],p[0].kind=S!=null&&S.read>0?O.Var:O.Local;break;default:}switch(p[0].kind._hx_index){case 3:case 5:(b[0].read>0||b[0].write>1)&&(h={id:r.allocVarId(),name:p[0].name,kind:O.Local,type:p[0].type},this.uniqueName(h),this.varMap.set(b[0].origin,h),j=new Uo(h),j.read++,u.h[h.id]=j,C=d.expr.p,F=[{e:n.TBinop(T.OpAssign,{e:n.TVar(p[0]),t:h.type,p:C},{e:n.TVar(h),t:p[0].type,p:C}),t:h.type,p:C}],w.push(function(e){return function(){z.addExpr(d,e[0])}}(F)),p[0].kind==O.Var&&w.push(function(e,t){return function(){z.varMap.set(t[0].origin,e[0])}}(p,b)));break;default:}}for(d={ret:d.ret,ref:d.ref,kind:d.kind,args:d.args,expr:this.mapVars(d.expr)},o=0;o<w.length;)v=w[o],++o,v();for(_=[],o=0;o<E.length;)switch(g=E[o],++o,a=g.v,a.kind._hx_index){case 1:h={id:r.allocVarId(),name:a.name,kind:O.Var,type:a.type},this.uniqueName(h),y=u.h[g.origin.id],y==null&&(y=new Uo(a),u.h[g.origin.id]=y),y.read++,this.varMap.set(g.origin,h),j=new Uo(h),j.origin=g.origin,f.h[g.origin.id]=j,u.h[h.id]=j,this.addExpr(d,{e:n.TBinop(T.OpAssign,{e:n.TVar(h),t:a.type,p:d.expr.p},{e:n.TVar(a),t:a.type,p:d.expr.p}),t:a.type,p:d.expr.p});break;case 3:g.write>0&&(k={id:r.allocVarId(),name:a.name,kind:O.Local,type:a.type},this.uniqueName(k),_.push({e:n.TVarDecl(k,{e:n.TVar(a),t:a.type,p:l.expr.p}),t:i.TVoid,p:l.expr.p}),this.varMap.set(g.origin,k));break;default:}for(a=u.iterator();a.hasNext();)m=a.next(),this.checkVar(m,!0,u,d.expr.p);for(a=f.iterator();a.hasNext();)m=a.next(),this.checkVar(m,!1,u,l.expr.p);if(l!=null)if(l={ret:l.ret,ref:l.ref,kind:l.kind,args:l.args,expr:this.mapVars(l.expr)},o=l.expr.e,o._hx_index==4)for(D=o.el,o=0;o<_.length;)N=_[o],++o,D.unshift(N);else _.push(l.expr),l.expr={e:n.TBlock(_),t:i.TVoid,p:l.expr.p};for(o=[],a=u.iterator();a.hasNext();)m=a.next(),m.local||o.push(m);for(u=o,o=[],a=f.iterator();a.hasNext();)m=a.next(),m.local||o.push(m);if(f=o,u.sort(function(e,t){var n=(e.origin==null?e.v.id:e.origin.id)-(t.origin==null?t.v.id:t.origin.id);return n!=0?n:e.v.id-t.v.id}),f.sort(function(e,t){var n=(e.origin==null?e.v.id:e.origin.id)-(t.origin==null?t.v.id:t.origin.id);return n!=0?n:e.v.id-t.v.id}),A){for(o=[],c=0;c<u.length;)a=u[c],++c,o.push(a.v);return[{name:"main",vars:o,funs:[d]}]}for(o=[],c=0;c<u.length;)a=u[c],++c,o.push(a.v);for(L={name:"vertex",vars:o,funs:[d]},o=[],c=0;c<f.length;)a=f[c],++c,o.push(a.v);return[L,{name:"fragment",vars:o,funs:[l]}]},addExpr:function(e,t){var o,s=e.expr.e;s._hx_index==4?(o=s.el,o.push(t)):e.expr={e:n.TBlock([e.expr,t]),t:i.TVoid,p:e.expr.p}},checkVar:function(e,n,s,o){switch(e.v.kind._hx_index){case 3:if(!n){var i=s.h[e.origin.id];if(i!=null&&i.v.kind==O.Input)return;if(e.requireInit&&(i==null||i.write==0))throw t.thrown(new De("Varying "+e.v.name+" is not written by vertex shader",o))}break;case 4:if(e.requireInit&&(e.origin.parent==null||e.origin.parent.name!="global"&&!this.isBatchShader))throw t.thrown(new De("Variable "+e.v.name+" is used without being initialized",o));break;default:}},mapVars:function(e){var t,o,i,a,c,s=e.e;switch(s._hx_index){case 1:return o=s.v,t=this.varMap.h[o.__id__],t==null?e:{e:n.TVar(t),t:e.t,p:e.p};break;case 7:return o=s.v,i=s.init,t=this.varMap.h[o.__id__],t==null?r.map(e,b(this,this.mapVars)):{e:n.TVarDecl(t,i==null?null:this.mapVars(i)),t:e.t,p:e.p};break;case 13:return o=s.v,a=s.it,c=s.loop,t=this.varMap.h[o.__id__],t==null?r.map(e,b(this,this.mapVars)):{e:n.TFor(t,this.mapVars(a),this.mapVars(c)),t:e.t,p:e.p};break;default:return r.map(e,b(this,this.mapVars))}},get:function(e){var t,n,o,i,a,c,l,d,u,h,m,f,p,s=this.vars.h[e.id];if(s==null){if(n=this.varMap.h[e.__id__],n==null){if(e.kind==O.Global||e.kind==O.Output||e.kind==O.Input)n=e;else{if(n={id:r.allocVarId(),name:e.name,kind:e.kind,type:e.type},e.qualifiers!=null)for(o=0,i=e.qualifiers;o<i.length;)switch(t=i[o],++o,t._hx_index){case 0:c=t.max;break;case 4:a=t.n;break;case 6:l=t.p;break;case 7:d=t.min,u=t.max;break;case 1:case 2:case 3:case 5:case 8:break;case 9:h=t.v;break;case 10:m=t.s;break;case 11:f=t.source;break;case 12:p=t.name;break;case 13:case 14:n.qualifiers==null&&(n.qualifiers=[]),n.qualifiers.push(t);break}this.uniqueName(n)}this.varMap.set(e,n)}s=new Uo(n),s.origin=e,this.vars.h[e.id]=s,this.avars.push(s)}return s},uniqueName:function(e){if(e.kind==O.Global||e.kind==O.Output||e.kind==O.Input)return;var t,n,s=this.varNames.h[e.name];if(s!=null&&s!=e){for(t=e.name;u.cca(t,t.length-1)>=48&&u.cca(t,t.length-1)<=57;)t=u.substr(t,0,-1);for(n=t==e.name?2:o.parseInt(u.substr(e.name,t.length,null));Object.prototype.hasOwnProperty.call(this.varNames.h,t+n);)++n;e.name=t+n}this.varNames.h[e.name]=e},checkExpr:function(e){var t,s,o,i,a,c,l,d,u,h,m,f,p,g,v,j,y=this,n=e.e;switch(n._hx_index){case 1:i=n.v,t=this.get(i),t.write==0&&(t.requireInit=!0),t.read++;break;case 5:switch(s=n.op,a=n.e1,d=n.e2,s._hx_index){case 4:switch(o=a.e,l=a.p,l=a.t,o._hx_index){case 1:i=o.v,c=d,t=this.get(i),t.write++,this.checkExpr(c);break;case 9:l=o.e,m=o.regs,o=l.e,m=l.p,m=l.t,o._hx_index==1?(i=o.v,c=d,t=this.get(i),t.write++,this.checkExpr(c)):r.iter(e,b(this,this.checkExpr));break;default:r.iter(e,b(this,this.checkExpr))}break;case 20:switch(o=s.op,s=a.e,o=a.p,o=a.t,s._hx_index){case 1:i=s.v,c=d,t=this.get(i),t.write==0&&(t.requireInit=!0),t.read++,t.write++,this.checkExpr(c);break;case 9:a=s.e,o=s.regs,s=a.e,o=a.p,o=a.t,s._hx_index==1?(i=s.v,c=d,t=this.get(i),t.write==0&&(t.requireInit=!0),t.read++,t.write++,this.checkExpr(c)):r.iter(e,b(this,this.checkExpr));break;default:r.iter(e,b(this,this.checkExpr))}break;default:r.iter(e,b(this,this.checkExpr))}break;case 7:i=n.v,f=n.init,t=this.get(i),t.local=!0,f!=null&&(this.checkExpr(f),t.write++);break;case 13:i=n.v,g=n.it,v=n.loop,this.checkExpr(g),t=this.get(i),t.local=!0,t.write++,this.checkExpr(v);break;case 22:for(s=n.target,s=n.code,p=n.args,u=null,h=null,h=function(e){var t,s,n=e.e;if(n._hx_index==1)switch(s=n.v,t=y.get(s),u.access._hx_index){case 0:t.read--;break;case 1:t.write++;break;case 2:t.read--,t.write++;break}else r.iter(e,h)},n=0,s=p.length;n<s;)j=n++,u=p[j],h(u.e),this.checkExpr(u.e);break;default:r.iter(e,b(this,this.checkExpr))}},__class__:jr},sl=function(){},c["hxsl.ChannelTools"]=sl,sl.__name__="hxsl.ChannelTools",sl.isPackedFormat=function(e){return e.format==S.nativeFormat},Vc=function(){},c["js.html._CanvasElement.CanvasUtil"]=Vc,Vc.__name__="js.html._CanvasElement.CanvasUtil",Vc.getContextWebGL=function(e,t){var s="webgl",n=e.getContext(s,t);return n??(s="experimental-webgl",n=e.getContext(s,t),n??null)},Xc=function(){},c["js.lib._ArrayBuffer.ArrayBufferCompat"]=Xc,Xc.__name__="js.lib._ArrayBuffer.ArrayBufferCompat",Xc.sliceImpl=function(e,t){var n=new Uint8Array(this,e,t==null?null:t-e),s=new Uint8Array(n.byteLength);return s.set(n),s.buffer},Math.__name__="Math";function cl(e){return e instanceof Array?new Ws(e):e.iterator()}function b(t,n){if(n==null)return null;n.__id__==null&&(n.__id__=e.$haxeUID++);var s;return t.hx__closures__==null?t.hx__closures__={}:s=t.hx__closures__[n.__id__],s==null&&(s=n.bind(t),t.hx__closures__[n.__id__]=s),s}e.$haxeUID|=0,typeof performance!="undefined"&&typeof performance.now=="function"&&(u.now=performance.now.bind(performance)),c.Math=Math,String.fromCodePoint==null&&(String.fromCodePoint=function(e){return e<65536?String.fromCharCode(e):String.fromCharCode((e>>10)+55232)+String.fromCharCode((e&1023)+56320)}),Object.defineProperty(String.prototype,"__class__",{value:c.String=String,enumerable:!1,writable:!0}),String.__name__="String",c.Array=Array,Array.__name__="Array",Date.prototype.__class__=c.Date=Date,Date.__name__="Date",St={},ll={},dl=Number,ul=Boolean,hl={},ml={},Xi.content=[{name:"R_customFont_png",data:"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"},{name:"R_hxlogo_png",data:"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P+/cwTIA5Bb8C94ZvEi82nCXZrx7c2F9fvitW59///3987xRJyb6ngGMMY1Goz7LV5qms33QA+AbWknSaDbr9Xp40Wq18HWtVmu1kvmc/flt219+5RX8IH5N12rNZjPNMjxIbRp/oh/Hxyc2btx01ON88YtfVFpOTk3WGrVmq1HHK2rS92ariavD4/zhD39ATjvygy/t2rV9xw46Wb1OC6F3t/D9+O/09DT+e8opp3z6058u3o9vm5qezheO76nV8Gu2uzfbF94m/CwtsNG0tpfDmI8ffc8Aot26/kjwmNJZK/byOWK+PYI61EYeetijYu+ePW+//XbxI5XlU/+s/ICO8eqrrx71ONdff/3lV1xRHa0iP4detvlXe2XIyRvWb9i586XOT7362p5du/4wOTkZLti1e71RzwrqDwPLl590442fX7lyZfERyQhvoKm/NPpXHoPmcPA29XlroL5ngPAwxEwAMVfBp6P5jKL4ePgRybcgiPmc/Y033sCNMHw20FxxVeEa8E/4hkceefSoh/q7//gfPvqxj0gq0+dm62HGHjju7UBHQ2UP9ZnOj2zd+tyLL77Y1nDyll0+L1z01Wr1sssuu/HGG448V8H84cWMd28OFDdtnnfpREbfM8DcvZzmnrJYEEGhJYfXYY886ok3btr89jvv0pY/E8NIqbiTusuMQXvgqEdD3P6128dGx3DfV1JxO6NQuJxLJ2Pts1u2PLc1V4R2vLATFfqpqamCKAPLM/MIrfXZZ5/9uc997sglFwuHDqFXcMIhPxZcdehX5+FcT0dxHj8GgAFgNh7g+URzsYfokOCd21uQHkc96+uv73n33XcLLaKQA0EbKSgDtZc9e/e+8ebbcx8NcdWVV9zw2RsqlREe8Moztn0ulAJP4um2b98e3rxt27a9e/fCQSI+2K0f34mq/w033LB69aqjnhQ6BGAhEwolarb3Q1vKzX2HT3wMBgPMjKDdz/WG9vavlApPff4Hfx2Jeu9etJhFh/3QuaFCm6nwl2gWP/fcc/M57F/91V+cd955THw+UKDg8S3h8hDPPvvs+g3PrFu/Abd/VK6gg3WLVS1btuyyyy797Gevn+dawsIL3e+Qo82CwhTodyVokBkA6NHO+nyOVGrn2POOxJ49e9555x1oE71iBDLF7ywGRDg7vsiybPPmzfM88pe+9KWTTz45bPls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"},{name:"R_normalmap_png",data:"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"},{name:"R_customFont_fnt",data:"QkZOVAABEQA4LWJpdCBPcGVyYXRvcisgOAwADgBjdXN0b21Gb250LnBuZw4ACAA/AAAA7wAAAEkAPwAFAAcAAAABAAUAAAAAALYAAAAHAC4ABgAHAAEAAQAIAAAAAAAyAAAAVgABAAUABwABAAEABwAAAAAAUAAAABUAEwAFAAcAAQABAAcAAAAAAGwAAAA6ABwAAwAHAAEAAQAFAAAAAACmAAAARQAlAAEABwABAAEAAwAAAAAAaAAAACQAHAAFAAcAAQABAAcAAAAAADEAAABSAAEAAwAHAAEAAQAFAAAAAAA0AAAAYgABAAUABwABAAEABwAAAAAAyAAAAFUALgAGAAcAAQABAAcAAAAAANsAAABOADcABQAHAAEAAQAHAAAAAAD6AAAAEwBIAAUABwABAAEABwAAAAAAPgAAAB0ACgAEAAcAAQABAAYAAAAAAGcAAAAeAB4ABQAGAAEAAwAHAAAAAABmAAAAGQAcAAQABwABAAEABgAAAAAAagAAAC4AHAAFAAgAAQABAAcAAAAAAM4AAAB4AC4ABQAHAAAAAQAFAAAAAABvAAAATAAeAAUABQABAAMABwAAAAAAUgAAACIAEwAFAAcAAQABAAcAAAAAAFkAAABOABMABQAHAAEAAQAHAAAAAADdAAAAWgA3AAUABwABAAEABwAAAAAAtAAAAHcAJQACAAIAAQABAAQAAAAAADgAAAABAAoABQAHAAEAAQAHAAAAAABPAAAADwATAAUABwABAAEABwAAAAAA2QAAAEIANwAFAAcAAQABAAcAAAAAAHkAAAAPACcABQAGAAEAAwAHAAAAAADYAAAAOgA3AAcABwAAAAEABwAAAAAAZQAAABMAHgAFAAUAAQADAAcAAAAAAKgAAABHACUABAABAAEAAQAGAAAAAADRAAAADgA3AAYABwABAAEABwAAAAAARQAAAEcACgAGAAcAAQABAAcAAAAAAM0AAAB0AC4AAwAHAAEAAQAFAAAAAADJAAAAXAAsAAYACQABAP//BwAAAAAAzAAAAHAALgADAAcAAQABAAUAAAAAAOsAAAA1AD8ABQAHAAEAAQAHAAAAAAD2AAAAdgA/AAUABwABAAEABwAAAAAAywAAAGoALgAFAAcAAQABAAcAAAAAAGAAAAB0ABMAAgACAAEAAQAEAAAAAADDAAAANAAuAAYABwABAAEABwAAAAAALQAAAEAABAAEAAEAAQAEAAYAAAAAADYAAABuAAEABQAHAAEAAQAHAAAAAABOAAAACQATAAUABwABAAEABwAAAAAAfAAAACEAJQABAAcAAQABAAMAAAAAAHYAAAB1AB4ABQAFAAEAAwAHAAAAAABRAAAAGwATAAYACAABAAEABwAAAAAA7AAAADsAPwADAAcAAQABAAUAAAAAAE0AAAABABMABwAHAAEAAQAJAAAAAADyAAAAXQA/AAUABwABAAEABwAAAAAARgAAAE4ACgAGAAcAAQABAAcAAAAAAF4AAABpABMABQADAAEAAQAHAAAAAABtAAAAPgAeAAcABQABAAMACQAAAAAAJAAAABEAAQAFAAcAAQABAAcAAAAAAEwAAABxAAoABgAHAAEAAQAHAAAAAADFAAAAQQAuAAUABwABAAEABwAAAAAA5wAAABwAQAAGAAcAAAADAAcAAAAAAPUAAABvAD8ABgAHAAEAAQAHAAAAAAA5AAAABwAKAAUABwABAAEABwAAAAAARAAAAEEACgAFAAcAAQABAAcAAAAAANUAAAAnADcABgAHAAEAAQAHAAAAAAB6AAAAFQAnAAUABQABAAMABwAAAAAAtQAAAAEAMAAFAAYAAQADAAcAAAAAAO0AAAA/AD8AAwAHAAEAAQAFAAAAAABVAAAANAATAAUABwABAAEABwAAAAAAZAAAAA0AHAAFAAcAAQABAAcAAAAAAGIAAAABABwABQAHAAEAAQAHAAAAAABpAAAAKgAcAAMABwABAAEABQAAAAAA1gAAAC4ANwAFAAcAAQABAAcAAAAAAMoAAABjAC4ABgAHAAEAAQAHAAAAAADhAAAAcgA3AAUABwABAAEABwAAAAAA9wAAAAEASQAFAAUAAQACAAcAAAAAAD8AAAAiAAoABQAHAAEAAQAHAAAAAADcAAAAVAA3AAUABwABAAEABwAAAAAAsAAAAGwAJQAEAAQAAQABAAYAAAAAADMAAABcAAEABQAHAAEAAQAHAAAAAABrAAAANAAcAAUABwABAAEABwAAAAAAwAAAACIALgAFAAcAAQABAAcAAAAAANMAAAAbADcABQAHAAEAAQAHAAAAAAB9AAAAIwAlAAUABwABAAEABwAAAAAA+QAAAA0ASAAFAAcAAQABAAcAAAAAACAAAAABAAgAAAAA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"}],Bt.add(V.updateCursor,-1),H.__toStr={}.toString,ArrayBuffer.prototype.slice==null&&(ArrayBuffer.prototype.slice=Xc.sliceImpl),k.Element=0,k.PCData=1,k.CData=2,k.Comment=3,k.DocType=4,k.ProcessingInstruction=5,k.Document=6,vn.LN2=Math.log(2),Se.V1=3,Se.V2=2,Se.V25=0,Se.Reserved=1,Se.V1_Bitrates=[[d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad],[d.BR_Free,d.BR_32,d.BR_40,d.BR_48,d.BR_56,d.BR_64,d.BR_80,d.BR_96,d.BR_112,d.BR_128,d.BR_160,d.BR_192,d.BR_224,d.BR_256,d.BR_320,d.BR_Bad],[d.BR_Free,d.BR_32,d.BR_48,d.BR_56,d.BR_64,d.BR_80,d.BR_96,d.BR_112,d.BR_128,d.BR_160,d.BR_192,d.BR_224,d.BR_256,d.BR_320,d.BR_384,d.BR_Bad],[d.BR_Free,d.BR_32,d.BR_64,d.BR_96,d.BR_128,d.BR_160,d.BR_192,d.BR_224,d.BR_256,d.BR_288,d.BR_320,d.BR_352,d.BR_384,d.BR_416,d.BR_448,d.BR_Bad]],Se.V2_Bitrates=[[d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad,d.BR_Bad],[d.BR_Free,d.BR_8,d.BR_16,d.BR_24,d.BR_32,d.BR_40,d.BR_48,d.BR_56,d.BR_64,d.BR_80,d.BR_96,d.BR_112,d.BR_128,d.BR_144,d.BR_160,d.BR_Bad],[d.BR_Free,d.BR_8,d.BR_16,d.BR_24,d.BR_32,d.BR_40,d.BR_48,d.BR_56,d.BR_64,d.BR_80,d.BR_96,d.BR_112,d.BR_128,d.BR_144,d.BR_160,d.BR_Bad],[d.BR_Free,d.BR_32,d.BR_48,d.BR_56,d.BR_64,d.BR_80,d.BR_96,d.BR_112,d.BR_128,d.BR_144,d.BR_160,d.BR_176,d.BR_192,d.BR_224,d.BR_256,d.BR_Bad]],Se.SamplingRates=[[ne.SR_11025,ne.SR_12000,ne.SR_8000,ne.SR_Bad],[ne.SR_Bad,ne.SR_Bad,ne.SR_Bad,ne.SR_Bad],[ne.SR_22050,ne.SR_24000,ne.SR_12000,ne.SR_Bad],[ne.SR_44100,ne.SR_48000,ne.SR_32000,ne.SR_Bad]],en.LReserved=0,en.LLayer3=1,en.LLayer2=2,en.LLayer1=3,Ao.CStereo=0,Ao.CJointStereo=1,Ao.CDualChannel=2,Ao.CMono=3,So.ENone=0,So.EMs50_15=1,So.EReserved=2,So.ECCIT_J17=3,Oe.tmpPoint=new U(0,0),Ie.STRICT=!0,Ni.BUFFERING=!1,Cs.tmp=new Cs,ma.defaultUseScreenResolution=!1,wt.GUID=0,K.SOFTWARE_DRIVER=!1,K.ANTIALIASING=0,L.tmp=new L,L.lumR=.212671,L.lumG=.71516,L.lumB=.072169,L.SQ13=.57735026918962576450914878050196,Be.IDENTITY_DECOMPOSED=Be.L([1,0,0,0,0,1,1,0,0,0,1,0,0,0,0,1]),Xt.EPSILON=1e-6,Un.SLEEP_THRESHOLD=1e-4,Un.MAX_THRESHOLD=1e6,Wn.TMP_RAY=new nt,Wn.TMP_MAT=new L,se.ROT2RAD=-.017453292519943295769236907684886,se.NO_VELOCITY=-1,se.VELOCITY=0,se.tmpMat=new L,$.UID=0,$.ALLOW_WEBGL2=!0,$.hasMultiIndirectCount=!1,$.BLACK=function(){var i,t=0,n=0,s=0,o=0;return o==null&&(o=1),s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),i=new j(t,n,s,o),i}(this),$.outOfMemoryCheck=!1,$.STREAM_POS=1,$.TFILTERS=[[[9728,9728],[9729,9729]],[[9728,9984],[9729,9985]],[[9728,9986],[9729,9987]]],$.TWRAP=[33071,10497],$.FACES=[0,1028,1029,1032],$.BLEND=[1,0,770,768,772,774,771,769,773,775,32769,32771,32770,32772,776],$.COMPARE=[519,512,514,517,516,518,513,515],$.STENCIL_OP=[7680,0,7681,7682,34055,7683,34056,5386],$.OP=[32774,32778,32779,32775,32776],$.CUBE_FACES=[34069,34070,34071,34072,34073,34074],$.CBUFFERS=function(){for(var t,n,s,a,r,c,o=[],i=0;i<32;){for(a=i++,t=[],n=0,r=a;n<r;)c=n++,t.push(36064+c);o.push(t)}return s=o,s}(this),Ji.ELEMENT_SIZE=20,po.MAX_MEMORY=6442450944,po.SIZE=65532,po.ALL_FLAGS=ve.__empty_constructs__.slice(),ea.VERSION_KEY_WORD="VERSION",ea.VERSION=1,ea.MODE_KEY_WORD="MODE",Rn.checkFlags=-1,Cn.defaultKillAlphaThreshold=.5,Cn.loadingTextureColor=-65281,rs.current=new rs("Default"),F.enableLights_bits=1,F.enableLights_offset=0,F.enableLights_mask=1,F.dynamicParameters_bits=1,F.dynamicParameters_offset=1,F.dynamicParameters_mask=2,F.isStatic_bits=1,F.isStatic_offset=2,F.isStatic_mask=4,F.culled_bits=1,F.culled_offset=3,F.culled_mask=8,F.batchMode_bits=1,F.batchMode_offset=4,F.batchMode_mask=16,F.culling_bits=2,F.culling_offset=0,F.culling_mask=3,F.depthWrite_bits=1,F.depthWrite_offset=2,F.depthWrite_mask=4,F.depthClamp_bits=1,F.depthClamp_offset=3,F.depthClamp_mask=8,F.depthTest_bits=3,F.depthTest_offset=4,F.depthTest_mask=112,F.blendSrc_bits=4,F.blendSrc_offset=7,F.blendSrc_mask=1920,F.blendDst_bits=4,F.blendDst_offset=11,F.blendDst_mask=30720,F.blendAlphaSrc_bits=4,F.blendAlphaSrc_offset=15,F.blendAlphaSrc_mask=491520,F.blendAlphaDst_bits=4,F.blendAlphaDst_offset=19,F.blendAlphaDst_mask=7864320,F.blendOp_bits=3,F.blendOp_offset=23,F.blendOp_mask=58720256,F.blendAlphaOp_bits=3,F.blendAlphaOp_offset=26,F.blendAlphaOp_mask=469762048,F.wireframe_bits=1,F.wireframe_offset=29,F.wireframe_mask=536870912,F.reserved_bits=1,F.reserved_offset=30,F.reserved_mask=1073741824,Q.readMask_bits=8,Q.readMask_offset=0,Q.readMask_mask=255,Q.writeMask_bits=8,Q.writeMask_offset=8,Q.writeMask_mask=65280,Q.reference_bits=8,Q.reference_offset=16,Q.reference_mask=16711680,Q.frontTest_bits=3,Q.frontTest_offset=0,Q.frontTest_mask=7,Q.frontPass_bits=3,Q.frontPass_offset=3,Q.frontPass_mask=56,Q.frontSTfail_bits=3,Q.frontSTfail_offset=6,Q.frontSTfail_mask=448,Q.frontDPfail_bits=3,Q.frontDPfail_offset=9,Q.frontDPfail_mask=3584,Q.backTest_bits=3,Q.backTest_offset=12,Q.backTest_mask=28672,Q.backPass_bits=3,Q.backPass_offset=15,Q.backPass_mask=229376,Q.backSTfail_bits=3,Q.backSTfail_offset=18,Q.backSTfail_mask=1835008,Q.backDPfail_bits=3,Q.backDPfail_offset=21,Q.backDPfail_mask=14680064,S.UID=0,S.PREVENT_AUTO_DISPOSE=2147483647,S.PREVENT_FORCED_DISPOSE=-1,S.nativeFormat=f.RGBA,S.TRILINEAR_FILTERING_ENABLED=!0,S.DEFAULT_WRAP=hs.Clamp,S.checkerTextureKeys=new le,S.noiseTextureKeys=new le,S.genTextureKeys=new fe,aa.__meta__={obj:{ignore:["shader"]}},Fe.SRC="HXSMF2gzZC5zaGFkZXIuU2NyZWVuU2hhZGVyBwEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACghfX2luaXRfXw4GAAALBnZlcnRleA4GAAACAgoAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAALAAAFAQYEAgYFDAkDKw4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAA",Fe._MODULE="h3d.shader.ScreenShader",ro.SRC="HXSMHWgzZC5wYXNzLl9Cb3JkZXIuQm9yZGVyU2hhZGVyCQEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACgVjb2xvcgUMAgAACwhfX2luaXRfXw4GAAAMBnZlcnRleA4GAAANCGZyYWdtZW50DgYAAAMCCwAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAAwAAAUBBgQCBgUMCQMrDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ0AAAUBBgQCCAUMAgoFDAUMAA",ro._MODULE="h3d.pass.Border",io.SRC="HXSMHmgzZC5wYXNzLl9Db3B5LkFycmF5Q29weVNoYWRlcgoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoHdGV4dHVyZQoDAgAACwVsYXllcgECAAAMCF9faW5pdF9fDgYAAA0GdmVydGV4DgYAAA4IZnJhZ21lbnQOBgAAAwIMAAAFAgYEAgcFDAIIBQwFDAYEAgkFCgIDBQoFCgAADQAABQEGBAIGBQwJAysOBAoCAgUKAAADBgEKAgIFCgQAAwIEAwMBAwAAAAAAAAAAAwEDAAAAAAAA8D8DBQwFDAABDgAABQEGBAIIBQwJAyIOAgIKCgMJAyoOAgIJBQoJAycOAQILAQMFCwUMBQwA",io._MODULE="h3d.pass.Copy",Js.SRC="HXSMGWgzZC5wYXNzLl9Db3B5LkNvcHlTaGFkZXIJAQVpbnB1dA0BAgIIcG9zaXRpb24FCgEBAAMCdXYFCgEBAAEAAAQFZmxpcFkDAgAABQZvdXRwdXQNAgIGCHBvc2l0aW9uBQwEBQAHBWNvbG9yBQwEBQAEAAAICnBpeGVsQ29sb3IFDAQAAAkMY2FsY3VsYXRlZFVWBQoEAAAKB3RleHR1cmUKAgIAAAsIX19pbml0X18OBgAADAZ2ZXJ0ZXgOBgAADQhmcmFnbWVudA4GAAADAgsAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAAMAAAFAQYEAgYFDAkDKw4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAENAAAFAQYEAggFDAkDIg4CAgoKAgIJBQoFDAUMAA",Js._MODULE="h3d.pass.Copy",Zs.SRC="HXSMIWgzZC5wYXNzLl9DdWJlQ29weS5DdWJlQ29weVNoYWRlcgoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoHdGV4dHVyZQoGAgAACwNtYXQGAgAADAhfX2luaXRfXw4GAAANBnZlcnRleA4GAAAOCGZyYWdtZW50DgYAAAMCDAAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAA0AAAUBBgQCBgUMCQMrDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAAQ4AAAUCCA8CdXYFCgQAAAYDBgECCQUKAQMAAAAAAAAAQAMFCgEDAAAAAAAA8D8DBQoABgQCCAUMCQMiDgICCgoGCQMgDgEGAQkDKg4CAg8FCgEDAAAAAAAA8D8DBQsCCwYFCwULBQwFDAA",Zs._MODULE="h3d.pass.CubeCopy",ze.db=new fe,ze.FILE_NAME="model.props",ze.LOD_CONFIG="lodConfig",ze.LOD_CONFIG_FIELD="lods.screenRatio",ze.DYN_BONES_CONFIG="dynamicBones",ze.current=new ze,me.tmpMat=new L,at.FPosChanged=1,at.FVisible=2,at.FCulled=4,at.FFollowPositionOnly=8,at.FLightCameraCenter=16,at.FAllocated=32,at.FAlwaysSyncAnimation=64,at.FInheritCulled=128,at.FModelRoot=256,at.FIgnoreBounds=512,at.FIgnoreCollide=1024,at.FIgnoreParentTransform=2048,at.FCullingColliderInherited=4096,at.FFixedPosition=8192,at.FFixedPositionSynced=16384,at.FAlwaysSync=32768,at.FDrawn=65536,at.FInSync=131072,at.FPosChangedInSync=262144,Ri.__meta__={fields:{cameraView:{global:["camera.view"]},cameraNear:{global:["camera.zNear"]},cameraFar:{global:["camera.zFar"]},cameraProj:{global:["camera.proj"]},cameraPos:{global:["camera.position"]},cameraProjDiag:{global:["camera.projDiag"]},cameraProjFlip:{global:["camera.projFlip"]},cameraProjDepth:{global:["camera.projDepth"]},cameraViewProj:{global:["camera.viewProj"]},cameraInverseViewProj:{global:["camera.inverseViewProj"]},cameraPreviousViewProj:{global:["camera.previousViewProj"]},cameraJitterOffsets:{global:["camera.jitterOffsets"]},globalTime:{global:["global.time"]},pixelSize:{global:["global.pixelSize"]},globalModelView:{global:["global.modelView"]},globalModelViewInverse:{global:["global.modelViewInverse"]},globalPreviousModelView:{global:["global.previousModelView"]},globalFrame:{global:["global.frame"]}}},J.newWorldPos=function(){var o,t=0,n=0,s=0;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=new h(t,n,s),o}(this),J.expectedPos=function(){var o,t=0,n=0,s=0;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=new h(t,n,s),o}(this),J.tmpVec=function(){var o,t=0,n=0,s=0;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=new h(t,n,s),o}(this),J.tmpVec2=function(){var o,t=0,n=0,s=0;return s==null&&(s=0),n==null&&(n=0),t==null&&(t=0),o=new h(t,n,s),o}(this),J.tmpQ=new In,J.tmpQ2=new In,Ne.FIXED_DT=.016666666666666666,Ne.TMP_MAT=new L,ys.SRC="HXSMF2gzZC5zaGFkZXIuQW1iaWVudExpZ2h0CgEGZ2xvYmFsDQECAgxhbWJpZW50TGlnaHQFCwABAAMQcGVyUGl4ZWxMaWdodGluZwIAAQEAAAAAAAAAAAQKcGl4ZWxDb2xvcgUMBAAABQ9saWdodFBpeGVsQ29sb3IFCwQAAAYKbGlnaHRDb2xvcgULBAAABwhhZGRpdGl2ZQICAAEAAAAAAAgIX19pbml0X18OBgAACRBfX2luaXRfX2ZyYWdtZW50DgYAAAoJY2FsY0xpZ2h0DgYAAAsGdmVydGV4DgYAAAwIZnJhZ21lbnQOBgAABQIIAAAFAQYEAgYFCwsCBwICAgULCQMqDgEBAwAAAAAAAAAAAwULBQsFCwACCQAABQEGBAIFBQsLAgcCAgIFCwkDKg4BAQMAAAAAAAAAAAMFCwULBQsAAwoBDQpsaWdodENvbG9yBQsEAAAFCwUBDQsCBwICDQULBAYAAgIFCwYBCQMWDgIEBgMBAwAAAAAAAPA/AwICBQsFCwULAQMAAAAAAAAAAAMFCwINBQsFCwULBQsFCwAAAAsAAAUBCwcCAgMCAgaBCgIEBQySAAULCQIKDgECBgULBQsFCwAAAAEMAAAFAQsCAwIGgQoCBAUMkgAFCwkCCg4BAgUFCwULBQsAAAA",ys._MODULE="h3d.shader.AmbientLight",Qs.SRC="HXSMEWgzZC5zaGFkZXIuQmFzZTJkGwEFaW5wdXQNAQMCCHBvc2l0aW9uBQoBAQADAnV2BQoBAQAEBWNvbG9yBQwBAQABAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgEdGltZQMAAAAJBnpWYWx1ZQMCAAAKB3RleHR1cmUKAgIAAAsOc3ByaXRlUG9zaXRpb24FDAQAAAwQYWJzb2x1dGVQb3NpdGlvbgUMBAAADQpwaXhlbENvbG9yBQwEAAAODHRleHR1cmVDb2xvcgUMBAAADwxjYWxjdWxhdGVkVVYFCgMAABAKaXNSZWxhdGl2ZQICAAEAAAAAABEFY29sb3IFDAIAABIPYWJzb2x1dGVNYXRyaXhBBQsCAAATD2Fic29sdXRlTWF0cml4QgULAgAAFA1maWx0ZXJNYXRyaXhBBQsCAAAVDWZpbHRlck1hdHJpeEIFCwIAABYIaGFzVVZQb3MCAgABAAAAAAAXBXV2UG9zBQwCAAAYCWtpbGxBbHBoYQICAAEAAAAAABkKcGl4ZWxBbGlnbgICAAEAAAAAABoQaGFsZlBpeGVsSW52ZXJzZQUKAgAAGwl2aWV3cG9ydEEFCwIAABwJdmlld3BvcnRCBQsCAAAdDm91dHB1dFBvc2l0aW9uBQwEAAAeCF9faW5pdF9fDgYAAB8GdmVydGV4DgYAACAIZnJhZ21lbnQOBgAAAwIeAAAFBgYEAgsFDAkDKw4DAgIFCgIJAwEDAAAAAAAA8D8DBQwFDAsCEAIFAwYECgIMBQwAAAMJAx4OAgkDKg4CCgILBQwRAAUKAQMAAAAAAADwPwMFCwISBQsDAwYECgIMBQwEAAMJAx4OAgkDKg4CCgILBQwRAAUKAQMAAAAAAADwPwMFCwITBQsDAwYECgIMBQw5AAUKCgILBQw5AAUKBQoABgQCDAUMAgsFDAUMAAYEAg8FCgsCFgIGAAYBAgMFCgoCFwUMOQAFCgUKCgIXBQwRAAUKBQoCAwUKBQoFCgYEAg0FDAsCEAIGAQIRBQwCBAUMBQwCBAUMBQwFDAYEAg4FDAkDIg4CAgoKAgIPBQoFDAUMBoECDQUMAg4FDAUMAAAfAAAFBQghA3RtcAULBAAACQMqDgIKAgwFDBEABQoBAwAAAAAAAPA/AwULAAYEAiEFCwkDKg4DCQMeDgICIQULAhQFCwMJAx4OAgIhBQsCFQULAwEDAAAAAAAA8D8DBQsFCwYEAh0FDAkDKw4DCQMeDgICIQULAhsFCwMJAx4OAgIhBQsCHAULAwoCDAUMOQAFCgUMBQwLAhkCBoMKAh0FDBEABQoCGgUKBQoAAAYEAgYFDAIdBQwFDAABIAAABQILBg4CGAIGCQoCDQUMDAADAQP8qfHSTWJQPwMCAgwAAAAGBAIHBQwCDQUMBQwA",Qs._MODULE="h3d.shader.Base2d",xo.SRC="HXSME2gzZC5zaGFkZXIuQmFzZU1lc2gcAQZjYW1lcmENAQwCBHZpZXcHAAEAAwRwcm9qBwABAAQIcG9zaXRpb24FCwABAAUIcHJvakZsaXADAAEABghwcm9qRGlhZwULAAEABwh2aWV3UHJvagcAAQAIEHByZXZpb3VzVmlld1Byb2oHAAEACQ9pbnZlcnNlVmlld1Byb2oHAAEACgV6TmVhcgMAAQALBHpGYXIDAAEADANkaXIFCwMBAA0Naml0dGVyT2Zmc2V0cwUMAAEAAAAADgZnbG9iYWwNAgUPBHRpbWUDAA4AEAlwaXhlbFNpemUFCgAOABEJbW9kZWxWaWV3BwAOAQMSEG1vZGVsVmlld0ludmVyc2UHAA4BAxMRcHJldmlvdXNNb2RlbFZpZXcHAA4BAwAAABQFaW5wdXQNAwIVCHBvc2l0aW9uBQsBFAAWBm5vcm1hbAULARQAAQAAFwZvdXRwdXQNBAYYCHBvc2l0aW9uBQwEFwAZBWNvbG9yBQwEFwAaBWRlcHRoAwQXABsGbm9ybWFsBQsEFwAcCXdvcmxkRGlzdAMEFwAdCHZlbG9jaXR5BQoEFwAEAAAeEHJlbGF0aXZlUG9zaXRpb24FCwQAAB8TdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAIBtwcmV2aW91c1RyYW5zZm9ybWVkUG9zaXRpb24FCwQAACEYcGl4ZWxUcmFuc2Zvcm1lZFBvc2l0aW9uBQsEAAAiEXRyYW5zZm9ybWVkTm9ybWFsBQsEAAAjEXByb2plY3RlZFBvc2l0aW9uBQwEAAAkGXByZXZpb3VzUHJvamVjdGVkUG9zaXRpb24FDAQAACUKcGl4ZWxDb2xvcgUMBAAAJgVkZXB0aAMEAAAnC25kY1Bvc2l0aW9uBQoEAAAoE3ByZXZpb3VzTmRjUG9zaXRpb24FCgQAACkIc2NyZWVuVVYFCgQAACoJc3BlY1Bvd2VyAwQAACsJc3BlY0NvbG9yBQsEAAAsCXdvcmxkRGlzdAMEAAAtDXBpeGVsVmVsb2NpdHkFCgQAAC4FY29sb3IFDAIAAC8Nc3BlY3VsYXJQb3dlcgMCAAEHAAAAAAAAAAAAAAAAAABZQDAOc3BlY3VsYXJBbW91bnQDAgABBwAAAAAAAAAAAAAAAAAAJEAxDXNwZWN1bGFyQ29sb3IFCwIAADIIX19pbml0X18OBgAAMxBfX2luaXRfX2ZyYWdtZW50DgYAADQGdmVydGV4DgYAADUIZnJhZ21lbnQOBgAABAIyAAAFDQYEAh4FCwIVBQsFCwYEAh8FCwYBAh4FCwkDNQ4BAhEHCAULBQsGBAIjBQwGAQkDKw4CAh8FCwEDAAAAAAAA8D8DBQwCBwcFDAUMBgQCIAULBgECHgULCQM1DgECEwcIBQsFCwYEAiQFDAYBCQMrDgICIAULAQMAAAAAAADwPwMFDAIIBwUMBQwGBAIiBQsJAyAOAQQGAQIWBQsJAzMOAQIRBwYFCwULBQsFCwYEAgwFCwkDIA4BBAYDAgQFCwIfBQsFCwULBQsFCwYEAiUFDAIuBQwFDAYEAioDAi8DAwYEAisFCwYBAjEFCwIwAwULBQsGBAIpBQoJAzsOAQYCCgIjBQwRAAUKCgIjBQwMAAMFCgUKBQoGBAImAwYCCgIjBQwIAAMKAiMFDAwAAwMDBgQCLAMGAgkDHA4BBgMCHwULAgQFCwULAwILAwMDAAIzAAAFCgYEAiIFCwkDIA4BAiIFCwULBQsGBAInBQoGAgoCIwUMEQAFCgoCIwUMDAADBQoFCgYEAigFCgYCCgIkBQwRAAUKCgIkBQwMAAMFCgUKBgQCKQUKCQM7DgECJwUKBQoFCgYEAiYDBgIKAiMFDAgAAwoCIwUMDAADAwMGBAIqAwIvAwMGBAIrBQsGAQIxBQsCMAMFCwULBoMCJwUKCgINBQwRAAUKBQoGgwIoBQoKAg0FDDkABQoFCgYEAi0FCgYBBAYDAigFCgInBQoFCgUKCQMpDgIBAwAAAAAAAOA/AwEDAAAAAAAA4L8DBQoFCgUKAAA0AAAFAgYEAhgFDAYBAiMFDAkDKw4EAQMAAAAAAADwPwMCBQMBAwAAAAAAAPA/AwEDAAAAAAAA8D8DBQwFDAUMBgQCIQULAh8FCwULAAE1AAAFBQYEAhkFDAIlBQwFDAYEAhoDAiYDAwYEAhsFCwIiBQsFCwYEAhwDAiwDAwYEAh0FCgItBQoFCgA",xo._MODULE="h3d.shader.BaseMesh",Ts.SRC="HXSMFWgzZC5zaGFkZXIuQmxlbmRzaGFwZQcBBWlucHV0DQEEAghwb3NpdGlvbgULAQEAAwZub3JtYWwFCwEBAAQHd2VpZ2h0cwULAQEABQdpbmRleGVzCQQAAAABAQABAAAGEHJlbGF0aXZlUG9zaXRpb24FCwQAAAcKc2hhcGVDb3VudAECAAAIBnZjb3VudAECAAAJB29mZnNldHMQgQMAAAIAAAoHd2VpZ2h0cxCBAwAAAgAACwZ2ZXJ0ZXgOBgAAAQALAAAFAQ4MA2lkeAEEAAAGFQECAAAAAAECBwEPAQAABQIIDQlvZmZzZXRQb3MFCwQAAAkDKg4DEQIJEIEDAAAGAAQGAQYBAgwBAggBAQECAwAAAAEBAQQGAQNFAQECAwAAAAEBAQEDEQIJEIEDAAAGAAYABAYBBgECDAECCAEBAQIDAAAAAQEBBAYBA0UBAQIDAAAAAQEBAQECAQAAAAEBAxECCRCBAwAABgAGAAQGAQYBAgwBAggBAQECAwAAAAEBAQQGAQNFAQECAwAAAAEBAQEBAgIAAAABAQMFCwAGBAIGBQsGAAIGBQsGAQINBQsRAgoQgQMAAAIMAQMFCwULBQsAAAA",Ts._MODULE="h3d.shader.Blendshape",Oo.SRC="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",Oo._MODULE="h3d.shader.Blur",ks.SRC="HXSME2gzZC5zaGFkZXIuQ29sb3JBZGQDAQpwaXhlbENvbG9yBQwEAAACBWNvbG9yBQsCAAADCGZyYWdtZW50DgYAAAEBAwAABQEGgAoCAQUMkgAFCwICBQsFCwA",ks._MODULE="h3d.shader.ColorAdd",Hs.SRC="HXSME2gzZC5zaGFkZXIuQ29sb3JLZXkDAQhjb2xvcktleQUMAgAAAgx0ZXh0dXJlQ29sb3IFDAQAAAMIZnJhZ21lbnQOBgAAAQEDAAAFAggEBWNkaWZmBQwEAAAGAwICBQwCAQUMBQwACwYJCQMeDgICBAUMAgQFDAMBA/Fo44i1+OQ+AwIMAAAAAA",Hs._MODULE="h3d.shader.ColorKey",Es.SRC="HXSMFmgzZC5zaGFkZXIuQ29sb3JNYXRyaXgEAQpwaXhlbENvbG9yBQwEAAACBm1hdHJpeAcCAAADB2VuYWJsZWQCAgABAAAAAAAECGZyYWdtZW50DgYAAAEBBAAABQELAgMCBgQCAQUMCQMrDgIKBAYBCQMrDgIKAgEFDJIABQsBAwAAAAAAAPA/AwUMAgIHBQwFDJIABQsKBAYBAgEFDAICBwUMBQwMAAMFDAUMAAAA",Es._MODULE="h3d.shader.ColorMatrix",wo.SRC="HXSME2gzZC5zaGFkZXIuRGlyTGlnaHQNAQVjb2xvcgULAgAAAglkaXJlY3Rpb24FCwIAAAMOZW5hYmxlU3BlY3VsYXICAgABAAAAAAAEBmNhbWVyYQ0BAQUIcG9zaXRpb24FCwAEAAAAAAYKbGlnaHRDb2xvcgULBAAABw9saWdodFBpeGVsQ29sb3IFCwQAAAgRdHJhbnNmb3JtZWROb3JtYWwFCwQAAAkTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAACglzcGVjUG93ZXIDBAAACwlzcGVjQ29sb3IFCwQAAAwMY2FsY0xpZ2h0aW5nDgYAAA0GdmVydGV4DgYAAA4IZnJhZ21lbnQOBgAAAwMMAAULBQUIDwRkaWZmAwQAAAkDFg4CCQMeDgICCAULBwMCAgULBQsDAQMAAAAAAAAAAAMDAAsHAgIDAgINBgECAQULAg8DBQsAAAAIEAFyBQsEAAAJAyAOAQkDIQ4CAgIFCwIIBQsFCwULAAgRCXNwZWNWYWx1ZQMEAAAJAxYOAgkDHg4CAhAFCwkDIA4BBAYDAgUFCwIJBQsFCwULBQsDAQMAAAAAAAAAAAMDAA0GAQIBBQsEBgACDwMGAQILBQsJAwgOAgIRAwIKAwMFCwULBQsFCwAAAA0AAAUBBoAKAgYFC5IABQsJAgwOAAULBQsAAQ4AAAUBBoAKAgcFC5IABQsJAgwOAAULBQsA",wo._MODULE="h3d.shader.DirLight",_o.SRC="HXSMFGgzZC5zaGFkZXIuRGlyU2hhZG93EAEGZW5hYmxlAgIAAQAAAAAAAgdVU0VfRVNNAgIAAQAAAAAAAwtzaGFkb3dQb3dlcgMCAAAEB1VTRV9QQ0YCAgABAAAAAAAFC1BDRl9TQU1QTEVTAQIAAQAAAAAABghwY2ZTY2FsZQMCAAAHCXNoYWRvd1JlcwUKAgAACAlzaGFkb3dNYXARAQIAAAkKc2hhZG93UHJvaggCAAAKCnNoYWRvd0JpYXMDAgAACxN0cmFuc2Zvcm1lZFBvc2l0aW9uBQsEAAAMBnNoYWRvdwMEAAANCWRpclNoYWRvdwMEAAAOC3BvaXNzb25EaXNrDwUMBQIAAA8EcmFuZA4GAAAQCGZyYWdtZW50DgYAAAIDDwERAXYDBAAAAwUCCBICZHADBAAACQMeDgIJAysOAQIRAwUMCQMrDgQBA18pyxDH+ilAAwED9P3UeOmOU0ADAQOiRbbz/ZRGQAMBA1CNl24Sq1dAAwUMAwANCQMTDgEGAQkDAg4BAhIDAwEDUPwYc9Fd5UADAwMAAAEQAAAFAgsCAQIFAQsCBAIFCwYEAgwDAQMAAAAAAADwPwMDCBMJdGV4ZWxTaXplBQoEAAAGAgEDAAAAAAAA8D8DAgcFCgUKAAgUCXNoYWRvd1BvcwULBAAABgECCwULAgkIBQsACBUIc2hhZG93VXYFCgQAAAkDOw4BCgIUBQsRAAUKBQoACBYEek1heAMEAAAJAzYOAQoCFAULCAADAwAIFwNyb3QDBAAABgEGAQkCDw4BBgAGAAoCCwULAAADCgILBQsEAAMDCgILBQsIAAMDAwEDH4XrUbgeCUADAwEDAAAAAAAAAEADAwAIGARjb3NSAwQAAAkDAw4BAhcDAwAIGQRzaW5SAwQAAAkDAg4BAhcDAwAIGg5zYW1wbGVTdHJlbmd0aAMEAAAGAgEDAAAAAAAA8D8DCQMnDgECBQEDAwAIGwhvZmZTY2FsZQUKBAAABgECEwUKAgYDBQoADhwBaQEEAAAGFQECAAAAAAECBQEPAQAABQQIHQZvZmZzZXQFCgQAAAYBChECDg8FDAUCHAEFDBEABQoCGwUKBQoABgQCHQUKCQMpDgIGAwYBAhgDCgIdBQoAAAMDBgECGQMKAh0FCgQAAwMDBgAGAQIYAwoCHQUKBAADAwYBAhkDCgIdBQoAAAMDAwUKBQoIHgVkZXB0aAMEAAAJA0EOAwIIEQEGAAIVBQoCHQUKBQoBAwAAAAAAAAAAAwMABoMCDAMLBAYHBgMCFgMCCgMDAh4DAgICGgMBAwAAAAAAAAAAAwMDAAAACwICAgUFCB8Jc2hhZG93UG9zBQsEAAAGAQILBQsCCQgFCwAIIAVkZXB0aAMEAAAJA0AOAgIIEQEJAzsOAQoCHwULEQAFCgUKAwAIIQR6TWF4AwQAAAkDNg4BCgIfBQsIAAMDAAgiBWRlbHRhAwQAAAYDCQMVDgIEBgACIAMCCgMDAwIhAwMCIQMDAAYEAgwDCQM2DgEJAwkOAQYBAgMDAiIDAwMDAwAFBAgjCXNoYWRvd1BvcwULBAAABgECCwULAgkIBQsACCQIc2hhZG93VXYFCgQAAAkDOw4BCgIjBQsRAAUKBQoACCUFZGVwdGgDBAAACQNADgICCBEBCgIkBQoRAAUKAwAGBAIMAwsGBwYDCQM2DgEKAiMFCwgAAwMCCgMDAiUDAgEDAAAAAAAAAAADAQMAAAAAAADwPwMDAwAAAAAAAAYEAg0DAgwDAwA",_o._MODULE="h3d.shader.DirShadow",jo.SRC="HXSMFWgzZC5zaGFkZXIuR2VuVGV4dHVyZQoBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoEbW9kZQECAAEAAAAAAAsFY29sb3IFDAIAAAwIX19pbml0X18OBgAADQZ2ZXJ0ZXgOBgAADghmcmFnbWVudA4GAAADAgwAAAUCBgQCBwUMAggFDAUMBgQCCQUKAgMFCgUKAAANAAAFAQYEAgYFDAkDKw4ECgICBQoAAAMGAQoCAgUKBAADAgQDAwEDAAAAAAAAAAADAQMAAAAAAADwPwMFDAUMAAEOAAAFARMEAgoBAQEBAQIAAAAAAQUBBgQCCAUMCwYHCQMcDgEKAgYFDBEABQoDAQMAAAAAAADwPwMCCQMrDgEBAwAAAAAAAAAAAwUMAgsFDAUMBQwAAAAA",jo._MODULE="h3d.shader.GenTexture",fo.SRC="HXSMFWgzZC5zaGFkZXIuTGluZVNoYWRlcg0BBmNhbWVyYQ0BBgIEdmlldwcAAQADBHByb2oHAAEABAh2aWV3UHJvagcAAQAFCXByb2pEZXB0aAMAAQAGBXpOZWFyAwABAAcEekZhcgMAAQAAAAAIBmdsb2JhbA0CAgkJcGl4ZWxTaXplBQoACAAKCW1vZGVsVmlldwcACAEDAAAACwVpbnB1dA0DAwwIcG9zaXRpb24FCwELAA0Gbm9ybWFsBQsBCwAOAnV2BQoBCwABAAAPBm91dHB1dA0EARAIcG9zaXRpb24FDAQPAAQAABERdHJhbnNmb3JtZWROb3JtYWwFCwQAABITdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAExFwcm9qZWN0ZWRQb3NpdGlvbgUMBAAAFAtsZW5ndGhTY2FsZQMCAAAVBXdpZHRoAwIAABYEcGRpcgUMBAAAFwhfX2luaXRfXw4GAAAYCWxpbmVhcml6ZQ4GAAAZBnZlcnRleA4GAAADAhcAAAUBBQUIGgNkaXIFCwQAAAYBAg0FCwkDMw4BAgoHBgULAAYEAhYFDAYBCQMrDgIGAQIaBQsJAzMOAQICBwYFCwEDAAAAAAAA8D8DBQwCAwcFDAUMBoEKAhYFDBEABQoGAgEDAAAAAAAA8D8DCQMNDgEGAAYBCgIWBQwAAAMKAhYFDAAAAwMGAQoCFgUMBAADCgIWBQwEAAMDAwMDBQoGgAISBQsGAQYBAhoFCwoCDgUKAAADBQsCFAMFCwULBgQCEQULCQMgDgECGgULBQsFCwAAAxgBGwFkAwQAAAMFAwgcAW4DBAAAAgYDAAgdAWYDBAAAAgcDAA0GAgQGAQYBAQMAAAAAAAAAQAMCHAMDAh0DAwMEBgMGAAIdAwIcAwMGAQYBBAYDBgEBAwAAAAAAAABAAwIbAwMBAwAAAAAAAPA/AwMDBAYDAh0DAhwDAwMDAgUDAwMDAwAAABkAAAUBBoAKAhMFDBEABQoGAQYBBgEGAQQGAQoCFgUMBQAFCgkDKQ4CAQMAAAAAAADwPwMBAwAAAAAAAPC/AwUKBQoFCgQGAwoCDgUKBAADAQMAAAAAAADgPwMDAwUKCQIYDgEGAgoCEwUMCAADCgITBQwMAAMDAwUKAgkFCgUKAhUDBQoFCgA",fo._MODULE="h3d.shader.LineShader",mo.SRC="HXSMF2gzZC5zaGFkZXIuTWluTWF4U2hhZGVyCwEFaW5wdXQNAQICCHBvc2l0aW9uBQoBAQADAnV2BQoBAQABAAAEBWZsaXBZAwIAAAUGb3V0cHV0DQICBghwb3NpdGlvbgUMBAUABwVjb2xvcgUMBAUABAAACApwaXhlbENvbG9yBQwEAAAJDGNhbGN1bGF0ZWRVVgUKBAAACgR0ZXhBCgICAAALBHRleEIKAgIAAAwFaXNNYXgCAgABAAAAAAANCF9faW5pdF9fDgYAAA4GdmVydGV4DgYAAA8IZnJhZ21lbnQOBgAAAwINAAAFAgYEAgcFDAIIBQwFDAYEAgkFCgIDBQoFCgAADgAABQEGBAIGBQwJAysOBAoCAgUKAAADBgEKAgIFCgQAAwIEAwMBAwAAAAAAAAAAAwEDAAAAAAAA8D8DBQwFDAABDwAABQMIEAFhBQwEAAAJAyIOAgIKCgICCQUKBQwACBEBYgUMBAAACQMiDgICCwoCAgkFCgUMAAYEAggFDAsCDAIJAxYOAgIQBQwCEQUMBQwJAxUOAgIQBQwCEQUMBQwFDAUMAA",mo._MODULE="h3d.shader.MinMaxShader",bi.SRC="HXSMG2gzZC5zaGFkZXIuQ3ViZU1pbk1heFNoYWRlcgwBBWlucHV0DQECAghwb3NpdGlvbgUKAQEAAwJ1dgUKAQEAAQAABAVmbGlwWQMCAAAFBm91dHB1dA0CAgYIcG9zaXRpb24FDAQFAAcFY29sb3IFDAQFAAQAAAgKcGl4ZWxDb2xvcgUMBAAACQxjYWxjdWxhdGVkVVYFCgQAAAoEdGV4QQoGAgAACwR0ZXhCCgYCAAAMBWlzTWF4AgIAAQAAAAAADQNtYXQGAgAADghfX2luaXRfXw4GAAAPBnZlcnRleA4GAAAQCGZyYWdtZW50DgYAAAMCDgAABQIGBAIHBQwCCAUMBQwGBAIJBQoCAwUKBQoAAA8AAAUBBgQCBgUMCQMrDgQKAgIFCgAAAwYBCgICBQoEAAMCBAMDAQMAAAAAAAAAAAMBAwAAAAAAAPA/AwUMBQwAARAAAAUFCBECdXYFCgQAAAYDBgECCQUKAQMAAAAAAAAAQAMFCgEDAAAAAAAA8D8DBQoACBIDZGlyBQsEAAAGAQkDKg4CAhEFCgEDAAAAAAAA8D8DBQsCDQYFCwAIEwFhBQwEAAAJAyIOAgIKCgYCEgULBQwACBQBYgUMBAAACQMiDgICCwoGAhIFCwUMAAYEAggFDAsCDAIJAxYOAgITBQwCFAUMBQwJAxUOAgITBQwCFAUMBQwFDAUMAA",bi._MODULE="h3d.shader.MinMaxShader",uo.SRC="HXSMFGgzZC5zaGFkZXIuTm9ybWFsTWFwCgEGY2FtZXJhDQECAghwb3NpdGlvbgULAAEAAwNkaXIFCwMBAAAAAAQGZ2xvYmFsDQIBBQltb2RlbFZpZXcHAAQBAwAAAAYFaW5wdXQNAwMHAnV2BQoBBgAIBm5vcm1hbAULAQYACQd0YW5nZW50BQsBBgABAAAKB3RleHR1cmUKAgIAAAsMY2FsY3VsYXRlZFVWBQoEAAAME3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAA0RdHJhbnNmb3JtZWROb3JtYWwFCwQAAA4SdHJhbnNmb3JtZWRUYW5nZW50BQwDAAAPDl9faW5pdF9fdmVydGV4DgYAABAIZnJhZ21lbnQOBgAAAgIPAAAFAgYEAg4FDAkDKw4CBgECCQULCQMzDgECBQcGBQsLBgcJAx4OAgIJBQsCCQULAwEDAAAAAAAA4D8DAgEDAAAAAAAA8D8DAQMAAAAAAADwvwMDBQwFDAYEAgsFCgIHBQoFCgABEAAABQUIEQFuBQsEAAACDQULAAgSAm5mBQsEAAAJAzoOAQkDIg4CAgoKAgILBQoFDAULAAgTBHRhblgFCwQAAAkDIA4BCgIOBQySAAULBQsACBQEdGFuWQULBAAABgEJAx8OAgIRBQsCEwULBQsHAwoCDgUMDAADAwULAAYEAg0FCwkDIA4BBAYABgAGAQoCEgULAAADAhMFCwULBgEKAhIFCwQAAwIUBQsFCwULBgEKAhIFCwgAAwIRBQsFCwULBQsFCwULAA",uo._MODULE="h3d.shader.NormalMap",vi.SRC="HXSMEWgzZC5zaGFkZXIuU2hhZG93BgEGc2hhZG93DQEFAgNtYXARAQABAAMEcHJvaggAAQAEBWNvbG9yBQsAAQAFBXBvd2VyAwABAAYEYmlhcwMAAQAAAAAHCnBpeGVsQ29sb3IFDAQAAAgTdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAACRhwaXhlbFRyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAoJc2hhZG93UG9zBQsEAAEBCwhmcmFnbWVudA4GAAABAQsAAAUGCAwJc2hhZG93UG9zBQsEAAAGAQIJBQsCAwgFCwAIDQVkZXB0aAMEAAAJA0AOAgICEQEJAzsOAQoCDAULEQAFCgUKAwAIDgR6TWF4AwQAAAkDNg4BCgIMBQsIAAMDAAgPBWRlbHRhAwQAAAYDCQMVDgIEBgACDQMCBgMDAwIOAwMCDgMDAAgQBXNoYWRlAwQAAAkDNg4BCQMJDgEGAQIFAwIPAwMDAwAGgQoCBwUMkgAFCwYABgEEBgMBAwAAAAAAAPA/AwIQAwMDCgIEBQuSAAULBQsCEAMFCwULAA",vi._MODULE="h3d.shader.Shadow",Ii.SRC="HXSMEGgzZC5zaGFkZXIuVXRpbHMHAQtib25lTWF0cml4WAgEAAACC2JvbmVNYXRyaXhZCAQAAAMLYm9uZU1hdHJpeFoIBAAABAtib25lTWF0cml4VwgEAAAFC3NraW5XZWlnaHRzBQwEAAAGDmFwcGx5U2tpblBvaW50DgYAAAcMYXBwbHlTa2luVmVjDgYAAAIDBgEIAXAFCwQAAAULBQMICQt0cmFuc2Zvcm1lZAULBAAABgAGAAYBBAYBAggFCwIBCAULBQsKAgUFDAAAAwULBgEEBgECCAULAgIIBQsFCwoCBQUMBAADBQsFCwYBBAYBAggFCwIDCAULBQsKAgUFDAgAAwULBQsACwYHCgIFBQwMAAMBAwAAAAAAAAAAAwIFAQaAAgkFCwYBBAYBAggFCwIECAULBQsKAgUFDAwAAwULBQsAAAANAgkFCwAAAwcBCgF2BQsEAAAFCwUDCAsLdHJhbnNmb3JtZWQFCwQAAAYABgAGAQQGAQIKBQsJAzMOAQIBCAYFCwULCgIFBQwAAAMFCwYBBAYBAgoFCwkDMw4BAgIIBgULBQsKAgUFDAQAAwULBQsGAQQGAQIKBQsJAzMOAQIDCAYFCwULCgIFBQwIAAMFCwULAAsGBwoCBQUMDAADAQMAAAAAAAAAAAMCBQEGgAILBQsGAQQGAQIKBQsJAzMOAQIECAYFCwULCgIFBQwMAAMFCwULAAAADQILBQsAAA",Ii._MODULE="h3d.shader.Skin",An.SRC="HXSME2gzZC5zaGFkZXIuU2tpbkJhc2UIARByZWxhdGl2ZVBvc2l0aW9uBQsEAAACE3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAMRdHJhbnNmb3JtZWROb3JtYWwFCwQAAAQITWF4Qm9uZXMBAgABAAAAAAAFEWZvdXJCb25lc0J5VmVydGV4AgIAAQAAAAAABgtjYWxjUHJldlBvcwICAAEAAAAAAAcNYm9uZXNNYXRyaXhlcw8IBAIAAQgIEXByZXZCb25lc01hdHJpeGVzDwgEAgABCAA",An._MODULE="h3d.shader.SkinBase",co.SRC="HXSMD2gzZC5zaGFkZXIuU2tpbhIBEHJlbGF0aXZlUG9zaXRpb24FCwQAAAITdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAAxF0cmFuc2Zvcm1lZE5vcm1hbAULBAAABAhNYXhCb25lcwECAAEAAAAAAAURZm91ckJvbmVzQnlWZXJ0ZXgCAgABAAAAAAAGC2NhbGNQcmV2UG9zAgIAAQAAAAAABw1ib25lc01hdHJpeGVzDwgEAgABCAgRcHJldkJvbmVzTWF0cml4ZXMPCAQCAAEICQtib25lTWF0cml4WAgEAAAKC2JvbmVNYXRyaXhZCAQAAAsLYm9uZU1hdHJpeFoIBAAADAtib25lTWF0cml4VwgEAAANC3NraW5XZWlnaHRzBQwEAAAOBWlucHV0DQEEDwhwb3NpdGlvbgULAQ4AEAZub3JtYWwFCwEOABEHd2VpZ2h0cwULAQ4AEgdpbmRleGVzCQQAAAABDgABAAATG3ByZXZpb3VzVHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAFA5hcHBseVNraW5Qb2ludA4GAAAVDGFwcGx5U2tpblZlYw4GAAAWBnZlcnRleA4GAAADAxQBFwFwBQsEAAAFCwUDCBgLdHJhbnNmb3JtZWQFCwQAAAYABgAGAQQGAQIXBQsCCQgFCwULCgINBQwAAAMFCwYBBAYBAhcFCwIKCAULBQsKAg0FDAQAAwULBQsGAQQGAQIXBQsCCwgFCwULCgINBQwIAAMFCwULAAsGBwoCDQUMDAADAQMAAAAAAAAAAAMCBQEGgAIYBQsGAQQGAQIXBQsCDAgFCwULCgINBQwMAAMFCwULAAAADQIYBQsAAAMVARkBdgULBAAABQsFAwgaC3RyYW5zZm9ybWVkBQsEAAAGAAYABgEEBgECGQULCQMzDgECCQgGBQsFCwoCDQUMAAADBQsGAQQGAQIZBQsJAzMOAQIKCAYFCwULCgINBQwEAAMFCwULBgEEBgECGQULCQMzDgECCwgGBQsFCwoCDQUMCAADBQsFCwALBgcKAg0FDAwAAwEDAAAAAAAAAAADAgUBBoACGgULBgEEBgECGQULCQMzDgECDAgGBQsFCwoCDQUMDAADBQsFCwAAAA0CGgULAAAAFgAABQsLAgYCBQcGBAIJCBECCA8IBAkDJg4BCgISCQQAAAAAAAMBCAgGBAIKCBECCA8IBAkDJg4BCgISCQQAAAAEAAMBCAgGBAILCBECCA8IBAkDJg4BCgISCQQAAAAIAAMBCAgGBAIMCBECCA8IBAkDJg4BCgISCQQAAAAMAAMBCAgGBAINBQwJAysOAgIRBQsBAwAAAAAAAAAAAwUMBQwLAgUCBgQKAg0FDAwAAwYDAQMAAAAAAADwPwMEBgAGAAoCEQULAAADCgIRBQsEAAMDCgIRBQsIAAMDAwMDAAAGBAITBQsJAhQOAQIBBQsFCwULAAAABgQCCQgRAgcPCAQJAyYOAQoCEgkEAAAAAAADAQgIBgQCCggRAgcPCAQJAyYOAQoCEgkEAAAABAADAQgIBgQCCwgRAgcPCAQJAyYOAQoCEgkEAAAACAADAQgIBgQCDAgRAgcPCAQJAyYOAQoCEgkEAAAADAADAQgIBgQCDQUMCQMrDgICEQULAQMAAAAAAAAAAAMFDAUMCwIFAgYECgINBQwMAAMGAwEDAAAAAAAA8D8DBAYABgAKAhEFCwAAAwoCEQULBAADAwoCEQULCAADAwMDAwAABgQCAgULCQIUDgECAQULBQsFCwYEAgMFCwkCFQ4BAhAFCwULBQsGBAIDBQsJAyAOAQIDBQsFCwULCwcCAgYCAgYEAhMFCwICBQsFCwAAAA",co._MODULE="h3d.shader.Skin",Bs.SRC="HXSMFmgzZC5zaGFkZXIuU2tpblRhbmdlbnQTARByZWxhdGl2ZVBvc2l0aW9uBQsEAAACE3RyYW5zZm9ybWVkUG9zaXRpb24FCwQAAAMRdHJhbnNmb3JtZWROb3JtYWwFCwQAAAQITWF4Qm9uZXMBAgABAAAAAAAFEWZvdXJCb25lc0J5VmVydGV4AgIAAQAAAAAABgtjYWxjUHJldlBvcwICAAEAAAAAAAcNYm9uZXNNYXRyaXhlcw8IBAIAAQgIEXByZXZCb25lc01hdHJpeGVzDwgEAgABCAkLYm9uZU1hdHJpeFgIBAAACgtib25lTWF0cml4WQgEAAALC2JvbmVNYXRyaXhaCAQAAAwLYm9uZU1hdHJpeFcIBAAADQtza2luV2VpZ2h0cwUMBAAADgVpbnB1dA0BBQ8IcG9zaXRpb24FCwEOABAGbm9ybWFsBQsBDgARB3RhbmdlbnQFCwEOABIHd2VpZ2h0cwULAQ4AEwdpbmRleGVzCQQAAAABDgABAAAUEnRyYW5zZm9ybWVkVGFuZ2VudAUMBAAAFRtwcmV2aW91c1RyYW5zZm9ybWVkUG9zaXRpb24FCwQAABYOYXBwbHlTa2luUG9pbnQOBgAAFwxhcHBseVNraW5WZWMOBgAAGAZ2ZXJ0ZXgOBgAAAwMWARkBcAULBAAABQsFAwgaC3RyYW5zZm9ybWVkBQsEAAAGAAYABgEEBgECGQULAgkIBQsFCwoCDQUMAAADBQsGAQQGAQIZBQsCCggFCwULCgINBQwEAAMFCwULBgEEBgECGQULAgsIBQsFCwoCDQUMCAADBQsFCwALBgcKAg0FDAwAAwEDAAAAAAAAAAADAgUBBoACGgULBgEEBgECGQULAgwIBQsFCwoCDQUMDAADBQsFCwAAAA0CGgULAAADFwEbAXYFCwQAAAULBQMIHAt0cmFuc2Zvcm1lZAULBAAABgAGAAYBBAYBAhsFCwkDMw4BAgkIBgULBQsKAg0FDAAAAwULBgEEBgECGwULCQMzDgECCggGBQsFCwoCDQUMBAADBQsFCwYBBAYBAhsFCwkDMw4BAgsIBgULBQsKAg0FDAgAAwULBQsACwYHCgINBQwMAAMBAwAAAAAAAAAAAwIFAQaAAhwFCwYBBAYBAhsFCwkDMw4BAgwIBgULBQsKAg0FDAwAAwULBQsAAAANAhwFCwAAABgAAAUNCwIGAgUHBgQCCQgRAggPCAQJAyYOAQoCEwkEAAAAAAADAQgIBgQCCggRAggPCAQJAyYOAQoCEwkEAAAABAADAQgIBgQCCwgRAggPCAQJAyYOAQoCEwkEAAAACAADAQgIBgQCDAgRAggPCAQJAyYOAQoCEwkEAAAADAADAQgIBgQCDQUMCQMrDgICEgULAQMAAAAAAAAAAAMFDAUMCwIFAgYECgINBQwMAAMGAwEDAAAAAAAA8D8DBAYABgAKAhIFCwAAAwoCEgULBAADAwoCEgULCAADAwMDAwAABgQCFQULCQIWDgECAQULBQsFCwAAAAYEAgkIEQIHDwgECQMmDgEKAhMJBAAAAAAAAwEICAYEAgoIEQIHDwgECQMmDgEKAhMJBAAAAAQAAwEICAYEAgsIEQIHDwgECQMmDgEKAhMJBAAAAAgAAwEICAYEAgwIEQIHDwgECQMmDgEKAhMJBAAAAAwAAwEICAYEAg0FDAkDKw4CAhIFCwEDAAAAAAAAAAADBQwFDAsCBQIGBAoCDQUMDAADBgMBAwAAAAAAAPA/AwQGAAYACgISBQsAAAMKAhIFCwQAAwMKAhIFCwgAAwMDAwMAAAYEAgIFCwkCFg4BAgEFCwULBQsGBAIDBQsJAhcOAQIQBQsFCwULBgQKAhQFDJIABQsJAhcOAQoCEQULkgAFCwULBQsGBAIDBQsJAyAOAQIDBQsFCwULBgQKAhQFDJIABQsJAyAOAQoCFAUMkgAFCwULBQsLBwICBgICBgQCFQULAgIFCwULAAAA",Bs._MODULE="h3d.shader.SkinTangent",ao.SRC="HXSMGmgzZC5zaGFkZXIuU3BlY3VsYXJUZXh0dXJlBAEHdGV4dHVyZQoCAgAAAgxjYWxjdWxhdGVkVVYFCgQAAAMJc3BlY0NvbG9yBQsEAAAECGZyYWdtZW50DgYAAAEBBAAABQEGgQIDBQsKCQMiDgICAQoCAgIFCgUMkgAFCwULAA",ao._MODULE="h3d.shader.SpecularTexture",oo.SRC="HXSMEmgzZC5zaGFkZXIuVGV4dHVyZQsBBWlucHV0DQEBAgJ1dgUKAQEAAQAAAwhhZGRpdGl2ZQICAAEAAAAAAAQJa2lsbEFscGhhAgIAAQAAAAAABQ1zcGVjdWxhckFscGhhAgIAAQAAAAAABhJraWxsQWxwaGFUaHJlc2hvbGQDAgABBwAAAAAAAAAAAAAAAAAA8D8HB3RleHR1cmUKAgIAAAgMY2FsY3VsYXRlZFVWBQoEAAAJCnBpeGVsQ29sb3IFDAQAAAoJc3BlY0NvbG9yBQsEAAALBnZlcnRleA4GAAAMCGZyYWdtZW50DgYAAAIACwAABQEGBAIIBQoCAgUKBQoAAQwAAAUECA0BYwUMBAAACQMiDgICBwoCAggFCgUMAAsGDgIEAgYJBgMKAg0FDAwAAwIGAwMBAwAAAAAAAAAAAwICDAAAAAsCAwIGgAIJBQwCDQUMBQwGgQIJBQwCDQUMBQwACwIFAgaBAgoFCwoCDQUM/gAFCwULAAAA",oo._MODULE="h3d.shader.Texture",Jn.SRC="HXSMEmgzZC5zaGFkZXIuVVZEZWx0YQQBB3V2RGVsdGEFCgIAAAIHdXZTY2FsZQUKAgAAAwxjYWxjdWxhdGVkVVYFCgQAAAQGdmVydGV4DgYAAAEABAAABQEGBAIDBQoGAAYBAgMFCgICBQoFCgIBBQoFCgUKAA",Jn._MODULE="h3d.shader.UVDelta",so.SRC="HXSMG2gzZC5zaGFkZXIuVmVydGV4Q29sb3JBbHBoYQQBBWlucHV0DQEBAgVjb2xvcgUMAQEAAQAAAwpwaXhlbENvbG9yBQwEAAAECGFkZGl0aXZlAgIAAQAAAAAABQhmcmFnbWVudA4GAAABAQUAAAUBCwIEAgaAAgMFDAICBQwFDAaBAgMFDAICBQwFDAAA",so._MODULE="h3d.shader.VertexColorAlpha",no.SRC="HXSMFmgzZC5zaGFkZXIuVm9sdW1lRGVjYWwdAQZjYW1lcmENAQwCBHZpZXcHAAEAAwRwcm9qBwABAAQIcG9zaXRpb24FCwABAAUIcHJvakZsaXADAAEABghwcm9qRGlhZwULAAEABwh2aWV3UHJvagcAAQAIEHByZXZpb3VzVmlld1Byb2oHAAEACQ9pbnZlcnNlVmlld1Byb2oHAAEACgV6TmVhcgMAAQALBHpGYXIDAAEADANkaXIFCwMBAA0Naml0dGVyT2Zmc2V0cwUMAAEAAAAADgZnbG9iYWwNAgUPBHRpbWUDAA4AEAlwaXhlbFNpemUFCgAOABEJbW9kZWxWaWV3BwAOAQMSEG1vZGVsVmlld0ludmVyc2UHAA4BAxMRcHJldmlvdXNNb2RlbFZpZXcHAA4BAwAAABQFaW5wdXQNAwIVCHBvc2l0aW9uBQsBFAAWBm5vcm1hbAULARQAAQAAFwZvdXRwdXQNBAYYCHBvc2l0aW9uBQwEFwAZBWNvbG9yBQwEFwAaBWRlcHRoAwQXABsGbm9ybWFsBQsEFwAcCXdvcmxkRGlzdAMEFwAdCHZlbG9jaXR5BQoEFwAEAAAeEHJlbGF0aXZlUG9zaXRpb24FCwQAAB8TdHJhbnNmb3JtZWRQb3NpdGlvbgULBAAAIBtwcmV2aW91c1RyYW5zZm9ybWVkUG9zaXRpb24FCwQAACEYcGl4ZWxUcmFuc2Zvcm1lZFBvc2l0aW9uBQsEAAAiEXRyYW5zZm9ybWVkTm9ybWFsBQsEAAAjEXByb2plY3RlZFBvc2l0aW9uBQwEAAAkGXByZXZpb3VzUHJvamVjdGVkUG9zaXRpb24FDAQAACUKcGl4ZWxDb2xvcgUMBAAAJgVkZXB0aAMEAAAnC25kY1Bvc2l0aW9uBQoEAAAoE3ByZXZpb3VzTmRjUG9zaXRpb24FCgQAACkIc2NyZWVuVVYFCgQAACoJc3BlY1Bvd2VyAwQAACsJc3BlY0NvbG9yBQsEAAAsCXdvcmxkRGlzdAMEAAAtDXBpeGVsVmVsb2NpdHkFCgQAAC4IZGVwdGhNYXARAQAAAC8Fc2NhbGUFCgIAADAGbm9ybWFsBQsCAAAxB3RhbmdlbnQFCwIAADIKaXNDZW50ZXJlZAICAAEAAAAAADMMY2FsY3VsYXRlZFVWBQoEAAA0EnRyYW5zZm9ybWVkVGFuZ2VudAUMBAAANQ5fX2luaXRfX3ZlcnRleA4GAAA2CGZyYWdtZW50DgYAAAICNQAABQIGBAIiBQsJAyAOAQQGAQIwBQsJAzMOAQIRBwYFCwULBQsFCwYEAjQFDAkDKw4CCQMgDgEEBgECMQULCQMzDgECEQcGBQsFCwULAQMAAAAAAADwPwMFDAUMAAE2AAAFCQg3Bm1hdHJpeAcEAAAGAQIJBwISBwcACDgJc2NyZWVuUG9zBQoEAAAGAgoCIwUMEQAFCgoCIwUMDAADBQoACDkDcnV2BQwEAAAJAysOAwI4BQoJA0AOAgIuEQEJAzsOAQI4BQoFCgMBAwAAAAAAAPA/AwUMAAg6BHdwb3MFDAQAAAYBAjkFDAI3BwUMAAg7BHBwb3MFDAQAAAYBAjkFDAIJBwUMAAYEAiEFCwYCCgI7BQySAAULCgI7BQwMAAMFCwULBgQCMwUKBgECLwUKBAYCCgI6BQwRAAUKCgI6BQwMAAMFCgUKBQoFCgsCMgIGgAIzBQoBAwAAAAAAAOA/AwUKAAALBgkJAxUOAgkDFQ4CCgIzBQoAAAMKAjMFCgQAAwMJAxUOAgYDAQMAAAAAAADwPwMKAjMFCgAAAwMGAwEDAAAAAAAA8D8DCgIzBQoEAAMDAwMBAwAAAAAAAAAAAwIMAAAAAA",no._MODULE="h3d.shader.VolumeDecal",Bn.pending=[],Bn.threadCount=0,qt.DEFAULT_RESOLVER=new _a,qt.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",Nn.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Nn.BYTES=A.ofString(Nn.CHARS),yt.helper=new DataView(new ArrayBuffer(8)),zs.escapes=function(){var n,t=new fe;return t.h.lt="<",t.h.gt=">",t.h.amp="&",t.h.quot='"',t.h.apos="'",n=t,n}(this),ut.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1],ut.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ut.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1],ut.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ut.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Mt.F32=0,Mt.F16=1,Mt.U8=2,Mt.S8=3,Mt.SIZES=[4,2,1,1],Pt.DFloat=1,Pt.DVec2=2,Pt.DVec3=3,Pt.DVec4=4,Pt.DMat4=16,Pt.DBytes4=9,y._UID=0,y.ALL_FORMATS=new fe,Ln.UID=0,Ln.CACHE=new le,Ln._UID=0,Ln.MAX_FORMATS=16,gt.ASCII=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",gt.LATIN1="-",gt.CYRILLIC="",gt.POLISH="",gt.TURKISH="I",gt.JP_KANA="",gt.UNICODE_SPECIALS="",gt.DEFAULT_CHARS=gt.ASCII+gt.LATIN1,gt.complementChars=function(){var t,n,i,a,s="",o=new le;for(t=0,i=s.length;t<i;)a=t++,o.h[u.cca(s,a)]=!0;return n=o,n}(this),p.BACKSPACE=8,p.TAB=9,p.ENTER=13,p.SHIFT=16,p.CTRL=17,p.ALT=18,p.ESCAPE=27,p.SPACE=32,p.PGUP=33,p.PGDOWN=34,p.END=35,p.HOME=36,p.LEFT=37,p.UP=38,p.RIGHT=39,p.DOWN=40,p.INSERT=45,p.DELETE=46,p.QWERTY_EQUALS=187,p.QWERTY_MINUS=189,p.QWERTY_TILDE=192,p.QWERTY_BRACKET_LEFT=219,p.QWERTY_BRACKET_RIGHT=221,p.QWERTY_SEMICOLON=186,p.QWERTY_QUOTE=222,p.QWERTY_BACKSLASH=220,p.QWERTY_COMMA=188,p.QWERTY_PERIOD=190,p.QWERTY_SLASH=191,p.INTL_BACKSLASH=226,p.LEFT_WINDOW_KEY=91,p.RIGHT_WINDOW_KEY=92,p.CONTEXT_MENU=93,p.PAUSE_BREAK=19,p.CAPS_LOCK=20,p.NUM_LOCK=144,p.SCROLL_LOCK=145,p.NUMBER_0=48,p.NUMBER_1=49,p.NUMBER_2=50,p.NUMBER_3=51,p.NUMBER_4=52,p.NUMBER_5=53,p.NUMBER_6=54,p.NUMBER_7=55,p.NUMBER_8=56,p.NUMBER_9=57,p.NUMPAD_0=96,p.NUMPAD_1=97,p.NUMPAD_2=98,p.NUMPAD_3=99,p.NUMPAD_4=100,p.NUMPAD_5=101,p.NUMPAD_6=102,p.NUMPAD_7=103,p.NUMPAD_8=104,p.NUMPAD_9=105,p.A=65,p.B=66,p.C=67,p.D=68,p.E=69,p.F=70,p.G=71,p.H=72,p.I=73,p.J=74,p.K=75,p.L=76,p.M=77,p.N=78,p.O=79,p.P=80,p.Q=81,p.R=82,p.S=83,p.T=84,p.U=85,p.V=86,p.W=87,p.X=88,p.Y=89,p.Z=90,p.F1=112,p.F2=113,p.F3=114,p.F4=115,p.F5=116,p.F6=117,p.F7=118,p.F8=119,p.F9=120,p.F10=121,p.F11=122,p.F12=123,p.F13=124,p.F14=125,p.F15=126,p.F16=127,p.F17=128,p.F18=129,p.F19=130,p.F20=131,p.F21=132,p.F22=133,p.F23=134,p.F24=135,p.NUMPAD_MULT=106,p.NUMPAD_ADD=107,p.NUMPAD_ENTER=108,p.NUMPAD_SUB=109,p.NUMPAD_DOT=110,p.NUMPAD_DIV=111,p.MOUSE_LEFT=0,p.MOUSE_RIGHT=1,p.MOUSE_MIDDLE=2,p.MOUSE_BACK=3,p.MOUSE_FORWARD=4,p.MOUSE_WHEEL_UP=5,p.MOUSE_WHEEL_DOWN=6,p.LOC_LEFT=256,p.LOC_RIGHT=512,p.LSHIFT=272,p.RSHIFT=528,p.LCTRL=273,p.RCTRL=529,p.LALT=274,p.RALT=530,p.initDone=!1,p.keyPressed=[],p.ALLOW_KEY_REPEAT=!1,x.PI=3.14159265358979323,x.EPSILON=1e-10,x.EPSILON2=1e-20,za.R=0,za.G=1,za.B=2,za.A=3,N.wantedFPS=60,N.maxDeltaTime=.5,N.smoothFactor=.95,N.lastTimeStamp=u.now()/1e3,N.elapsedTime=0,N.frameCount=0,N.dt=1/N.wantedFPS,N.currentDT=1/N.wantedFPS,V.setCursor=V.setNativeCursor,V.loopInit=!1,V.fpsLimit=-1,yn.HORIZONTAL=-9007199254740992,yn.TOLERANCE=1e-20,yn.SKIP=-2,yn.UNASSIGNED=-1,ua.QTMP=new In,xa.CURRENT_VERSION=4,es.baseLodConfig=[.5,.2,.01],Qn.BLEND=X.__empty_constructs__.slice(),Qn.CULLING=xt.__empty_constructs__.slice(),Vs.invalidChars=new Ss("[^A-Za-z0-9_]","g"),bo.RELOAD_LFS=[],wn.ENABLED=!1,wn.ENGINE_PACKAGES=["h3d","hxd","h2d","haxe","sys","hrt"],Ba.Dynamic=0,Ba.Static=1,Ba.UniformDynamic=2,Ba.UniformReadWrite=3,Ba.Uniform=4,dt.LIVE_UPDATE=!1,gs.Jpg=0,gs.Png=1,gs.Gif=2,gs.Tga=3,gs.Dds=4,gs.Raw=5,gs.Hdr=6,We.DEFAULT_FILTER=Dn.Linear,We.MIPMAP_MAX_SIZE=0,We.ENABLE_AUTO_WATCH=!0,We.BLACK_1x1=G.alloc(1,1,f.RGBA),We.LOG_TEXTURE_LOAD=!1,Me.BLOCKSIZE=64,Me.W1=2841,Me.W2=2676,Me.W3=2408,Me.W5=1609,Me.W6=1108,Me.W7=565,Me.CF4A=-9,Me.CF4B=111,Me.CF4C=29,Me.CF4D=-3,Me.CF3A=28,Me.CF3B=109,Me.CF3C=-9,Me.CF3X=104,Me.CF3Y=27,Me.CF3Z=-3,Me.CF2A=139,Me.CF2B=-11,Ms.ENABLE_AUTO_WATCH=!0,hi.ID=0,Pi.ID=0,ue.STREAM_DURATION=5,ue.STREAM_BUFFER_SAMPLE_COUNT=44100,ue.BUFFER_QUEUE_LENGTH=2,ue.MAX_SOURCES=16,ue.SOUND_BUFFER_CACHE_SIZE=256,ue.VIRTUAL_VOLUME_THRESHOLD=1e-5,ue.BUFFER_STREAM_SPLIT=16,Ya.FADE_SAMPLES=10,r.UID=0,r.SWIZ=B.__empty_constructs__.slice(),r.MAX_CHANNELS_BITS=3,r.MAX_PARTIAL_MAPPINGS_BITS=7,Eo.SRC="HXSMEGh4c2wuQmF0Y2hTaGFkZXIFAQ9CYXRjaF9IYXNPZmZzZXQCAgABAAAAAAACEEJhdGNoX1VzZVN0b3JhZ2UCAgABAAAAAAADC0JhdGNoX0NvdW50AQIAAQAAEAAABAxCYXRjaF9CdWZmZXIQBQwDAgAABRNCYXRjaF9TdG9yYWdlQnVmZmVyEIIFDAAAAgAAAA",Eo._MODULE="hxsl.BatchShader",C.vec2=i.TVec(2,v.VFloat),C.vec3=i.TVec(3,v.VFloat),C.vec4=i.TVec(4,v.VFloat),C.ivec2=i.TVec(2,v.VInt),C.ivec3=i.TVec(3,v.VInt),C.ivec4=i.TVec(4,v.VInt),He.VAR_IDS=!1,He.TRACE=!1,ft.SWIZ=[B.X,B.Y,B.Z,B.W],_t.KWD_LIST=`attribute const uniform varying buffer shared\r
	coherent volatile restrict readonly writeonly\r
	atomic_uint\r
	layout\r
	centroid flat smooth noperspective\r
	patch sample\r
	break continue do for while switch case default\r
	if else\r
	subroutine\r
	in out inout\r
	float double int void bool true false\r
	invariant precise\r
	discard return\r
	mat2 mat3 mat4 dmat2 dmat3 dmat4\r
	mat2x2 mat2x3 mat2x4 dmat2x2 dmat2x3 dmat2x4\r
	mat3x2 mat3x3 mat3x4 dmat3x2 dmat3x3 dmat3x4\r
	mat4x2 mat4x3 mat4x4 dmat4x2 dmat4x3 dmat4x4\r
	vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 dvec2 dvec3 dvec4\r
	uint uvec2 uvec3 uvec4\r
	lowp mediump highp precision\r
	image1D iimage1D uimage1D\r
	image2D iimage2D uimage2D\r
	image3D iimage3D uimage3D\r
	struct\r
	common partition active\r
	asm\r
	class union enum typedef template this packed\r
	resource\r
	goto\r
	inline noinline public static extern external interface\r
	long short half fixed unsigned superp\r
	input output\r
	hvec2 hvec3 hvec4 fvec2 fvec3 fvec4\r
	sampler3DRect\r
	filter\r
	sizeof cast\r
	namespace using\r
	row_major`,_t.KWDS=function(){var t,n,s,i,o=new fe;for(t=0,n=new Ss(`[ 	\r
]+`,"g").split(_t.KWD_LIST);t<n.length;)i=n[t],++t,o.h[i]=!0;return s=o,s}(this),_t.GLOBALS=function(){var n,s,i,a,r,t=[];for(n=0,a=l.__empty_constructs__.slice();n<a.length;)s=a[n],++n,i=""+o.string(s),i=i.charAt(0).toLowerCase()+u.substr(i,1,null),t[s._hx_index]=i;t[l.ToInt._hx_index]="int",t[l.ToFloat._hx_index]="float",t[l.ToBool._hx_index]="bool",t[l.LReflect._hx_index]="reflect",t[l.Mat3x4._hx_index]="_mat3x4",t[l.VertexID._hx_index]="gl_VertexID",t[l.InstanceID._hx_index]="gl_InstanceID",t[l.IVec2._hx_index]="ivec2",t[l.IVec3._hx_index]="ivec3",t[l.IVec4._hx_index]="ivec4",t[l.BVec2._hx_index]="bvec2",t[l.BVec3._hx_index]="bvec3",t[l.BVec4._hx_index]="bvec4",t[l.FragCoord._hx_index]="gl_FragCoord",t[l.FrontFacing._hx_index]="gl_FrontFacing",t[l.FloatBitsToUint._hx_index]="_floatBitsToUint",t[l.UintBitsToFloat._hx_index]="_uintBitsToFloat",t[l.ComputeVar_LocalInvocation._hx_index]="ivec3(gl_LocalInvocationID)",t[l.ComputeVar_GlobalInvocation._hx_index]="ivec3(gl_GlobalInvocationID)",t[l.ComputeVar_LocalInvocationIndex._hx_index]="int(gl_LocalInvocationIndex)",t[l.ComputeVar_WorkGroup._hx_index]="ivec3(gl_WorkGroupID)";for(n=0;n<t.length;)s=t[n],++n,_t.KWDS.h[s]=!0;return r=t,r}(this),_t.MAT34="struct _mat3x4 { vec4 a; vec4 b; vec4 c; };",ni.UID=0,Z.SWIZ=["x","y","z","w"],ta.UID=0,pe.TVECS=new le,pe.TDIMS=Ke.__empty_constructs__.slice(),pe.BOPS=function(){var t,n=T.__empty_constructs__.slice();return n.splice(T.OpAssignOp(null)._hx_index,0,null),t=n,t}(this),pe.UNOPS=ln.__empty_constructs__.slice(),pe.TGLOBALS=l.__empty_constructs__.slice(),pe.TSWIZ=new le,pe.REGS=[B.X,B.Y,B.Z,B.W],pe.VKINDS=O.__empty_constructs__.slice(),pe.PRECS=zo.__empty_constructs__.slice(),pe.FKIND=de.__empty_constructs__.slice(),pe.SIGN=9204765,Ge.MAX_LIST_SIZE=0,Ge.ALLOW_DUPLICATES=!0,ia.UID=0,st.UNROLL_LOOPS=!1,st.SHADER_RESOLVE=new fe,Ko.main(),Bn.run()})(typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this)